{"version":3,"file":"dbox.js","sources":["../lib/carto/carto.js","../lib/helper.js","../lib/chart.js","../../bars/bars.js","../../distro/distrochart.js","../../distro/distro.js","../../heatmap/heatmap.js","../../leaflet/leaflet.js","../../map/map.js","../../radar/radar.js","../../scatter/scatter.js","../../spineplot/spineplot.js","../../timeline/timeline.js","../../treemap/treemap.js","../index.dev.js"],"sourcesContent":["/*\n * CartoDB helper function\n */\n\nimport * as cartodb from \"cartodb\";\nexport default function carto() {\n\n  function carto(){\n\n  }\n\n  carto.query = function(config, callback){\n    //Config the cartdb User\n    var sql = new cartodb.SQL({ user: config.cartodb.user });\n    //Execute the query\n    sql.execute(config.cartodb.sql)\n      .done(function(data){\n\n        var result = data.rows;\n        //parse the data\n        if( config.parser ){\n          result = data.rows.map(config.parser)\n        }\n        //execute the callback with no error\n        callback(null, result);\n      })\n      .error(function(error){\n        //Return the error\n        callback(error, null);\n      })\n  }\n\n  return carto;\n}\n","import * as d3 from 'd3';\nvar d3Tip = require('d3-tip');\n\nexport default function () {\n\n  var vm = this; // Hard binded to chart\n\n  var Helper = {\n    chart: {\n      config: vm._config,\n      width: vm._width,\n      height: vm._height,\n      style: vm._addStyle,\n      fullSvg: function () {\n        return vm._fullSvg;\n      },\n      svg: function () {\n        return vm._svg;\n      },\n    },\n    utils: {\n      d3: {}\n    }\n  };\n\n  Helper.utils.d3.tip = d3Tip;\n\n  Helper.utils.generateScale = function (data, config) {\n    var scale = {};\n    var domains;\n    if (!config.range) {\n      throw 'Range is not defined';\n    }\n    // Used in bars.js when we want to create a groupBy or stackBy bar chart\n    if (config.groupBy && config.groupBy == 'parent') {\n      // Axis of type band \n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    } else if (config.stackBy && config.stackBy == 'parent') {\n      domains = data[0].map(function (d) {\n        return d.data[config.column];\n      });\n    } else if (config.groupBy == 'children') {\n      // GroupBy Columns\n      domains = config.column;\n    } else if (config.groupBy == 'data') {\n      // Considering the highest value on all the columns for each groupBy column\n      domains = [0, d3.max(data, function (d) {\n        return d3.max(config.column, function (column) {\n          return d[column];\n        });\n      })];\n    } else if (config.stackBy == 'data') {\n      // Using a d3.stack() \n      domains = [0, d3.max(data, function (serie) {\n        return d3.max(serie, function (d) {\n          return d[1];\n        });\n      })];\n    } else if (config.groupBy == undefined && config.type == 'band') {\n      // In case the axis is of type band and there is no groupby\n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    } else if (config.type === 'linear') {\n      // Axis of type numeric\n      domains = d3.extent(data, function (d) {\n        return +d[config.column];\n      });\n    } else {\n      // Axis of type band\n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    }\n\n    if (config.minZero) {\n      domains = [0, d3.max(data, function (d) {\n        return +d[config.column];\n      })];\n    }\n    if (config.domains && Array.isArray(config.domains)) {\n      domains = config.domains;\n    }\n\n    if (config.type) {\n      switch (config.type) {\n      case 'linear':\n        scale = d3.scaleLinear()\n          .rangeRound(config.range)\n          .domain(domains);\n        break;\n\n      case 'time':\n        scale = d3.scaleTime()\n          .range(config.range);\n        // .domain(domains);\n        break;\n\n      case 'ordinal':\n        scale = d3.scaleBand()\n          .rangeRound(config.range)\n          .padding(0.1)\n          .domain(domains);\n        break;\n\n      case 'band':\n        scale = d3.scaleBand()\n          .rangeRound(config.range)\n          .domain(domains)\n          .padding(0.1);\n        break;\n\n      case 'quantile':\n        scale = d3.scaleBand()\n          .rangeRound(config.range)\n          .padding(0.1)\n          .domain(data.map(function (d) {\n            return d[config.column];\n          }));\n        if (!config.bins) {\n          config.bins = 10;\n        }\n        scale = d3.scaleQuantile()\n          .range(d3.range(config.bins));\n        break;\n\n      default:\n        scale = d3.scaleLinear()\n          .rangeRound(config.range)\n          .domain(domains);\n        break;\n      }\n    } else {\n      scale = d3.scaleLinear()\n        .rangeRound(config.range)\n        .domain(domains);\n    }\n\n    return scale;\n  };\n\n  Helper.utils.format = function (d) {\n    var value = '';\n    if (vm._config.formatPreffix) {\n      value += vm._config.formatPreffix;\n    }\n    if (d === 0 || d % 1 == 0) {\n      value += d3.format(',.0f')(d);\n    } else if (d < 1 && d > 0) {\n      value += d3.format(',.2f')(d);\n    } else {\n      value += d3.format(',.1f')(d);\n    }\n    if (vm._config.formatSuffix) {\n      value += vm._config.formatSuffix;\n    }\n    return value;\n  };\n\n  // wrap function used in x axis labels\n  Helper.utils.wrap = function(text, width, tooltip) {\n    text.each(function () {\n      var text = d3.select(this),\n        words = text.text().split(/\\s+/).reverse(),\n        word,\n        line = [],\n        lineNumber = 0,\n        lineHeight = 1.1, // ems\n        y = text.attr('y'),\n        dy = parseFloat(text.attr('dy')) || 0,\n        tspan = text.text(null).append('tspan').attr('x', 0).attr('y', y).attr('dy', dy + 'em');\n\n      while (word = words.pop()) {\n        line.push(word);\n        tspan.text(line.join(' '));\n        if (tspan.node().getComputedTextLength() > width) {\n          line.pop();\n          tspan.text(line.join(' '));\n          line = [word];\n          tspan = text.append('tspan').attr('x', 0).attr('y', y).attr('dy', ++lineNumber * lineHeight + dy + 'em').text(word);\n\n          if (lineNumber > 0) {\n            if (words.length > 0 && tspan.node().getComputedTextLength() > width) {\n              if (tooltip) {\n                text\n                  .on('mouseover', tooltip.show)\n                  .on('mouseout', tooltip.hide);\n              }\n              let i = 1;\n              while (tspan.node().getComputedTextLength() > width) {\n                tspan.text(function () {\n                  return tspan.text().slice(0, -i) + '...';\n                });\n                ++i;\n              }\n            }\n            words = [];\n          } else {\n            let i = 1;\n            while (tspan.node().getComputedTextLength() > width) {\n              tspan.text(function () {\n                return tspan.text().slice(0, -i) + '...';\n              });\n              ++i;\n            }\n          }\n        }\n      }\n    });\n  };\n\n  Helper.utils.sortAscending = function (a, b) {\n    if (!Number.isNaN(+a) && !Number.isNaN(+b)) {\n      // If both values are numbers use numeric value\n      return Number(a) - Number(b);\n    } else if (!Number.isNaN(+a) && Number.isNaN(+b)) {\n      return -1;\n    } else if (Number.isNaN(+a) && !Number.isNaN(+b)) {\n      return 1;\n    } else if (a <= b) {\n      return -1;\n    } else {\n      return 1;\n    }\n  };\n\n  Helper.utils.sortDescending = function (a, b) {\n    if (!Number.isNaN(+b) && !Number.isNaN(+a)) {\n      // If both values are numbers use numeric value\n      return Number(b) - Number(a);\n    } else if (!Number.isNaN(+b) && Number.isNaN(+a)) {\n      return -1;\n    } else if (Number.isNaN(+b) && !Number.isNaN(+a)) {\n      return 1;\n    } else if (b <= a) {\n      return -1;\n    } else {\n      return 1;\n    }\n  };\n\n  return Helper;\n}\n","import * as d3 from 'd3';\nimport * as _ from 'lodash';\n\nimport carto from './carto/carto';\nimport Helper from './helper';\n\n/**\n * Dbox Chart core\n */\nexport default function (config) {\n\n  const Chart = {};\n\n  Chart.init = function (config) {\n    const vm = this;\n\n    const defaultConfig = {\n      size: {\n        width: 800,\n        height: 600,\n        margin: {\n          left: 0,\n          right: 0,\n          top: 0,\n          bottom: 0,\n        },\n      },\n    };\n\n    const defaultStyle = {\n      chart: {\n        backgroundColor: {\n          color: 'transparent',\n          // linearGradient : { x1: 0, y1: 0, x2: 1, y2: 1 },\n          // stops: [ [0, '#FCFCFC'], [1, '#F3F2F2'] ]\n        },\n      },\n      title: {\n        textColor: '#E6B537',\n        fontSize: '30px',\n        fontWeight: 600,\n        textAlign: 'center',\n        hr: {\n          enabled: true,\n          borderWidth: '1px',\n          borderColor: '#fff',\n        },\n      },\n      legend: {\n        position: 'bottom',\n        figure: 'circle',\n        text: {\n          textColor: '#fff',\n          fontSize: '20px',\n          fontWeight: 600,\n        },\n      },\n      tooltip: {\n        backgroundColor: '#757575',\n        opacity: 0.9,\n        text: {\n          textColor: '#fff',\n          fontSize: '12px',\n          fontWeight: 600,\n          textAlign: 'center',\n          fontFamily: 'sans-serif',\n          padding: '0.8em',\n        },\n        border: {\n          color: '#5A5C5D',\n          radius: '5px',\n          width: '1px',\n        },\n      },\n      yAxis: {\n        enabled: true,\n        axis: {\n          strokeWidth: 3,\n          strokeColor: '#5F6C6C',\n          strokeOpacity: 0,\n          paddingTick: 0,\n        },\n        ticks: {\n          strokeWidth: 3,\n          strokeColor: '#929D9E',\n          grid: 'dashed',\n          gridDashed: '3, 5',\n          opacity: 0.6,\n        },\n        labels: {\n          fontSize: 12,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'end',\n        },\n        title: {\n          fontSize: 17,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'middle',\n          // rotation\n          // text align or position\n        },\n      },\n      xAxis: {\n        enabled: true,\n        axis: {\n          strokeWidth: 3,\n          strokeColor: '#5F6C6C',\n          strokeOpacity: 1,\n          paddingTick: 5,\n        },\n        ticks: {\n          strokeWidth: 1,\n          strokeColor: '#5F6C6C',\n          // ticksize\n        },\n        labels: {\n          fontSize: 12,\n          fontWeight: 400,\n          textColor: '#fff',\n          textAnchor: 'middle',\n        },\n        title: {\n          fontSize: 17,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'middle',\n          // text align\n        },\n      },\n    };\n\n    vm._config = config ? _.cloneDeep(config) : defaultConfig;\n\n\n    vm._data = [];\n    vm._margin = vm._config.size.margin;\n    vm._addStyle = config.addStyle ? config.addStyle : defaultStyle;\n\n    // Define width and height\n    vm._width = vm._config.size.width - vm._margin.left - vm._margin.right;\n    vm._height = vm._config.size.height - vm._margin.top - vm._margin.bottom;\n    vm._svg = '';\n    vm._scales = {};\n    vm._axes = {};\n\n    // Public\n    vm.layers = [];\n\n    // Helper data/functions for layers to use\n    vm.helper = Helper.bind(vm)();\n  };\n\n  //------------------------\n  //User\n  Chart.config = function (config) {\n    const vm = this;\n    vm._config = _.cloneDeep(config);\n    return vm;\n  };\n\n  Chart.size = function (sizeObj) {\n    const vm = this;\n    if (sizeObj) {\n      if (sizeObj.margin) {\n        if (sizeObj.margin.left == Number(sizeObj.margin.left)) {\n          vm._config.size.margin.left = sizeObj.margin.left;\n          vm._margin.left = sizeObj.margin.left;\n        }\n        if (sizeObj.margin.right == Number(sizeObj.margin.right)) {\n          vm._config.size.margin.right = sizeObj.margin.right;\n          vm._margin.right = sizeObj.margin.right;\n        }\n        if (sizeObj.margin.top == Number(sizeObj.margin.top)) {\n          vm._config.size.margin.top = sizeObj.margin.top;\n          vm._margin.top = sizeObj.margin.top;\n        }\n        if (sizeObj.margin.bottom == Number(sizeObj.margin.bottom)) {\n          vm._config.size.margin.bottom = sizeObj.margin.bottom;\n          vm._margin.bottom = sizeObj.margin.bottom;\n        }\n      }\n      if (sizeObj.width == Number(sizeObj.width)) {\n        vm._config.size.width = sizeObj.width;\n        vm._width = sizeObj.width;\n      }\n      if (sizeObj.height == Number(sizeObj.height)) {\n        vm._config.size.height = sizeObj.height;\n        vm._height = sizeObj.height;\n      }\n    }\n    return vm;\n  };\n\n  Chart.addStyle = function (stylesObj) {\n    const vm = this;\n    if (stylesObj) {\n      vm._addStyle = stylesObj;\n    }\n    return vm;\n  };\n\n  Chart.grid = function (bool) {\n    const vm = this;\n    vm._config.grid = bool ? true : false;\n    return vm;\n  };\n\n  Chart.bindTo = function (selector) {\n    const vm = this;\n    vm._config.bindTo = selector;\n    return vm;\n  };\n\n  Chart.data = function (data) {\n    const vm = this;\n    if (vm._config.data !== undefined) {\n      vm._config.data = Object.assign({}, vm._config.data, data);\n    } else {\n      vm._config.data = data;\n    }\n    return vm;\n  };\n\n  Chart.legend = function (legend) {\n    const vm = this;\n    vm._config.legend = legend;\n    return vm;\n  };\n\n  Chart.legendType = function (legendType) {\n    const vm = this;\n    vm._config.legendType = legendType;\n    return vm;\n  };\n\n  Chart.legendTitle = function (legendTitle) {\n    const vm = this;\n    vm._config.legendTitle = legendTitle;\n    return vm;\n  };\n\n  Chart.layer = function (_layer, _config) {\n    const vm = this;\n    var layer;\n    var config = _config ? _config : vm._config;\n    if (_layer === undefined && _layer === null) {\n      //@Todo Throw Error\n    } else {\n      layer = _layer(config, vm.helper);\n      vm.layers.push(layer);\n      return layer;\n    }\n  };\n\n  Chart.getLayer = function (layerIndex) {\n    const vm = this;\n    return vm.layers[layerIndex];\n  };\n\n  Chart.draw = function () {\n    const vm = this;\n    let q;\n\n    vm._scales = vm.scales();\n    //vm._axes   = vm.axes(); CALL THE AXES AFTER DATA LOADING IN ORDER TO UPDATE THE DOMAINS OF THE SCALES\n\n    q = vm.loadData();\n\n    q.awaitAll((error, results) => {\n      if (error) {\n        throw error;\n      }\n\n      if (Array.isArray(results) && results.length == 1) {\n        vm._data = results[0];\n      } else {\n        vm._data = results;\n      }\n\n      vm.initLayers();\n      vm.drawSVG();\n\n      //@TODO, ONE MAIN AXES THEN ADD THE POSSIBILITY FOR THE LAYER TO OVERRIDE \n      vm._axes = vm.axes();\n      vm.drawAxes();\n\n      //Draw layers after axes\n      vm.drawLayers();\n\n      //Trigger load chart event\n      if (vm._config.events && vm._config.events.load) {\n        vm.dispatch.on('load.chart', vm._config.events.load(vm));\n      }\n\n\n    });\n    return vm;\n  };\n\n  Chart.addStyle = function (theme) {\n    const vm = this;\n    vm._addStyle = theme;\n    return vm;\n  };\n\n  //----------------------\n  // Helper functions\n  Chart.scales = function () {\n    const vm = this;\n\n    var scales = {};\n    // xAxis scale\n    if (vm._config.xAxis && vm._config.xAxis.scale) {\n      switch (vm._config.xAxis.scale) {\n      case 'linear':\n        scales.x = d3.scaleLinear()\n            .range([0, vm._width]);\n        break;\n\n      case 'time':\n        scales.x = d3.scaleTime()\n          .range([0, vm._width]);\n        break;\n\n      case 'ordinal':\n        scales.x = d3.scaleOrdinal()\n          .range([0, vm._width], 0.1);\n        break;\n\n      case 'band':\n        scales.x = d3.scaleBand()\n          .rangeRound([0, vm._width])\n          .padding(0.1);\n        break;\n\n      case 'quantile':\n        scales.x = d3.scaleOrdinal()\n          .range([0, vm._width], 0.1);\n\n        scales.q = d3.scaleQuantile()\n          .range(d3.range(vm._config.xAxis.buckets));\n        break;\n\n      default:\n        scales.x = d3.scaleLinear()\n          .range([0, vm._width]);\n        break;\n      }\n    } else {\n      scales.x = d3.scaleLinear()\n        .range([0, vm._width]);\n    }\n\n    //yAxis scale\n    if (vm._config.yAxis && vm._config.yAxis.scale) {\n      switch (vm._config.yAxis.scale) {\n      case 'linear':\n        scales.y = d3.scaleLinear()\n          .range([vm._height, 0]);\n        break;\n\n      case 'time':\n        scales.y = d3.scaleTime()\n          .range([vm._height, 0]);\n        break;\n\n      case 'ordinal':\n        scales.y = d3.scaleOrdinal()\n          .range([vm._height, 0], 0.1);\n        break;\n\n      case 'band':\n        scales.y = d3.scaleBand()\n          .rangeRound([vm._height, 0])\n          .padding(0.1);\n        break;\n\n      case 'quantile':\n        scales.y = d3.scaleOrdinal()\n          .range([0, vm._width], 0.1);\n\n        scales.q = d3.scaleQuantile()\n          .range(d3.range(vm._config.yAxis.buckets));\n        break;\n\n      default:\n        scales.y = d3.scaleLinear()\n          .range([vm._height, 0]);\n        break;\n      }\n    } else {\n      scales.y = d3.scaleLinear()\n        .range([vm._height, 0]);\n    }\n\n\n    scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    return scales;\n  };\n\n  Chart.setScales = function () {\n\n  };\n\n  Chart.axes = function () {\n    const vm = this,\n      axes = {};\n    axes.x = d3.axisBottom(vm._scales.x);\n    axes.y = d3.axisLeft(vm._scales.y);\n\n    //remove corners in axis line\n    axes.x.tickSizeOuter(0);\n    axes.y.tickSizeOuter(0);\n\n    //Replaced with *addStyle -check\n    if (vm._config.xAxis && vm._config.xAxis.ticks &&\n      vm._config.xAxis.ticks.enabled === true && vm._config.xAxis.ticks.style) {\n\n      switch (vm._config.xAxis.ticks.style) {\n      case 'straightLine':\n        axes.x\n          .tickSize(-vm._height, 0);\n        break;\n      case 'dashLine':\n        axes.x\n          .tickSize(-vm._width, 0);\n        break;\n      }\n    }\n    //addStyle\n    if (vm._addStyle.xAxis.ticks.grid) {\n      switch (vm._addStyle.xAxis.ticks.grid) {\n      case 'straight':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      case 'dashed':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      }\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.ticks && vm._config.xAxis.ticks.values) {\n      axes.x.tickValues(vm._config.xAxis.ticks.values);\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.ticks && vm._config.xAxis.ticks.format) {\n      axes.x.tickFormat(vm._config.xAxis.ticks.format);\n    }\n\n    //Replaced with *addStyle -check\n    if (vm._config.yAxis && vm._config.yAxis.ticks &&\n      vm._config.yAxis.ticks.enabled === true && vm._config.yAxis.ticks.style) {\n\n      switch (vm._config.yAxis.ticks.style) {\n      case 'straightLine':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      case 'dashLine':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      }\n    }\n    // addStyle\n    if (vm._addStyle.yAxis.ticks.grid) {\n      switch (vm._addStyle.yAxis.ticks.grid) {\n      case 'straight':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      case 'dashed':\n        axes.y\n          .tickSize(-vm._width, 0);\n        break;\n      }\n    }\n\n    if (vm._config.yAxis && vm._config.yAxis.ticks && vm._config.yAxis.ticks.format) {\n      axes.y.tickFormat(vm._config.yAxis.ticks.format);\n    }\n    return axes;\n  };\n\n  Chart.loadData = function () {\n    const vm = this;\n    var q;\n\n    if (vm._config.data.tsv) {\n      q = d3.queue()\n        .defer(d3.tsv, vm._config.data.tsv);\n    }\n\n    if (vm._config.data.json) {\n      q = d3.queue()\n        .defer(d3.json, vm._config.data.json);\n    }\n\n    if (vm._config.data.csv) {\n      q = d3.queue()\n        .defer(d3.csv, vm._config.data.csv);\n    }\n\n    if (vm._config.data.raw) {\n      q = d3.queue()\n        .defer(vm.mapData, vm._config.data.raw);\n    }\n\n    if (vm._config.data.cartodb) {\n      q = d3.queue()\n        .defer(carto.query, vm._config.data);\n    }\n\n    if (vm._config.map && vm._config.map.topojson && vm._config.map.topojson.url) {\n      q.defer(d3.json, vm._config.map.topojson.url);\n    }\n\n    if (vm._config.plotOptions && vm._config.plotOptions.bars &&\n      vm._config.plotOptions.bars.averageLines && Array.isArray(vm._config.plotOptions.bars.averageLines) &&\n      vm._config.plotOptions.bars.averageLines.length > 0) {\n\n      vm._config.plotOptions.bars.averageLines.forEach(function (l) {\n        if (l.data.cartodb) {\n          q.defer(carto.query, l.data);\n        }\n      });\n    }\n\n    return q;\n  };\n\n  Chart.initLayers = function () {\n    const vm = this;\n    vm.layers.forEach(function (ly) {\n      ly.data(vm._data)\n        .scales();\n\n      //@TODO validate domains from multiple layers\n      vm._scales = ly._scales;\n    });\n  };\n\n\n  Chart.drawSVG = function () {\n    const vm = this;\n\n    //Remove any previous svg\n    d3.select(vm._config.bindTo).select('svg').remove();\n    d3.select(vm._config.bindTo).html('');\n\n    //Add the css template class\n    if (vm._config.template) {\n      d3.select(vm._config.bindTo).classed(vm._config.template, true);\n    }\n\n    //Add title to the chart\n    if (vm._config && vm._config.title) {\n      d3.select(vm._config.bindTo).append('div')\n        .attr('class', 'chart-title')\n        .html(vm._config.title)\n        .style('display', 'flex')\n        .style('justify-content', 'center')\n        .style('align-items', 'center')\n        .style('font-size', vm._addStyle.title.fontSize)\n        .style('font-weight', vm._addStyle.title.fontWeight)\n        .style('color', vm._addStyle.title.textColor)\n        .style('text-align', vm._addStyle.title.textAlign);\n\n      if (vm._addStyle.title.hr.enabled) {\n        d3.select(vm._config.bindTo).append('hr')\n          .attr('class', 'hr-title')\n          .style('width', '80%')\n          .style('margin-left', '10%')\n          .style('margin-top', '0.5em')\n          .style('border-width', vm._addStyle.title.hr.borderWidth)\n          .style('border-color', vm._addStyle.title.hr.borderColor);\n      }\n    }\n\n    //Add Legend to the chart\n    //@TODO - PASS THE STYLES TO DBOX.CSS\n    //@TODO - ALLOW DIFFERENT POSSITIONS FOR THE LEGEND\n    if (vm._config.legend && vm._config.legend.enabled === true && vm._config.legend.position === 'top') {\n      var legend = d3.select(vm._config.bindTo).append('div')\n        .attr('class', 'chart-legend-top');\n\n      var html = '';\n      html += '<div style=\"background-color:#E2E2E1;text-align:center;height: 40px;margin: 0px 15px\">';\n      vm._config.legend.categories.forEach(function (c) {\n        html += '<div class=\"dbox-legend-category-title\" style=\"margin:0 20px;\"><span class=\"dbox-legend-category-color\" style=\"background-color:' + c.color + ';\"> </span><span style=\"height: 10px;float: left;margin: 10px 5px 5px 5px;border-radius: 50%;\">' + c.title + '</span></div>';\n      });\n      html += '</div>';\n      legend.html(html);\n    }\n\n\n    //Create the svg\n    vm._fullSvg = d3.select(vm._config.bindTo).append('svg')\n      .style('font-size', vm._config.chart ? vm._config.chart['font-size'] ? vm._config.chart['font-size'] : '12px' : '12px')\n      .attr('width', vm._width + vm._margin.left + vm._margin.right)\n      .attr('height', vm._height + vm._margin.top + vm._margin.bottom);\n\n    vm._svg = vm._fullSvg\n      .append('g')\n      .attr('transform', 'translate(' + vm._margin.left + ',' + vm._margin.top + ')');\n\n\n    //Call the tip function\n    /*if(vm._config.data.tip){\n      vm._svg.call(vm._tip);\n    }*/\n\n    //Apply background color\n\n    d3.select(vm._config.bindTo + ' svg').style('background-color', vm._addStyle.chart.backgroundColor.color);\n\n\n\n    //Legend for average lines\n    /*\n    d3.select(vm._config.bindTo).append('div')\n      .attr('class', 'chart-legend-bottom');\n    if(vm._config.plotOptions && vm._config.plotOptions.bars\n      && vm._config.plotOptions.bars.averageLines && Array.isArray(vm._config.plotOptions.bars.averageLines)\n      && vm._config.plotOptions.bars.averageLines.length >0 ){\n\n      d3.select(vm._config.bindTo).append('div')\n        .attr('class', 'container-average-lines')\n        .append('div')\n          .attr('class', 'legend-average-lines')\n        .html('Average Lines Controller')\n    }\n    */\n\n    if (vm._config.hasOwnProperty('legend')) {\n      vm.drawLegend();\n    }\n  };\n\n  Chart.drawLayers = function () {\n    const vm = this;\n    vm.layers.forEach(function (ly) {\n      ly.draw();\n    });\n  };\n\n  Chart.drawLegend = function () {\n    const vm = this;\n\n    const legendTip = vm.helper.utils.d3.tip().html(d => {\n      return '<div class=\"title-tip\">' + (d.name || d) + '</div>';\n    });\n    vm._fullSvg.call(legendTip);\n    var legendBox;\n    // Draw legend, defaults to right\n    if (vm._config.styles && vm._addStyle.legend.position === 'bottom') {\n      legendBox = vm._fullSvg.append('g')\n        .attr('class', 'legendBox')\n        .attr('width', vm._width)\n        .attr('transform', 'translate(' + vm._config.size.margin.left + ',' + (vm._config.size.height - 30) +\n          ')');\n    } else {\n      legendBox = vm._fullSvg.append('g')\n        .attr('class', 'legendBox')\n        .attr('transform', 'translate(' + (vm._config.size.width - vm._config.size.margin.right + 5) + ',' + 1 * 19 + ')');\n    }\n\n    if (vm._config.legendTitle) {\n      legendBox.append('text')\n        .attr('class', 'legend-title')\n        .text(vm._config.legendTitle);\n\n      //wrap legend title if text size exceeds 70% of container\n      let lWidth = vm._config.size.margin.right;\n      var text = d3.selectAll('.legend-title'),\n        words = text.text().split(/\\s+/).reverse(),\n        word,\n        line = [],\n        lineNumber = 1,\n        lineHeight = 1.1, // ems\n        y = text.attr('y'),\n        dy = 0,\n        tspan = text.text(null).append('tspan').attr('x', 0).attr('y', y).attr('dy', dy + 'em');\n      while (word = words.pop()) {\n        line.push(word);\n        tspan.text(line.join(' '));\n        if (tspan.node().getComputedTextLength() > lWidth) {\n          line.pop();\n          tspan.text(line.join(' '));\n          line = [word];\n          ++lineNumber;\n          tspan = text.append('tspan').attr('x', 0).attr('y', y).attr('dy', lineHeight + 'em').text(word);\n        }\n      }\n    }\n\n    let lbWidth = vm._config.size.margin.right * 0.8;\n\n    if (vm._config.legendType === 'checkbox') {\n      let size = 18,\n        x = 0,\n        y = 0,\n        rx = 2,\n        ry = 2,\n        markStrokeWidth = 3;\n\n      vm._scales.color.domain(vm._config.legend.map(o => o.name));\n\n      var legendCheck = legendBox.selectAll('.legend-checkbox')\n        .data(vm._config.legend)\n        .enter().append('g')\n        .attr('class', '.legend-checkbox legend')\n        .attr('transform', function (d, i) {\n          return 'translate(0,' + (vm._config.legendTitle && lineNumber > 1 ? lineNumber * lineHeight + i : 1 + i) * 20 + ')';\n        })\n        .on('click', function (d, i) {\n          // Run the custom function\n          if (typeof vm._config.events.onClickLegend === 'function') {\n            vm._config.events.onClickLegend.call(this, d, i);\n          }\n          d3.event.stopPropagation();\n        });\n\n      legendCheck.append('rect')\n        .attr('width', size)\n        .attr('height', size)\n        .attr('x', x)\n        .attr('rx', rx)\n        .attr('ry', ry)\n        .attr('fill-opacity', 1)\n        .attr('fill', function (d) {\n          return vm._scales.color(d.name);\n        });\n\n\n      let coordinates = [\n        {\n          x: x + (size / 8),\n          y: y + (size / 2)\n        },\n        {\n          x: x + (size / 2.2),\n          y: (y + size) - (size / 4)\n        },\n        {\n          x: (x + size) - (size / 8),\n          y: (y + (size / 10))\n        }\n      ];\n\n      let line = d3.line()\n        .x(function (d) {\n          return d.x;\n        })\n        .y(function (d) {\n          return d.y;\n        });\n\n      // mark\n      legendCheck.append('path')\n        .attr('d', line(coordinates))\n        .attr('stroke-width', markStrokeWidth)\n        .attr('stroke', 'white')\n        .attr('fill', 'none')\n        .attr('class', 'mark')\n        .property('checked', function (d) {\n          // External function call. It must be after all the internal code; allowing the user to overide \n          return d.active;\n        })\n        .attr('opacity', function () {\n          if (d3.select(this).property('checked')) {\n            return 1;\n          } else {\n            return 0;\n          }\n        });\n\n      legendCheck.append('text')\n        .attr('class', 'labelText')\n        .attr('x', 20)\n        .attr('y', 9)\n        .attr('dy', '.35em')\n        .attr('text-anchor', 'start')\n        .text(function (d) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          return d.name;\n        });\n\n      //cut label text if text size exceeds 80% of container\n      legendCheck.selectAll('text').each(function (d) {\n        if (typeof (d.name) === 'string') {\n          if (this.getComputedTextLength() > lbWidth) {\n            d3.select(this)\n              .attr('title', d.name)\n              .on('mouseover', legendTip.show)\n              .on('mouseout', legendTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > lbWidth) {\n              d3.select(this).text(function (d) {\n                return d['name'].slice(0, -i) + '...';\n              });\n              ++i;\n            }\n          } else {\n            return d;\n          }\n        }\n      });\n    } else {\n      var legend;\n      if (vm._config.styles && vm._addStyle.legend.position === 'bottom') {\n        legend = legendBox.selectAll('.legend')\n          .data(vm._config.legend)\n          .enter().append('g')\n          .attr('class', 'legend')\n          .attr('width', vm._width / (vm._config.legend.length + 1))\n          .attr('transform', function (d, i) {\n            //horizontal position \n            //what if there are too many legends?\n            return 'translate(' + vm._width / (vm._config.legend.length + 1) * i + ',' + (vm._config.legendTitle && lineNumber > 1 ? lineNumber * lineHeight : 0) * 19 + ')';\n          });\n\n      } else {\n        legend = legendBox.selectAll('.legend')\n          .data(vm._config.legend)\n          .enter().append('g')\n          .attr('class', 'legend')\n          .attr('transform', function (d, i) {\n            return 'translate(' + 5 + ',' + (vm._config.legendTitle && lineNumber > 1 ? lineNumber * lineHeight + i : 1 + i) * 19 + ')';\n          });\n      }\n\n      if (vm._addStyle.legend.figure === 'circle') {\n        legend.append('circle')\n          .attr('cx', 2)\n          .attr('cy', 9)\n          .attr('r', 7)\n          .attr('stroke-width', 2)\n          .attr('stroke', function (d) {\n            return vm._scales.color(d.name);\n          })\n          .attr('fill', function (d) {\n            return vm._scales.color(d.name);\n          })\n          .attr('fill-opacity', 0.8);\n      } else {\n        legend.append('rect')\n          .attr('x', 0)\n          .attr('width', 18)\n          .attr('height', 18)\n          .attr('fill', function (d) {\n            return vm._scales.color(d.name);\n          });\n      }\n\n      legend.append('text')\n        .attr('x', 20)\n        .attr('y', 9)\n        .attr('dy', '.35em')\n        .attr('text-anchor', 'start')\n        .text(function (d) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          return d.name;\n        });\n\n      //cut label text if text size exceeds 80% of container\n      let lbWidth = vm._config.size.margin.right - 19;\n      legend.selectAll('text').each(function (d) {\n        if (typeof (d.name) === 'string') {\n          if (this.getComputedTextLength() > lbWidth) {\n            d3.select(this)\n              .attr('title', d.name)\n              .on('mouseover', legendTip.show)\n              .on('mouseout', legendTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > lbWidth) {\n              d3.select(this).text(function (d) {\n                return d['name'].slice(0, -i) + '...';\n              });\n              ++i;\n            }\n          } else {\n            return d;\n          }\n        }\n      });\n    }\n\n    /**\n     * Give some extra style\n     */\n\n    legendBox.selectAll('.legend text')\n      .attr('fill', vm._addStyle.legend.text.textColor)\n      .attr('font-size', vm._addStyle.legend.text.fontSize)\n      .attr('font-weight', vm._addStyle.legend.text.fontWeight);\n  };\n\n  Chart.drawGrid = function () {\n    const vm = this;\n    return vm;\n  };\n\n  Chart.drawAxes = function () {\n    const vm = this;\n    var yAxis;\n\n    /**\n     * Draw axes depends on axes config and styles.\n     * Let's start with config.\n     */\n\n\n    //Axes tooltip\n    const axesTip = vm.helper.utils.d3.tip().html(d => {\n      return '<div class=\"title-tip\">' + d + '</div>';\n    });\n\n    if ((!vm._config.yAxis || (vm._config.yAxis && vm._config.yAxis.enabled !== false)) && (!vm._config.xAxis || (vm._config.xAxis && vm._config.xAxis.enabled !== false))) {\n      vm._svg.call(axesTip);\n    }\n\n\n    /**\n     * Config axes\n     */\n\n    // y\n\n    if (!vm._config.yAxis || (vm._config.yAxis && vm._config.yAxis.enabled !== false)) {\n      yAxis = vm._svg.append('g')\n        .attr('class', 'y axis')\n        .call(vm._axes.y);\n\n      if (vm._config.yAxis && vm._config.yAxis.text) {\n        yAxis.append('text')\n          .attr('class', 'axis-title')\n          .attr('y', -vm._margin.left * 0.7)\n          .attr('x', -vm._height / 2)\n          .attr('transform', 'rotate(-90)')\n          .attr('text-anchor', 'middle')\n          .text(vm._config.yAxis.text);\n      }\n    }\n\n    if (vm._config.yAxis.domain && vm._config.yAxis.domain.hasOwnProperty('enabled')) {\n      if (vm._config.yAxis.ticks) {\n        if (vm._config.yAxis.domain.enabled === false && vm._config.yAxis.ticks.enabled === false) {\n          d3.select('g.y.axis .domain').remove();\n          d3.selectAll('g.y.axis .tick').remove();\n        } else if (vm._config.yAxis.domain.enabled === false && vm._config.yAxis.ticks.enabled === true) {\n          d3.select('g.y.axis .domain').remove();\n          //d3.selectAll('g.y.axis .tick text').remove();\n        }\n      } else {\n        if (vm._config.yAxis.domain.enabled === false) {\n          d3.select('g.y.axis .domain').remove();\n          d3.selectAll('g.y.axis .tick').remove();\n        }\n      }\n    }\n\n    if (!vm._config.yAxis || (vm._config.yAxis && vm._config.yAxis.enabled !== false)) {\n      // Add ellipsis to cut label text when too long\n      // for yAxis on the left\n      yAxis.selectAll('text').each(function (d) {\n        let element = this;\n        if (typeof (d) === 'string') {\n          if (this.getComputedTextLength() > 0.8 * vm._margin.left) {\n            d3.select(element)\n              .on('mouseover', axesTip.show)\n              .on('mouseout', axesTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > 0.8 * vm._margin.left) {\n              d3.select(this).text(function (d) {\n                return d.slice(0, -i) + '...';\n              }).attr('title', d);\n              ++i;\n            }\n          } else {\n            return d;\n          }\n        }\n      });\n    }\n\n    //Dropdown Y axis\n    if (vm._config.yAxis && vm._config.yAxis.dropdown && vm._config.yAxis.dropdown.enabled === true) {\n      var yAxisDropDown = d3.select(vm._config.bindTo).append('div').attr('class', 'dbox-yAxis-select')\n        .append('select')\n        .on('change', function () {\n          vm.updateAxis('y', this.value);\n        });\n\n      /*\n      .attr('style', function(){\n                              var x = -1*d3.select(vm._config.bindTo).node().getBoundingClientRect().width/2+ vm._chart._margin.left/4;\n                              var y = -1*d3.select(vm._config.bindTo).node().getBoundingClientRect().height/2;\n                              return 'transform: translate('+x+'px,'+y+'px) rotate(-90deg);'\n                            })\n      */\n\n      var x = -1 * d3.select(vm._config.bindTo).node().getBoundingClientRect().width / 2 + vm._margin.left / 2.5;\n      var y = -1 * d3.select(vm._config.bindTo).node().getBoundingClientRect().height / 1.5;\n\n      if (vm._config.yAxis.dropdown.styles) {\n\n        var styles = vm._config.yAxis.dropdown.styles;\n        styles.display = 'block';\n        styles.transform = 'translate(' + x + 'px,' + y + 'px) rotate(-90deg)';\n        styles.margin = 'auto';\n        styles['text-align'] = 'center';\n        styles['text-align-last'] = 'center';\n\n        d3.select('.dbox-yAxis-select select').styles(styles);\n\n        d3.select('.dbox-yAxis-select select option').styles({\n          'text-align': 'left'\n        });\n\n      } else {\n        d3.select('.dbox-yAxis-select select').styles({\n          'display': 'block',\n          'transform': 'translate(' + x + 'px,' + y + 'px) rotate(-90deg)',\n          'margin': 'auto',\n          'text-align': 'center',\n          'text-align-last': 'center'\n        });\n\n        d3.select('.dbox-yAxis-select select option').styles({\n          'text-align': 'left'\n        });\n      }\n\n      if (vm._config.yAxis.dropdown.options) {\n\n        yAxisDropDown.selectAll('option')\n          .data(vm._config.yAxis.dropdown.options)\n          .enter().append('option')\n          .attr('class', function (d) {\n            return d.value;\n          })\n          .attr('value', function (d) {\n            return d.value;\n          })\n          .text(function (d) {\n            return d.title;\n          })\n          .property('selected', function (d) {\n            return d.selected;\n          });\n\n      } else {\n        console.log('No options present in config');\n      }\n    }\n\n    // y\n\n    /////////////////////////////\n\n    // x\n    if (!vm._config.xAxis || (vm._config.xAxis && vm._config.xAxis.enabled !== false)) {\n\n      vm._xAxis = vm._svg.append('g')\n        .attr('class', 'x axis')\n        .attr('transform', 'translate(0,' + vm._height + ')')\n        .call(vm._axes.x);\n\n      //Do not show line if axis is disabled\n      if (vm._config.xAxis.line && vm._config.xAxis.line.enabled == false) {\n        vm._xAxis.selectAll('path')\n          .style('display', 'none');\n      }\n\n      //Set custom position for ticks\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.x) {\n        vm._xAxis.selectAll('text')\n          .attr('dx', vm._config.xAxis.ticks.x);\n      }\n\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.y) {\n        vm._xAxis.selectAll('text')\n          .attr('dy', vm._config.xAxis.ticks.y);\n      }\n\n      //Disable ticks when set to false\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.line && vm._config.xAxis.ticks.line.enabled === false) {\n        vm._xAxis.selectAll('line')\n          .style('display', 'none');\n      }\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.text) {\n      vm._xAxis.append('text')\n        .attr('class', 'axis-title')\n        .attr('x', vm._width / 2)\n        .attr('y', 40)\n        .style('text-anchor', 'middle')\n        .text(vm._config.xAxis.text);\n    }\n\n    if (vm._config.xAxis.domain !== undefined && vm._config.xAxis.domain.hasOwnProperty('enabled')) {\n      if (vm._config.xAxis.ticks) {\n        if (vm._config.xAxis.domain.enabled === false && vm._config.xAxis.ticks.enabled === false) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          d3.selectAll('g.x.axis .tick').remove();\n        } else if (vm._config.xAxis.domain.enabled === false && vm._config.xAxis.ticks.enabled === true) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          //d3.selectAll('g.x.axis .tick text').remove();\n        }\n      } else {\n        if (vm._config.xAxis.domain.enabled === false) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          d3.selectAll(vm._config.bindTo + ' g.x.axis .tick').remove();\n        }\n      }\n    }\n\n    //Dropdown X axis\n    if (vm._config.xAxis && vm._config.xAxis.dropdown && vm._config.xAxis.dropdown.enabled === true) {\n      var xAxisDropDown = d3.select(vm._config.bindTo).append('div').attr('class', 'dbox-xAxis-select')\n        .append('select')\n        .on('change', function () {\n          vm.updateAxis('x', this.value);\n        });\n\n      if (vm._config.xAxis.dropdown.styles) {\n\n        var styles = vm._config.xAxis.dropdown.styles;\n        styles.display = 'block';\n        styles.margin = 'auto';\n        styles['text-align'] = 'center';\n        styles['text-align-last'] = 'center';\n\n        d3.select('.dbox-xAxis-select select').styles(styles);\n\n        d3.select('.dbox-xAxis-select select option').styles({\n          'text-align': 'left'\n        });\n\n      } else {\n        d3.select('.dbox-xAxis-select select').styles({\n          'display': 'block',\n          'margin': 'auto',\n          'text-align': 'center',\n          'text-align-last': 'center'\n        });\n\n        d3.select('.dbox-xAxis-select select option').styles({\n          'text-align': 'left'\n        });\n      }\n\n      if (vm._config.xAxis.dropdown.options) {\n\n        xAxisDropDown.selectAll('option')\n          .data(vm._config.xAxis.dropdown.options)\n          .enter().append('option')\n          .attr('class', function (d) {\n            return d.value;\n          })\n          .attr('value', function (d) {\n            return d.value;\n          })\n          .text(function (d) {\n            return d.title;\n          })\n          .property('selected', function (d) {\n            return d.selected;\n          });\n\n      } else {\n        console.log('No options present in config');\n      }\n    }\n\n    /**\n     * Let's style axes\n     */\n    //Style Y axis\n    if (vm._config.xAxis.enabled !== false && vm._addStyle.xAxis.enabled) {\n      //axis line\n      yAxis.selectAll('.domain')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', vm._addStyle.yAxis.axis.strokeWidth)\n        .attr('stroke', vm._addStyle.yAxis.axis.strokeColor)\n        .attr('opacity', vm._addStyle.yAxis.axis.strokeOpacity);\n\n      //axis title\n      yAxis.selectAll('.axis-title')\n        .attr('font-size', vm._addStyle.yAxis.title.fontSize)\n        .attr('font-weight', vm._addStyle.yAxis.title.fontWeight)\n        .attr('fill', vm._addStyle.yAxis.title.textColor)\n        .attr('text-anchor', vm._addStyle.yAxis.title.textAnchor);\n\n      //tick lines\n      yAxis.selectAll('.tick line')\n        .attr('stroke-width', vm._addStyle.yAxis.ticks.strokeWidth)\n        .attr('stroke', vm._addStyle.yAxis.ticks.strokeColor)\n        .attr('stroke-opacity', vm._addStyle.yAxis.ticks.opacity)\n        .attr('width', vm._addStyle.yAxis.ticks.tickWidth)\n        //condition gridline\n        .attr('stroke-dasharray', vm._addStyle.yAxis.ticks.gridDashed)\n        .attr('transform', 'translate(-' + vm._addStyle.yAxis.axis.paddingTick + ', 0)');\n      //don't draw first tick when styled as grid\n      if (vm._addStyle.yAxis.ticks.grid) {\n        yAxis.selectAll('.tick:first-of-type line:first-of-type')\n          .attr('stroke', 'none');\n      }\n\n      //tick text\n      yAxis.selectAll('.tick text')\n        .attr('font-size', vm._addStyle.yAxis.labels.fontSize)\n        .attr('font-weight', vm._addStyle.yAxis.labels.fontWeight)\n        .attr('fill', vm._addStyle.yAxis.labels.textColor)\n        .attr('text-anchor', vm._addStyle.yAxis.labels.textAnchor)\n        .attr('transform', 'translate(-' + vm._addStyle.yAxis.axis.paddingTick + ', 0)');\n\n    }\n\n    //Style X axis\n    if (vm._config.xAxis.enabled !== false && vm._addStyle.xAxis.enabled) {\n      //axis line\n      vm._xAxis.selectAll('.domain')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', vm._addStyle.xAxis.axis.strokeWidth)\n        .attr('stroke', vm._addStyle.xAxis.axis.strokeColor)\n        .attr('opacity', vm._addStyle.xAxis.axis.strokeOpacity);\n\n      //axis title\n      vm._xAxis.selectAll('.axis-title')\n        .attr('font-size', vm._addStyle.xAxis.title.fontSize)\n        .attr('font-weight', vm._addStyle.xAxis.title.fontWeight)\n        .attr('fill', vm._addStyle.xAxis.title.textColor)\n        .attr('text-anchor', vm._addStyle.xAxis.title.textAnchor)\n        .attr('transform', 'translate(0, ' + vm._addStyle.xAxis.axis.paddingTick + ')');\n\n      //tick lines\n      vm._xAxis.selectAll('.tick line')\n        .attr('stroke-width', vm._addStyle.xAxis.ticks.strokeWidth)\n        .attr('stroke', vm._addStyle.xAxis.ticks.strokeColor)\n        .attr('transform', 'translate(0, ' + vm._addStyle.xAxis.axis.paddingTick + ')');\n      //don't draw first tick when styled as grid\n      if (vm._addStyle.xAxis.ticks.grid) {\n        vm._xAxis.selectAll('.tick:first-of-type line:first-of-type')\n          .attr('stroke', 'none');\n      }\n\n      //tick text\n      vm._xAxis.selectAll('.tick text')\n        .attr('font-size', vm._addStyle.xAxis.labels.fontSize)\n        .attr('font-weight', vm._addStyle.xAxis.labels.fontWeight)\n        .attr('fill', vm._addStyle.xAxis.labels.textColor)\n        .attr('text-anchor', vm._addStyle.xAxis.labels.textAnchor)\n        .attr('transform', vm._addStyle.xAxis.labels.rotate ? 'translate(0,50) rotate(' + vm._addStyle.xAxis.axis.labels.rotate + ')' : 'translate(0, ' + vm._addStyle.xAxis.axis.paddingTick + ')');\n    }\n\n    if (!vm._config.xAxis || (vm._config.xAxis && vm._config.xAxis.enabled !== false)) {\n      // Add ellipsis to cut label text \n      // when it is too long\n    \n      const biggestLabelWidth = d3.max(d3.select('.x.axis').selectAll('text').nodes().map(o => o.getComputedTextLength())); // Biggest label computed text length\n      let xBandWidth = vm._scales.x.bandwidth ? vm._scales.x.bandwidth() : (vm._config.size.width - (vm._config.size.margin.left + vm._config.size.margin.right)) / vm._scales.x.ticks();\n      if (biggestLabelWidth > xBandWidth) { // Biggest label doesn't fit\n        vm._xAxis.selectAll('text').each(function (d) {\n          if (typeof (d) === 'string') {\n            // Vertical labels\n            d3.select(this)\n                .attr('text-anchor', 'end')\n                .attr('dy', 0)\n                .attr('transform', 'translate(-5,8)rotate(-90)');\n            // Still doesn't fit!\n            if (this.getComputedTextLength() > 0.8 * vm._config.size.margin.bottom) {\n              d3.select(this)\n                .on('mouseover', axesTip.show)\n                .on('mouseout', axesTip.hide);\n              let i = 1;\n              while (this.getComputedTextLength() > 0.8 * vm._config.size.margin.bottom) {\n                d3.select(this).text(function (d) {\n                  return d.slice(0, -i) + '...';\n                }).attr('title', d);\n                ++i;\n              }\n            } else {\n              return d;\n            }\n          }\n        });\n      } \n    }\n\n    /**\n     * Already replaced with addStyle\n     */\n    /*if (vm._config.yAxis && vm._config.yAxis.enabled !== false) {\n\n      if (vm._config.yAxis && vm._config.yAxis.text) {\n        yAxis.append('text')\n          .attr('class', 'label title')\n          .attr('transform', 'rotate(-90)')\n          .attr('y', vm._config.yAxis.y ? vm._config.yAxis.y : -50)\n          .attr('x', -150)\n          .attr('dy', '.71em')\n          .style('text-anchor', 'middle')\n          .style('fill', vm._config.yAxis.fill ? vm._config.yAxis.fill : 'black')\n          .style('font-size', vm._config.yAxis['font-size'] ? vm._config.yAxis['font-size'] : '12px')\n          .style('font-weight', vm._config.xAxis['font-weight'] ? vm._config.xAxis['font-weight'] : '600')\n          .text(vm._config.yAxis.text);\n      }\n    }*/\n\n    //Set ticks straight or dashed, to be replaced with *addStyle -checked\n    if (vm._config.yAxis.ticks && vm._config.yAxis.ticks.enabled && vm._config.yAxis.ticks.style) {\n      switch (vm._config.yAxis.ticks.style) {\n      case 'straightLine':\n        break;\n      case 'dashLine':\n        d3.selectAll('g.y.axis .tick line').attr('stroke-dasharray', '5, 5');\n        break;\n      }\n    }\n    //To be replaced with *addStyle -checked\n    if (vm._config.yAxis.domain && vm._config.yAxis.domain.enabled && vm._config.yAxis.domain.stroke) {\n      d3.select('g.y.axis .domain').attr('stroke', vm._config.yAxis.domain.stroke);\n    }\n\n    //To be replaced with *addStyle -checked\n    if (vm._config.yAxis.domain && vm._config.yAxis.domain.enabled && vm._config.yAxis.domain['stroke-width']) {\n      d3.select('g.y.axis .domain').attr('stroke-width', vm._config.yAxis.domain['stroke-width']);\n    }\n\n    // y\n\n    /////////////////////////////\n\n    // x\n\n    if (!vm._config.xAxis || (vm._config.xAxis && vm._config.xAxis.enabled !== false)) {\n\n      //To be replaced with *addStyle -checked\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.style) {\n        Object.keys(vm._config.xAxis.ticks.style).forEach(function (k) {\n          vm._xAxis.selectAll('text')\n            .style(k, vm._config.xAxis.ticks.style[k]);\n        });\n      }\n\n      //Set rotation for ticks, to be replaced with *addStyle -checked\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.rotate) {\n        vm._xAxis.selectAll('text')\n          .attr('text-anchor', 'end')\n          .attr('transform', 'rotate(' + vm._config.xAxis.ticks.rotate + ')');\n      }\n\n      //Set ticks straight or dashed, to be replaced with *addStyle -checked\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.enabled && vm._config.xAxis.ticks.style) {\n        switch (vm._config.xAxis.ticks.style) {\n        case 'straightLine':\n          break;\n        case 'dashLine':\n          d3.selectAll(vm._config.bindTo + ' g.x.axis .tick line').attr('stroke-dasharray', '5, 5');\n          break;\n        }\n      }\n\n    }\n\n    //to be replaced with *addStyle -checked\n    if (vm._config.xAxis.domain && vm._config.xAxis.domain.enabled && vm._config.xAxis.domain.stroke) {\n      d3.select(vm._config.bindTo + ' g.x.axis .domain').attr('stroke', vm._config.xAxis.domain.stroke);\n    }\n\n    //to be replaced with *addStyle -checked\n    if (vm._config.xAxis.domain && vm._config.xAxis.domain.enabled && vm._config.xAxis.domain['stroke-width']) {\n      d3.select(vm._config.bindTo + ' g.x.axis .domain').attr('stroke-width', vm._config.xAxis.domain['stroke-width']);\n    }\n\n    //to be replaced with *addStyle\n    /*if (vm._config.xAxis && vm._config.xAxis.text) {\n      xAxis.append('text')\n        .attr('class', 'label title')\n        .attr('x', vm._width / 2)\n        .attr('y', vm._config.xAxis.y ? vm._config.xAxis.y : 30)\n        .style('text-anchor', 'middle')\n        .style('fill', vm._config.xAxis.fill ? vm._config.xAxis.fill : 'black')\n        .style('font-size', vm._config.xAxis['font-size'] ? vm._config.xAxis['font-size'] : '12px')\n        .style('font-weight', vm._config.xAxis['font-weight'] ? vm._config.xAxis['font-weight'] : '600')\n        .text(vm._config.xAxis.text);\n    }*/\n  };\n\n  Chart.updateAxis = function (axis, value) {\n    const vm = this;\n\n    if (axis === 'x') {\n      vm._config.xAxis.dropdown.options.map((obj) => {\n        if (obj.value === value) {\n          obj.selected = true;\n        } else {\n          obj.selected = false;\n        }\n      });\n    } else if (axis === 'y') {\n      vm._config.yAxis.dropdown.options.map((obj) => {\n        if (obj.value === value) {\n          obj.selected = true;\n        } else {\n          obj.selected = false;\n        }\n      });\n    }\n\n    vm._config[axis] = value;\n\n    var layer = vm.layers[0];\n\n    layer._config = vm._config;\n\n    vm.draw();\n\n    // Trigger update chart axis\n    if (vm._config.events && vm._config.events.change) {\n      vm.dispatch.on('change.axis', vm._config.events.change(vm));\n    }\n  };\n\n\n\n  Chart.dispatch = d3.dispatch('load', 'change');\n\n  Chart.mapData = function (data, callback) {\n    callback(null, data);\n  };\n\n  Chart.getDomains = function (data) {\n    const vm = this;\n\n    var domains = {};\n    var minMax = [];\n    var sorted = [];\n\n\n    // Default ascending function\n    var sortFunctionY = function (a, b) {\n      return vm.utils.sortAscending(a.y, b.y);\n    };\n    var sortFunctionX = function (a, b) {\n      return vm.utils.sortAscending(a.x, b.x);\n    };\n\n\n    // if applying sort\n    if (vm._config.data.sort && vm._config.data.sort.order) {\n      switch (vm._config.data.sort.order) {\n      case 'asc':\n        sortFunctionY = function (a, b) {\n          return vm.utils.sortAscending(a.y, b.y);\n        };\n        sortFunctionX = function (a, b) {\n          return vm.utils.sortAscending(a.x, b.x);\n        };\n        break;\n\n      case 'desc':\n        sortFunctionY = function (a, b) {\n          return vm.utils.sortDescending(a.y, b.y);\n        };\n        sortFunctionX = function (a, b) {\n          return vm.utils.sortDescending(a.x, b.x);\n        };\n        break;\n      }\n    }\n\n\n    // xAxis\n    if (vm._config.xAxis && vm._config.xAxis.scale) {\n      switch (vm._config.xAxis.scale) {\n      case 'linear':\n        minMax = d3.extent(data, function (d) {\n          return d.x;\n        });\n        domains.x = minMax;\n        break;\n\n      case 'time':\n        minMax = d3.extent(data, function (d) {\n          return d.x;\n        });\n        domains.x = minMax;\n        break;\n\n      case 'ordinal':\n\n        // If the xAxis' order depends on the yAxis values\n        if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n          sorted = data.sort(sortFunctionY);\n        } else {\n          sorted = data.sort(sortFunctionX);\n        }\n\n        domains.x = [];\n        sorted.forEach(function (d) {\n          domains.x.push(d.x);\n        });\n\n        break;\n\n      case 'quantile':\n\n        //The xAxis order depends on the yAxis values\n        if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n          sorted = data.sort(sortFunctionY);\n        } else {\n          sorted = data.sort(sortFunctionX);\n        }\n\n        domains.q = [];\n        sorted.forEach(function (d) {\n          domains.q.push(d.x);\n        });\n\n        domains.x = d3.range(vm._config.xAxis.buckets);\n\n        break;\n\n\n      default:\n        minMax = d3.extent(data, function (d) {\n          return d.x;\n        });\n        domains.x = minMax;\n        break;\n      }\n    } else {\n      minMax = d3.extent(data, function (d) {\n        return d.x;\n      });\n      domains.x = minMax;\n    }\n\n    //yAxis\n    if (vm._config.yAxis && vm._config.yAxis.scale) {\n      switch (vm._config.yAxis.scale) {\n      case 'linear':\n        minMax = d3.extent(data, function (d) {\n          return d.y;\n        });\n\n        //Adjust for min values greater than zero\n        //set the min value to -10%\n        if (minMax[0] > 0) {\n          minMax[0] = minMax[0] - (minMax[1] - minMax[0]) * .1;\n        }\n        domains.y = minMax;\n        break;\n\n      case 'time':\n        minMax = d3.extent(data, function (d) {\n          return d.y;\n        });\n        domains.y = minMax;\n        break;\n\n      case 'ordinal':\n        if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n\n          sorted = data.sort(function (a, b) {\n            return vm.utils.sortAscending(a.y, b.y);\n          });\n          domains.y = [];\n          sorted.forEach(function (d) {\n            domains.y.push(d.x);\n          });\n\n        } else {\n          domains.y = d3.map(data, function (d) {\n            return d.y;\n          }).keys().sort(function (a, b) {\n            return vm.utils.sortAscending(a, b);\n          });\n        }\n\n        break;\n\n      default:\n        minMax = d3.extent(data, function (d) {\n          return d.y;\n        });\n        domains.y = minMax;\n        break;\n      }\n    } else {\n      minMax = d3.extent(data, function (d) {\n        return d.y;\n      });\n      domains.y = minMax;\n    }\n\n\n    return domains;\n  };\n\n  Chart.destroy = function () {\n    const vm = this;\n    d3.select(vm._config.bindTo).html('');\n  };\n\n  Chart.init(config);\n\n  return Chart;\n}\n","import * as d3 from 'd3';\n/*\n * Simple Bar chart\n */\nexport default function (config, helper) {\n\n  //Link Bars to the helper object in helper.js\n  var Bars = Object.create(helper);\n\n  Bars.init = function (config) {\n    var vm = this;\n\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._tip = d3.tip()\n      .attr('class', 'd3-tip')\n      .direction('n')\n      .html(vm._config.tip || function (d) {\n        var html = '';\n        html += d[vm._config.x] ? ('<span>' + (Number.isNaN(+d[vm._config.x]) || vm._config.xAxis.scale === 'band' ? d[vm._config.x] : vm.utils.format(d[vm._config.x])) + '</span></br>') : '';\n        html += d[vm._config.y] ? ('<span>' + (Number.isNaN(+d[vm._config.y]) || vm._config.yAxis.scale === 'band' ? d[vm._config.y] : vm.utils.format(d[vm._config.y])) + '</span></br>') : '';\n        return html;\n      });\n  };\n\n\n  //-------------------------------\n  //User config functions\n  Bars.id = function (columnName) {\n    var vm = this;\n    vm._config.id = columnName;\n    return vm;\n  };\n\n  Bars.x = function (columnName) {\n    var vm = this;\n    vm._config.x = columnName;\n    return vm;\n  };\n\n  Bars.y = function (columnName) {\n    var vm = this;\n    vm._config.y = columnName;\n    return vm;\n  };\n\n  /**\n   * Used to draw a bar chart with multiple bars per group\n   * @param {array} columns \n   */\n  Bars.groupBy = function (columns) {\n    var vm = this;\n    vm._config.groupBy = columns;\n    return vm;\n  };\n\n  /**\n   * Used to draw a bar chart stacked with multiple bars per group\n   * @param {array} columns \n   */\n  Bars.stackBy = function (columnName) {\n    var vm = this;\n    vm._config.stackBy = columnName;\n    return vm;\n  };\n\n  /**\n   * column name used for the domain values\n   * @param {string} columnName \n   */\n  Bars.fill = function (columnName) {\n    var vm = this;\n    vm._config.fill = columnName;\n    return vm;\n  };\n\n  /**\n   * array of values used \n   * @param {array or scale} columnName \n   */\n  Bars.colors = function (colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Bars.sortBy = function (option) {\n    //option = string [asc,desc] \n    //option = array for groupBy and stackBy\n    var vm = this;\n    vm._config.sortBy = option;\n    return vm;\n  };\n\n  Bars.format = function (format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function) {\n      vm.utils.format = format;\n    } else {\n      vm.utils.format = d3.format(format);\n    }\n    return vm;\n  };\n\n  Bars.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    return vm;\n  };\n\n  Bars.legend = function (legend) {\n    var vm = this;\n    vm._config.legend = legend;\n    return vm;\n  };\n\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Bars.data = function (data) {\n    var vm = this;\n\n    if (vm._config.filter) {\n      //In case we want to filter observations\n      data = data.filter(vm._config.filter);\n    }\n\n    if (vm._config.hasOwnProperty('stackBy') && Array.isArray(vm._config.stackBy) && vm._config.stackBy.length > 0) {\n      // Used in a stackbar, transpose the data into layers \n      vm._data = d3.stack().keys(vm._config.stackBy)(data);\n    } else {\n      // Normal bar, save the data as numbers \n      vm._data = data.map(function (d) {\n        if (d[vm._config.x] == Number(d[vm._config.x]))\n          d[vm._config.x] = +d[vm._config.x];\n        if (d[vm._config.y] == Number(d[vm._config.y]))\n          d[vm._config.y] = +d[vm._config.y];\n        return d;\n      });\n    }\n\n    //@TODO - ALLOW MULITPLE SORTS\n    if (vm._config.sortBy) {\n      vm._data = vm._data.sort(function (a, b) {\n        return a[vm._config.sortBy[0]] - b[vm._config.sortBy[0]];\n      });\n    }\n\n    if (vm._config.hasOwnProperty('quantiles')) {\n      vm._quantiles = vm._setQuantile(data);\n      vm._minMax = d3.extent(data, function (d) {\n        return +d[vm._config.fill];\n      });\n    }\n\n    return vm;\n  };\n\n  Bars.scales = function (scales) {\n    var vm = this;\n    var config;\n    //vm._scales = scales;\n    /* Use\n     * vm._config.x\n     * vm._config.xAxis.scale\n     * vm._config.y\n     * vm._config.yAxis.scale\n     * vm._data\n     */\n    //Normal bars \n    if (vm._config.hasOwnProperty('x') && vm._config.hasOwnProperty('y')) {\n      config = {\n        column: vm._config.x,\n        type: vm._config.xAxis.scale,\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      config = {\n        column: vm._config.y,\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    //GroupBy bars on the xAxis\n    if (vm._config.hasOwnProperty('x') && vm._config.hasOwnProperty('groupBy')) {\n      /* Generate x scale */\n      config = {\n        column: vm._config.x,\n        type: vm._config.xAxis.scale,\n        groupBy: 'parent',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate groupBy scale */\n      config = {\n        column: vm._config.groupBy,\n        type: 'band',\n        groupBy: 'children',\n        range: [0, vm._scales.x.bandwidth()],\n      };\n      vm._scales.groupBy = vm.utils.generateScale(vm._data, config);\n      //vm.chart.scales.groupBy = vm._scales.groupBy; \n\n      /* Generate y scale */\n      config = {\n        column: vm._config.groupBy,\n        type: vm._config.yAxis.scale,\n        groupBy: 'data',\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero,\n      };\n      if(vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    //GroupBy bars on the yAxis\n    if (vm._config.hasOwnProperty('y') && vm._config.hasOwnProperty('groupBy')) {\n      /* Generate y scale */\n      config = {\n        column: vm._config.y,\n        type: vm._config.yAxis.scale,\n        groupBy: 'parent',\n        range: [0, vm.chart.height],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n\n      /* Generate groupBy scale */\n      config = {\n        column: vm._config.groupBy,\n        type: 'band',\n        groupBy: 'children',\n        range: [0, vm._scales.y.bandwidth()],\n      };\n      vm._scales.groupBy = vm.utils.generateScale(vm._data, config);\n      //vm.chart.scales.groupBy = vm._scales.groupBy; \n\n      /* Generate x scale */\n      config = {\n        column: vm._config.groupBy,\n        type: vm._config.xAxis.scale,\n        groupBy: 'data',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n    }\n\n\n    //Stack bars on the xAxis\n    if (vm._config.hasOwnProperty('x') && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: vm._config.x,\n        type: vm._config.xAxis.scale,\n        stackBy: 'parent',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate y scale */\n      config = {\n        column: '',\n        stackBy: 'data',\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    // Stack bars on the yAxis\n    if (vm._config.hasOwnProperty('y') && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: '',\n        type: vm._config.xAxis.scale,\n        stackBy: 'data',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate y scale */\n      config = {\n        column: vm._config.y,\n        stackBy: 'parent',\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n\n    //vm.chart.scales.x = vm._scales.x;\n    //vm.chart.scales.y = vm._scales.y;\n\n    if (vm._config.hasOwnProperty('colors'))\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    else\n      vm._scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    return vm;\n  };\n\n  Bars.draw = function () {\n    var vm = this;\n\n    if (vm._config.hasOwnProperty('groupBy')) {\n      if (vm._config.hasOwnProperty('x')) vm._drawGroupByXAxis();\n      if (vm._config.hasOwnProperty('y')) vm._drawGroupByYAxis();\n      return vm;\n    }\n\n    if (vm._config.hasOwnProperty('stackBy')) {\n      if (vm._config.hasOwnProperty('x')) vm._drawStackByXAxis();\n      if (vm._config.hasOwnProperty('y')) vm._drawStackByYAxis();\n      return vm;\n    }\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().selectAll('.bar')\n      .data(vm._data)\n      .enter().append('rect')\n      .attr('class', 'bar')\n      .attr('id', function (d, i) {\n        var id = 'bars-' + i;\n        if (vm._config.id) {\n          id = 'bars-' + d[vm._config.id];\n        }\n        return id;\n      })\n      .attr('x', function (d) {\n        var value = vm._scales.x(d[vm._config.x]);\n        if (vm._config.xAxis.scale == 'linear') {\n          value = 0;\n        }\n        return value;\n      })\n      .attr('y', function (d) {\n        return vm._scales.y(d[vm._config.y]);\n      })\n      .attr('width', function (d) {\n        return vm._scales.x.bandwidth ? vm._scales.x.bandwidth() : vm._scales.x(d[vm._config.x]);\n      })\n      .attr('height', function (d) {\n        return vm._scales.y.bandwidth ? vm._scales.y.bandwidth() : vm.chart.height - vm._scales.y(d[vm._config.y]);\n      })\n      .attr('fill', function (d) {\n        return vm._scales.color !== false ? vm._scales.color(d[vm._config.fill]) : vm._getQuantileColor(d[vm._config.fill], 'default');\n      })\n      .style('opacity', 0.9)\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n    return vm;\n  };\n\n  /** \n   * Draw bars grouped by \n   */\n  Bars._drawGroupByXAxis = function () {\n    var vm = this;\n    vm._tip.html(vm._config.tip || function (d) {\n      let html =  d.key + '<br>';\n      if (d.axis !== d.key) {\n        html += d.axis + '<br>';\n      }\n      html += vm.utils.format(d.value);\n      return html;\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('transform', function (d) {\n        return 'translate(' + vm._scales.x(d[vm._config.x]) + ',0)';\n      })\n      .selectAll('rect')\n      .data(function (d) {\n        return vm._config.groupBy.map(function (key) {\n          return {\n            key: key,\n            value: d[key],\n            axis: d[vm._config.x]\n          };\n        });\n      })\n      .enter().append('rect')\n      .attr('x', function (d) {\n        return vm._scales.groupBy(d.key);\n      })\n      .attr('y', function (d) {\n        return vm._scales.y(d.value);\n      })\n      .attr('width', vm._scales.groupBy.bandwidth())\n      .attr('height', function (d) {\n        return vm.chart.height - vm._scales.y(d.value);\n      })\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { // OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { // External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n  };\n\n  Bars._drawGroupByYAxis = function () {\n    var vm = this;\n    vm._tip.html(vm._config.tip || function (d) {\n      let html = d.key + '<br>';\n      if (d.axis !== d.key) {\n        html += d.axis + '<br>';\n      }\n      html += vm.utils.format(d.value);\n      return html;\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('transform', function (d) {\n        return 'translate(0,' + vm._scales.y(d[vm._config.y]) + ' )';\n      })\n      .selectAll('rect')\n      .data(function (d) {\n        return vm._config.groupBy.map(function (key) {\n          return {\n            key: key,\n            value: d[key],\n            axis: d[vm._config.y]\n          };\n        });\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return vm._scales.groupBy(d.key);\n      })\n      .attr('x', 0)\n      .attr('width', function (d) {\n        return vm._scales.x(d.value);\n      })\n      .attr('height', vm._scales.groupBy.bandwidth())\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n  };\n\n  Bars._drawStackByXAxis = function () {\n    var vm = this;\n    vm._tip.html(vm._config.tip || function (d) {\n      var html = '';\n      for (var k in d.data) {\n        if ((d[1] - d[0]).toFixed(12) === Number(d.data[k]).toFixed(12)) {\n          html += k + '<br>';\n        }\n      }\n      html += d.data[vm._config.x];\n      return html + '<br>' + vm.utils.format(d[1] - d[0]);\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      //.attr('transform', function(d) { return 'translate(0,'+ vm._scales.y(d[vm._config.y]) +' )'; })\n      .selectAll('rect')\n      .data(function (d) {\n        return d;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return vm._scales.y(d[1]);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d.data[vm._config.x]);\n      })\n      .attr('width', function (d) {\n        return vm._scales.x.bandwidth();\n      })\n      .attr('height', function (d) {\n        return vm._scales.y(d[0]) - vm._scales.y(d[1]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n  };\n\n  Bars._drawStackByYAxis = function () {\n    var vm = this;\n\n    vm._tip.html(vm._config.tip || function (d) {\n      var html = '';\n      for (var k in d.data) {\n        if ((d[1] - d[0]).toFixed(12) === Number(d.data[k]).toFixed(12)) {\n          html += k + '<br>';\n        }\n      }\n      html += d.data[vm._config.y];\n      return html + '<br>' + vm.utils.format(d[1] - d[0]);\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      .selectAll('rect')\n      .data(function (d) {\n        return d;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return vm._scales.y(d.data[vm._config.y]);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d[0]);\n      })\n      .attr('height', function (d) {\n        return vm._scales.y.bandwidth();\n      })\n      .attr('width', function (d) {\n        return vm._scales.x(d[1]) - vm._scales.x(d[0]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n  };\n\n  Bars._setQuantile = function (data) {\n    var vm = this;\n    var values = [];\n    var quantile = [];\n\n    if (vm._config.quantiles && vm._config.quantiles.predefinedQuantiles &&\n      vm._config.quantiles.predefinedQuantiles.length > 0) {\n      return vm._config.quantiles.predefinedQuantiles;\n    }\n\n    data.forEach(function (d) {\n      values.push(+d[vm._config.fill]);\n    });\n\n    values.sort(d3.ascending);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.quantiles && vm._config.quantiles.buckets) {\n\n      if (vm._config.quantiles.ignoreZeros === true) {\n        var aux = _.dropWhile(values, function (o) {\n          return o <= 0;\n        });\n        //aux.unshift(values[0]);  \n\n        quantile.push(values[0]);\n        quantile.push(0);\n\n        for (var i = 1; i <= vm._config.quantiles.buckets - 1; i++) {\n          quantile.push(d3.quantile(aux, i * 1 / (vm._config.quantiles.buckets - 1)));\n        }\n\n      } else {\n        quantile.push(d3.quantile(values, 0));\n        for (var i = 1; i <= vm._config.quantiles.buckets; i++) {\n          quantile.push(d3.quantile(values, i * 1 / vm._config.quantiles.buckets));\n        }\n      }\n\n    } else {\n      quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2), d3.quantile(values, 0.4), d3.quantile(values, 0.6), d3.quantile(values, 0.8), d3.quantile(values, 1)];\n    }\n\n    //@TODO - VALIDATE WHEN ZEROS NEED TO BE PUT ON QUANTILE 1 AND RECALCULATE NON ZERO VALUES INTO THE REST OF THE BUCKETS\n    if (vm._config.quantiles && vm._config.quantiles.buckets && vm._config.quantiles.buckets === 5) {\n\n      if (quantile[1] === quantile[2] && quantile[2] === quantile[3] && quantile[3] === quantile[4] && quantile[4] === quantile[5]) {\n        quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2)];\n      }\n    }\n\n    return quantile;\n  };\n\n  Bars._getQuantileColor = function (d, type) {\n    var vm = this;\n    var total = parseFloat(d);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.bars.quantiles && vm._config.bars.quantiles.colors) {\n      if (vm._quantiles.length > 2) {\n\n        if (vm._config && vm._config.bars.min !== undefined && vm._config.bars.max !== undefined) {\n          if (total < vm._config.bars.min || total > vm._config.bars.max) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        } else {\n          if (total < vm._minMax[0] || total > vm._minMax[1]) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        }\n\n        if (type == 'default') {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.bars.quantiles.colors[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.bars.quantiles.colors[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.bars.quantiles.colors[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colors[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colors[4]; //'#480000';\n          }\n        }\n\n        if (type == 'onHover' && vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.quantiles.colorsOnHover[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.quantiles.colorsOnHover[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.quantiles.colorsOnHover[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colorsOnHover[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colorsOnHover[4]; //'#480000';\n          }\n        }\n\n      }\n    }\n\n    if (vm._quantiles.length == 2) {\n      /*if(total === 0 ){\n        return d4theme.colors.quantiles[0];//return '#fff';\n      }else if(total <= vm._quantiles[1]){\n        return d4theme.colors.quantiles[1];//return '#f7c7c5';\n      }*/\n      if (total <= vm._quantiles[1]) {\n        return vm._config.quantiles.colors[0]; //'#f7c7c5';\n      }\n    }\n\n  };\n\n  Bars.init(config);\n  return Bars;\n}\n","import * as d3 from 'd3';\n/**\n * @fileOverview A D3 based distribution chart system. Supports: Box plots, Violin plots, Notched box plots, trend lines, beeswarm plot\n * @version 3.0\n */\n\n\n/**\n * Creates a box plot, violin plot, and or notched box plot\n * @param settings Configuration options for the base plot\n * @param settings.data The data for the plot\n * @param settings.xName The name of the column that should be used for the x groups\n * @param settings.yName The name of the column used for the y values\n * @param {string} settings.selector The selector string for the main chart div\n * @param [settings.axisLabels={}] Defaults to the xName and yName\n * @param [settings.yTicks = 1] 1 = default ticks. 2 =  double, 0.5 = half\n * @param [settings.scale='linear'] 'linear' or 'log' - y scale of the chart\n * @param [settings.chartSize={width:800, height:400}] The height and width of the chart itself (doesn't include the container)\n * @param [settings.margin={top: 15, right: 60, bottom: 40, left: 50}] The margins around the chart (inside the main div)\n * @param [settings.constrainExtremes=false] Should the y scale include outliers?\n * @returns {object} chart A chart object\n */\nexport default function makeDistroChart(settings) {\n\n    var chart = {};\n\n    // Defaults\n    chart.settings = {\n      data: null,\n      id: null,\n      idName: null,\n      events: null,\n      xName: null,\n      xSort:null,\n      yName: null,\n      selector: null,\n      axisLables: null,\n      yTicks: 1,\n      scale: 'linear',\n      chartSize: {width: 800, height: 400},\n      margin: {top: 15, right: 60, bottom: 40, left: 50},\n      constrainExtremes: false,\n      color: d3.scaleOrdinal(d3.schemeCategory10)\n    };\n    for (var setting in settings) {\n      chart.settings[setting] = settings[setting]\n    }\n\n\n    function formatAsFloat(d) {\n      if (d % 1 !== 0) {\n        return d3.format(\",.2f\")(d);\n      } else {\n        return d3.format(\",.0f\")(d);\n      }\n    }\n    function formatNumber(d) {\n      var value = '';\n        if (d % 1 == 0) {\n        value = d3.format(',.0f')(d);\n        } else if (d < 1 && d > 0) {\n        value = d3.format(',.2f')(d);\n        } else {\n        value = d3.format(',.1f')(d);\n        }\n        return value;\n    }\n\n    function formatRange(d) {\n        var range = d.split(' - ');\n        var value = '';\n        for(var i = 0; i < range.length; i++){\n          if (range[i] % 1 == 0) {\n            value += d3.format(',.0f')(range[i]);\n          } else if (range[i] < 1 && range[i] > 0) {\n            value += d3.format(',.2f')(range[i]);\n          } else {\n            value += d3.format(',.1f')(range[i]);\n          }\n          if (i === 0) {\n            value += ' - ';\n          }\n        }\n        return value;\n      }\n\n    function logFormatNumber(d) {\n      var x = Math.log(d) / Math.log(10) + 1e-6;\n      return Math.abs(x - Math.floor(x)) < 0.6 ? formatAsFloat(d) : \"\";\n    }\n\n    chart.yFormatter = formatNumber;\n    chart.xFormatter = formatRange;\n\n    chart.data = chart.settings.data;\n\n    chart.groupObjs = {}; //The data organized by grouping and sorted as well as any metadata for the groups\n    chart.objs = {mainDiv: null, chartDiv: null, g: null, xAxis: null, yAxis: null};\n    chart.colorFunct = null;\n\n    /**\n     * Takes an array, function, or object mapping and created a color function from it\n     * @param {function|[]|object} colorOptions\n     * @returns {function} Function to be used to determine chart colors\n     */\n    function getColorFunct(colorOptions) {\n        if (typeof colorOptions == 'function') {\n            return colorOptions\n        } else if (Array.isArray(colorOptions)) {\n            //  If an array is provided, map it to the domain\n            var colorMap = {}, cColor = 0;\n            /* @TODO - REVIEW PREVIOUS CODE \n            for (var cName in chart.groupObjs) {\n                debugger;\n                colorMap[cName] = colorOptions[cColor];\n                cColor = (cColor + 1) % colorOptions.length;\n            }*/\n            if (Array.isArray(chart.settings.xSort)){\n                chart.settings.xSort.forEach(function(key, index){\n                    colorMap[key] = colorOptions[index];\n                })\n            }else{\n                Object.keys(chart.groupObjs).sort(d3.ascending).forEach(function(key, index){\n                    colorMap[key] = colorOptions[index];\n                })\n            }\n            return function (group) {\n                return colorMap[group];\n            }\n        } else if (typeof colorOptions == 'object') {\n            // if an object is provided, assume it maps to  the colors\n            return function (group) {\n                return colorOptions[group];\n            }\n        } else {\n            return d3.scaleOrdinal(d3.schemeCategory10);\n        }\n    }\n\n    /**\n     * Takes a percentage as returns the values that correspond to that percentage of the group range witdh\n     * @param objWidth Percentage of range band\n     * @param gName The bin name to use to get the x shift\n     * @returns {{left: null, right: null, middle: null}}\n     */\n    function getObjWidth(objWidth, gName) {\n        var objSize = {left: null, right: null, middle: null};\n        var width = chart.xScale.bandwidth() * (objWidth / 100);\n        var padding = (chart.xScale.bandwidth() - width) / 2;\n        var gShift = chart.xScale(gName);\n        objSize.middle = chart.xScale.bandwidth() / 2 + gShift;\n        objSize.left = padding + gShift;\n        objSize.right = objSize.left + width;\n        return objSize;\n    }\n\n    /**\n     * Adds jitter to the  scatter point plot\n     * @param doJitter true or false, add jitter to the point\n     * @param width percent of the range band to cover with the jitter\n     * @returns {number}\n     */\n    function addJitter(doJitter, width) {\n        if (doJitter !== true || width == 0) {\n            return 0\n        }\n        return Math.floor(Math.random() * width) - width / 2;\n    }\n\n    function shallowCopy(oldObj) {\n        var newObj = {};\n        for (var i in oldObj) {\n            if (oldObj.hasOwnProperty(i)) {\n                newObj[i] = oldObj[i];\n            }\n        }\n        return newObj;\n    }\n\n    /**\n     * Closure that creates the tooltip hover function\n     * @param groupName Name of the x group\n     * @param metrics Object to use to get values for the group\n     * @returns {Function} A function that provides the values for the tooltip\n     */\n    function tooltipHover(groupName, metrics, pointName = '', pointValue = undefined) {\n        var tooltipString = pointName;\n        tooltipString += pointValue ? '<br>' + pointValue.toLocaleString() + '<br><hr style=\"height: 1px; background-color: #ADADAE; border: none; margin: 0.5em;\">': '';\n        tooltipString += groupName;\n        tooltipString += \"<br\\>Max: \" + formatAsFloat(metrics.max, 0.1);\n        tooltipString += \"<br\\>Q3: \" + formatAsFloat(metrics.quartile3);\n        tooltipString += \"<br\\>Mediana: \" + formatAsFloat(metrics.median);\n        tooltipString += \"<br\\>Q1: \" + formatAsFloat(metrics.quartile1);\n        tooltipString += \"<br\\>Min: \" + formatAsFloat(metrics.min);\n        return function () {\n            chart.objs.tooltip.transition().duration(200).style(\"opacity\", 0.8);\n            chart.objs.tooltip.html(tooltipString)\n        };\n    }\n\n    chart.distroSelect = function(id) {\n        console.log('this ', id, 'is selected');\n        chart.objs.mainDiv.select('.point.distro-' + id).attr('class', 'active');\n    };\n\n    /**\n     * Parse the data and calculates base values for the plots\n     */\n    !function prepareData() {\n        function calcMetrics(values) {\n\n            var metrics = { //These are the original nonscaled values\n                max: null,\n                upperOuterFence: null,\n                upperInnerFence: null,\n                quartile3: null,\n                median: null,\n                mean: null,\n                iqr: null,\n                quartile1: null,\n                lowerInnerFence: null,\n                lowerOuterFence: null,\n                min: null\n            };\n\n            metrics.min = d3.min(values);\n            metrics.quartile1 = d3.quantile(values, 0.25);\n            metrics.median = d3.median(values);\n            metrics.mean = d3.mean(values);\n            metrics.quartile3 = d3.quantile(values, 0.75);\n            metrics.max = d3.max(values);\n            metrics.iqr = metrics.quartile3 - metrics.quartile1;\n\n            //The inner fences are the closest value to the IQR without going past it (assumes sorted lists)\n            var LIF = metrics.quartile1 - (1.5 * metrics.iqr);\n            var UIF = metrics.quartile3 + (1.5 * metrics.iqr);\n            for (var i = 0; i <= values.length; i++) {\n                if (values[i] < LIF) {\n                    continue;\n                }\n                if (!metrics.lowerInnerFence && values[i] >= LIF) {\n                    metrics.lowerInnerFence = values[i];\n                    continue;\n                }\n                if (values[i] > UIF) {\n                    metrics.upperInnerFence = values[i - 1];\n                    break;\n                }\n            }\n\n\n            metrics.lowerOuterFence = metrics.quartile1 - (3 * metrics.iqr);\n            metrics.upperOuterFence = metrics.quartile3 + (3 * metrics.iqr);\n            if (!metrics.lowerInnerFence) {\n                metrics.lowerInnerFence = metrics.min;\n            }\n            if (!metrics.upperInnerFence) {\n                metrics.upperInnerFence = metrics.max;\n            }\n            return metrics\n        }\n\n        var current_x = null;\n        var current_y = null;\n        var current_id = null;\n        var current_idName = null;\n        var current_row;\n\n        // Group the values\n        for (current_row = 0; current_row < chart.data.length; current_row++) {\n            current_x = chart.data[current_row][chart.settings.xName];\n            current_y = chart.data[current_row][chart.settings.yName];\n            current_id = chart.settings.id ? chart.data[current_row][chart.settings.id] : null;\n            current_idName = chart.settings.idName ? chart.data[current_row][chart.settings.idName] : null;\n\n            if (chart.groupObjs.hasOwnProperty(current_x)) {\n                if (chart.settings.id) {\n                    chart.groupObjs[current_x].valuesInfo.push({\n                        value: current_y,\n                        id: current_id,\n                        idName: current_idName\n                    });\n                } else{\n                    chart.groupObjs[current_x].values.push(current_y);\n                }\n            } else {\n                if (chart.settings.id) {\n                    chart.groupObjs[current_x] = {};\n                    chart.groupObjs[current_x].valuesInfo = [{\n                        value: current_y,\n                        id: current_id,\n                        idName: current_idName\n                    }];\n                } else{\n                    chart.groupObjs[current_x] = {};\n                    chart.groupObjs[current_x].values = [current_y];\n                }\n            }\n\n\n            //original\n            /*if (chart.groupObjs.hasOwnProperty(current_x)) {\n                chart.groupObjs[current_x].values.push(current_y);\n            } else {\n                chart.groupObjs[current_x] = {};\n                chart.groupObjs[current_x].values = [current_y];\n            }*/\n        }\n\n        for (var cName in chart.groupObjs) {\n            if (chart.settings.id) {\n                chart.groupObjs[cName].values = [];\n                //in order to keep the array chart.groupObjs[cName].values \n                for (let index = 0; index < chart.groupObjs[cName].valuesInfo.length; index++){\n                    chart.groupObjs[cName].values.push(chart.groupObjs[cName].valuesInfo[index].value);\n                }\n\n                chart.groupObjs[cName].valuesInfo.sort(function(x,y) { return d3.ascending(x.value, y.value) });\n            }\n\n            //original\n            chart.groupObjs[cName].values.sort(d3.ascending);\n            chart.groupObjs[cName].metrics = {};\n            chart.groupObjs[cName].metrics =  calcMetrics(chart.groupObjs[cName].values);\n        }\n    }();\n\n    /**\n     * Prepare the chart settings and chart div and svg\n     */\n    !function prepareSettings() {\n        var domain = ''; \n        //Set base settings\n        chart.margin = chart.settings.margin;\n        chart.divWidth = chart.settings.chartSize.width;\n        chart.divHeight = chart.settings.chartSize.height;\n        chart.width = chart.divWidth - chart.margin.left - chart.margin.right;\n        chart.height = chart.divHeight - chart.margin.top - chart.margin.bottom;\n\n        if (chart.settings.axisLabels) {\n            chart.xAxisLable = chart.settings.axisLabels.xAxis;\n            chart.yAxisLable = chart.settings.axisLabels.yAxis;\n        } else {\n            chart.xAxisLable = chart.settings.xName;\n            chart.yAxisLable = chart.settings.yName;\n        }\n\n        if (chart.settings.scale === 'log') {\n            chart.yScale = d3.scaleLog();\n            chart.yFormatter = logFormatNumber;\n        } else {\n            chart.yScale = d3.scaleLinear();\n        }\n\n        if (chart.settings.constrainExtremes === true) {\n            var fences = [];\n            for (var cName in chart.groupObjs) {\n                fences.push(chart.groupObjs[cName].metrics.lowerInnerFence);\n                fences.push(chart.groupObjs[cName].metrics.upperInnerFence);\n            }\n            chart.range = d3.extent(fences);\n\n        } else {\n            chart.range = d3.extent(chart.data, function (d) {return d[chart.settings.yName];});\n        }\n\n        chart.colorFunct = getColorFunct(chart.settings.colors);\n\n        // Build Scale functions\n        chart.yScale.range([chart.height, 0]).domain(chart.range).nice().clamp(true);\n        \n        if (chart.settings.xSort === null) {\n            domain = Object.keys(chart.groupObjs)\n        } else {\n            domain = Array.isArray(chart.settings.xSort) ? chart.settings.xSort : Object.keys(chart.groupObjs).sort(d3.ascending)\n        }\n        chart.xScale = d3.scaleBand().domain(domain).rangeRound([0, chart.width]);\n\n        //Build Axes Functions\n        chart.objs.yAxis = d3.axisLeft()\n            .scale(chart.yScale)\n            .tickFormat(chart.yFormatter)\n            .tickSizeOuter(0)\n            .tickSizeInner(-chart.width + (chart.margin.right + chart.margin.left));\n        //chart.objs.yAxis.ticks(chart.objs.yAxis.ticks()*chart.settings.yTicks);\n        chart.objs.xAxis = d3.axisBottom()\n            .scale(chart.xScale)\n            //.tickFormat(chart.xFormatter)\n            .tickSizeOuter(0)\n            .tickSize(5); \n    }();\n\n    /**\n     * Updates the chart based on the current settings and window size\n     * @returns {*}\n     */\n    chart.update = function () {\n        // Update chart size based on view port size\n        chart.width = parseInt(chart.objs.chartDiv.style(\"width\"), 10) - (chart.margin.left + chart.margin.right);\n        chart.height = parseInt(chart.objs.chartDiv.style(\"height\"), 10) - (chart.margin.top + chart.margin.bottom);\n        // Update scale functions\n        chart.xScale.rangeRound([0, chart.width]);\n        chart.yScale.range([chart.height, 0]);\n\n        // Update the yDomain if the Violin plot clamp is set to -1 meaning it will extend the violins to make nice points\n        if (chart.violinPlots && chart.violinPlots.options.show == true && chart.violinPlots.options._yDomainVP != null) {\n            chart.yScale.domain(chart.violinPlots.options._yDomainVP).nice().clamp(true);\n        } else {\n            chart.yScale.domain(chart.range).nice().clamp(true);\n        }\n\n        //Update axes\n        chart.objs.g.select('.x.axis').attr(\"transform\", \"translate(0,\" + chart.height + \")\").call(chart.objs.xAxis)\n            .selectAll(\".tick text\")\n            .attr(\"y\", 5)\n            .attr(\"x\", -5)\n            .attr(\"transform\", \"rotate(-40)\")\n            .style(\"text-anchor\", \"end\");\n        chart.objs.g.select('.x.axis .label').attr(\"x\", chart.width / 2);\n        chart.objs.g.select('.y.axis').call(chart.objs.yAxis.tickSizeInner(-chart.width));\n        chart.objs.g.select('.y.axis .label').attr(\"x\", -chart.height / 2);\n        chart.objs.chartDiv.select('svg').attr(\"width\", chart.width + (chart.margin.left + chart.margin.right)).attr(\"height\", chart.height + (chart.margin.top + chart.margin.bottom));\n\n        return chart;\n    };\n\n    /**\n     * Prepare the chart html elements\n     */\n    !function prepareChart() {\n      // Build main div and chart div\n      chart.objs.mainDiv = d3.select(chart.settings.selector)\n        .style(\"width\", chart.divWidth + \"px\")\n        .style(\"height\", chart.divHeight+ \"px\");\n      // Add all the divs to make it centered and responsive\n      chart.objs.mainDiv.append(\"div\")\n        .attr(\"class\", \"inner-wrapper\")\n        .style(\"padding-bottom\", \"5%\")\n        .style(\"height\", chart.divHeight + \"px\")\n        .append(\"div\").attr(\"class\", \"outer-box\")\n        .append(\"div\").attr(\"class\", \"inner-box\");\n      // Capture the inner div for the chart (where the chart actually is)\n      chart.selector = chart.settings.selector + \" .inner-box\";   \n      chart.objs.chartDiv = d3.select(chart.selector);\n      d3.select(window).on('resize.' + chart.selector, chart.update);\n\n      // Create the svg\n      chart.objs.g = chart.objs.chartDiv.append(\"svg\")\n        .attr(\"class\", \"chart-area\")\n        .attr(\"width\", chart.width + (chart.margin.left + chart.margin.right))\n        .attr(\"height\", chart.height + (chart.margin.top + chart.margin.bottom))\n        .append(\"g\")\n        .attr(\"transform\", \"translate(\" + chart.margin.left + \",\" + chart.margin.top + \")\");\n      \n      // Create axes\n      chart.objs.axes = chart.objs.g.append(\"g\").attr(\"class\", \"axis\");\n      chart.objs.axes.append(\"g\")\n          .attr(\"class\", \"x axis\")\n          .attr(\"transform\", \"translate(0,\" + chart.height + \")\")\n          .call(chart.objs.xAxis)\n          .append(\"text\")\n          .attr(\"class\", \"label\")\n          .attr(\"y\", chart.margin.bottom - 20)\n          .attr(\"x\", -chart.width / 2)\n          .attr(\"dy\", \".71em\")\n          .attr('fill', '#fff')\n          .style(\"text-anchor\", \"middle\")\n          .text(chart.xAxisLable);\n\n      chart.objs.axes.append(\"g\")\n          .attr(\"class\", \"y axis\")\n          .call(chart.objs.yAxis)\n          .append(\"text\")\n          .attr(\"class\", \"label\")\n          .attr(\"transform\", \"rotate(-90)\")\n          .attr(\"y\", -chart.margin.left * 0.9)\n          .attr(\"x\", -chart.height / 2)\n          .attr(\"dy\", \".71em\")\n          .attr('fill', '#fff')\n          .style(\"text-anchor\", \"middle\")\n          .text(chart.yAxisLable);\n\n      // Create tooltip div\n      chart.objs.tooltip = chart.objs.mainDiv.append('div').attr('class', 'tooltip').style(\"display\", \"none\");\n      for (var cName in chart.groupObjs) {\n          chart.groupObjs[cName].g = chart.objs.g.append(\"g\").attr(\"class\", \"group\");\n          /*chart.groupObjs[cName].g.on(\"mouseover\", function () {\n              chart.objs.tooltip\n                  .style(\"display\", null)\n                  .style(\"left\", (d3.event.pageX) + \"px\")\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\n          }).on(\"mouseout\", function () {\n            chart.objs.tooltip.style(\"display\", \"none\");\n          }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics));*/\n      }\n      chart.update();\n    }();\n\n    /**\n     * Render a violin plot on the current chart\n     * @param options\n     * @param [options.showViolinPlot=true] True or False, show the violin plot\n     * @param [options.resolution=100 default]\n     * @param [options.bandwidth=10 default] May need higher bandwidth for larger data sets\n     * @param [options.width=50] The max percent of the group rangeBand that the violin can be\n     * @param [options.curve=''] How to render the violin\n     * @param [options.clamp=0 default]\n     *   0 = keep data within chart min and max, clamp once data = 0. May extend beyond data set min and max\n     *   1 = clamp at min and max of data set. Possibly no tails\n     *  -1 = extend chart axis to make room for data to interpolate to 0. May extend axis and data set min and max\n     * @param [options.colors=chart default] The color mapping for the violin plot\n     * @returns {*} The chart object\n     */\n    chart.renderViolinPlot = function (options) {\n        chart.violinPlots = {};\n\n        var defaultOptions = {\n            show: true,\n            showViolinPlot: true,\n            resolution: 100,\n            bandwidth: 20,\n            width: 50,\n            curve: d3.curveCardinal,\n            clamp: 1,\n            colors: chart.colorFunct,\n            _yDomainVP: null // If the Violin plot is set to close all violin plots, it may need to extend the domain, that extended domain is stored here\n        };\n        chart.violinPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.violinPlots.options[option] = options[option]\n        }\n        var vOpts = chart.violinPlots.options;\n\n        // Create violin plot objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].violin = {};\n            chart.groupObjs[cName].violin.objs = {};\n        }\n\n        /**\n         * Take a new set of options and redraw the violin\n         * @param updateOptions\n         */\n        chart.violinPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    vOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].violin.objs.g.remove()\n            }\n\n            chart.violinPlots.prepareViolin();\n            chart.violinPlots.update();\n        };\n\n        chart.violinPlots.reset = function () {\n            chart.violinPlots.change(defaultOptions)\n        };\n        chart.violinPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.violinPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.violinPlots.change(opts);\n\n        };\n\n        chart.violinPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.violinPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.violinPlots.change(opts);\n\n        };\n\n        /**\n         * Update the violin obj values\n         */\n        chart.violinPlots.update = function () {\n            var cName, cViolinPlot;\n\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                // Build the violins sideways, so use the yScale for the xScale and make a new yScale\n                var xVScale = chart.yScale.copy();\n\n\n                // Create the Kernel Density Estimator Function\n                cViolinPlot.kde = kernelDensityEstimator(eKernel(vOpts.bandwidth), xVScale.ticks(vOpts.resolution));\n                cViolinPlot.kdedata = cViolinPlot.kde(chart.groupObjs[cName].values);\n\n                var interpolateMax = chart.groupObjs[cName].metrics.max,\n                    interpolateMin = chart.groupObjs[cName].metrics.min;\n\n                if (vOpts.clamp == 0 || vOpts.clamp == -1) { //\n                    // When clamp is 0, calculate the min and max that is needed to bring the violin plot to a point\n                    // interpolateMax = the Minimum value greater than the max where y = 0\n                    interpolateMax = d3.min(cViolinPlot.kdedata.filter(function (d) {\n                        return (d.x > chart.groupObjs[cName].metrics.max && d.y == 0)\n                    }), function (d) {\n                        return d.x;\n                    });\n                    // interpolateMin = the Maximum value less than the min where y = 0\n                    interpolateMin = d3.max(cViolinPlot.kdedata.filter(function (d) {\n                        return (d.x < chart.groupObjs[cName].metrics.min && d.y == 0)\n                    }), function (d) {\n                        return d.x;\n                    });\n                    // If clamp is -1 we need to extend the axises so that the violins come to a point\n                    if (vOpts.clamp == -1) {\n                        kdeTester = eKernelTest(eKernel(vOpts.bandwidth), chart.groupObjs[cName].values);\n                        if (!interpolateMax) {\n                            var interMaxY = kdeTester(chart.groupObjs[cName].metrics.max);\n                            var interMaxX = chart.groupObjs[cName].metrics.max;\n                            var count = 25; // Arbitrary limit to make sure we don't get an infinite loop\n                            while (count > 0 && interMaxY != 0) {\n                                interMaxY = kdeTester(interMaxX);\n                                interMaxX += 1;\n                                count -= 1;\n                            }\n                            interpolateMax = interMaxX;\n                        }\n                        if (!interpolateMin) {\n                            var interMinY = kdeTester(chart.groupObjs[cName].metrics.min);\n                            var interMinX = chart.groupObjs[cName].metrics.min;\n                            var count = 25;  // Arbitrary limit to make sure we don't get an infinite loop\n                            while (count > 0 && interMinY != 0) {\n                                interMinY = kdeTester(interMinX);\n                                interMinX -= 1;\n                                count -= 1;\n                            }\n                            interpolateMin = interMinX;\n                        }\n\n                    }\n                    // Check to see if the new values are outside the existing chart range\n                    //   If they are assign them to the master _yDomainVP\n                    if (!vOpts._yDomainVP) vOpts._yDomainVP = chart.range.slice(0);\n                    if (interpolateMin && interpolateMin < vOpts._yDomainVP[0]) {\n                        vOpts._yDomainVP[0] = interpolateMin;\n                    }\n                    if (interpolateMax && interpolateMax > vOpts._yDomainVP[1]) {\n                        vOpts._yDomainVP[1] = interpolateMax;\n                    }\n\n\n                }\n\n\n                if (vOpts.showViolinPlot) {\n                    chart.update();\n                    xVScale = chart.yScale.copy();\n\n                    // Need to recalculate the KDE because the xVScale changed\n                    cViolinPlot.kde = kernelDensityEstimator(eKernel(vOpts.bandwidth), xVScale.ticks(vOpts.resolution));\n                    cViolinPlot.kdedata = cViolinPlot.kde(chart.groupObjs[cName].values);\n                }\n\n                cViolinPlot.kdedata = cViolinPlot.kdedata\n                    .filter(function (d) {\n                        return (!interpolateMin || d.x >= interpolateMin)\n                    })\n                    .filter(function (d) {\n                        return (!interpolateMax || d.x <= interpolateMax)\n                    });\n            }\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                // Get the violin width\n                var objBounds = getObjWidth(vOpts.width, cName);\n                var width = (objBounds.right - objBounds.left) / 2;\n\n                var yVScale = d3.scaleLinear()\n                    .range([width, 0])\n                    .domain([0, d3.max(cViolinPlot.kdedata, function (d) {return d.y;})])\n                    .clamp(true);\n\n                var area = d3.area()\n                    .curve(vOpts.curve)\n                    .x(function (d) {return xVScale(d.x);})\n                    .y0(width)\n                    .y1(function (d) {return yVScale(d.y);});\n\n                var line = d3.line()\n                    .curve(vOpts.curve)\n                    .x(function (d) {return xVScale(d.x);})\n                    .y(function (d) {return yVScale(d.y)});\n\n                if (cViolinPlot.objs.left.area) {\n                    cViolinPlot.objs.left.area\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", area);\n                    cViolinPlot.objs.left.line\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", line);\n\n                    cViolinPlot.objs.right.area\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", area);\n                    cViolinPlot.objs.right.line\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", line);\n                }\n\n                // Rotate the violins\n                cViolinPlot.objs.left.g.attr(\"transform\", \"rotate(90,0,0)   translate(0,-\" + objBounds.left + \")  scale(1,-1)\");\n                cViolinPlot.objs.right.g.attr(\"transform\", \"rotate(90,0,0)  translate(0,-\" + objBounds.right + \")\");\n            }\n        };\n\n        /**\n         * Create the svg elements for the violin plot\n         */\n        chart.violinPlots.prepareViolin = function () {\n            var cName, cViolinPlot;\n\n            if (vOpts.colors) {\n                chart.violinPlots.color = getColorFunct(vOpts.colors);\n            } else {\n                chart.violinPlots.color = chart.colorFunct\n            }\n\n            if (vOpts.show == false) {return}\n\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                cViolinPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"violin-plot\");\n                cViolinPlot.objs.left = {area: null, line: null, g: null};\n                cViolinPlot.objs.right = {area: null, line: null, g: null};\n\n                cViolinPlot.objs.left.g = cViolinPlot.objs.g.append(\"g\");\n                cViolinPlot.objs.right.g = cViolinPlot.objs.g.append(\"g\");\n\n                if (vOpts.showViolinPlot !== false) {\n                    //Area\n                    cViolinPlot.objs.left.area = cViolinPlot.objs.left.g.append(\"path\")\n                        .attr(\"class\", \"area\")\n                        .style(\"fill\", chart.violinPlots.color(cName));\n                    cViolinPlot.objs.right.area = cViolinPlot.objs.right.g.append(\"path\")\n                        .attr(\"class\", \"area\")\n                        .style(\"fill\", chart.violinPlots.color(cName));\n\n                    //Lines\n                    cViolinPlot.objs.left.line = cViolinPlot.objs.left.g.append(\"path\")\n                        .attr(\"class\", \"line\")\n                        .attr(\"fill\", 'none')\n                        .style(\"stroke\", chart.violinPlots.color(cName));\n                    cViolinPlot.objs.right.line = cViolinPlot.objs.right.g.append(\"path\")\n                        .attr(\"class\", \"line\")\n                        .attr(\"fill\", 'none')\n                        .style(\"stroke\", chart.violinPlots.color(cName));\n                }\n\n            }\n\n        };\n\n\n        function kernelDensityEstimator(kernel, x) {\n            return function (sample) {\n                return x.map(function (x) {\n                    return {x:x, y:d3.mean(sample, function (v) {return kernel(x - v);})};\n                });\n            };\n        }\n\n        function eKernel(scale) {\n            return function (u) {\n                return Math.abs(u /= scale) <= 1 ? .75 * (1 - u * u) / scale : 0;\n            };\n        }\n\n        // Used to find the roots for adjusting violin axis\n        // Given an array, find the value for a single point, even if it is not in the domain\n        function eKernelTest(kernel, array) {\n            return function (testX) {\n                return d3.mean(array, function (v) {return kernel(testX - v);})\n            }\n        }\n\n        chart.violinPlots.prepareViolin();\n\n        d3.select(window).on('resize.' + chart.selector + '.violinPlot', chart.violinPlots.update);\n        chart.violinPlots.update();\n        return chart;\n    };\n\n    /**\n     * Render a box plot on the current chart\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showBox=true] Show the box part of the box plot\n     * @param [options.showWhiskers=true] Show the whiskers\n     * @param [options.showMedian=true] Show the median line\n     * @param [options.showMean=false] Show the mean line\n     * @param [options.medianCSize=3] The size of the circle on the median\n     * @param [options.showOutliers=true] Plot outliers\n     * @param [options.boxwidth=30] The max percent of the group rangeBand that the box can be\n     * @param [options.lineWidth=boxWidth] The max percent of the group rangeBand that the line can be\n     * @param [options.outlierScatter=false] Spread out the outliers so they don't all overlap (in development)\n     * @param [options.outlierCSize=2] Size of the outliers\n     * @param [options.colors=chart default] The color mapping for the box plot\n     * @returns {*} The chart object\n     */\n    chart.renderBoxPlot = function (options) {\n        chart.boxPlots = {};\n\n        // Defaults\n        var defaultOptions = {\n            show: true,\n            showBox: true,\n            showWhiskers: true,\n            showMedian: true,\n            showMean: false,\n            medianCSize: 3.5,\n            showOutliers: true,\n            boxWidth: 30,\n            lineWidth: null,\n            scatterOutliers: false,\n            outlierCSize: 2.5,\n            colors: chart.colorFunct\n        };\n        chart.boxPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.boxPlots.options[option] = options[option]\n        }\n        var bOpts = chart.boxPlots.options;\n\n        //Create box plot objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].boxPlot = {};\n            chart.groupObjs[cName].boxPlot.objs = {};\n        }\n\n\n        /**\n         * Calculates all the outlier points for each group\n         */\n        !function calcAllOutliers() {\n\n            /**\n             * Create lists of the outliers for each content group\n             * @param cGroup The object to modify\n             * @return null Modifies the object in place\n             */\n            function calcOutliers(cGroup) {\n                var cExtremes = [];\n                var cOutliers = [];\n                var cOut, idx;\n                for (idx = 0; idx <= cGroup.values.length; idx++) {\n                    cOut = {value: cGroup.values[idx]};\n\n                    if (cOut.value < cGroup.metrics.lowerInnerFence) {\n                        if (cOut.value < cGroup.metrics.lowerOuterFence) {\n                            cExtremes.push(cOut);\n                        } else {\n                            cOutliers.push(cOut);\n                        }\n                    } else if (cOut.value > cGroup.metrics.upperInnerFence) {\n                        if (cOut.value > cGroup.metrics.upperOuterFence) {\n                            cExtremes.push(cOut);\n                        } else {\n                            cOutliers.push(cOut);\n                        }\n                    }\n                }\n                cGroup.boxPlot.objs.outliers = cOutliers;\n                cGroup.boxPlot.objs.extremes = cExtremes;\n            }\n\n            for (var cName in chart.groupObjs) {\n                calcOutliers(chart.groupObjs[cName]);\n            }\n        }();\n\n        /**\n         * Take updated options and redraw the box plot\n         * @param updateOptions\n         */\n        chart.boxPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    bOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].boxPlot.objs.g.remove()\n            }\n            chart.boxPlots.prepareBoxPlot();\n            chart.boxPlots.update()\n        };\n\n        chart.boxPlots.reset = function () {\n            chart.boxPlots.change(defaultOptions)\n        };\n        chart.boxPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.boxPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.boxPlots.change(opts)\n\n        };\n        chart.boxPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.boxPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.boxPlots.change(opts)\n        };\n\n        /**\n         * Update the box plot obj values\n         */\n        chart.boxPlots.update = function () {\n            var cName, cBoxPlot;\n\n            for (cName in chart.groupObjs) {\n                cBoxPlot = chart.groupObjs[cName].boxPlot;\n\n                // Get the box width\n                var objBounds = getObjWidth(bOpts.boxWidth, cName);\n                var width = (objBounds.right - objBounds.left);\n\n                var sMetrics = {}; //temp var for scaled (plottable) metric values\n                for (var attr in chart.groupObjs[cName].metrics) {\n                    sMetrics[attr] = null;\n                    sMetrics[attr] = chart.yScale(chart.groupObjs[cName].metrics[attr]);\n                }\n\n                // Box\n                if (cBoxPlot.objs.box) {\n                    cBoxPlot.objs.box\n                        .attr(\"x\", objBounds.left)\n                        .attr('width', width)\n                        .attr(\"y\", sMetrics.quartile3)\n                        .attr(\"rx\", 1)\n                        .attr(\"ry\", 1)\n                        .attr(\"height\", -sMetrics.quartile3 + sMetrics.quartile1)\n                }\n\n                // Lines\n                var lineBounds = null;\n                if (bOpts.lineWidth) {\n                    lineBounds = getObjWidth(bOpts.lineWidth, cName)\n                } else {\n                    lineBounds = objBounds\n                }\n                // --Whiskers\n                if (cBoxPlot.objs.upperWhisker) {\n                    cBoxPlot.objs.upperWhisker.fence\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.upperInnerFence)\n                        .attr(\"y2\", sMetrics.upperInnerFence);\n                    cBoxPlot.objs.upperWhisker.line\n                        .attr(\"x1\", lineBounds.middle)\n                        .attr(\"x2\", lineBounds.middle)\n                        .attr('y1', sMetrics.quartile3)\n                        .attr(\"y2\", sMetrics.upperInnerFence);\n\n                    cBoxPlot.objs.lowerWhisker.fence\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.lowerInnerFence)\n                        .attr(\"y2\", sMetrics.lowerInnerFence);\n                    cBoxPlot.objs.lowerWhisker.line\n                        .attr(\"x1\", lineBounds.middle)\n                        .attr(\"x2\", lineBounds.middle)\n                        .attr('y1', sMetrics.quartile1)\n                        .attr(\"y2\", sMetrics.lowerInnerFence);\n                }\n\n                // --Median\n                if (cBoxPlot.objs.median) {\n                    cBoxPlot.objs.median.line\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.median)\n                        .attr(\"y2\", sMetrics.median);\n                    cBoxPlot.objs.median.circle\n                        .attr(\"cx\", lineBounds.middle)\n                        .attr(\"cy\", sMetrics.median)\n                }\n\n                // --Mean\n                if (cBoxPlot.objs.mean) {\n                    cBoxPlot.objs.mean.line\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.mean)\n                        .attr(\"y2\", sMetrics.mean);\n                    cBoxPlot.objs.mean.circle\n                        .attr(\"cx\", lineBounds.middle)\n                        .attr(\"cy\", sMetrics.mean);\n                }\n\n                // Outliers\n\n                var pt;\n                if (cBoxPlot.objs.outliers) {\n                    for (pt in cBoxPlot.objs.outliers) {\n                        cBoxPlot.objs.outliers[pt].point\n                            .attr(\"cx\", objBounds.middle + addJitter(bOpts.scatterOutliers, width))\n                            .attr(\"cy\", chart.yScale(cBoxPlot.objs.outliers[pt].value));\n                    }\n                }\n                if (cBoxPlot.objs.extremes) {\n                    for (pt in cBoxPlot.objs.extremes) {\n                        cBoxPlot.objs.extremes[pt].point\n                            .attr(\"cx\", objBounds.middle + addJitter(bOpts.scatterOutliers, width))\n                            .attr(\"cy\", chart.yScale(cBoxPlot.objs.extremes[pt].value));\n                    }\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the box plot\n         */\n        chart.boxPlots.prepareBoxPlot = function () {\n            var cName, cBoxPlot;\n\n            if (bOpts.colors) {\n                chart.boxPlots.colorFunct = getColorFunct(bOpts.colors);\n            } else {\n                chart.boxPlots.colorFunct = chart.colorFunct\n            }\n\n            if (bOpts.show == false) {\n                return\n            }\n\n            for (cName in chart.groupObjs) {\n                cBoxPlot = chart.groupObjs[cName].boxPlot;\n\n                cBoxPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"box-plot\");\n\n                //Plot Box (default show)\n                if (bOpts.showBox) {\n                    cBoxPlot.objs.box = cBoxPlot.objs.g.append(\"rect\")\n                        .attr(\"class\", \"box\")\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName))\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    //A stroke is added to the box with the group color, it is\n                    // hidden by default and can be shown through css with stroke-width\n                }\n\n                //Plot Median (default show)\n                if (bOpts.showMedian) {\n                    cBoxPlot.objs.median = {line: null, circle: null};\n                    cBoxPlot.objs.median.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"median\");\n                    cBoxPlot.objs.median.circle = cBoxPlot.objs.g.append(\"circle\")\n                        .attr(\"class\", \"median\")\n                        .attr('r', bOpts.medianCSize)\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName));\n                }\n\n                // Plot Mean (default no plot)\n                if (bOpts.showMean) {\n                    cBoxPlot.objs.mean = {line: null, circle: null};\n                    cBoxPlot.objs.mean.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"mean\");\n                    cBoxPlot.objs.mean.circle = cBoxPlot.objs.g.append(\"circle\")\n                        .attr(\"class\", \"mean\")\n                        .attr('r', bOpts.medianCSize)\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName));\n                }\n\n                // Plot Whiskers (default show)\n                if (bOpts.showWhiskers) {\n                    cBoxPlot.objs.upperWhisker = {fence: null, line: null};\n                    cBoxPlot.objs.lowerWhisker = {fence: null, line: null};\n                    cBoxPlot.objs.upperWhisker.fence = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    cBoxPlot.objs.upperWhisker.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n\n                    cBoxPlot.objs.lowerWhisker.fence = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    cBoxPlot.objs.lowerWhisker.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                }\n\n                // Plot outliers (default show)\n                if (bOpts.showOutliers) {\n                    if (!cBoxPlot.objs.outliers) calcAllOutliers();\n                    var pt;\n                    if (cBoxPlot.objs.outliers.length) {\n                        var outDiv = cBoxPlot.objs.g.append(\"g\").attr(\"class\", \"boxplot outliers\");\n                        for (pt in cBoxPlot.objs.outliers) {\n                            cBoxPlot.objs.outliers[pt].point = outDiv.append(\"circle\")\n                                .attr(\"class\", \"outlier\")\n                                .attr('r', bOpts.outlierCSize)\n                                .style(\"fill\", chart.boxPlots.colorFunct(cName));\n                        }\n                    }\n\n                    if (cBoxPlot.objs.extremes.length) {\n                        var extDiv = cBoxPlot.objs.g.append(\"g\").attr(\"class\", \"boxplot extremes\");\n                        for (pt in cBoxPlot.objs.extremes) {\n                            cBoxPlot.objs.extremes[pt].point = extDiv.append(\"circle\")\n                                .attr(\"class\", \"extreme\")\n                                .attr('r', bOpts.outlierCSize)\n                                .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                        }\n                    }\n                }\n\n\n            }\n        };\n        chart.boxPlots.prepareBoxPlot();\n\n        d3.select(window).on('resize.' + chart.selector + '.boxPlot', chart.boxPlots.update);\n        chart.boxPlots.update();\n        return chart;\n\n    };\n\n    /**\n     * Render a notched box on the current chart\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showNotchBox=true] Show the notch box\n     * @param [options.showLines=false] Show lines at the confidence intervals\n     * @param [options.boxWidth=35] The width of the widest part of the box\n     * @param [options.medianWidth=20] The width of the narrowist part of the box\n     * @param [options.lineWidth=50] The width of the confidence interval lines\n     * @param [options.notchStyle=null] null=traditional style, 'box' cuts out the whole notch in right angles\n     * @param [options.colors=chart default] The color mapping for the notch boxes\n     * @returns {*} The chart object\n     */\n    chart.renderNotchBoxes = function (options) {\n        chart.notchBoxes = {};\n\n        //Defaults\n        var defaultOptions = {\n            show: true,\n            showNotchBox: true,\n            showLines: false,\n            boxWidth: 35,\n            medianWidth: 20,\n            lineWidth: 50,\n            notchStyle: null,\n            colors: null\n        };\n        chart.notchBoxes.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.notchBoxes.options[option] = options[option]\n        }\n        var nOpts = chart.notchBoxes.options;\n\n        //Create notch objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].notchBox = {};\n            chart.groupObjs[cName].notchBox.objs = {};\n        }\n\n        /**\n         * Makes the svg path string for a notched box\n         * @param cNotch Current notch box object\n         * @param notchBounds objBound object\n         * @returns {string} A string in the proper format for a svg polygon\n         */\n        function makeNotchBox(cNotch, notchBounds) {\n            var scaledValues = [];\n            if (nOpts.notchStyle == 'box') {\n                scaledValues = [\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile1)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile1)]\n                ];\n            } else {\n                scaledValues = [\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile1)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile1)]\n                ];\n            }\n            return scaledValues.map(function (d) {\n                return [d[0], d[1]].join(\",\");\n            }).join(\" \");\n        }\n\n        /**\n         * Calculate the confidence intervals\n         */\n        !function calcNotches() {\n            var cNotch, modifier;\n            for (var cName in chart.groupObjs) {\n                cNotch = chart.groupObjs[cName];\n                modifier = (1.57 * (cNotch.metrics.iqr / Math.sqrt(cNotch.values.length)));\n                cNotch.metrics.upperNotch = cNotch.metrics.median + modifier;\n                cNotch.metrics.lowerNotch = cNotch.metrics.median - modifier;\n            }\n        }();\n\n        /**\n         * Take a new set of options and redraw the notch boxes\n         * @param updateOptions\n         */\n        chart.notchBoxes.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    nOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].notchBox.objs.g.remove()\n            }\n            chart.notchBoxes.prepareNotchBoxes();\n            chart.notchBoxes.update();\n        };\n\n        chart.notchBoxes.reset = function () {\n            chart.notchBoxes.change(defaultOptions)\n        };\n        chart.notchBoxes.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.notchBoxes.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.notchBoxes.change(opts)\n        };\n        chart.notchBoxes.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.notchBoxes.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.notchBoxes.change(opts)\n        };\n\n        /**\n         * Update the notch box obj values\n         */\n        chart.notchBoxes.update = function () {\n            var cName, cGroup;\n\n            for (cName in chart.groupObjs) {\n                cGroup = chart.groupObjs[cName];\n\n                // Get the box size\n                var boxBounds = getObjWidth(nOpts.boxWidth, cName);\n                var medianBounds = getObjWidth(nOpts.medianWidth, cName);\n\n                var notchBounds = {\n                    boxLeft: boxBounds.left,\n                    boxRight: boxBounds.right,\n                    middle: boxBounds.middle,\n                    medianLeft: medianBounds.left,\n                    medianRight: medianBounds.right\n                };\n\n                // Notch Box\n                if (cGroup.notchBox.objs.notch) {\n                    cGroup.notchBox.objs.notch\n                        .attr(\"points\", makeNotchBox(cGroup, notchBounds));\n                }\n                if (cGroup.notchBox.objs.upperLine) {\n                    var lineBounds = null;\n                    if (nOpts.lineWidth) {\n                        lineBounds = getObjWidth(nOpts.lineWidth, cName)\n                    } else {\n                        lineBounds = objBounds\n                    }\n\n                    var confidenceLines = {\n                        upper: chart.yScale(cGroup.metrics.upperNotch),\n                        lower: chart.yScale(cGroup.metrics.lowerNotch)\n                    };\n                    cGroup.notchBox.objs.upperLine\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', confidenceLines.upper)\n                        .attr(\"y2\", confidenceLines.upper);\n                    cGroup.notchBox.objs.lowerLine\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', confidenceLines.lower)\n                        .attr(\"y2\", confidenceLines.lower);\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the notch boxes\n         */\n        chart.notchBoxes.prepareNotchBoxes = function () {\n            var cName, cNotch;\n\n            if (nOpts && nOpts.colors) {\n                chart.notchBoxes.colorFunct = getColorFunct(nOpts.colors);\n            } else {\n                chart.notchBoxes.colorFunct = chart.colorFunct\n            }\n\n            if (nOpts.show == false) {\n                return\n            }\n\n            for (cName in chart.groupObjs) {\n                cNotch = chart.groupObjs[cName].notchBox;\n\n                cNotch.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"notch-plot\");\n\n                // Plot Box (default show)\n                if (nOpts.showNotchBox) {\n                    cNotch.objs.notch = cNotch.objs.g.append(\"polygon\")\n                        .attr(\"class\", \"notch\")\n                        .style(\"fill\", chart.notchBoxes.colorFunct(cName))\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n                    //A stroke is added to the notch with the group color, it is\n                    // hidden by default and can be shown through css with stroke-width\n                }\n\n                //Plot Confidence Lines (default hide)\n                if (nOpts.showLines) {\n                    cNotch.objs.upperLine = cNotch.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper confidence line\")\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n\n                    cNotch.objs.lowerLine = cNotch.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower confidence line\")\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n                }\n            }\n        };\n        chart.notchBoxes.prepareNotchBoxes();\n\n        d3.select(window).on('resize.' + chart.selector + '.notchBox', chart.notchBoxes.update);\n        chart.notchBoxes.update();\n        return chart;\n    };\n\n    /**\n     * Render a raw data in various forms\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showPlot=false] True or false, show points\n     * @param [options.plotType='none'] Options: no scatter = (false or 'none'); scatter points= (true or [amount=% of width (default=10)]); beeswarm points = ('beeswarm')\n     * @param [options.pointSize=6] Diameter of the circle in pizels (not the radius)\n     * @param [options.showLines=['median']] Can equal any of the metrics lines\n     * @param [options.showbeanLines=false] Options: no lines = false\n     * @param [options.beanWidth=20] % width\n     * @param [options.colors=chart default]\n     * @returns {*} The chart object\n     *\n     */\n    chart.renderDataPlots = function (options) {\n        chart.dataPlots = {};\n\n\n        //Defaults\n        var defaultOptions = {\n            show: true,\n            showPlot: false,\n            plotType: 'none',\n            pointSize: 7,\n            showLines: false,//['median'],\n            showBeanLines: false,\n            beanWidth: 20,\n            colors: null\n        };\n        chart.dataPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.dataPlots.options[option] = options[option]\n        }\n        var dOpts = chart.dataPlots.options;\n\n        //Create notch objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].dataPlots = {};\n            chart.groupObjs[cName].dataPlots.objs = {};\n        }\n        // The lines don't fit into a group bucket so they live under the dataPlot object\n        chart.dataPlots.objs = {};\n\n        /**\n         * Take updated options and redraw the data plots\n         * @param updateOptions\n         */\n        chart.dataPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    dOpts[key] = updateOptions[key]\n                }\n            }\n\n            chart.dataPlots.objs.g.remove();\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].dataPlots.objs.g.remove()\n            }\n            chart.dataPlots.preparePlots();\n            chart.dataPlots.update()\n        };\n\n        chart.dataPlots.reset = function () {\n            chart.dataPlots.change(defaultOptions)\n        };\n        chart.dataPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.dataPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.dataPlots.change(opts)\n        };\n        chart.dataPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.dataPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.dataPlots.change(opts)\n        };\n\n        /**\n         * Update the data plot obj values\n         */\n        chart.dataPlots.update = function () {\n            var cName, cGroup, cPlot;\n\n            // Metrics lines\n            if (chart.dataPlots.objs.g) {\n                var halfBand = chart.xScale.bandwidth() / 2; // find the middle of each band\n                for (var cMetric in chart.dataPlots.objs.lines) {\n                    chart.dataPlots.objs.lines[cMetric].line\n                        .x(function (d) {\n                            return chart.xScale(d.x) + halfBand\n                        });\n                    chart.dataPlots.objs.lines[cMetric].g\n                        .datum(chart.dataPlots.objs.lines[cMetric].values)\n                        .attr('d', chart.dataPlots.objs.lines[cMetric].line);\n                }\n            }\n\n\n            for (cName in chart.groupObjs) {\n                cGroup = chart.groupObjs[cName];\n                cPlot = cGroup.dataPlots;\n\n                if (cPlot.objs.points) {\n                    if (dOpts.plotType == 'beeswarm') {\n                        var swarmBounds = getObjWidth(100, cName);\n                        var yPtScale = chart.yScale.copy()\n                            .range([Math.floor(chart.yScale.range()[0] / dOpts.pointSize), 0])\n                            .interpolate(d3.interpolateRound)\n                            .domain(chart.yScale.domain());\n                        var maxWidth = Math.floor(chart.xScale.bandwidth() / dOpts.pointSize);\n                        var ptsObj = {};\n                        var cYBucket = null;\n                        //  Bucket points\n                        for (var pt = 0; pt < cGroup.values.length; pt++) {\n                            cYBucket = yPtScale(cGroup.values[pt]);\n                            if (ptsObj.hasOwnProperty(cYBucket) !== true) {\n                                ptsObj[cYBucket] = [];\n                            }\n                            ptsObj[cYBucket].push(cPlot.objs.points.pts[pt]\n                                .attr(\"cx\", swarmBounds.middle)\n                                .attr(\"cy\", yPtScale(cGroup.values[pt]) * dOpts.pointSize));\n                        }\n                        //  Plot buckets\n                        var rightMax = Math.min(swarmBounds.right - dOpts.pointSize);\n                        for (var row in ptsObj) {\n                            var leftMin = swarmBounds.left + (Math.max((maxWidth - ptsObj[row].length) / 2, 0) * dOpts.pointSize);\n                            var col = 0;\n                            for (pt in ptsObj[row]) {\n                                ptsObj[row][pt].attr(\"cx\", Math.min(leftMin + col * dOpts.pointSize, rightMax) + dOpts.pointSize / 2);\n                                col++\n                            }\n                        }\n                    } else { // For scatter points and points with no scatter\n                        var plotBounds = null,\n                            scatterWidth = 0,\n                            width = 0;\n                        if (dOpts.plotType == 'scatter' || typeof dOpts.plotType == 'number') {\n                            //Default scatter percentage is 20% of box width\n                            scatterWidth = typeof dOpts.plotType == 'number' ? dOpts.plotType : 20;\n                        }\n\n                        plotBounds = getObjWidth(scatterWidth, cName);\n                        width = plotBounds.right - plotBounds.left;\n\n                        for (var pt = 0; pt < cGroup.values.length; pt++) {\n                            cPlot.objs.points.pts[pt]\n                                .attr(\"cx\", plotBounds.middle + addJitter(true, width))\n                                .attr(\"cy\", chart.yScale(cGroup.values[pt]));\n                        }\n                    }\n                }\n\n\n                if (cPlot.objs.bean) {\n                    var beanBounds = getObjWidth(dOpts.beanWidth, cName);\n                    for (var pt = 0; pt < cGroup.values.length; pt++) {\n                        cPlot.objs.bean.lines[pt]\n                            .attr(\"x1\", beanBounds.left)\n                            .attr(\"x2\", beanBounds.right)\n                            .attr('y1', chart.yScale(cGroup.values[pt]))\n                            .attr(\"y2\", chart.yScale(cGroup.values[pt]));\n                    }\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the data plots\n         */\n        chart.dataPlots.preparePlots = function () {\n            var cName, cPlot;\n            \n            if (dOpts && dOpts.colors) {\n                chart.dataPlots.colorFunct = getColorFunct(dOpts.colors);\n            } else {\n                chart.dataPlots.colorFunct = chart.colorFunct\n            }\n\n            if (dOpts.show == false) {\n                return\n            }\n\n            // Metrics lines\n            chart.dataPlots.objs.g = chart.objs.g.append(\"g\").attr(\"class\", \"metrics-lines\");\n            if (dOpts.showLines && dOpts.showLines.length > 0) {\n                chart.dataPlots.objs.lines = {};\n                var cMetric;\n                for (var line in dOpts.showLines) {\n                    cMetric = dOpts.showLines[line];\n                    chart.dataPlots.objs.lines[cMetric] = {};\n                    chart.dataPlots.objs.lines[cMetric].values = [];\n                    for (var cGroup in chart.groupObjs) {\n                        chart.dataPlots.objs.lines[cMetric].values.push({\n                            x: cGroup,\n                            y: chart.groupObjs[cGroup].metrics[cMetric]\n                        })\n                    }\n                    chart.dataPlots.objs.lines[cMetric].line = d3.line()\n                        .curve(d3.curveCardinal)\n                        .y(function (d) {\n                            return chart.yScale(d.y)\n                        });\n                    chart.dataPlots.objs.lines[cMetric].g = chart.dataPlots.objs.g.append(\"path\")\n                        .attr(\"class\", \"line \" + cMetric)\n                        .attr(\"data-metric\", cMetric)\n                        .style(\"fill\", 'none')\n                        .style(\"stroke\", chart.colorFunct(cMetric));\n                }\n\n            }\n\n\n            for (cName in chart.groupObjs) {\n                cPlot = chart.groupObjs[cName].dataPlots;\n                cPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"data-plot\");\n                // Points Plot\n                if (dOpts.showPlot) {\n                    cPlot.objs.points = {g: null, pts: []};\n                    cPlot.objs.points.g = cPlot.objs.g.append(\"g\").attr(\"class\", \"points-plot\");\n                    for (var pt = 0; pt < chart.groupObjs[cName].values.length; pt++) {\n                        let val = chart.groupObjs[cName].values[pt];\n                        let valInfo = chart.groupObjs[cName].valuesInfo[pt];\n                        cPlot.objs.points.pts.push(cPlot.objs.points.g.append(\"circle\")\n                            .attr(\"class\", \"point\")\n                            //class id so it can be selected\n                            .attr('class', function() { var id = chart.settings.id ? chart.settings.id : false;\n                            return id ? 'distro-' + valInfo.id : '';})\n                            .attr('r', dOpts.pointSize / 2)// Options is diameter, r takes radius so divide by 2\n                            .style(\"fill\", chart.dataPlots.colorFunct(cName))\n                            .style(\"fill-opacity\", 0.6)\n                            .style(\"stroke\", chart.dataPlots.colorFunct(cName))\n                            .style(\"stroke-width\", \"2px\")\n                            .on('mouseover', ()=>{\n                                chart.objs.tooltip\n                                    .style(\"display\", null)\n                                    .style(\"left\", (d3.event.pageX) + \"px\")\n                                    .style(\"top\", (d3.event.pageY - 28) + \"px\");\n                            }).on(\"mouseout\", function () {\n                                chart.objs.tooltip.style(\"display\", \"none\");\n                            }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics, valInfo.idName, val))\n                            .on('click', function(){\n                                if (chart.settings.events.onClickElement) {\n                                    chart.settings.events.onClickElement.call(this, valInfo);\n                                }\n                            }));\n                    }\n                }\n\n\n                // Bean lines\n                if (dOpts.showBeanLines) {\n                    cPlot.objs.bean = {g: null, lines: []};\n                    cPlot.objs.bean.g = cPlot.objs.g.append(\"g\").attr(\"class\", \"bean-plot\");\n                    for (var pt = 0; pt < chart.groupObjs[cName].values.length; pt++) {\n                        cPlot.objs.bean.lines.push(cPlot.objs.bean.g.append(\"line\")\n                            .attr(\"class\", \"bean line\")\n                            .style(\"stroke-width\", '1')\n                            .style(\"stroke\", chart.dataPlots.colorFunct(cName)));\n                    }\n                }\n            }\n\n        };\n        chart.dataPlots.preparePlots();\n\n        d3.select(window).on('resize.' + chart.selector + '.dataPlot', chart.dataPlots.update);\n        chart.dataPlots.update();\n        return chart;\n    };\n\n    return chart;\n}","import * as d3 from 'd3';\n\nimport makeDistroChart from './distrochart';\n\n/* Simple Distro example\n * Single and multiline Distros\n */\nexport default function(config, helper) {\n\n  var parseDate = d3.timeParse('%Y-%m-%d');\n\n  var Distro = Object.create(helper);\n\n  Distro.init = function(config){\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales ={};\n    vm._axes = {};\n\n    \n    vm._tip = vm.utils.d3.tip().attr('class', 'd3-tip')\n      .html(vm._config.tip ? vm._config.tip : function(d) {\n        console.log(d);\n        var html ='';\n        //html += d.x ? ('<span>' + (Number.isNaN(+d.x) ? d.x : vm.utils.format(d.x)) + '</span></br>') : '';\n        html += d.y ? ('<span>' + (Number.isNaN(+d.y) ? d.y : vm.utils.format(d.y)) + '</span></br>') : '';\n        /* html += d.magnitude ? ('<span>' + (Number.isNaN(+d.magnitude) ? d.magnitude : vm.utils.format(d.magnitude)) + '</span></br>') : '';\n        html += d.color ? ('<span>' + (Number.isNaN(+d.color) ? d.color : vm.utils.format(d.color)) + '</span>') : ''; */\n        return html;\n      });\n\n  }\n\n  //-------------------------------\n  //User config functions\n  Distro.type = function(type){\n    var vm = this;\n    vm._config.type = type;\n    return vm;\n  }\n\n  Distro.x = function(col){\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  }\n\n  Distro.y = function(col){\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  }\n\n  Distro.sortBy = function(opt){\n    var vm = this;\n    vm._config.sortBy = opt;\n    return vm;\n  }\n\n  Distro.fill = function(col){\n    var vm = this;\n    vm._config.fill = col;\n    return vm;\n  }\n\n  Distro.id = function (col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  };\n\n  Distro.colors = function(colors) {\n    var vm = this;\n    if(Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  }\n\n  Distro.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Distro.data = function(data){\n    var vm = this;\n    \n    vm._data = [];\n    data.forEach(function(d){\n      d.x = d[vm._config.x];\n      d.y = +d[vm._config.y];\n      d.color = vm._config.fill ? d[vm._config.fill] : 'red';\n      delete(d[vm._config.x]);\n      delete(d[vm._config.y]);\n      if(vm._config.fill) delete(d[vm._config.x]); \n\n      vm._data.push(d);\n    });\n\n    return vm;\n  }\n\n  Distro.scales = function(){\n    var vm = this;\n\n\n\n    return vm;\n  }\n\n\n  Distro.draw = function(){\n    var vm = this;\n    //Call the tip\n    //vm.chart.svg().call(vm._tip);\n\n    vm.chart.fullSvg().remove()\n\n    var chart1 = makeDistroChart({\n        chart: vm.chart,\n        data: vm._data,\n        id: vm._config.id,\n        idName: vm._config.idName,\n        events: vm._config.events,\n        xName:'x',\n        xSort: typeof vm._config.sortBy === 'object' &&  vm._config.sortBy.x ? vm._config.sortBy.x : null, \n        yName:'y',\n        axisLabels: { xAxis: vm._config.axisLabels.xAxis, yAxis: vm._config.axisLabels.yAxis },\n        selector: \"#distro\",\n        colors: ['#fff5ca', '#fbc43a', '#5cbd00', '#084c1f'],\n        chartSize: { height: vm._config.size.height, width: vm._config.size.width },\n        margin: { top: vm._config.size.margin.top, right: vm._config.size.margin.right, bottom: vm._config.size.margin.bottom, left: vm._config.size.margin.left },\n        constrainExtremes: true});\n\n    if (vm.chart.config.styles) {\n      d3.select('#distro .tooltip')\n        .style('background-color', vm.chart.style.tooltip.backgroundColor)\n        .style('line-height', 1)\n        .style('font-weight', vm.chart.style.tooltip.text.fontWeight)\n        .style('font-size', vm.chart.style.tooltip.text.fontSize) \n        .style('color', vm.chart.style.tooltip.text.textColor)\n        .style('font-family', vm.chart.style.tooltip.text.fontFamily)\n        .style('background-color', vm.chart.style.tooltip.backgroundColor)\n        .style('padding', vm.chart.style.tooltip.text.padding)\n        .style('border', vm.chart.style.tooltip.border.width + ' solid ' + vm.chart.style.tooltip.border.color ) \n        .style('border-radius', vm.chart.style.tooltip.border.radius);\n    }\n\n    chart1.renderBoxPlot();\n    chart1.renderDataPlots();\n    chart1.renderNotchBoxes({showNotchBox:false});\n    chart1.renderViolinPlot({showViolinPlot:false}); \n    \n    chart1.boxPlots.show({reset:true, showWhiskers:false,showOutliers:false, showMean:true, showMedian:true, showBox:false});\n    chart1.dataPlots.change({showPlot:true}); \n    chart1.violinPlots.show({reset:true,clamp:0, width:100});\n    //Box Plot\n    /* chart1.violinPlots.hide();\n    chart1.boxPlots.show({reset:true});\n    chart1.notchBoxes.hide();\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false});  */\n\n    //Notched Box Plot\n   /*  chart1.violinPlots.hide();\n    chart1.notchBoxes.show({reset:true});\n    chart1.boxPlots.show({reset:true, showBox:false,showOutliers:true,boxWidth:20,scatterOutliers:true});\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false}); */\n\n    //Violin Plot Unbound\n    /* chart1.violinPlots.show({reset:true,clamp:0});\n    chart1.boxPlots.show({reset:true, showWhiskers:false,showOutliers:false,boxWidth:10,lineWidth:15,colors:['#555']});\n    chart1.notchBoxes.hide();\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false})  */\n\n    //Violin Plot Clamp to Data\n    if (vm._config.type === 'violin') {\n      chart1.violinPlots.show({reset:true,clamp:1, width:50});\n      chart1.boxPlots.show({reset:true, showWhiskers:false,showOutliers:false,boxWidth:10,lineWidth:15,colors:['#555']});\n      chart1.notchBoxes.hide();\n      chart1.dataPlots.change({showPlot:false,showBeanLines:false}); \n    }\n    \n\n    //Bean Plot\n    /* chart1.violinPlots.show({reset:true, width:75, clamp:0, resolution:30, bandwidth:50});\n    chart1.dataPlots.show({showBeanLines:true,beanWidth:15,showPlot:false,colors:['#555']});\n    chart1.boxPlots.hide();\n    chart1.notchBoxes.hide(); */\n\n    //Beeswarm Plot\n    /* chart1.violinPlots.hide();\n    chart1.dataPlots.show({showPlot:true, plotType:'beeswarm',showBeanLines:false, colors:null});\n    chart1.notchBoxes.hide();\n    chart1.boxPlots.hide(); */\n    \n    //Scatter Plot\n    if (vm._config.type === 'scatter') {\n      chart1.violinPlots.hide();\n      chart1.dataPlots.show({showPlot:true, plotType:40, showBeanLines:false,colors:null});\n      chart1.notchBoxes.hide();\n      //chart1.boxPlots.hide();\n    }\n\n    \n    //Trend Lines\n    /* if(chart1.dataPlots.options.showLines){\n        chart1.dataPlots.change({showLines:false});\n    } else {\n        chart1.dataPlots.change({showLines:['median','quartile1','quartile3']});\n    } */\n\n\n    return vm;\n  }\n\n  Distro.init(config);\n  return Distro;\n}\n","import * as d3 from 'd3';\n\n/*\n * Heatmap Chart\n */\nexport default function (config, helper) {\n\n  var Heatmap = Object.create(helper);\n\n  Heatmap.init = function (config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n\n    vm._legendElementWidth = vm._gridWidth;\n\n    vm._tip = d3.tip()\n      .attr('class', 'd3-tip')\n      .direction('n')\n      .html(vm._config.tip || function (d) {\n        var html = d.x;\n        if (d.x !== d.y) {\n          html += '<br>' + d.y;\n        }\n        html += '<br>' + vm.utils.format(d.value);\n        return html;\n      });\n  };\n\n  //-------------------------------\n  //User config functions\n  Heatmap.x = function (column) {\n    var vm = this;\n    vm._config.x = column;\n    return vm;\n  };\n\n  Heatmap.y = function (column) {\n    var vm = this;\n    vm._config.y = column;\n    return vm;\n  };\n\n  Heatmap.fill = function (column) {\n    var vm = this;\n    vm._config.fill = column;\n    return vm;\n  };\n\n  Heatmap.colors = function (colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    return vm;\n  };\n\n  Heatmap.colorLegend = function (legendTitle) {\n    var vm = this;\n    vm._config.legendTitle = legendTitle;\n    return vm;\n  };\n\n  /**\n   * Personalize border radius (rx, ry) for each rect\n   * @param {number} radius - value to be set, default is 5\n   */\n  Heatmap.borderRadius = function (radius) {\n    var vm = this;\n    vm._config.borderRadius = radius;\n    return vm;\n  };\n\n  Heatmap.sortBy = function (sortBy) {\n    var vm = this;\n    vm._config.sortBy = sortBy;\n    return vm;\n  };\n\n  Heatmap.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  //-------------------------------\n  //Triggered by chart.js;\n  Heatmap.data = function (data) {\n    var vm = this;\n    var xSort = vm.utils.sortAscending;\n    var ySort = vm.utils.sortAscending;\n\n    if (typeof vm._config.sortBy === 'string') {\n      if (vm._config.hasOwnProperty('sortBy') && vm._config.sortBy === 'desc') xSort = vm.utils.sortDescending;\n    }\n\n    if (typeof vm._config.sortBy === 'object') {\n      if (vm._config.hasOwnProperty('sortBy') && vm._config.sortBy.hasOwnProperty('x') && vm._config.sortBy.x === 'desc') xSort = vm.utils.sortDescending;\n      if (vm._config.hasOwnProperty('sortBy') && vm._config.sortBy.hasOwnProperty('y') && vm._config.sortBy.y === 'desc') ySort = vm.utils.sortDescending;\n    }\n\n    vm._config.xCategories = d3.nest()\n      .key(function (d) {\n        return d[vm._config.x];\n      }).sortKeys(xSort)\n      .entries(data)\n      .map(function (d) {\n        return d.key;\n      });\n\n    vm._config.yCategories = d3.nest()\n      .key(function (d) {\n        return d[vm._config.y];\n      }).sortKeys(ySort)\n      .entries(data)\n      .map(function (d) {\n        return d.key;\n      });\n\n    vm._config.fillValues = d3.nest()\n      .key(function (d) {\n        return d[vm._config.fill];\n      })\n      .entries(data)\n      .map(function (d) {\n        return Number(d.key);\n      });\n\n    /**\n     * Calculate grid width and height according to chart size\n     */\n    vm._gridWidth = Math.floor((vm._config.size.width - (vm._config.size.margin.left + vm._config.size.margin.right)) / vm._config.xCategories.length);\n\n    vm._gridHeight = Math.floor((vm._config.size.height - (vm._config.size.margin.top + vm._config.size.margin.bottom)) / vm._config.yCategories.length);\n\n    vm._data = data.map(function (d) {\n      var m = {\n        y: d[vm._config.y],\n        x: d[vm._config.x],\n        value: +d[vm._config.fill],\n      };\n      return m;\n    });\n\n    return vm;\n  };\n\n  Heatmap.scales = function () {\n    var vm = this;\n    return vm;\n  };\n\n  Heatmap.drawColorLegend = function () {\n    var vm = this;\n   \n    //Define legend gradient\n    var defs = vm.chart.svg().append('defs');\n\n    var linearGradient = defs.append('linearGradient')\n      .attr('id', 'linear-gradient-label');\n\n    //Define direction for gradient. Default is vertical top-bottom.\n    linearGradient\n      .attr('x1', '0%')\n      .attr('y1', '100%')\n      .attr('x2', '0%')\n      .attr('y2', '0%');\n\n    //Define color scheme as linear gradient\n    var colorScale = d3.scaleLinear()\n      .range(vm._config.colors);\n\n    linearGradient.selectAll('stop') \n      .data(colorScale.range())                  \n      .enter().append('stop')\n      .attr('offset', function(d,i) { return i/(colorScale.range().length-1); })\n      .attr('stop-color', function(d) { return d; });\n\n    //Add gradient legend \n    //defaults to right position\n    var legend = vm.chart.svg()\n      .append('g')\n      .attr('class', 'legend')\n      .attr('transform', 'translate(' + (vm._config.size.width - vm._config.size.margin.right + 5) +',' + vm._config.size.height * .1 + ')');\n\n    //legend title\n    legend.append('text')\n      .attr('x', 0)\n      .attr('class', 'legend-title')\n      .attr('text-anchor', 'middle')\n      .text(vm._config.legendTitle);\n\n    //top text is the max value\n    legend.append('text')\n      .attr('x', 0)\n      .attr('y', '1.5em')\n      .attr('class', 'top-label')\n      .attr('text-anchor', 'middle')\n      .text(function(){\n        let max = Math.ceil(Math.max(...vm._config.fillValues));\n        return vm.utils.format(max);\n      });\n\n    //draw gradient\n    legend.append('rect')\n      .attr('x', -18)\n      .attr('y', '2.3em')\n      .attr('width', 18)\n      .attr('height', vm._config.size.height * 0.6)\n      .attr('fill', 'url(#linear-gradient-label)');\n\n    //bottom text is the min value\n    legend.append('text')\n      .attr('x', 0)\n      .attr('y', vm._config.size.height * 0.6 + 40)\n      .attr('class', 'bottom-label')\n      .attr('text-anchor', 'middle')\n      .text(function() {\n        let min = Math.floor(Math.min(...vm._config.fillValues));\n        return vm.utils.format(min);\n      });\n\n  };\n\n  Heatmap.draw = function () {\n    var vm = this;\n\n    //Call the tip\n    vm.chart.svg().call(vm._tip);\n\n    const axesTip = d3.tip().html(d => {\n      return '<div class=\"title-tip\">' + d + '</div>';\n    });\n    vm.chart.svg().call(axesTip);\n\n    vm._yLabels = vm.chart.svg().append('g')\n      .attr('class', 'y axis')\n      .attr('transform', 'translate(0,0)')\n      .selectAll('.tick')\n      .data(vm._config.yCategories)\n      .enter()\n      .append('g')\n      .attr('class', 'tick')\n      .attr('transform', function(d, i) {\n        return 'translate(0,' + (i * vm._gridHeight) + ')';\n      })\n      .append('text')\n      .attr('text-anchor', 'end')\n      .attr('transform', 'translate(-6,' + vm._gridHeight / 1.5 + ')')\n      .text(function (d) {\n        return d;\n      });\n\n    vm._yLabels.each(function(d) {\n      if (this.getComputedTextLength() > vm._config.size.margin.left * 0.9) {\n        d3.select(this)\n          .on('mouseover', axesTip.show)\n          .on('mouseout', axesTip.hide);\n        let i = 1;\n        while (this.getComputedTextLength() > vm._config.size.margin.left * 0.9) {\n          d3.select(this).text(function (d) {\n            return d.slice(0, -i) + '...';\n          }).attr('title', d);\n          ++i;\n        }\n      }\n    });\n\n    vm._xLabels = vm.chart.svg().append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(0,0)')\n      .selectAll('.tick')\n      .data(vm._config.xCategories)\n      .enter()\n      .append('g')\n      .attr('class', 'tick')\n      .attr('transform', function (d, i) {\n        return 'translate(' + (i * vm._gridWidth + (vm._gridWidth / 2)) + ',' + (vm._config.yCategories.length * vm._gridHeight + 20 ) + ')';\n      })\n      .append('text')\n      .attr('text-anchor', 'middle')\n      .text(function (d) {\n        return d;\n      });\n\n    const biggestLabelWidth = d3.max(d3.select('.x.axis').selectAll('text').nodes().map(o => o.getComputedTextLength())); // Biggest label computed text length\n    let xBandWidth = vm._gridWidth;\n    let labelMaxWidth = xBandWidth;\n    if (biggestLabelWidth > xBandWidth) { // Biggest label doesn't fit\n      vm._xLabels.each(function (d) {\n        d3.select(this)\n          .attr('text-anchor', 'end')\n          .attr('dy', 0)\n          .attr('transform', 'translate(-5,-10)rotate(-90)');\n        // Still doesn't fit!\n        labelMaxWidth = 0.75 * vm._config.size.margin.bottom;\n        if (this.getComputedTextLength() > labelMaxWidth) {\n          d3.select(this)\n            .on('mouseover', axesTip.show)\n            .on('mouseout', axesTip.hide);\n          let i = 1;\n          while (this.getComputedTextLength() > labelMaxWidth) {\n            d3.select(this).text(function (d) {\n              return d.slice(0, -i) + '...';\n            }).attr('title', d);\n            ++i;\n          }\n        } else {\n          return d;\n        }\n      });\n    }\n\n    var colorScale = d3.scaleQuantile()\n      .domain([0, d3.max(vm._data, function (d) {\n        return d.value;\n      })])\n      .range(vm._config.colors);\n\n    var cards = vm.chart.svg().selectAll('.grid-cell')\n      .data(vm._data, function (d) {\n        return d.y + ':' + d.x;\n      });\n\n    cards.enter().append('rect')\n      .attr('x', function (d) {\n        return (vm._config.xCategories.indexOf(String(d.x))) * vm._gridWidth;\n      })\n      .attr('y', function (d) {\n        return (vm._config.yCategories.indexOf(String(d.y))) * vm._gridHeight;\n      })\n      .attr('rx', vm._config.borderRadius || 5)\n      .attr('ry', vm._config.borderRadius || 5)\n\n      .attr('class', 'grid-cell')\n      .attr('stroke', '#fff')\n      .attr('stroke-width', '3px')\n      .attr('id', function (d) {\n        return 'x' + d.x + 'y' + d.y;\n      })\n      .attr('width', vm._gridWidth)\n      .attr('height', vm._gridHeight)\n      .on('mouseover', function (d, i) {\n        vm._tip.show(d, d3.select(this).node());\n        if (vm._config.hasOwnProperty('mouseover')) {\n          vm._config.mouseover.call(vm, d, i);\n        }\n      })\n      .on('mouseout', function (d, i) {\n        vm._tip.hide(d, d3.select(this).node());\n        if (vm._config.hasOwnProperty('mouseout')) {\n          vm._config.mouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('onclick')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      })\n      .attr('fill', vm._config.colors[0])\n      .transition()\n      .duration(3000)\n      .ease(d3.easeLinear)\n      .attr('fill', function (d) {\n        return colorScale(d.value);\n      });\n\n    if (vm._config.hasOwnProperty('legendTitle') ){ \n      Heatmap.drawColorLegend(); \n    }\n      \n    /*\n      var legend = vm.chart.svg().selectAll('.legend')\n          .data([0].concat(colorScale.quantiles()), function(d) { return d; });\n\n      var lgroup = legend.enter().append('g')\n          .attr('class', 'legend');\n\n      lgroup.append('rect')\n          .attr('x', function(d, i) {  return vm._legendElementWidth * i; })\n          .attr('y', vm._config.size.height - vm._config.size.margin.bottom*2)\n          .attr('width', vm._legendElementWidth)\n          .attr('height', vm._gridWidth / 2)\n          .style('fill', function(d, i) { return vm._config.colors[i]; });\n\n      lgroup.append('text')\n          .attr('class', 'mono')\n          .text(function(d) { return ' ' + Math.round(d); })\n          .attr('x', function(d, i) { return vm._legendElementWidth * i; })\n          .attr('y', vm._config.size.height - vm._config.size.margin.bottom*2 + vm._gridWidth);\n\n      legend.exit().remove();*/\n    return vm;\n  };\n\n  Heatmap.init(config);\n\n  return Heatmap;\n}\n","import * as d3 from 'd3';\n/**\n * Leaflet Chart\n */\n\nexport default function (config, helper) {\n\n  var Leaflet = Object.create(helper);\n\n  Leaflet.init = function (config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._scales = {};\n    vm._axes = {};\n    vm._data = [];\n\n    vm._scales.color = d3.scaleQuantize().range([\"#fee5d9\", \"#fcae91\", \"#fb6a4a\", \"#de2d26\", \"#a50f15\"\n    ]);\n  }\n\n  Leaflet.id = function (col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  }\n\n  Leaflet.fill = function (col) {\n    var vm = this;\n    vm._config.fill = col;\n    return vm\n  }\n\n  Leaflet.opacity = function (value) {\n    var vm = this;\n    vm._config.opacity = value;\n    return vm;\n  }\n\n  Leaflet.colors = function (colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    if (colors && Array.isArray(colors)) {\n      vm._scales.color.range(colors);\n    } else if (typeof colors === 'function') {\n      vm._scales.color = colors;\n    }\n    return vm;\n  }\n\n  Leaflet.colorLegend = function (legendTitle) {\n    var vm = this;\n    vm._config.legendTitle = legendTitle;\n    return vm;\n  };\n\n  // -------------------------------\n  // Triggered by chart.js;\n  Leaflet.data = function (data) {\n    var vm = this;\n\n    vm._topojson = data[1] ? data[1] : false; //Topojson\n    data = data[0]; //User data\n\n    if (vm._config.data.filter) {\n      data = data.filter(vm._config.data.filter);\n    }\n\n    vm._data = data;\n    //vm._quantiles = vm._setQuantile(data);\n    vm._minMax = d3.extent(data, function(d) { return +d[vm._config.fill]; })\n\n    vm._scales.color.domain(vm._minMax);\n\n    var objects = vm._config.map.topojson.objects;\n\n    vm._nodes = [];\n    if (Array.isArray(objects)) {\n      for (let idx = 0; idx < objects.length; idx++) {\n        const obj = objects[idx];\n        vm._topojson.objects[obj].geometries.forEach(function (geom) {\n          var found = vm._data.filter(o => o[vm._config.id] == geom.id)[0]\n          if (found) \n            geom.properties[vm._config.fill] = found[vm._config.fill];\n          vm._nodes.push(geom);\n        });\n      }\n    } else if (objects) {\n      vm._topojson.objects[objects].geometries.forEach(function (geom) {\n        var found = vm._data.filter(o => o[vm._config.id] == geom.id)[0]\n        if (found)\n          geom.properties[vm._config.fill] = found[vm._config.fill];\n        vm._nodes.push(geom);\n      });\n    }\n\n    // vm._config.map.min = vm._minMax[0];\n    // vm._config.map.max = vm._minMax[1];\n    return vm\n  }\n\n  Leaflet.scales = function () {\n    var vm = this;\n    return vm\n  }\n\n  Leaflet.colors = function (colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    if (colors) {\n      if (Array.isArray(colors)) {\n        vm._scales.color = d3.scaleOrdinal().range(colors);\n      } else if (typeof colors === 'function') {\n        vm._scales.color = colors;\n      }\n    }\n    return vm;\n  }\n\n  Leaflet.drawColorLegend = function () {\n    var vm = this;\n   \n    //Define legend gradient\n    var defs = d3.select('#' + vm._config.bindTo).select('svg.leaflet-zoom-animated').append('defs');\n\n    var linearGradient = defs.append('linearGradient')\n      .attr('id', 'linear-gradient-label');\n\n    //Define direction for gradient. Default is vertical top-bottom.\n    linearGradient\n      .attr('x1', '0%')\n      .attr('y1', '100%')\n      .attr('x2', '0%')\n      .attr('y2', '0%');\n\n    //Define color scheme as linear gradient\n    var colorScale = d3.scaleLinear()\n      .range(vm._config.colors);\n\n    linearGradient.selectAll('stop') \n      .data(colorScale.range())                  \n      .enter().append('stop')\n      .attr('offset', function(d,i) { return i/(colorScale.range().length-1); })\n      .attr('stop-color', function(d) { return d; });\n\n    //Add gradient legend \n    //defaults to right position\n    var legend = d3.select('#' + vm._config.bindTo).select('svg.leaflet-zoom-animated')\n      .append('g')\n      .attr('class', 'legend')\n      .attr('transform', 'translate(' + (vm._config.size.width - 300 ) +',' + vm._config.size.height * .1 + ')');\n\n    //legend title\n    legend.append('text')\n      .attr('x', 0)\n      .attr('class', 'legend-title')\n      .attr('text-anchor', 'middle')\n      .text(vm._config.legendTitle);\n\n    //top text is the max value\n    legend.append('text')\n      .attr('x', 0)\n      .attr('y', '1.5em')\n      .attr('class', 'top-label')\n      .attr('text-anchor', 'middle')\n      .text(function(){\n        let max = Math.ceil(vm._minMax[1]);\n        if (vm._config.legendTitle === 'Porcentaje' && max > 100) {\n          max = 100;\n        }\n        return vm.utils.format(max);\n      })\n\n    //draw gradient\n    legend.append('rect')\n      .attr('x', -9)\n      .attr('y', '2.3em')\n      .attr('width', 18)\n      .attr('height', vm._config.size.height * 0.6)\n      .attr('fill', 'url(#linear-gradient-label)');\n\n    //bottom text is the min value\n    legend.append('text')\n      .attr('x', 0)\n      .attr('y', vm._config.size.height * 0.6 + 40)\n      .attr('class', 'bottom-label')\n      .attr('text-anchor', 'middle')\n      .text(function(){ \n        let min = Math.floor(Math.min(vm._minMax[0]))\n        return vm.utils.format(min);\n      });\n\n  };\n\n  Leaflet.draw = function () {\n    var vm = this;\n\n    var urlTopojson = vm._config.map.topojson.url;\n    var objects = vm._config.map.topojson.objects; //'states'\n    var tran = vm._config.map.topojson.translate; //var tran = [2580, 700];\n    var scale = vm._config.map.topojson.scale; //1300\n    var parser = vm._config.map.topojson.parser;\n    var id = vm._config.map.topojson.id;\n\n    L.TopoJSON = L.GeoJSON.extend({\n      addData: function (jsonData) {\n        var geojson, key;\n        if (jsonData.type === 'Topology') {\n          if (objects) {\n            if (Array.isArray(objects)) {\n              for (let idx = 0; idx < objects.length; idx++) {\n                const obj = objects[idx];\n                geojson = topojson.feature(jsonData, jsonData.objects[obj]);\n                L.GeoJSON.prototype.addData.call(this, geojson);\n              }\n            } else {\n              geojson = topojson.feature(jsonData, jsonData.objects[objects]);\n              L.GeoJSON.prototype.addData.call(this, geojson);\n            }\n          } else {\n            for (key in jsonData.objects) {\n              geojson = topojson.feature(jsonData, jsonData.objects[key]);\n              L.GeoJSON.prototype.addData.call(this, geojson);\n            }\n          }\n        } else {\n          L.GeoJSON.prototype.addData.call(this, jsonData);\n        }\n      }\n    });\n\n    var LatLng = {\n      lat: 25.5629994, \n      lon: -100.6405644\n    }\n    if (vm._config.map.topojson.center && vm._config.map.topojson.center.length === 2) {\n      LatLng.lat = vm._config.map.topojson.center[0]\n      LatLng.lon = vm._config.map.topojson.center[1]\n    }\n\n    var map = new L.Map(vm._config.bindTo, {\n        center: new L.LatLng(LatLng.lat, LatLng.lon),\n        zoom: vm._config.map.topojson.zoom || 7,\n        maxZoom: 10,\n        minZoom: 3\n      }),\n      OpenStreetMap_BlackAndWhite = L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {\n        attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n      }),\n      topoLayer = new L.TopoJSON(),\n      $countryName = $('.country-name');\n\n    OpenStreetMap_BlackAndWhite.addTo(map);\n    addTopoData(vm._topojson)\n\n    function addTopoData(topoData) {\n      topoLayer.addData(topoData);\n      topoLayer.addTo(map);\n      topoLayer.eachLayer(handleLayer);\n    }\n\n    var tip = d3.tip().html(function(d) {\n      let html = '<div class=\"d3-tip\" style=\"z-index: 99999;\"><span>' + (d.feature.properties.NOM_ENT || d.feature.properties.NOM_MUN) + '</span><br/><span>' +\n        vm.utils.format(d.feature.properties[vm._config.fill]) + '</span></div>';\n      return html;\n    })\n    d3.select('#' + vm._config.bindTo).select('svg.leaflet-zoom-animated').call(tip);\n    function handleLayer(layer) {\n      \n      var value = layer.feature.properties[vm._config.fill];\n      if (!value) {\n        // Remove polygons without data\n        /** @todo validate what to do with NA's */\n        d3.select(layer._path).remove();\n      } else {\n        var fillColor = vm._scales.color(value);\n\n        layer.setStyle({\n          fillColor: fillColor,\n          fillOpacity: vm._config.opacity ||0.7,\n          color: '#555',\n          weight: 1,\n          opacity: .5\n        });\n\n        layer.on({\n          mouseover: function() {\n            enterLayer(layer)\n          },\n          mouseout: function() {\n            leaveLayer(layer);\n          }\n        });\n      }\n    }\n\n    function enterLayer(layer) {\n      tip.show(layer, d3.select(layer._path).node());\n    }\n\n    function leaveLayer(layer) {\n      tip.hide(layer);\n    }\n\n    /**\n     * Draw Legend\n     */\n    if (typeof vm._config.legend === 'function') {\n      vm._config.legend.call(this, vm._nodes);\n    }\n\n    Leaflet.drawColorLegend();\n    \n    return vm\n  }\n  \n\n  Leaflet.init(config);\n\n  return Leaflet;\n}\n","import * as d3 from 'd3';\n/*\n * Map \n */\n\nexport default function(config) {\n\n  function Map(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    vm._tip = d3.tip().attr('class', 'd3-tip');\n\n    vm._formatWithZeroDecimals  = d3.format(\",.0f\");\n    vm._formatWithOneDecimal    = d3.format(\",.1f\");\n    vm._formatWithTwoDecimals   = d3.format(\",.2f\");\n    vm._formatWithThreeDecimals = d3.format(\",.3f\");\n\n    vm._format = {};\n    vm._format.total = vm._formatWithZeroDecimals;\n    vm._format.percentage = function(d){return d3.format(\",.1f\")(d) + '%';} ;\n    vm._format.change =  d3.format(\",.1f\");\n\n  }\n\n  //-------------------------------\n  //User config functions\n\n  Map.prototype.id = function(col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  }\n\n  Map.prototype.color = function(col) {\n    var vm = this;\n    vm._config.color = col;\n    return vm;\n  }\n\n  Map.prototype.tip = function(tip){\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  }\n\n  Map.prototype.onclick = function(onclick){\n    var vm = this;\n    vm._config.onclick = onclick;\n    return vm;\n  }\n\n  Map.prototype.end = function() {\n    var vm = this;\n    return vm._chart;\n  }\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Map.prototype.chart = function(chart) {\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  }\n\n \n  Map.prototype.data = function(data) {\n    var vm = this;\n    \n    vm._topojson = data[1]? data[1] : false ; //Topojson\n    var data = data[0]; //User data\n\n    if(vm._config.data.filter){\n      data = data[0].filter(vm._config.data.filter);\n    }\n  \n    vm._data = data;\n    vm._quantiles = vm._setQuantile(data);\n    vm._minMax = d3.extent(data, function(d) { return +d[vm._config.color]; })\n\n    vm._config.map.min = vm._minMax[0];\n    vm._config.map.max = vm._minMax[1];\n\n    return vm;\n  }\n\n  Map.prototype.scales = function(s) {\n    var vm = this;\n    vm._scales = s;\n    return vm;\n  }\n\n  Map.prototype.axes = function(a) {\n    var vm = this;\n    vm._axes = a;\n    return vm;\n  }\n\n  Map.prototype.domains = function() {\n    var vm = this;\n    return vm;\n  };\n\n  Map.prototype.draw  = function(){\n    var vm = this;\n\n    //@config\n    var urlTopojson = vm._config.map.topojson.url;\n    var objects = vm._config.map.topojson.objects; //'states'\n    var tran = vm._config.map.topojson.translate; //var tran = [2580, 700];\n    var scale = vm._config.map.topojson.scale; //1300\n    \n    var parser = vm._config.map.topojson.parser;\n   \n    var id = vm._config.map.topojson.id;\n\n    //Call the tip\n    vm._chart._svg.call(vm._tip)\n\n    vm._projection = d3.geoMercator()\n        .scale(scale)\n        .translate(tran);\n\n    vm.path = d3.geoPath()\n        .projection(vm._projection);\n\n    vm._polygons = vm._chart._svg.append(\"g\")\n        .attr(\"id\", \"dbox-map-polygons\")\n        .style('display', 'true')\n        .attr(\"transform\", function() {\n            return \"translate(\" + (vm._config.size.translateX) + \",100) scale(\" + vm._config.size.scale + \")\"\n        });\n    \n    var features = topojson.feature(vm._topojson, vm._topojson.objects[objects]).features;\n    //console.log('topojson features', features);\n    if (typeof vm._config.map.topojson.filter != 'undefined') {\n      var filter = vm._config.map.topojson.filter;\n      console.log(filter);\n      Object.keys(filter).map(function(key) {\n        features = features.filter(feature => feature.properties[key] === filter[key]);\n      });\n    }\n\n    vm._polygons.selectAll(\"path\")\n        .data(features, parser)\n        .enter().append(\"path\")\n        .attr(\"d\", d3.geoPath().projection(vm._projection))\n        .attr(\"id\", id) \n        .attr(\"data-geotype\", objects)\n        .attr(\"fill\", \"#808080\")\n        .attr('stroke', '#a0a0a0')\n        .style('stroke-width', '1px')\n        .on('mouseover', function(d, i) {\n        \n          if(vm._config.map.quantiles.colorsOnHover){ //OnHover colors\n            d3.select(this).attr('fill', function(d) {\n                return vm._getQuantileColor(d[vm._config.color],'onHover');\n            })\n          }\n\n          //vm._tip.show(d, d3.select(this).node()) //Show TIP\n\n          if (vm._config.data.onmouseover) { //External function call\n            vm._config.data.onmouseover.call(this, d, i);\n          }\n\n        })\n        .on('mouseout', function(d, i) {\n\n            if(vm._config.map.quantiles.colorsOnHover){ //OnHover reset default color\n              d3.select(this).attr('fill', function(d) {\n                  return vm._getQuantileColor(d[vm._config.color],'default');\n              })\n            }\n            //Hide tip\n            //vm._tip.hide(d, d3.select(this).node()) \n\n            if (vm._config.data.onmouseout) { //External function call\n              vm._config.data.onmouseout.call(this, d, i)\n            }\n            \n        })\n        .on(\"click\", function(d, i) {\n            if (vm._config.data.onclick) {\n                vm._config.data.onclick.call(this, d, i)\n            }\n        })\n\n    vm._polygonsDefault = vm._polygons.selectAll(\"path\").data();\n\n    vm._polygons.selectAll(\"path\").attr(\"stroke\", \"#333\").attr('stroke-width', 0.2);\n    vm._polygons.selectAll(\"path\").attr(\"fill\", \"red\");\n    vm._polygons.selectAll(\"path\").attr('data-total', null);\n    vm._polygons.selectAll(\"path\")\n        .data(vm._data, function(d) {\n          //@TODO WHY THE F..K IS D3 ITERATING OVER THE OLD DATA\n          return d.id ? d.id : d[vm._config.id];\n        })\n        .attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.color],'default');\n        })\n        .attr('data-total', function(d) {\n            return +d[vm._config.color];\n        })\n\n    //Resets the map paths data to topojson\n    vm._polygons.selectAll(\"path\").data(vm._polygonsDefault, function(d) {\n        return d.id;\n    });\n\n\n  };\n\n  Map.prototype._setQuantile = function(data){\n    var vm = this; \n    var values = [];\n    var quantile = []; \n\n    if(vm._config.map.quantiles &&  vm._config.map.quantiles.predefinedQuantiles \n        && vm._config.map.quantiles.predefinedQuantiles.length > 0){\n      return vm._config.map.quantiles.predefinedQuantiles;\n    }\n\n    data.forEach(function(d){      \n      values.push(+d[vm._config.color]);\n    });\n\n    values.sort(d3.ascending);\n    \n    //@TODO use quantile scale instead of manual calculations \n    if(vm._config && vm._config.map && vm._config.map.quantiles && vm._config.map.quantiles.buckets){\n\n      if(vm._config.map.quantiles.ignoreZeros === true){\n        var aux = _.dropWhile(values, function(o) { return o <= 0 });\n        //aux.unshift(values[0]);  \n\n        quantile.push(values[0]);\n        quantile.push(0);\n        \n        for(var i = 1; i <= vm._config.map.quantiles.buckets - 1; i++ ){        \n          quantile.push( d3.quantile(aux,  i* 1/(vm._config.map.quantiles.buckets - 1) ) )\n        }\n\n      }else{\n        quantile.push( d3.quantile(values, 0) )\n        for(var i = 1; i <= vm._config.map.quantiles.buckets; i++ ){        \n          quantile.push( d3.quantile(values,  i* 1/vm._config.map.quantiles.buckets ) )\n        }\n      }\n        \n    }else{\n      quantile = [ d3.quantile(values, 0), d3.quantile(values, 0.2), d3.quantile(values, 0.4), d3.quantile(values, 0.6), d3.quantile(values, 0.8), d3.quantile(values,1) ];\n    }\n   \n    //@TODO - VALIDATE WHEN ZEROS NEED TO BE PUT ON QUANTILE 1 AND RECALCULATE NON ZERO VALUES INTO THE REST OF THE BUCKETS\n    if( vm._config.map.quantiles && vm._config.map.quantiles.buckets \n        && vm._config.map.quantiles.buckets === 5){\n\n      if( quantile[1] === quantile[2] && quantile[2] === quantile[3] && quantile[3] === quantile[4] && quantile[4] === quantile[5]){\n        quantile = [ d3.quantile(values, 0), d3.quantile(values, 0.2) ];\n      }\n    }\n   \n    return quantile;\n  }\n\n  Map.prototype._getQuantileColor = function(d,type){\n    var vm = this; \n    var total = parseFloat(d);\n\n    //@TODO use quantile scale instead of manual calculations \n    if(vm._config && vm._config.map && vm._config.map.quantiles && vm._config.map.quantiles.colors){\n      if(vm._quantiles.length > 2){\n\n        if(vm._config && vm._config.map && vm._config.map.min !== undefined && vm._config.map.max !== undefined){\n          if(total < vm._config.map.min || total > vm._config.map.max){\n            console.log('outOfRangeColor', total, vm._config.map.min ,vm._config.map.max)\n            return vm._config.map.quantiles.outOfRangeColor; \n          }\n        }else{\n          if(total < vm._minMax[0] || total > vm._minMax[1]){\n            console.log('outOfRangeColor', total, vm._config.map.min ,vm._config.map.max)\n            return vm._config.map.quantiles.outOfRangeColor; \n          }\n        }\n\n        if(type == 'default'){\n          if(total <= vm._quantiles[1]){\n            return vm._config.map.quantiles.colors[0];//\"#f7c7c5\";\n          }else if(total <= vm._quantiles[2]){\n            return vm._config.map.quantiles.colors[1];//\"#e65158\";\n          }else if(total <= vm._quantiles[3]){\n            return vm._config.map.quantiles.colors[2];//\"#c20216\";\n          }else if(total <= vm._quantiles[4]){\n            return vm._config.map.quantiles.colors[3];//\"#750000\";\n          }else if(total <= vm._quantiles[5]){\n            return vm._config.map.quantiles.colors[4];//\"#480000\";\n          }\n        }\n\n        if(type == 'onHover' && vm._config.map.quantiles.colorsOnHover){\n          if(total <= vm._quantiles[1]){\n            return vm._config.map.quantiles.colorsOnHover[0];//\"#f7c7c5\";\n          }else if(total <= vm._quantiles[2]){\n            return vm._config.map.quantiles.colorsOnHover[1];//\"#e65158\";\n          }else if(total <= vm._quantiles[3]){\n            return vm._config.map.quantiles.colorsOnHover[2];//\"#c20216\";\n          }else if(total <= vm._quantiles[4]){\n            return vm._config.map.quantiles.colorsOnHover[3];//\"#750000\";\n          }else if(total <= vm._quantiles[5]){\n            return vm._config.map.quantiles.colorsOnHover[4];//\"#480000\";\n          }\n        }\n\n      }\n    }\n\n    if(vm._quantiles.length == 2){\n      /*if(total === 0 ){\n        return d4theme.colors.quantiles[0];//return '#fff';\n      }else if(total <= vm._quantiles[1]){\n        return d4theme.colors.quantiles[1];//return \"#f7c7c5\";\n      }*/\n      if(total <= vm._quantiles[1]){\n        return vm._config.map.quantiles.colors[0];//\"#f7c7c5\";\n      }\n    }\n\n  }\n\n\n\n\n\n\n return new Map(config);\n}","import * as d3 from 'd3';\n\n/*\n * Build a radar chart.\n */\nexport default function(config) {\n  function Radar(config) {\n    var vm = this, size;\n\n    vm.CIRCLE_RADIANS = 2 * Math.PI;\n\n    // The first axis must be at the circle's top.\n    vm.RADIANS_TO_ROTATE = vm.CIRCLE_RADIANS / -4;\n\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    vm._axesData = {};\n    vm._filter = null;\n    vm._minMax = [0, 0];\n    vm._viewData = [];\n    vm._colorMap = {};\n    vm._ticks = 0;\n    vm._scale = null;\n    vm._excludedPolygons = [];\n\n    // Set defaults.\n    if(!vm._config.ticks) {\n      vm._config.ticks = 10;\n    }\n\n    if(!vm._config.transitionDuration) {\n      vm._config.transitionDuration = 400;\n    }\n\n    if(!vm._config.axisLabelMargin) {\n      vm._config.axisLabelMargin = 24;\n    }\n\n    if(!vm._config.legend) {\n      vm._config.legend = {\n        enable: true\n      };\n    }\n\n    if(!vm._config.legend.at) {\n      vm._config.legend.at = {\n        x: 20,\n        y: 20\n      };\n    }\n\n    if('undefined' == typeof vm._config.styleDefaults) {\n      vm._config.styleDefaults = true;\n    }\n\n    // Calculate basic data.\n    size = vm._config.size;\n\n    vm._center = {\n      x: (size.width / 2) - size.margin.left,\n      y: (size.height / 2) - size.margin.top\n    };\n\n    vm._radius = Math.min(\n      (size.width - size.margin.left - size.margin.right) / 2,\n      (size.height - size.margin.top - size.margin.bottom) / 2\n    );\n  }\n\n  // User API.\n\n  Radar.prototype.polygonsFrom = function(column) {\n    var vm = this;\n    vm._config.polygonsFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.axesFrom = function(column) {\n    var vm = this;\n    vm._config.axesFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.valuesFrom = function(column) {\n    var vm = this;\n    vm._config.valuesFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.ticks = function(ticks) {\n    var vm = this;\n    vm._config.ticks = ticks;\n    return vm;\n  };\n\n  Radar.prototype.colors = function(colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    return vm;\n  };\n\n  Radar.prototype.end = function() {\n    var vm = this;\n    return vm._chart;\n  };\n\n  // Internal helpers.\n\n  Radar.prototype.drawTicks = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      dur = vm._config.transitionDuration,\n      sel;\n\n    sel = svg.select('g.ticks');\n\n    if(sel.empty()) {\n      sel = svg.append('g').attr('class', 'ticks');\n    }\n\n    sel = sel.selectAll('circle.tick')\n      .data(\n        // Add an explicit index for keying the chart with their original array\n        // indexes, then reverse it so rendering occurs from bigger to smaller\n        // circles, allowing to set a fill color to the concentric cirlces\n        // without getting the more external cirlce capping all the others.\n        vm._ticks.map((val, idx) => [idx, val]).reverse(),\n        d => d[0]);\n\n    sel\n      .transition()\n      .duration(dur)\n      .attr('r', function(d) { return vm._scale(d[1]); });\n\n    sel.enter()\n      .append('circle')\n      .classed('tick', true)\n      .attr('cx', vm._center.x)\n      .attr('cy', vm._center.y)\n      .style('fill', vm._ifStyleDefaults('none'))\n      .style('stroke', vm._ifStyleDefaults('gray'))\n      .attr('r', function(d) { return vm._scale(d[1]); })\n      .attr('opacity', 0)\n      .transition()\n      .duration(dur)\n      .attr('opacity', 1);\n\n    sel.exit()\n      .transition()\n      .duration(dur)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.drawTicksLabels = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      margin = 2,\n      dur = vm._config.transitionDuration,\n      sel;\n\n    sel = svg.select('g.ticks-labels');\n\n    if(sel.empty()) {\n      sel = svg.append('g').attr('class', 'ticks-labels');\n    }\n\n    sel = sel.selectAll('text.tick-label')\n      .data(vm._ticks);\n\n    sel\n      .transition()\n      .duration(dur)\n      .text(function(d) { return d; })\n      .attr('y', function(d) { return vm._center.y - margin - vm._scale(d); });\n\n    sel.enter()\n      .append('text')\n      .text(function(d) { return d.toFixed(1); })\n      .attr('class', 'tick-label')\n      .attr('x', vm._center.x + margin)\n      .attr('y', function(d) { return vm._center.y - margin - vm._scale(d); })\n      .attr('fill', vm._ifStyleDefaults('gray'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'))\n      .attr('opacity', 0)\n      .transition()\n      .duration(dur)\n      .attr('opacity', 1);\n\n    sel.exit()\n      .transition()\n      .duration(dur)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.extractAxes = function(data) {\n    var result,\n      vm = this,\n      axes = vm._config.axesFrom,\n      radiansPerAxis;\n\n    result = data.reduce(\n      function(prev, item) {\n        return prev.indexOf(item[axes]) > -1\n          ? prev\n          : prev.concat(item[axes]);\n      }, []);\n\n    radiansPerAxis = (vm.CIRCLE_RADIANS / result.length);\n\n    result = result.map(\n      function(item, idx) {\n        return {\n          axis: item,\n          rads: (idx * radiansPerAxis) + vm.RADIANS_TO_ROTATE\n        };\n      });\n\n    return {\n      list: result,\n      hash: result.reduce(function(hashed, el) {\n        hashed[el.axis] = el;\n        return hashed;\n      }, {})\n    };\n  };\n\n  Radar.prototype.buildColorMap = function(data) {\n    var vm = this,\n      colors = vm._config.colors;\n    return data.reduce(function(cMap, row) {\n      var polyg = row[vm._config.polygonsFrom],\n        cIdx = cMap.index.indexOf(polyg);\n\n      if(cIdx == -1) {\n        cIdx = cMap.index.push(polyg) - 1;\n        cMap.hash[polyg] = colors[cIdx];\n        cMap.list.push({polygon: polyg, color: colors[cIdx]});\n      }\n      return cMap;\n    }, {index: [], hash: {}, list: []});\n  };\n\n  Radar.prototype.drawAxes = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      selection;\n\n    selection = svg.selectAll('line.axis')\n      .data(vm._axesData.list, function(d) { return d.axis; });\n\n    selection.enter()\n      .append('line')\n      .classed('axis', true)\n      .attr('x1', vm._center.x)\n      .attr('y1', vm._center.y)\n      .style('stroke', vm._ifStyleDefaults('gray'))\n      .attr('x2', vm._center.x)\n      .attr('y2', vm._center.y)\n      .transition()\n      .duration(duration)\n      .attr('x2', function(d) {\n        return vm.xOf(d.rads, vm._radius + 8);\n      })\n      .attr('y2', function(d) {\n        return vm.yOf(d.rads, vm._radius + 8);\n      });\n\n    selection\n      .transition()\n      .duration(duration)\n      .attr('x2', function(d) {\n        return vm.xOf(d.rads, vm._radius + 8);\n      })\n      .attr('y2', function(d) {\n        return vm.yOf(d.rads, vm._radius + 8);\n      });\n\n    selection.exit()\n      .transition()\n      .duration(duration)\n      .attr('x2', vm._center.x)\n      .attr('y2', vm._center.y)\n      .remove();\n  };\n\n  Radar.prototype.drawAxesLabels = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      fromCenter = vm._radius + vm._config.axisLabelMargin,\n      labels,\n      rects;\n\n\n\n\n    rects = svg.selectAll('rect.axis-label')\n      .data(vm._axesData.list, function(d) { return d.axis; });\n\n    rects.enter()\n      .append('rect')\n      .attr('class', 'axis-label')\n      .attr('x', (d) => vm.xOf(d.rads, fromCenter) - 50)\n      .attr('y', (d) => vm.yOf(d.rads, fromCenter) - 20)\n      .attr('rx', '5px')\n      .attr('ry', '5px')\n      .attr('width', '100px')\n      .attr('height', '40px')\n      .attr('fill', '#A3A3AF')\n      .attr('opacity', 0)\n      .transition()\n      .duration(duration)\n      .attr('opacity', 1);\n\n    rects.exit()\n      .transition()\n      .duration(duration)\n      .attr('opacity', 0)\n      .remove();\n\n\n    labels = svg.selectAll('text.axis-label')\n      .data(vm._axesData.list, function(d) { return d.axis; });\n\n    labels\n      .transition()\n      .duration(duration)\n      .attr('x', (d) => vm.xOf(d.rads, fromCenter+5))\n      .attr('y', (d) => vm.yOf(d.rads, fromCenter+5));\n\n    labels.enter()\n      .append('text')\n      .attr('class', 'axis-label')\n      .attr('text-anchor', 'middle')\n      .attr('fill', 'white')//vm._ifStyleDefaults('gray'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'))\n      .text(function(d) { return d.axis; })\n      .attr('x', (d) => vm.xOf(d.rads, fromCenter+5))\n      .attr('y', (d) => vm.yOf(d.rads, fromCenter+5))\n      .attr('opacity', 0)\n      .transition()\n      .duration(duration)\n      .attr('opacity', 1);\n\n    labels.exit()\n      .transition()\n      .duration(duration)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.drawPolygons = function() {\n\n\n    var vm = this,\n      data = vm._viewData,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      groupedData,\n      gs, gsExit, gsEnter;\n\n    // Prepare the data.\n    groupedData = data.reduce(function(bundle, row) {\n      var polygIdx = bundle.keys.indexOf(row.polygon);\n      if(polygIdx == -1) {\n        polygIdx = bundle.keys.push(row.polygon) - 1;\n        bundle.polygons.push({\n          polygon: row.polygon,\n          color: row.color,\n          points: [],\n          values: [],\n          rawData:row.rawData,\n        });\n      }\n      bundle.polygons[polygIdx].values.push(row);\n      bundle.polygons[polygIdx].points.push(row.xy.join(','));\n      return bundle;\n    }, {keys: [], polygons:[]}).polygons;\n\n\n    gs = svg.selectAll('g.polygon-container')\n      .data(groupedData, function(d) { return d.polygon + '-container'; });\n\n    gsEnter = gs.enter()\n      .append('g')\n      .attr('class', 'polygon-container')\n      .attr('id', function(d) {\n        var x= d;\n        return 'radar-id-'+d.rawData.CVE_ENT\n      })\n\n    gsExit = gs.exit();\n    gsExit.transition().duration(duration).remove();\n\n    vm._buildNestedPolygons(gs, gsEnter, gsExit);\n    vm._buildNestedVertexes(gs, gsEnter, gsExit);\n  };\n\n  Radar.prototype._buildNestedVertexes = function(update, enter, exit) {\n    var vm = this,\n      duration = vm._config.transitionDuration,\n      selector = 'circle.vertex',\n      toUpdate;\n\n    function appendHelper(selection) {\n      selection\n        .append('circle')\n        .attr('class', 'vertex')\n        .attr('cx', vm._center.x)\n        .attr('cy', vm._center.y)\n        .attr('r', 4)\n        .attr('fill', d => d.color)\n        .call(updateHelper)\n        .on('mouseover', d => {\n          var x = d.xy[0] + 10,\n            y = d.xy[1] - 10;\n          vm._showTooltip(x, y, d.polygon, d.value);\n        })\n        .on('mouseout', () => {\n          vm._hideTooltip();\n        });\n    }\n\n    function removeHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('cx', vm._center.x)\n        .attr('cy', vm._center.y)\n        .remove();\n    }\n\n    function updateHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('cx', function(d) { return d.xy[0]; })\n        .attr('cy', function(d) { return d.xy[1]; });\n    }\n\n    function dataFunc(d) { return d.values; }\n\n    function keyFunc(d) { return d.polygon + '-' + d.axis; }\n\n    toUpdate = update.selectAll(selector)\n      .data(dataFunc, keyFunc);\n\n    toUpdate\n      .call(updateHelper);\n\n    toUpdate.enter()\n      .call(appendHelper);\n\n    toUpdate.exit()\n      .call(removeHelper);\n\n    enter.selectAll(selector)\n      .data(dataFunc, keyFunc)\n      .enter()\n      .call(appendHelper);\n\n    exit.selectAll(selector)\n      .call(removeHelper);\n  };\n\n  /**\n   * Draw a tooltip at the given X, Y possition.\n   * @param  {int} x       The X coordinate\n   * @param  {int} y       The Y coordinate\n   * @param  {string} val1 The value to show as the first line\n   * @param  {string} val2 The value to show in the second line\n   * @return {selection}   Return the created tooltip as a D3 selection\n   */\n  Radar.prototype._showTooltip = function(x, y, val1, val2) {\n    var tt, subtt, bg, bbox,\n      padding = 2,\n      vm = this,\n      svg = vm._chart._svg;\n\n    tt = svg.append('g')\n      .attr('class', 'tooltip')\n      .attr('opacity', 0);\n\n    bg = tt.append('rect').attr('class', 'tooltip-background');\n\n    subtt = tt\n      .append('text')\n      .attr('y', y)\n      .attr('x', x)\n      .style('fill', vm._ifStyleDefaults('white'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'));\n\n    subtt.append('tspan')\n      .text(Number(val2).toFixed(1));\n\n    subtt.append('tspan')\n      .attr('dy', '-1.2em')\n      .attr('x', x)\n      .text(val1);\n\n    bbox = tt.node().getBBox();\n\n    bg.attr('x', bbox.x - padding)\n      .attr('y', bbox.y - padding)\n      .attr('width', bbox.width + (padding * 2))\n      .attr('height', bbox.height + (padding + 2))\n      .style('fill', vm._ifStyleDefaults('gray'));\n\n    tt.transition()\n      .duration(200)\n      .attr('opacity', .9);\n\n    return tt;\n  };\n\n  /**\n   * Remove the tooltip created by _showTooltip()\n   * @return {undefined}\n   */\n  Radar.prototype._hideTooltip = function() {\n    this._chart._svg.selectAll('g.tooltip')\n      .transition()\n      .duration(200)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype._buildNestedPolygons = function(update, enter, exit) {\n    var vm = this,\n      duration = vm._config.transitionDuration,\n      selector = 'polygon.category',\n      toUpdate;\n\n    // Used for the transitions where the polygons expand from\n    // or shrink to the center.\n    function centerPoints(data) {\n      var center = [vm._center.x, vm._center.y].join(',');\n      return data.points.map(function() {\n        // All polygon's points move to the center.\n        return center;\n      }).join(' ');\n    }\n\n    function appendHelper(selection) {\n      selection\n        .append('polygon')\n        .attr('class', 'category')\n        .attr('points', centerPoints)\n        .style('stroke', function(d) { return d.color; })\n        .style('fill', function(d) { return d.color; })\n        .style('fill-opacity', 0.4)\n        .style('stroke-width', vm._ifStyleDefaults('1px'))\n        .call(updateHelper);\n    }\n\n    function removeHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('points', centerPoints)\n        .remove();\n    }\n\n    function updateHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('points', function(d) { return d.points.join(' '); });\n    }\n\n    function dataFunc(d) { return [d]; }\n\n    function keyFunc(d) { return d.polygon; }\n\n    toUpdate = update.selectAll(selector)\n      .data(dataFunc, keyFunc);\n\n    toUpdate\n      .call(updateHelper);\n\n    toUpdate.enter()\n      .call(appendHelper);\n\n    toUpdate.exit()\n      .call(removeHelper);\n\n    enter.selectAll(selector)\n      .data(dataFunc, keyFunc)\n      .enter()\n      .call(appendHelper);\n\n    exit.selectAll(selector)\n      .call(removeHelper);\n\n  };\n\n  Radar.prototype.drawLegend = function() {\n    var vm = this,\n      cMap = vm._colorMap.list,\n      svg = vm._chart._svg,\n      at = vm._config.legend.at,\n      side = 14,\n      margin = 4,\n      legend, newLegend;\n\n    legend = svg.selectAll('g.legend-item')\n      .data(cMap, function(d) { return d.polygon; })\n      .attr('opacity', d => {\n        return vm._excludedPolygons.indexOf(d.polygon) > -1 ? .4 : 1;\n      });\n\n    newLegend = legend.enter()\n      .append('g')\n      .on('click', (d) => {\n        vm._excludedPolygons = vm._toggleList(\n          vm._excludedPolygons, [d.polygon]);\n        vm.draw();\n      })\n      .attr('class', 'legend-item');\n\n    newLegend\n      .append('text')\n      .text(d => d.polygon)\n      .attr('x', at.x + side + margin)\n      .attr('y', (d, i) => ((side + margin) * i) + at.y + side)\n      .style('font-family', vm._ifStyleDefaults('sans-serif'));\n\n    newLegend\n      .append('rect')\n      .attr('fill', d => d.color)\n      .attr('width', side)\n      .attr('height', side)\n      .attr('x', at.x)\n      .attr('y', (d, i) => ((side + margin) * i) + at.y);\n  };\n\n  /**\n   * Return value if config styleDefaults is true, else null.\n   * @param  {string} value The value to use as default\n   * @return {string}       The value itself or null\n   */\n  Radar.prototype._ifStyleDefaults = function(value) {\n    return this._config.styleDefaults ? value : null;\n  };\n\n  /**\n   * Append items not present in base from items and pop those which are.\n   * @param  {array} base   Array to append to remove from.\n   * @param  {array} items  Items to be toogled (appended or removed).\n   * @return {array}        A new array.\n   */\n  Radar.prototype._toggleList = (base, items) => {\n    var newItems = items.filter(it => base.indexOf(it) == -1);\n    return base.filter(it => items.indexOf(it) == -1).concat(newItems);\n  };\n\n  Radar.prototype.xOf = function(rads, value) {\n    var vm = this;\n    return vm._center.x + (value * Math.cos(rads));\n  };\n\n  Radar.prototype.yOf = function(rads, value) {\n    var vm = this;\n    return vm._center.y + (value * Math.sin(rads));\n  };\n\n  Radar.prototype.minMax = function(data) {\n    var vm = this;\n    return data.reduce(function(minMax, row) {\n      var val = parseInt(row[vm._config.valuesFrom]);\n      if(minMax.length == 0) {\n        return [val, val];\n      }\n      return [\n        val < minMax[0] ? val : minMax[0],\n        val > minMax[1] ? val : minMax[1]\n      ];\n    }, []);\n  };\n\n  // Build the data with coords.\n  Radar.prototype.dataForVisualization = function(data) {\n    var vm = this,\n      scale = vm._scale,\n      axisKey = vm._config.axesFrom,\n      valKey = vm._config.valuesFrom,\n      polygKey = vm._config.polygonsFrom,\n      axesHash = vm._axesData.hash;\n\n    return data.map(function(row) {\n      var axis = row[axisKey],\n        rads = axesHash[axis].rads,\n        polygon = row[polygKey],\n        val = row[valKey],\n        scVal = scale(val);\n      return {\n        xy: [\n          vm.xOf(rads, scVal),\n          vm.yOf(rads, scVal)\n        ],\n        value: val,\n        polygon: polygon,\n        axis: axis,\n        color: vm._colorMap.hash[polygon],\n        rawData: row\n      };\n    });\n  };\n\n  Radar.prototype.filter = function(fun) {\n    var vm = this;\n    vm._filter = fun;\n    return vm;\n  };\n\n  // DBOX internals.\n\n  Radar.prototype.chart = function(chart) {\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  };\n\n  Radar.prototype.data = function(data) {\n    var vm = this;\n    //In case we want to filter observations\n    if(vm._config.data.filter){\n      data = data.filter(vm._config.data.filter);\n    }\n\n    vm._data = data;\n    return vm;\n  };\n\n  Radar.prototype.scales = function(scales) {\n    var vm = this;\n    vm._scales = scales;\n    // We only need one scale.\n    vm._scale = vm._scales.x;\n    vm._scale.range([0, vm._radius]);\n    return vm;\n  };\n\n  Radar.prototype.axes = function(axes) {\n    var vm = this;\n    // TODO Do nothing?\n    return vm;\n  };\n\n  Radar.prototype.domains = function() {\n    var vm = this;\n    vm._calcDomains(vm._data);\n    return vm;\n  };\n\n  Radar.prototype._calcDomains = function(data) {\n    var vm = this;\n    vm._minMax = vm.minMax(data);\n    vm._scale.domain(vm._config.scales && vm._config.scales.x && vm._config.scales.x.domain && Array.isArray(vm._config.scales.x.domain) ? vm._config.scales.x.domain : [0, vm._minMax[1]]);\n\n    vm._ticks = vm._scale.ticks(vm._config.ticks);\n    // Exclude 0 from ticks if it is the first element.\n    // We don't need to have the 0 actually rendered.\n    if(vm._ticks.length > 0 && vm._ticks[0] === 0) {\n      vm._ticks = vm._ticks.slice(1);\n    }\n  };\n\n  Radar.prototype.draw = function() {\n    var vm = this,\n      data = vm._data;\n\n    // Build the color map previusly to filtering in order to keep the\n    // association between colors and polygons even when some of them (the\n    // polygons) have been filtered out.\n    vm._colorMap = vm.buildColorMap(data);\n\n    // Apply the filter function, if it's present.\n    if(typeof vm._filter === 'function') {\n      data = data.filter(vm._filter);\n    }\n\n    // Filter out excluded polygons from.\n    if(vm._excludedPolygons.length > 0) {\n      data = data.filter(it => {\n        return vm._excludedPolygons.indexOf(\n          it[vm._config.polygonsFrom]) == -1;\n      });\n    }\n\n    vm._calcDomains(data);\n    vm._axesData = vm.extractAxes(data);\n    vm._viewData = vm.dataForVisualization(data);\n\n    vm.drawTicks();\n    vm.drawAxes();\n    vm.drawAxesLabels();\n    vm.drawTicksLabels();\n    vm.drawPolygons();\n    vm.drawLegend();\n  };\n\n  return new Radar(config);\n\n}\n","import * as d3 from 'd3';\n/*\n * Simple Scatter chart\n */\n\nexport default function (config, helper) {\n\n  var Scatter = Object.create(helper);\n\n  Scatter.init = function (config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    \n    vm._tip = this.utils.d3.tip().attr('class', 'd3-tip')\n      .html(vm._config.tip && vm._config.tip.html ? vm._config.tip.html : function(d) {\n        if (vm.chart.config.styles) {\n          var html = `<div style='\n            line-height: 1; \n            opacity: ${vm.chart.style.tooltip.opacity}; \n            font-weight: ${vm.chart.style.tooltip.text.fontWeight}; \n            font-size: ${vm.chart.style.tooltip.text.fontSize}; \n            color: ${vm.chart.style.tooltip.text.textColor};\n            font-family: ${vm.chart.style.tooltip.text.fontFamily};\n            background-color: ${vm.chart.style.tooltip.backgroundColor}; \n            padding: ${vm.chart.style.tooltip.text.padding};   \n            border: ${vm.chart.style.tooltip.border.width} solid ${vm.chart.style.tooltip.border.color};  \n            border-radius:  ${vm.chart.style.tooltip.border.radius};'>`;\n          html += `<strong style='color:${vm.chart.style.tooltip.text.fontColor};'>`;\n        }\n        else { var html = \"<div> <strong>\" }\n        html += vm._config.idName ? d.datum[vm._config.idName] ? d.datum[vm._config.idName] + '<br>' : '' : '';\n        html += d.x ? ('<span>(' + (Number.isNaN(+d.x) || vm._config.xAxis.scale !== 'linear' ? d.x : vm.utils.format(d.x)) + '</span>') : '';\n        html += d.y ? ('<span>, &nbsp;' + (Number.isNaN(+d.y) || vm._config.yAxis.scale !== 'linear' ? d.y : vm.utils.format(d.y)) + ')</span>') : '';\n        html += ' </strong><br>';\n        if (vm._config.magnitude && d.magnitude !== d.x && d.magnitude !== d.y) {\n          html += d.magnitude ? (`<span>` + (Number.isNaN(+d.magnitude) ? d.magnitude : vm.utils.format(d.magnitude)) + '</span>') : '';\n        }\n        /*if (d.color !== d.x && d.color !== d.y) {\n          html += d.color ? ('<span> ' + (Number.isNaN(+d.color) ? d.color : vm.utils.format(d.color)) + '</span>') : '';\n        }*/\n        html += '</div>';\n\n        return html;\n      });\n  };\n\n  //-------------------------------\n  //User config functions\n\n  Scatter.id = function (col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  };\n\n  Scatter.idName = function (col) {\n    var vm = this;\n    vm._config.idName = col;\n    return vm;\n  };\n\n  Scatter.x = function (col) {\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  };\n\n  Scatter.y = function (col) {\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  };\n\n  Scatter.radius = function (radius) {\n    var vm = this;\n    vm._config.radius = radius;\n    return vm;\n  };\n\n  Scatter.magnitude = function (magnitude) {\n    var vm = this;\n    vm._config.magnitude = magnitude;\n    return vm;\n  };\n\n  Scatter.radiusRange = function (radiusRange) {\n    var vm = this;\n    vm._config.radiusRange = radiusRange;\n    return vm;\n  };\n\n  Scatter.magnitudeRange = function (magnitudeRange) {\n    var vm = this;\n    vm._config.magnitudeRange = magnitudeRange;\n    return vm;\n  };\n\n  Scatter.properties = function (properties) {\n    var vm = this;\n    vm._config.properties = properties;\n    return vm;\n  };\n\n  Scatter.figure = function (figureType) {\n    var vm = this;\n    vm._config.figureType = figureType;\n    return vm;\n  };\n\n  Scatter.colors = function(colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Scatter.fill = function (col) {\n    var vm = this;\n    vm._config.fill = col;\n    return vm;\n  };\n\n  Scatter.opacity = function (opacity) {\n    var vm = this;\n    vm._config.opacity = opacity;\n    return vm;\n  };\n\n  Scatter.regression = function (regression) {\n    var vm = this;\n    vm._config.regression = regression;\n    return vm;\n  };\n\n  Scatter.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  Scatter.data = function (data) {\n    var vm = this;\n    var xr,yr, xMean, yMean, b1, b0, term1, term2;\n    vm._data = [];\n\n    \n\n    data.forEach(function (d) {\n      var m = {};\n      m.datum = d;\n      m.x = vm._config.xAxis.scale == 'linear' ? +d[vm._config.x] : d[vm._config.x];\n      m.y = vm._config.yAxis.scale == 'linear' ? +d[vm._config.y] : d[vm._config.y];\n      m.color = vm._config.fill.slice(0, 1) !== '#' ? d[vm._config.fill] : vm._config.fill;\n      m.radius = vm._config.radius !== undefined ? isNaN(vm._config.radius) ? +d[vm._config.radius] : vm._config.radius : 5;\n      \n      m.magnitude = vm._config.magnitude !== undefined ? isNaN(vm._config.magnitude) ? +d[vm._config.magnitude] : vm._config.magnitude : 5;\n\n      if (vm._config.properties !== undefined && Array.isArray(vm._config.properties) && vm._config.properties.length > 0) {\n        vm._config.properties.forEach(function (p) {\n          m[p] = d[p];\n        });\n      }\n\n      vm._data.push(m);\n    });\n\n    if (vm._config.regression === true \n      && vm._config.yAxis.scale === 'linear' \n      && vm._config.xAxis.scale === 'linear' ) {\n      xMean = d3.mean(data.map(function(d){ return +d[vm._config.x]; }));\n      yMean = d3.mean(data.map(function(d){ return +d[vm._config.y]; }));\n      xr = 0;\n      yr = 0;\n      term1 = 0;\n      term2 = 0;\n\n      vm._data.forEach(function(m){\n        xr = m.x - xMean;\n        yr = m.y - yMean;\n        term1 += xr * yr;\n        term2 += xr * xr;\n      });\n\n      var b1 = term1 / term2;\n      var b0 = yMean - (b1 * xMean);\n\n      vm._data.forEach(function(m){\n        m.yhat = b0 + (m.x * b1);\n      })\n    }\n\n    if (vm._config.yAxis.scale !== 'linear') {\n      vm._data.sort(function(a, b) {\n        return vm.utils.sortAscending(a.y, b.y);\n      });\n    }\n    if (vm._config.xAxis.scale !== 'linear') {\n      vm._data.sort(function(a, b) {\n        return vm.utils.sortAscending(a.x, b.x);\n      });\n    }    \n    \n    return vm;\n  };\n\n  Scatter.scales = function () {\n    var vm = this;\n\n    if (vm._config.hasOwnProperty('x') && vm._config.hasOwnProperty('y')) {\n      config = {\n        column: 'x',\n        type: vm._config.xAxis.scale,\n        range: [0, vm.chart.width],\n        minZero: false\n      };\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n\n      config = {\n        column: 'y',\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: false\n      };\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    if (vm._config.hasOwnProperty('colors'))\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    else\n      vm._scales.color = d3.scaleOrdinal(d3.schemeCategory20c);\n\n    var radiusMinMax = d3.extent(vm._data, function (d) {\n      return d.radius;\n    });\n\n    var magnitudeMinMax = d3.extent(vm._data, function (d) {\n      return d.magnitude;\n    });\n\n    var arrOk = [0, 0];\n\n    vm._scales.radius = d3.scaleLinear()\n      .range(vm._config.radiusRange != undefined ? vm._config.radiusRange : [5, 15])\n      .domain(radiusMinMax).nice();\n\n    vm._scales.magnitude = d3.scaleLinear()\n      .range(vm._config.magnitudeRange != undefined ? vm._config.magnitudeRange : [5, 20])\n      .domain(magnitudeMinMax).nice();\n\n    if (vm._config.xAxis.scaleDomain && Array.isArray(vm._config.xAxis.scaleDomain)) {\n      vm._scales.x.domain(vm._config.xAxis.scaleDomain);\n\n    }\n    if (vm._config.yAxis.scaleDomain && Array.isArray(vm._config.yAxis.scaleDomain)) {\n      vm._scales.y.domain(vm._config.yAxis.scaleDomain);\n    }\n    return vm;\n  };\n\n  Scatter.draw = function () {\n    var vm = this;\n    //Call the tip\n    vm.chart.svg().call(vm._tip);\n\n    // Squares \n    if ( vm._config.figureType === 'square' ) {\n      vm.chart.svg().selectAll('square')\n        .data(vm._data)\n        .enter().append('rect')\n        .attr('class', 'square')\n        .attr('class', function (d, i) {\n          //Backward compability with d.properties\n          var id = (d.properties !== undefined && d.properties.id !== undefined) ? d.properties.id : false;\n          id = vm._config.id ? vm._config.id : false;\n          return id ? 'scatter-' + d.datum[id] : 'scatter-' + i;\n        })\n        .attr('width', function (d) {\n          return vm._scales.magnitude(d.magnitude);\n        })\n        .attr('height', function (d) {\n          return vm._scales.magnitude(d.magnitude);\n        })\n        .attr('x', function (d) {\n          if (vm._config.xAxis.scale == 'ordinal' || vm._config.xAxis.scale == 'band') {\n            return vm._scales.x(d.x) + vm._scales.x.bandwidth() / 2 - vm._scales.magnitude(d.magnitude)/2;\n          }\n          else {\n            return vm._scales.x(d.x);\n          }\n        })\n        .attr('y', function (d) {\n          if (vm._config.yAxis.scale == 'ordinal' || vm._config.yAxis.scale == 'band') {\n            return vm._scales.y(d.y) + vm._scales.y.bandwidth() / 2 - vm._scales.magnitude(d.magnitude)/2;\n          }\n          else {\n            return vm._scales.y(d.y);\n          }\n        })\n        .style('fill', function (d) {\n          return String(d.color).slice(0, 1) !== '#' ? vm._scales.color(d.color) : d.color;\n        })\n        .style('opacity', vm._config.opacity !== undefined ? vm._config.opacity : 1)\n        .on('mouseover', function (d, i) {\n          if (vm._config.mouseover) {\n            vm._config.mouseover.call(vm, d, i);\n          }\n          vm._tip.show(d, d3.select(this).node());\n        })\n        .on('mouseout', function (d, i) {\n          if (vm._config.mouseout) {\n            vm._config.mouseout.call(this, d, i);\n          }\n          vm._tip.hide(d, d3.select(this).node());\n        })\n        .on('click', function (d, i) {\n          if (vm._config.events.onClickElement) {\n            vm._config.events.onClickElement.call(this, d, i);\n          }\n        });\n    }\n    // Circles\n    else {\n      vm.chart.svg().selectAll('.dot')\n        .data(vm._data)\n        //.data(vm._data, function(d){ return d.key})\n        .enter().append('circle')\n        .attr('class', 'dot')\n        .attr('class', function (d, i) {\n          //Backward compability with d.properties\n          var id = (d.properties !== undefined && d.properties.id !== undefined) ? d.properties.id : false;\n          id = vm._config.id ? vm._config.id : false;\n          return id ? 'scatter-' + d.datum[id] : 'scatter-' + i;\n        })\n        .attr('r', function (d) {\n          return vm._scales.radius(d.radius);\n        })\n        .attr('cx', function (d) {\n          if (vm._config.xAxis.scale == 'ordinal' || vm._config.xAxis.scale == 'band')\n            return vm._scales.x(d.x) + vm._scales.x.bandwidth() / 2;\n          else\n            return vm._scales.x(d.x);\n\n          /*  if(vm._config.xAxis.scale == 'ordinal' || vm._config.xAxis.scale == 'band')\n            return vm._scales.x(d.x) + (Math.random() * (vm._scales.x.bandwidth() - (d.size * 2)));\n          else \n            return vm._scales.x(d.x); */\n        })\n        .attr('cy', function (d) {\n          if (vm._config.yAxis.scale == 'ordinal' || vm._config.yAxis.scale == 'band')\n            return vm._scales.y(d.y) + vm._scales.y.bandwidth() / 2;\n          else\n            return vm._scales.y(d.y);\n\n          /* if(vm._config.yAxis.scale == 'ordinal' || vm._config.yAxis.scale == 'band')\n            return vm._scales.y(d.y) + (Math.random() * (vm._scales.y.bandwidth() - (d.size * 2)));\n          else \n            return vm._scales.y(d.y); */\n        })\n        .style('fill', function (d) {\n          return String(d.color).slice(0, 1) !== '#' ? vm._scales.color(d.color) : d.color;\n        })\n        .style('opacity', vm._config.opacity !== undefined ? vm._config.opacity : 1)\n        .on('mouseover', function (d, i) {\n          if (vm._config.mouseover) {\n            vm._config.mouseover.call(vm, d, i);\n          }\n          vm._tip.show(d, d3.select(this).node());\n        })\n        .on('mouseout', function (d, i) {\n          if (vm._config.mouseout) {\n            vm._config.mouseout.call(this, d, i);\n          }\n          vm._tip.hide(d, d3.select(this).node());\n        })\n        .on('click', function (d, i) {\n          if (vm._config.events.onClickElement) {\n            vm._config.events.onClickElement.call(this, d, i);\n          }\n        });\n\n      if (vm._config.regression === true){\n        var line = d3.line()\n        .x(function(d) {\n            return vm._scales.x(d.x);\n        })\n        .y(function(d) {\n            return vm._scales.y(d.yhat);\n        });\n\n        vm.chart.svg().append(\"path\")\n          .datum(vm._data)\n          .attr(\"class\", \"line\")\n          .attr(\"d\", line)\n          .style(\"stroke\",\"rgb(251, 196, 58)\")\n      }\n    }\n    return vm;\n  };\n\n  Scatter.select = function (id) {\n    var vm = this;\n    console.log('this ', id, 'is selected');\n    //vm.chart.svg().select('circle.scatter-' + id);\n    return vm;\n  };\n\n  Scatter.selectAll = function (id) {\n    var vm = this;\n    return vm.chart.svg().selectAll('circle');\n  };\n\n  Scatter.init(config);\n  return Scatter;\n}\n","import * as d3 from 'd3';\nimport * as _ from 'lodash';\n\n/*\n * Simple Spineplot\n */\nexport default function (config, helper) {\n\n  //Link Spineplot to the helper object in helper.js\n  var Spineplot = Object.create(helper);\n\n  Spineplot.init = function (config) {\n    var vm = this;\n\n    vm._config = config ? config : {};\n    vm._config.orientation = 'horizontal';\n    vm._data = [];\n    vm._scales = {};\n    vm._tip = d3.tip()\n      .attr('class', 'd3-tip')\n      .direction('n')\n      .html(vm._config.tip || function (d) {\n        var html = '<div>';\n        html += '<span>' + d[vm._config.category] + '</span>';\n        html += '</br><span>' + vm.utils.format(d[vm._config.value]) + '</span>';\n        html += '</div>';\n        return html;\n      });\n\n  };\n\n\n  //-------------------------------\n  //User config functions\n  Spineplot.id = function (columnName) {\n    var vm = this;\n    vm._config.id = columnName;\n    return vm;\n  };\n\n  Spineplot.category = function (columnName) {\n    var vm = this;\n    vm._config.category = columnName;\n    return vm;\n  };\n\n  Spineplot.value = function (columnName) {\n    var vm = this;\n    vm._config.value = columnName;\n    return vm;\n  };\n\n  Spineplot.orientation = function (orientation) {\n    var vm = this;\n    vm._config.orientation = orientation;\n    return vm;\n  };\n\n  /**\n   * Used to draw a bar chart stacked with multiple bars per group\n   * @param {array} columns \n   */\n  Spineplot.stackBy = function (columnName) {\n    var vm = this;\n    vm._config.stackBy = columnName;\n    return vm;\n  };\n\n  /**\n   * column name used for the domain values\n   * @param {string} columnName \n   */\n  Spineplot.fill = function (columnName) {\n    var vm = this;\n    vm._config.fill = columnName;\n    return vm;\n  };\n\n  /**\n   * array of values used \n   * @param {array or scale} columnName \n   */\n  Spineplot.colors = function (colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Spineplot.sortBy = function (option) {\n    //option = string [asc,desc] \n    //option = array for groupBy and stackBy\n    var vm = this;\n    vm._config.sortBy = option;\n    return vm;\n  };\n\n  Spineplot.format = function (format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function)\n      vm.utils.format = format;\n    else\n      vm.utils.format = d3.format(format);\n    return vm;\n  };\n\n  Spineplot.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    return vm;\n  };\n\n  Spineplot.legend = function (legend) {\n    var vm = this;\n    vm._config.legend = legend;\n    return vm;\n  };\n\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Spineplot.data = function (data) {\n    var vm = this;\n\n    if (vm._config.filter) {\n      // In case we want to filter observations\n      data = data.filter(vm._config.filter);\n    }\n    //@TODO - ALLOW MULITPLE SORTS\n    if (vm._config.sortBy) {\n      if (vm._config.sortBy.category) {\n        data = data.sort(function (a, b) {\n          return vm._config.sortBy.category === 'desc' ? vm.utils.sortDescending(a[vm._config.category], b[vm._config.category]) : vm.utils.sortAscending(a[vm._config.category], b[vm._config.category]);\n        });\n      }\n      if (vm._config.sortBy.value) {\n        data = data.sort(function (a, b) {\n          return vm._config.sortBy.value === 'desc' ? vm.utils.sortDescending(a[vm._config.value], b[vm._config.value]) : vm.utils.sortAscending(a[vm._config.value], b[vm._config.value]);\n        });\n      }\n    } else {\n      data = data.sort(function (a, b) {\n        return vm.utils.sortAscending(a[vm._config.category], b[vm._config.category]);\n      });\n    }\n\n    var total = 0;\n    vm._data = data.map(function(d) {\n      d.x0 = total;\n      d.x1 = total + d[vm._config.value];\n      total += +d[vm._config.value];\n      if (vm._config.hasOwnProperty('stackBy') && Array.isArray(vm._config.stackBy) && vm._config.stackBy.length > 0) {\n        d.stackValues = d3.stack().keys(vm._config.stackBy)([d]);\n        d.totalCollapse = d3.sum(d.stackValues, function(stack) {\n          return stack[0][1] - stack[0][0];\n        });\n      }\n      return d;\n    });\n\n    if (vm._config.hasOwnProperty('quantiles')) {\n      vm._quantiles = vm._setQuantile(data);\n      vm._minMax = d3.extent(data, function (d) {\n        return +d[vm._config.fill];\n      });\n    }\n\n    return vm;\n  };\n\n  Spineplot.scales = function (s) {\n    var vm = this;\n    var config;\n    //vm._scales = s;\n    /* Use\n     * vm._config.category\n     * vm._config.categoryAxis.scale\n     * vm._config.value\n     * vm._config.valueAxis.scale\n     * vm._data\n     */\n    // Normal bars \n    if (vm._config.hasOwnProperty('category') && vm._config.hasOwnProperty('value')) {\n      config = {\n        column: 'x1',\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      config = {\n        column: vm._config.value,\n        type: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n\n    //Stack bars on the xAxis\n    if (vm._config.orientation === 'horizontal' && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: 'x1',\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate y scale */\n      config = {\n        column: '',\n        type: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.y = d3.scaleLinear().range(config.range).domain([0, 1]);\n    }\n\n    //Stack bars on the yAxis\n    if (vm._config.orientation === 'vertical' && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: '',\n        txpe: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.x = d3.scaleLinear().range(config.range).domain([0, 1]);\n\n      /* Generate y scale */\n      config = {\n        column: vm._config.value,\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n      \n    }\n    //vm.chart.scales.x = vm._scales.x;\n    //vm.chart.scales.y = vm._scales.y;\n\n    if (vm._config.hasOwnProperty('colors'))\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    else\n      vm._scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    return vm;\n  };\n\n  Spineplot.draw = function () {\n    var vm = this;\n\n    if (vm._config.hasOwnProperty('stackBy')) {\n      if (vm._config.orientation === 'horizontal') vm._drawStackByXAxis();\n      if (vm._config.orientation === 'vertical') vm._drawStackByYAxis();\n      return vm;\n    }\n\n    vm.chart.svg().call(vm._tip);\n\n    const axesTip = d3.tip()\n      .attr('class', 'title-tip')\n      .html(d => {\n        return d[vm._config.category];\n      });\n    vm.chart.svg().call(axesTip);\n\n    if (vm._config.orientation === 'horizontal') {\n\n      /**\n       * x axis tick labels\n       */\n      vm._xLabels = vm.chart.svg().append('g')\n        .attr('class', 'x axis')\n        .attr('transform', 'translate(0,' + (vm.chart.height + 20) + ')')\n        .selectAll('.tick')\n        .data(vm._data)\n        .enter()\n        .append('g')\n        .attr('class', 'tick')\n        .attr('transform', d => { \n          const x = vm._scales.x(d.x0) + (vm._scales.x(d.x1 - d.x0) / 2);\n          return 'translate(' + x + ', 8)'; \n        })\n        .append('text')\n        .attr('text-anchor', 'middle')\n        .text(function(d) {\n          return d[vm._config.category];\n        });\n\n      vm._xLabels.each(function (d) {\n        const currentWidth = this.getComputedTextLength();\n        let labelMaxWidth = (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n        if (currentWidth < (labelMaxWidth * 2)) {\n          d3.select(this).call(vm.utils.wrap, labelMaxWidth, axesTip);\n        } else {\n          d3.select(this)\n            .attr('text-anchor', 'end')\n            .attr('dy', 0)\n            .attr('transform', 'translate(3,-8)rotate(-90)');\n          labelMaxWidth = vm._config.size.margin.bottom * 0.9;\n          if (this.getComputedTextLength() > labelMaxWidth) {\n            d3.select(this)\n              .on('mouseover', axesTip.show)\n              .on('mouseout', axesTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > labelMaxWidth) {\n              d3.select(this).text(function (d) {\n                return (d[vm._config.category] + '').slice(0, -i) + '...';\n              }).attr('title', d);\n              ++i;\n            }\n          }\n        }\n      });\n      \n\n      vm.chart.svg().selectAll('.bar')\n        .data(vm._data)\n        .enter().append('rect')\n        .attr('class', 'bar')\n        .attr('id', (d, i) => {\n          var id = 'spineplot-' + i;\n          if (vm._config.id) {\n            id = 'spineplot-' + d[vm._config.id];\n          }\n          return id;\n        })\n        .attr('x', (d) => vm._scales.x(d.x0) )\n        .attr('y', 0)\n        .attr('width', d => vm._scales.x(d[vm._config.value]) )\n        .attr('height', vm.chart.height)\n        .attr('fill', (d) => {\n          return vm._scales.color !== false ? vm._scales.color(d[vm._config.fill]) : vm._getQuantileColor(d[vm._config.fill], 'default');\n        })\n        .attr('stroke', 'white')\n        .attr('stroke-width', 1)\n        .style('opacity', 0.9)\n        .on('mouseover', function(d, i) {\n          if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n            d3.select(this).attr('fill', function (d) {\n              return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n            });\n          }\n          vm._tip.show(d, d3.select(this).node());\n\n          if (vm._config.hasOwnProperty('onmouseover')) { //External function call, must be after all the internal code; allowing the user to overide \n            vm._config.onmouseover.call(this, d, i);\n          }\n\n        })\n        .on('mouseout', function (d, i) {\n          if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n            d3.select(this).attr('fill', function (d) {\n              return vm._getQuantileColor(d[vm._config.fill], 'default');\n            });\n          }\n          vm._tip.hide();\n\n          if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n            vm._config.onmouseout.call(this, d, i);\n          }\n        })\n        .on('click', function (d, i) {\n          if (vm._config.hasOwnProperty('click')) {\n            vm._config.onclick.call(this, d, i);\n          }\n        });\n    }\n    return vm;\n  };\n\n\n  //\n  /** \n   * Draw bars grouped by \n   */\n  Spineplot._drawStackByXAxis = function () {\n    var vm = this;\n    vm._tip.html(vm._config.tip || function (d) {\n      var cat = '';\n      cat += '<span>' + d.key + '</span>';\n      if (d.key !== d[0].data[vm._config.category]) {\n        cat += '<br><span>' + d[0].data[vm._config.category] + '</span>';\n      }\n      cat += '<br><span>' + vm.utils.format(d[0].data[d.key]) + '</span>';\n      return cat;\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    const axesTip = d3.tip()\n      .attr('class', 'title-tip')\n      .html(d => {\n        return d[vm._config.category];\n      });\n    vm.chart.svg().call(axesTip);\n\n    /**\n     * x axis labels\n     */\n    vm._xLabels = vm.chart.svg().append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(0,' + (vm.chart.height + 20) + ')')\n      .selectAll('g')\n      .data(vm._data)\n      .enter()\n      .append('g')\n      .attr('class', 'tick')\n      .attr('transform', d => {\n        const x = vm._scales.x(d.x0) + (vm._scales.x(d.x1 - d.x0) / 2);\n        return 'translate(' + x + ', 0)';\n      })\n      .append('text')\n      .attr('text-anchor', 'middle')\n      .text(d => d[vm._config.category]);\n\n    vm._xLabels.each(function (d) {\n      const currentWidth = this.getComputedTextLength();\n      let labelMaxWidth = (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n      if (currentWidth < (labelMaxWidth * 2)) {\n        d3.select(this).call(vm.utils.wrap, labelMaxWidth, axesTip);\n      } else {\n        d3.select(this)\n          .attr('text-anchor', 'end')\n          .attr('dy', 0)\n          .attr('transform', 'translate(3,-8)rotate(-90)');\n        labelMaxWidth = vm._config.size.margin.bottom * 0.9;\n        if (this.getComputedTextLength() > labelMaxWidth) {\n          d3.select(this)\n            .on('mouseover', axesTip.show)\n            .on('mouseout', axesTip.hide);\n          let i = 1;\n          while (this.getComputedTextLength() > labelMaxWidth) {\n            d3.select(this).text(function (d) {\n              return (d[vm._config.category] + '').slice(0, -i) + '...';\n            }).attr('title', d);\n            ++i;\n          }\n        }\n      }\n    });\n      \n    var groups = vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g');\n    \n    groups.selectAll('rect')\n      .data(function (d) {\n        return d.stackValues;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return d[0][1] ? vm._scales.y(d[0][1] / d[0].data.totalCollapse) : vm._scales.y(0);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d[0].data.x0);\n      })\n      .attr('width', function (d) {\n        return vm._scales.x(d[0].data[vm._config.value]);\n      })\n      .attr('height', function (d) {\n        return vm._scales.y((d[0][0] / d[0].data.totalCollapse)) - vm._scales.y(d[0][1] / d[0].data.totalCollapse);\n      })\n      .attr('stroke', 'white')\n      .attr('stroke-width', 1)\n      .attr('fill', function (d) {\n        return vm._scales.color(d[vm._config.fill]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n  };\n\n  Spineplot._drawStackByYAxis = function () {\n    var vm = this;\n\n    vm._tip.html(vm._config.tip || function (d) {\n      var html = '<div><span>' + d[vm._config.category] + '<span><br>';\n      for (var k in d.data) {\n        if ((d[1] - d[0]) == d.data[k]) {\n          html += '<span>' + k + '</span>';\n        }\n      }\n      html += '<br>' + vm.utils.format(d[1] - d[0])\n      return html;\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      .selectAll('rect')\n      .data(function (d) {\n        return d;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return vm._scales.y(d.data[vm._config.value]);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d[0]);\n      })\n      .attr('height', function (d) {\n        return vm._scales.y.bandwidth()\n      })\n      .attr('width', function (d) {\n        return vm._scales.x(d[1]) - vm._scales.x(d[0]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i)\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i)\n        }\n      });\n\n  };\n\n  Spineplot._setQuantile = function (data) {\n    var vm = this;\n    var values = [];\n    var quantile = [];\n\n    if (vm._config.quantiles && vm._config.quantiles.predefinedQuantiles &&\n      vm._config.quantiles.predefinedQuantiles.length > 0) {\n      return vm._config.quantiles.predefinedQuantiles;\n    }\n\n    data.forEach(function (d) {\n      values.push(+d[vm._config.fill]);\n    });\n\n    values.sort(vm.utils.sortAscending);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.quantiles && vm._config.quantiles.buckets) {\n\n      if (vm._config.quantiles.ignoreZeros === true) {\n        var aux = _.dropWhile(values, function (o) {\n          return o <= 0;\n        });\n        //aux.unshift(values[0]);  \n\n        quantile.push(values[0]);\n        quantile.push(0);\n\n        for (var i = 1; i <= vm._config.quantiles.buckets - 1; i++) {\n          quantile.push(d3.quantile(aux, i * 1 / (vm._config.quantiles.buckets - 1)))\n        }\n\n      } else {\n        quantile.push(d3.quantile(values, 0))\n        for (var i = 1; i <= vm._config.quantiles.buckets; i++) {\n          quantile.push(d3.quantile(values, i * 1 / vm._config.quantiles.buckets))\n        }\n      }\n\n    } else {\n      quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2), d3.quantile(values, 0.4), d3.quantile(values, 0.6), d3.quantile(values, 0.8), d3.quantile(values, 1)];\n    }\n\n    //@TODO - VALIDATE WHEN ZEROS NEED TO BE PUT ON QUANTILE 1 AND RECALCULATE NON ZERO VALUES INTO THE REST OF THE BUCKETS\n    if (vm._config.quantiles && vm._config.quantiles.buckets && vm._config.quantiles.buckets === 5) {\n\n      if (quantile[1] === quantile[2] && quantile[2] === quantile[3] && quantile[3] === quantile[4] && quantile[4] === quantile[5]) {\n        quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2)];\n      }\n    }\n\n    return quantile;\n  };\n\n  Spineplot._getQuantileColor = function (d, type) {\n    var vm = this;\n    var total = parseFloat(d);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.bars.quantiles && vm._config.bars.quantiles.colors) {\n      if (vm._quantiles.length > 2) {\n\n        if (vm._config && vm._config.bars.min !== undefined && vm._config.bars.max !== undefined) {\n          if (total < vm._config.bars.min || total > vm._config.bars.max) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        } else {\n          if (total < vm._minMax[0] || total > vm._minMax[1]) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        }\n\n        if (type == 'default') {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.bars.quantiles.colors[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.bars.quantiles.colors[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.bars.quantiles.colors[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colors[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colors[4]; //'#480000';\n          }\n        }\n\n        if (type == 'onHover' && vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.quantiles.colorsOnHover[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.quantiles.colorsOnHover[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.quantiles.colorsOnHover[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colorsOnHover[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colorsOnHover[4]; //'#480000';\n          }\n        }\n\n      }\n    }\n\n    if (vm._quantiles.length == 2) {\n      /*if(total === 0 ){\n        return d4theme.colors.quantiles[0];//return '#fff';\n      }else if(total <= vm._quantiles[1]){\n        return d4theme.colors.quantiles[1];//return '#f7c7c5';\n      }*/\n      if (total <= vm._quantiles[1]) {\n        return vm._config.quantiles.colors[0]; //'#f7c7c5';\n      }\n    }\n\n  };\n\n  Spineplot.init(config);\n  return Spineplot;\n}\n","import * as d3 from 'd3';\n\n/* Simple timeline example\n * Single and multiline timelines\n */\nexport default function(config, helper) {\n\n\n  var Timeline = Object.create(helper);\n\n  Timeline.init = function(config){\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales ={};\n    vm._axes = {};\n\n    vm._config.parseDate = d3.timeParse('%Y-%m-%d');\n\n    vm._line = d3.line()\n      //.curve(d3.curveCardinal)\n      .curve(d3.curveLinear)\n      .x(function(d) { return vm._scales.x(d.x); })\n      .y(function(d) { return vm._scales.y(d.y); });\n\n\n    vm._area = d3.area()\n      //.curve(d3.curveCardinal)\n      .curve(d3.curveLinear)\n      .x(function(d) {\n        if (d.alreadyScaled && d.alreadyScaled === true){\n          return d.x;\n        }else{\n          return vm._scales.x(d.x);\n        }\n      })\n      .y1(function(d) {\n        if (d.alreadyScaled && d.alreadyScaled === true){\n          return d.y;\n        }else{\n          return vm._scales.y(d.y);\n        }\n      });\n    \n    vm._tip = vm.utils.d3.tip().attr('class', 'd3-tip')\n      .html(vm._config.tip && vm._config.tip.html ? vm._config.tip.html : function(d) {\n\n        let scaleColor = vm._scales.color !== false ? vm._scales.color(d.name): vm._getQuantileColor(d.name,'default');\n        if (vm.chart.config.styles) {\n          var html = `<div style='\n            line-height: 1; \n            opacity: ${vm.chart.style.tooltip.opacity}; \n            font-weight: ${vm.chart.style.tooltip.text.fontWeight}; \n            font-size: ${vm.chart.style.tooltip.text.fontSize}; \n            color: ${vm.chart.style.tooltip.text.textColor};\n            font-family: ${vm.chart.style.tooltip.text.fontFamily};\n            background-color: ${vm.chart.style.tooltip.backgroundColor}; \n            padding: ${vm.chart.style.tooltip.text.padding};   \n            border: ${vm.chart.style.tooltip.border.width} solid ${vm.chart.style.tooltip.border.color};  \n            border-radius:  ${vm.chart.style.tooltip.border.radius};'>`;\n          html += `<strong style='color:${vm.chart.style.tooltip.text.fontColor};'>`;\n        }\n        else { var html = \"<div> <strong>\"; }\n        html += `<strong style='color:${scaleColor}'>` + d.name + \": </strong>\";\n        html += d.y ? (`<span >` + (Number.isNaN(+d.y) ? d.y : vm.utils.format(d.y)) + '</span>') : '';\n        html += \"</div>\";\n\n        return html;\n\n        /*var html ='';\n        html += d.name + '<br>';\n        //html += d.x ? ('<span>' + (Number.isNaN(+d.x) ? d.x : vm.utils.format(d.x)) + '</span></br>') : '';\n        html += d.y ? ('<span>' + (Number.isNaN(+d.y) ? d.y : vm.utils.format(d.y)) + '</span></br>') : '';\n        html += d.magnitude ? ('<span>' + (Number.isNaN(+d.magnitude) ? d.magnitude : vm.utils.format(d.magnitude)) + '</span></br>') : '';\n        html += d.color ? ('<span>' + (Number.isNaN(+d.color) ? d.color : vm.utils.format(d.color)) + '</span>') : '';\n        return html;*/\n      });\n\n  }\n\n  //-------------------------------\n  //User config functions\n  Timeline.x = function(col){\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  }\n\n  Timeline.parseDate = function(format){\n    var vm = this;\n    vm._config.parseDate = d3.timeParse(format);\n    return vm;\n  }\n\n  Timeline.y = function(col){\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  }\n\n  Timeline.series = function(arr){\n    var vm = this;\n    vm._config.series = arr;\n    return vm;\n  }\n\n  Timeline.fill = function(col){\n    var vm = this;\n    vm._config.fill = col;\n    return vm;\n  }\n\n  Timeline.colors = function(colors) {\n    var vm = this;\n    if(Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  }\n\n  Timeline.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Timeline.data = function(data){\n    var vm = this;\n    \n    vm._data = [];\n    data.forEach(function(d){\n      d.x = vm._config.parseDate(d[vm._config.x]);\n      d.color = d[vm._config.fill];\n      delete(d[vm._config.x]);\n      vm._data.push(d);\n    });\n\n    //Sort the data by d.x\n    data = data.sort(function(a, b){\n      return d3.ascending(a.x, b.x);\n    })\n\n    vm._lines = vm._config.y ? vm._config.y : vm._config.series;\n\n    vm._lines = vm._lines.map(function(name) {\n      return {\n        name: name,\n        values: data.map(function(d) {\n          return {x: d.x, y: +d[name]};\n        })\n      };\n    });\n\n    return vm;\n  }\n\n  Timeline.scales = function(){\n    var vm = this;\n\n    vm._xMinMax = d3.extent(vm._data, function(d) { return d.x; });\n\n    vm._yMinMax = [\n      vm._config.yAxis.minZero ? 0 : d3.min(vm._lines, function(c) { return d3.min(c.values, function(v) { return v.y; }); }),\n      d3.max(vm._lines, function(c) { return d3.max(c.values, function(v) { return v.y; }); })\n    ];\n\n    config = {\n      column: vm._config.x,\n      type: vm._config.xAxis.scale,\n      range: [0, vm.chart.width],\n      minZero: false\n    };\n    vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n\n    config = {\n      column: vm._config.y,\n      type: vm._config.yAxis.scale,\n      range: [vm.chart.height, 0],\n      minZero: vm._config.yAxis.minZero\n    };\n    vm._scales.y = vm.utils.generateScale(vm._data, config);\n\n\n    vm._scales.x.domain(vm._xMinMax)\n    vm._scales.y.domain(vm._yMinMax)\n\n    if(vm._config.hasOwnProperty('colors'))\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    else\n      vm._scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    return vm;\n  }\n\n\n  Timeline.draw = function(){\n    var vm = this;\n    //Call the tip\n    vm.chart.svg().call(vm._tip);\n    \n    var lines = vm.chart.svg().selectAll(\".lines\")\n      .data(vm._lines)\n    .enter().append(\"g\")\n      .attr(\"class\", \"lines\");\n\n    var path = vm.chart.svg().selectAll(\".lines\").append(\"path\")\n      .attr(\"class\", \"line\")\n      .attr(\"d\", function(d) {\n        return vm._line(d.values);\n      })\n      .attr(\"stroke\", function(d){   \n        return vm._scales.color !== false ? vm._scales.color(d.name): vm._getQuantileColor(d.name,'default');\n      })\n      .attr(\"stroke-width\", 4)\n      .attr('fill','none');\n\n    /**By default it draws dots on data points with 4px radius*/\n    var dots = vm.chart.svg().selectAll('.dots')\n      .data(vm._lines)\n      .enter().append('g')\n        .attr('class', 'dots')\n        .selectAll('.circle')\n        .data( function(d) { \n          d.values.forEach((el) => {el.name = d.name;}); \n          return d.values; \n        })\n        .enter().append('circle')\n          .attr('class', 'dot')\n          .attr(\"cx\", function(d, i) { \n            return vm._scales.x(d.x); \n          })\n          .attr(\"cy\", function(d) { \n            return vm._scales.y(d.y); \n          })\n          .attr(\"r\", 4)\n          .style('stroke', function(d){   \n            return vm._scales.color !== false ? vm._scales.color(d.name): vm._getQuantileColor(d.name,'default');\n          })\n          .style('stroke-width', 2)\n          .style('fill', '#fff')\n          .style('fill-opacity', 0.5)\n          .on('mouseover', function (d, i) {\n            if (vm._config.mouseover) {\n              //vm._config.mouseover.call(vm, d, i);\n            }\n            vm._tip.show(d, d3.select(this).node());\n          })\n          .on('mouseout', function (d, i) {\n            if (vm._config.mouseout) {\n              //vm._config.mouseout.call(this, d, i);\n            }\n            vm._tip.hide(d, d3.select(this).node());\n          })\n\n\n    //var t = textures.lines().thicker();\n\n    //vm.chart.svg().call(t);\n\n\n    /* vm._area.y0(vm._scales.y(vm._yMinMax[0]));\n\n    var areas = vm.chart.svg().selectAll(\".areas\")\n      .data(vm._lines)\n    .enter().append(\"g\")\n      .attr(\"class\", \"areas\");\n\n    var pathArea  = vm.chart.svg().selectAll(\".areas\").append(\"path\")\n      .attr(\"class\", \"area\")\n      .attr(\"d\", function(d) {\n        return vm._area(d.values);\n      }) */\n      //.attr(\"fill\", t.url());\n\n    return vm;\n  }\n\n  Timeline.init(config);\n  return Timeline;\n}\n","import * as d3 from 'd3';\n\n/* \n * Simple SVG Treemap Chart\n */\nexport default function(config, helper) {\n\n  var Treemap = Object.create(helper);\n\n  Treemap.init = function(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._config._padding = 3;\n    vm._config._labels = false;\n    vm._config.tip = function(d) {\n      console.log(d);\n      var html = '<div>';\n      if (d.parent.data.name && d.parent.data.name !== 'data') {\n\n        html += '<span>' + d.parent.data.name + '</span><br>'; \n      }\n      html += '<span>' + d.data.name + '</span><br>'; \n      html += '<span>' + vm.utils.format(d.value) + '</span>';\n      html += '</div>';\n      return html;\n    };\n    vm._data = [];\n    vm._scales = {\n      color: d3.scaleOrdinal(d3.schemeCategory20c)\n    };\n    vm._axes = {};\n    vm._tip = d3.tip()\n      .attr('class', 'd3-tip tip-treemap')\n      .direction('n')\n      .html(vm._config.tip);\n  }\n\n  Treemap.size = function(col) {\n    var vm = this;\n    vm._config._size = col;\n    return vm;\n  }\n\n  Treemap.colors = function(arrayOfColors, domain) {\n    var vm = this;\n    vm._scales.color = d3.scaleOrdinal(arrayOfColors);\n    if (domain) {\n      vm._scales.color.domain(domain);\n    }\n    return vm;\n  }\n\n  Treemap.padding = function(padding) {\n    var vm = this;\n    vm._config._padding = padding;\n    return vm;\n  }\n\n  Treemap.nestBy = function(keys) {\n    var vm = this;\n    if (Array.isArray(keys)) {\n      if (keys.length == 0)\n        throw \"Error: nestBy() array is empty\";\n      vm._config._keys = keys;\n    } else if (typeof keys === 'string' || keys instanceof String) {\n      vm._config._keys = [keys];\n    } else {\n      if (keys == undefined || keys == null)\n        throw \"Error: nestBy() expects column names to deaggregate data\";\n      vm._config._keys = [keys.toString()];\n      console.warning(\"nestBy() expected name of columns. Argument will be forced to string version .toString()\");\n    }\n    vm._config._labelName = vm._config._keys[vm._config._keys.length - 1]; //label will be last key\n    return vm;\n  }\n\n  Treemap.format = function(format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function)\n      vm.utils.format = format;\n    else\n      vm.utils.format = d3.format(format);\n    return vm;\n  }\n\n  Treemap.labels = function(bool) {\n    var vm = this;\n    vm._config._labels = Boolean(bool);\n    return vm;\n  };\n\n  Treemap.tip = function(tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  }\n\n  Treemap.scales = function (scales) {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.axes = function() {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.domains = function() {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.isValidStructure = function(datum) {\n    var vm = this;\n    if ((typeof datum.name === 'string' || datum.name instanceof String) && Array.isArray(datum.children)) {\n      var res = true;\n      datum.children.forEach(function(child) {\n        res = res && vm.isValidStructure(child);\n      });\n      return res;\n    } else if ((typeof datum.name === 'string' || datum.name instanceof String) && Number(datum[vm._config._size]) == datum[vm._config._size]) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  Treemap.formatNestedData = function(data) {\n    var vm = this;\n    if (data.key) {\n      data.name = data.key;\n      delete data.key;\n    } else {\n      if (!Array.isArray(data.values)) {\n        data.name = data[vm._config._labelName];\n      }\n    }\n    if (Array.isArray(data.values)) {\n      var children = [];\n      data.values.forEach(function(v) {\n        children.push(vm.formatNestedData(v))\n      });\n      data.children = children;\n      delete data.values;\n    }\n    if (!data[vm._config._size] && data.value) {\n      data[vm._config._size] = data.value;\n    }\n    return data;\n  }\n\n  function nestKey(nest, key, callback) {\n    callback(null, nest.key(function(d) {\n      return d[key];\n    }))\n  }\n\n  Treemap.data = function(data) {\n    var vm = this;\n    // Validate structure like [{name: '', children: [{},{}]}]\n    if (data) {\n      if (Array.isArray(data) && data.length > 0) {\n        if (!vm.isValidStructure(data[0])) {\n          data.forEach(function(d) {\n            d[vm._config._size] = +d[vm._config._size];\n          });\n          try {\n            if (!vm._config._keys)\n              throw \"nestBy() in layer was not configured\";\n            var nested = d3.nest();\n            var queue = d3.queue();\n            for (var i = 0; i < vm._config._keys.length; i++)\n              queue.defer(nestKey, nested, vm._config._keys[i])\n            queue.awaitAll(function(error, nested) {\n              var nestedData = nested[0].rollup(function(leaves) {\n                return d3.sum(leaves, function(d) {\n                  return d[vm._config._size];\n                })\n              }).entries(data);\n              var aux = {};\n              aux.key = 'data';\n              aux.values = _.cloneDeep(nestedData); // WARN: Lodash dependency\n              data = vm.formatNestedData(aux);\n              vm._data = data;\n            });\n\n          } catch (err) {\n            console.error(err);\n          }\n        }\n      } else {\n        if (!vm.isValidStructure(data)) {\n          try {\n            if (!data.key)\n              throw \"Property 'key' not found\";\n            if (data[vm._config._size] !== Number(data[vm._config._size]))\n              throw \"Value used for treemap rect size is not a number\";\n            data = vm.formatNestedData(data);\n            vm._data = data;\n          } catch (err) {\n            console.error(err);\n          }\n        }\n      }\n    }\n    return vm;\n  }\n\n  Treemap.draw = function() {\n    var vm = this;\n    vm.chart.svg().call(vm._tip);\n\n    var treemap = d3.treemap()\n      .tile(d3.treemapResquarify)\n      .size([vm.chart.width, vm.chart.height])\n      .round(true)\n      .paddingInner(vm._config._padding);\n\n    var root = d3.hierarchy(vm._data)\n      .eachBefore(function(d) {\n        d.data.id = (d.parent ? d.parent.data.id + \".\" : \"\") + d.data.name;\n      })\n      .sum(function(d) {\n        return d[vm._config._size];\n      })\n      .sort(function(a, b) {\n        return b.height - a.height || b.value - a.value;\n      });\n\n    treemap(root);\n\n    console.log(root.leaves());\n\n    var cell = vm.chart.svg().selectAll(\"g\")\n      .data(root.leaves())\n      .enter().append(\"g\")\n      .attr(\"transform\", function(d) {\n        return \"translate(\" + d.x0 + \",\" + d.y0 + \")\";\n      });\n\n    var rect = cell.append(\"rect\")\n      .attr(\"id\", function(d) {\n        return d.data.id;\n      })\n      .attr(\"width\", function(d) {\n        return d.x1 - d.x0;\n      })\n      .attr(\"height\", function(d) {\n        return d.y1 - d.y0;\n      })\n      .attr(\"fill\", function(d) {\n        console.log('fill', d);\n        console.log(vm._scales.color.range());\n        console.log(vm._scales.color.domain());\n        return vm._scales.color(d.data.name);\n      });\n\n    cell.append(\"clipPath\")\n      .attr(\"id\", function(d) {\n        return \"clip-\" + d.data.id;\n      })\n      .append(\"use\")\n      .attr(\"xlink:href\", function(d) {\n        return \"#\" + d.data.id;\n      });\n\n    if (vm._config._labels) {\n      var text = cell.append(\"text\")\n        .attr(\"clip-path\", function(d) {\n          return \"url(#clip-\" + d.data.id + \")\";\n        })\n      text.append(\"tspan\")\n        .attr('class', 'capitalize')\n        .attr(\"x\", 8)\n        .attr(\"y\", 25)\n        .text(function(d) {\n          if (d.value > 2) {\n            var arr = d.data.id.replace('data.', '').split('.');\n            return arr.length > 1 ? arr.slice(arr.length - 2, arr.length).join(' / ') : arr[arr.length - 1].toString();\n          } else\n            return '';\n        });\n      text.append(\"tspan\")\n        .attr('class', 'capitalize')\n        .attr(\"x\", 8)\n        .attr(\"y\", 45)\n        .text(function(d) {\n          return d.value > 2 ? vm.utils.format(d.value) : '';\n        });\n    }\n\n    rect.on('mouseover', function(d) {\n        /*if(vm._config.data.mouseover){\n          vm._config.data.mouseover.call(vm, d,i);\n        }*/\n        vm._tip.show(d, d3.select(this).node());\n      })\n      .on('mouseout', function(d) {\n        /*if(vm._config.data.mouseout){\n          vm._config.data.mouseout.call(this, d,i);\n        }*/\n        vm._tip.hide(d, d3.select(this).node());\n      })\n\n    return vm;\n  }\n\n  Treemap.init(config);\n  return Treemap;\n}\n","/*\n * Dboxjs\n *\n * You can import other modules here, including external packages. When\n * bundling using rollup you can mark those modules as external and have them\n * excluded or, if they have a jsnext:main entry in their package.json (like\n * this package does), let rollup bundle them into your dist file.\n */\n\n/* Core */\nimport * as _ from 'lodash';\n\nexport {\n  default as chart,\n} from './lib/chart';\n\n/* Chart modules */\nexport {\n  default as bars\n} from '../bars/bars.js';\n\nexport {\n  default as distro\n} from '../distro/distro.js';\n\nexport {\n  default as heatmap,\n} from '../heatmap/heatmap.js';\n\nexport {\n  default as leaflet,\n} from '../leaflet/leaflet.js';\n\nexport {\n  default as map,\n} from '../map/map.js';\n\nexport {\n  default as radar\n} from '../radar/radar.js';\n\nexport {\n  default as scatter,\n} from '../scatter/scatter.js';\n\nexport {\n  default as spineplot\n} from '../spineplot/spineplot.js';\n\nexport {\n  default as timeline,\n} from '../timeline/timeline.js';\n\nexport {\n  default as treemap,\n} from '../treemap/treemap.js';\n\n"],"names":["carto","query","config","callback","sql","cartodb","user","execute","done","data","result","rows","parser","map","error","d3Tip","require","vm","Helper","chart","_config","width","_width","height","_height","style","_addStyle","fullSvg","_fullSvg","svg","_svg","utils","d3","tip","generateScale","scale","domains","range","groupBy","d","column","stackBy","serie","undefined","type","minZero","Array","isArray","rangeRound","domain","padding","bins","format","value","formatPreffix","formatSuffix","wrap","text","tooltip","each","words","split","reverse","word","line","lineNumber","lineHeight","y","attr","dy","parseFloat","tspan","append","pop","push","join","node","getComputedTextLength","length","on","show","hide","i","slice","sortAscending","a","b","Number","isNaN","sortDescending","Chart","init","defaultConfig","size","margin","left","right","top","bottom","defaultStyle","backgroundColor","color","title","textColor","fontSize","fontWeight","textAlign","hr","enabled","borderWidth","borderColor","legend","position","figure","opacity","fontFamily","border","radius","yAxis","axis","strokeWidth","strokeColor","strokeOpacity","paddingTick","ticks","grid","gridDashed","labels","textAnchor","xAxis","_","_data","_margin","addStyle","_scales","_axes","layers","helper","bind","sizeObj","stylesObj","bool","bindTo","selector","Object","assign","legendType","legendTitle","layer","_layer","getLayer","layerIndex","draw","q","scales","loadData","awaitAll","results","initLayers","drawSVG","axes","drawAxes","drawLayers","events","load","dispatch","theme","x","buckets","setScales","tickSizeOuter","tickSize","values","tickValues","tickFormat","tsv","defer","json","csv","raw","mapData","topojson","url","plotOptions","bars","averageLines","forEach","l","ly","select","remove","html","template","classed","categories","c","hasOwnProperty","drawLegend","legendTip","name","call","legendBox","styles","lWidth","lbWidth","rx","ry","markStrokeWidth","o","legendCheck","selectAll","enter","onClickLegend","stopPropagation","coordinates","property","active","drawGrid","axesTip","element","dropdown","yAxisDropDown","updateAxis","getBoundingClientRect","display","transform","options","selected","console","log","_xAxis","xAxisDropDown","tickWidth","rotate","biggestLabelWidth","nodes","xBandWidth","bandwidth","stroke","keys","k","obj","change","getDomains","minMax","sorted","sortFunctionY","sortFunctionX","sort","order","destroy","Bars","create","_tip","direction","id","columnName","columns","fill","colors","sortBy","option","Function","filter","_quantiles","_setQuantile","_minMax","_drawGroupByXAxis","_drawGroupByYAxis","_drawStackByXAxis","_drawStackByYAxis","_getQuantileColor","quantiles","onmouseover","onmouseout","onclick","key","toFixed","quantile","predefinedQuantiles","ignoreZeros","aux","dropWhile","total","min","max","outOfRangeColor","colorsOnHover","makeDistroChart","settings","idName","xName","xSort","yName","axisLables","yTicks","chartSize","constrainExtremes","setting","formatAsFloat","formatNumber","formatRange","logFormatNumber","Math","abs","floor","yFormatter","xFormatter","groupObjs","objs","mainDiv","chartDiv","g","colorFunct","getColorFunct","colorOptions","colorMap","index","group","getObjWidth","objWidth","gName","objSize","middle","xScale","gShift","addJitter","doJitter","random","shallowCopy","oldObj","newObj","tooltipHover","groupName","metrics","pointName","pointValue","tooltipString","toLocaleString","quartile3","median","quartile1","transition","duration","distroSelect","prepareData","calcMetrics","upperOuterFence","upperInnerFence","mean","iqr","lowerInnerFence","lowerOuterFence","LIF","UIF","current_x","current_y","current_id","current_idName","current_row","valuesInfo","cName","prepareSettings","divWidth","divHeight","axisLabels","xAxisLable","yAxisLable","yScale","fences","nice","clamp","tickSizeInner","update","parseInt","violinPlots","_yDomainVP","prepareChart","window","renderViolinPlot","defaultOptions","showViolinPlot","resolution","curve","vOpts","violin","updateOptions","prepareViolin","reset","opts","cViolinPlot","xVScale","copy","kde","kernelDensityEstimator","eKernel","kdedata","interpolateMax","interpolateMin","kdeTester","eKernelTest","interMaxY","interMaxX","count","interMinY","interMinX","objBounds","yVScale","area","y0","y1","datum","kernel","sample","v","u","array","testX","renderBoxPlot","boxPlots","showBox","showWhiskers","showMedian","showMean","medianCSize","showOutliers","boxWidth","lineWidth","scatterOutliers","outlierCSize","bOpts","boxPlot","calcAllOutliers","calcOutliers","cGroup","cExtremes","cOutliers","cOut","idx","outliers","extremes","prepareBoxPlot","cBoxPlot","sMetrics","box","lineBounds","upperWhisker","fence","lowerWhisker","circle","pt","point","outDiv","extDiv","renderNotchBoxes","notchBoxes","showNotchBox","showLines","medianWidth","notchStyle","nOpts","notchBox","makeNotchBox","cNotch","notchBounds","scaledValues","boxLeft","lowerNotch","medianLeft","upperNotch","boxRight","medianRight","calcNotches","modifier","sqrt","prepareNotchBoxes","boxBounds","medianBounds","notch","upperLine","confidenceLines","upper","lower","lowerLine","renderDataPlots","dataPlots","showPlot","plotType","pointSize","showBeanLines","beanWidth","dOpts","preparePlots","cPlot","halfBand","cMetric","lines","points","swarmBounds","yPtScale","interpolate","maxWidth","ptsObj","cYBucket","pts","rightMax","row","leftMin","col","plotBounds","scatterWidth","bean","beanBounds","val","valInfo","pageX","pageY","onClickElement","parseDate","Distro","opt","chart1","babelHelpers['typeof']","Heatmap","_legendElementWidth","_gridWidth","colorLegend","borderRadius","ySort","xCategories","sortKeys","entries","yCategories","fillValues","_gridHeight","m","drawColorLegend","defs","linearGradient","colorScale","ceil","_yLabels","_xLabels","labelMaxWidth","cards","indexOf","String","mouseover","mouseout","ease","Leaflet","_topojson","objects","_nodes","geometries","geom","found","properties","urlTopojson","tran","translate","L","TopoJSON","GeoJSON","extend","addData","jsonData","geojson","feature","prototype","LatLng","lat","lon","center","Map","zoom","maxZoom","minZoom","OpenStreetMap_BlackAndWhite","tileLayer","attribution","topoLayer","$countryName","$","addTo","addTopoData","topoData","eachLayer","handleLayer","NOM_ENT","NOM_MUN","_path","fillColor","setStyle","fillOpacity","weight","enterLayer","leaveLayer","_formatWithZeroDecimals","_formatWithOneDecimal","_formatWithTwoDecimals","_formatWithThreeDecimals","_format","percentage","end","_chart","s","_projection","path","projection","_polygons","translateX","features","_polygonsDefault","Radar","CIRCLE_RADIANS","PI","RADIANS_TO_ROTATE","_axesData","_filter","_viewData","_colorMap","_ticks","_scale","_excludedPolygons","transitionDuration","axisLabelMargin","enable","at","styleDefaults","_center","_radius","polygonsFrom","axesFrom","valuesFrom","drawTicks","dur","sel","empty","_ifStyleDefaults","exit","drawTicksLabels","extractAxes","radiansPerAxis","reduce","prev","item","concat","rads","list","hash","hashed","el","buildColorMap","cMap","polyg","cIdx","polygon","selection","xOf","yOf","drawAxesLabels","fromCenter","rects","drawPolygons","groupedData","gs","gsExit","gsEnter","bundle","polygIdx","polygons","rawData","xy","CVE_ENT","_buildNestedPolygons","_buildNestedVertexes","toUpdate","appendHelper","updateHelper","_showTooltip","_hideTooltip","removeHelper","dataFunc","keyFunc","val1","val2","tt","subtt","bg","bbox","getBBox","centerPoints","side","newLegend","_toggleList","base","items","newItems","it","cos","sin","dataForVisualization","axisKey","valKey","polygKey","axesHash","scVal","fun","_calcDomains","Scatter","fontColor","magnitude","radiusRange","magnitudeRange","figureType","regression","xr","yr","xMean","yMean","b1","b0","term1","term2","p","yhat","radiusMinMax","magnitudeMinMax","scaleDomain","Spineplot","orientation","category","x0","x1","stackValues","totalCollapse","stack","txpe","currentWidth","cat","groups","Timeline","_line","_area","alreadyScaled","scaleColor","series","arr","_lines","_xMinMax","_yMinMax","dots","Treemap","_padding","_labels","parent","_size","arrayOfColors","nestBy","_keys","toString","warning","_labelName","Boolean","isValidStructure","children","res","child","formatNestedData","nestKey","nest","nested","queue","nestedData","rollup","leaves","cloneDeep","err","treemap","tile","round","paddingInner","root","eachBefore","sum","cell","rect","replace"],"mappings":"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"}