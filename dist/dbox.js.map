{"version":3,"file":"dbox.js","sources":["../lib/helper.js","../lib/chart.js","../node_modules/@dboxjs/bars/bars.js","../node_modules/@dboxjs/distro/distrochart.js","../node_modules/@dboxjs/distro/distro.js","../node_modules/@dboxjs/heatmap/heatmap.js","../node_modules/@dboxjs/leaflet/leaflet.js","../node_modules/@dboxjs/map/map.js","../node_modules/@dboxjs/radar/radar.js","../node_modules/@dboxjs/scatter/scatter.js","../node_modules/@dboxjs/spineplot/spineplot.js","../node_modules/@dboxjs/timeline/timeline.js","../node_modules/@dboxjs/treemap/treemap.js","../index.js"],"sourcesContent":["import * as d3 from 'd3';\nvar d3Tip = require('d3-tip');\nvar _ = require('lodash');\n\nexport default function () {\n  var vm = this; // Hard binded to chart\n\n  var Helper = {\n    chart: {\n      config: vm._config,\n      width: vm._width,\n      height: vm._height,\n      style: vm._addStyle,\n      fullSvg: function () {\n        return vm._fullSvg;\n      },\n      svg: function () {\n        return vm._svg;\n      }\n    },\n    utils: {\n      d3: {}\n    }\n  };\n  Helper.utils.d3.tip = typeof d3Tip === 'function' ? d3Tip : d3Tip.default;\n\n  /**\n   * Generate scale based on data and config\n   * @param {*} data\n   * @param {*} config\n   * @returns\n   */\n  Helper.utils.generateScale = function (data, config) {\n    var scale = {};\n    var domains;\n    if (!config.range) {\n      throw 'Range is not defined';\n    }\n    // Used in bars.js when we want to create a groupBy or stackBy bar chart\n    if (config.groupBy && config.groupBy == 'parent') {\n      // Axis of type band\n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    } else if (config.stackBy && config.stackBy == 'parent') {\n      domains = data[0].map(function (d) {\n        return d.data[config.column];\n      });\n    } else if (config.groupBy == 'children') {\n      // GroupBy Columns\n      domains = config.column;\n    } else if (config.groupBy == 'data') {\n      // Considering the highest value on all the columns for each groupBy column\n      domains = [\n        0,\n        d3.max(data, function (d) {\n          return d3.max(config.column, function (column) {\n            return d[column];\n          });\n        })\n      ];\n    } else if (config.stackBy == 'data') {\n      // Using a d3.stack()\n      domains = [\n        0,\n        d3.max(data, function (serie) {\n          return d3.max(serie, function (d) {\n            return d[1];\n          });\n        })\n      ];\n    } else if (config.groupBy == undefined && config.type == 'band') {\n      // In case the axis is of type band and there is no groupby\n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    } else if (config.type === 'linear') {\n      // Axis of type numeric\n      if (config.minZero) {\n        domains = [\n          0,\n          d3.max(data, function (d) {\n            return +d[config.column];\n          })\n        ];\n      } else {\n        domains = d3.extent(data, function (d) {\n          return +d[config.column];\n        });\n      }\n    } else {\n      // Axis of type band\n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    }\n\n    if (config.domains && Array.isArray(config.domains)) {\n      domains = config.domains;\n    }\n\n    if (config.type) {\n      switch (config.type) {\n        case 'linear':\n          scale = d3\n            .scaleLinear()\n            .rangeRound(config.range)\n            .domain(domains)\n            .nice();\n          break;\n\n        case 'time':\n          scale = d3.scaleTime().range(config.range);\n          // .domain(domains);\n          break;\n\n        case 'ordinal':\n          scale = d3\n            .scaleBand()\n            .rangeRound(config.range)\n            .padding(0.1)\n            .domain(domains);\n          break;\n\n        case 'band':\n          scale = d3\n            .scaleBand()\n            .rangeRound(config.range)\n            .domain(domains)\n            .padding(0.1);\n          break;\n\n        case 'quantile':\n          scale = d3\n            .scaleBand()\n            .rangeRound(config.range)\n            .padding(0.1)\n            .domain(\n              data.map(function (d) {\n                return d[config.column];\n              })\n            );\n          if (!config.bins) {\n            config.bins = 10;\n          }\n          scale = d3.scaleQuantile().range(d3.range(config.bins));\n          break;\n\n        default:\n          scale = d3\n            .scaleLinear()\n            .rangeRound(config.range)\n            .domain(domains)\n            .nice();\n          break;\n      }\n    } else {\n      scale = d3\n        .scaleLinear()\n        .rangeRound(config.range)\n        .domain(domains)\n        .nice();\n    }\n\n    return scale;\n  };\n\n  /**\n   * Format numbers\n   * @param {Object} config - configurate current formatter\n   * @param {number} config.decimals - Quantity of decimals to use\n   * @param {string} config.axis - Current scale selected from axis ['xAxis', 'yAxis']\n   * @param {string} config.formatPreffix - Preffix to use in formatting. Eg. '$'\n   * @param {string} config.formatSuffix - Suffix to use in formatting. Eg. '%'\n   * @param {boolean} [smallNumber] - Display number in small format\n   * @returns Function configured to parse a number [d]\n   */\n  Helper.utils.format = function (config, smallNumber) {\n    if (!config) {\n      // Default config\n      var linearAxis =\n        vm._config.yAxis && vm._config.yAxis.scale === 'linear'\n          ? 'yAxis'\n          : vm._config.xAxis && vm._config.xAxis.scale === 'linear'\n            ? 'xAxis'\n            : '';\n      config = {\n        decimals: vm._config.decimals,\n        axis: linearAxis,\n        formatPreffix: vm._config.formatPreffix,\n        formatSuffix: vm._config.formatSuffix\n      };\n    }\n    return function (d) {\n      if (Number.isNaN(Number(d))) {\n        // d is not a number, return original value\n        return d;\n      }\n      var fullNumber = smallNumber ? false : true;\n      var floatingPoints = 1; // Default\n      if (config.decimals !== undefined && Number.isInteger(config.decimals)) {\n        floatingPoints = Number(config.decimals);\n      }\n      var value = '';\n      if (config.formatPreffix) {\n        value += config.formatPreffix;\n      }\n      var suffix = '';\n\n      if (smallNumber) {\n        var currentAxis = config.axis;\n        var mean = currentAxis\n          ? d3.mean(vm._scales[currentAxis.replace('Axis', '')].ticks())\n          : d;\n\n        if (mean >= 1000000000000) {\n          if (currentAxis) {\n            vm._config[currentAxis].scaleText = 'Billones';\n          } else {\n            suffix = ' billones';\n          }\n          d = d / 1000000000000;\n        } else if (mean >= 1000000000) {\n          // Thousands of millions\n          if (currentAxis) {\n            vm._config[currentAxis].scaleText = 'Miles de millones';\n          } else {\n            suffix = ' mil millones';\n          }\n          d = d / 1000000000;\n        } else if (mean >= 1000000) {\n          // Millions\n          if (currentAxis) {\n            vm._config[currentAxis].scaleText = 'Millones';\n          } else {\n            suffix = ' millones';\n          }\n          d = d / 1000000;\n        } else if (mean >= 10000) {\n          // Thousands\n          if (currentAxis) {\n            vm._config[currentAxis].scaleText = 'Miles';\n          } else {\n            suffix = ' mil';\n          }\n          d = d / 1000;\n        }\n      }\n\n      if (Number.isInteger(d)) {\n        value += d3.format(',.0f')(d);\n      } else if (d > 1) {\n        value += d3.format(',.' + floatingPoints + 'f')(d);\n      } else {\n        var floats = d.toString().split('.')[1];\n        var points = 1;\n        if (floats) {\n          for (let index = 0; index < floats.length; index++) {\n            const number = Number(floats[index]);\n            if (number === 0) {\n              points += 1;\n            } else {\n              break;\n            }\n          }\n          value += d3.format(',.' + points + 'f')(d);\n        }\n      }\n      value += suffix;\n\n      if (config.formatSuffix && value.indexOf(config.formatSuffix) < 0) {\n        value += config.formatSuffix;\n      }\n      return value;\n    };\n  };\n\n  // wrap function used in x axis labels\n  Helper.utils.wrap = function (text, width, tooltip) {\n    text.each(function () {\n      var text = d3.select(this),\n        words = text\n          .text()\n          .split(/\\s+/)\n          .reverse(),\n        word,\n        line = [],\n        lineNumber = 0,\n        lineHeight = 1.1, // ems\n        y = text.attr('y'),\n        dy = parseFloat(text.attr('dy')) || 0,\n        tspan = text\n          .text(null)\n          .append('tspan')\n          .attr('x', 0)\n          .attr('y', y)\n          .attr('dy', dy + 'em');\n\n      while ((word = words.pop())) {\n        line.push(word);\n        tspan.text(line.join(' '));\n        if (tspan.node().getComputedTextLength() > width) {\n          line.pop();\n          tspan.text(line.join(' '));\n          line = [word];\n          tspan = text\n            .append('tspan')\n            .attr('x', 0)\n            .attr('y', y)\n            .attr('dy', ++lineNumber * lineHeight + dy + 'em')\n            .text(word);\n\n          if (lineNumber > 0) {\n            if (\n              words.length > 0 &&\n              tspan.node().getComputedTextLength() > width\n            ) {\n              if (tooltip) {\n                text.on('mouseover', tooltip.show).on('mouseout', tooltip.hide);\n              }\n              let i = 1;\n              while (tspan.node().getComputedTextLength() > width) {\n                tspan.text(function () {\n                  return tspan.text().slice(0, -i) + '...';\n                });\n                ++i;\n              }\n            }\n            words = [];\n          } else {\n            let i = 1;\n            while (tspan.node().getComputedTextLength() > width) {\n              tspan.text(function () {\n                return tspan.text().slice(0, -i) + '...';\n              });\n              ++i;\n            }\n          }\n        }\n      }\n    });\n  };\n\n  Helper.utils.sortAscending = function (a, b) {\n    if (!Number.isNaN(+a) && !Number.isNaN(+b)) {\n      // If both values are numbers use numeric value\n      return Number(a) - Number(b);\n    } else if (!Number.isNaN(+a) && Number.isNaN(+b)) {\n      return -1;\n    } else if (Number.isNaN(+a) && !Number.isNaN(+b)) {\n      return 1;\n    } else if (a <= b) {\n      return -1;\n    } else {\n      return 1;\n    }\n  };\n\n  Helper.utils.sortDescending = function (a, b) {\n    if (!Number.isNaN(+b) && !Number.isNaN(+a)) {\n      // If both values are numbers use numeric value\n      return Number(b) - Number(a);\n    } else if (!Number.isNaN(+b) && Number.isNaN(+a)) {\n      return -1;\n    } else if (Number.isNaN(+b) && !Number.isNaN(+a)) {\n      return 1;\n    } else if (b <= a) {\n      return -1;\n    } else {\n      return 1;\n    }\n  };\n\n  Helper.utils.VirtualScroller = function () {\n    var enter = null,\n      update = null,\n      exit = null,\n      data = [],\n      dataid = null,\n      svg = null,\n      viewport = null,\n      totalRows = 0,\n      position = 0,\n      rowHeight = 30,\n      totalHeight = 0,\n      viewportHeight = 0,\n      visibleRows = 0,\n      delta = 0,\n      lineNumber = 0,\n      lineHeight = 0.7, //ems\n      scrollTop = 0;\n\n    function virtualscroller(container) {\n      function render(resize) {\n        if (resize) {\n          /*\n           * Tested values:\n           * 240 -> 9 rows\n           * 170 ->13 rows\n           */\n          viewportHeight = parseInt(viewport.style('height')) - 170;\n          visibleRows = Math.ceil(viewportHeight / rowHeight);\n        }\n        var lastPosition = position;\n        if (position < data.length && position >= 0 && scrollTop < 0) {\n          position += 1;\n        } else if (position <= data.length && position > 0 && scrollTop > 0) {\n          position -= 1;\n        }\n        delta = position - lastPosition;\n        scrollRenderFrame(position);\n      }\n\n      function scrollRenderFrame(scrollPosition) {\n        var position0 = Math.max(\n          0,\n          Math.min(scrollPosition, totalRows - visibleRows + 1)\n        ),\n          position1 = position0 + visibleRows;\n        container.each(function () {\n          var rowSelection = container\n            .selectAll('.legend-checkbox')\n            .data(\n              data.slice(position0, Math.min(position1, totalRows)),\n              dataid\n            );\n          rowSelection\n            .exit()\n            .call(exit)\n            .remove();\n          rowSelection\n            .enter()\n            .append('g')\n            .attr('class', 'legend-checkbox legend')\n            .attr('random', function (d) {\n              return d;\n            })\n            .call(enter)\n            .attr('transform', function (d, i) {\n              return (\n                'translate(0,' +\n                (vm._config.legendTitle && lineNumber > 1\n                  ? lineNumber * lineHeight + i\n                  : 1 + i) *\n                21 +\n                ')'\n              );\n            })\n            .on('click', function (d) {\n              // Run the custom function\n              var i = data.findIndex(x => x.name == d.name);\n              if (typeof vm._config.events.onClickLegend === 'function') {\n                vm._config.events.onClickLegend.call(this, d, i);\n              }\n              d3.event.stopPropagation();\n            });\n\n          rowSelection.order();\n          var rowUpdateSelection = container.selectAll('.legend-checkbox');\n\n          rowUpdateSelection.call(update);\n\n          rowUpdateSelection.each(function (d, i) {\n            d3.select(this)\n              .attr('font-weight', 'bold')\n              .attr('transform', function (d) {\n                return (\n                  'translate(0,' +\n                  (vm._config.legendTitle && lineNumber > 1\n                    ? lineNumber * lineHeight + i\n                    : 1 + i) *\n                  21 +\n                  ')'\n                );\n              });\n          });\n\n          /* d3.select('.legendBox')\n            .append('rect')\n            .attr('width', '160px')\n            .attr('height', rowHeight/2 + 'px')\n            .attr('transform', 'translate(0,' + (legendBoxBackgroundHeight - (rowHeight/2)) + ')')\n            .style('fill', 'white'); */\n        });\n      }\n\n      virtualscroller.render = render;\n      let isFirefox = typeof InstallTrigger !== 'undefined';\n      let support =\n        'onwheel' in d3.select('.legendBox')\n          ? 'wheel' // Modern browsers support \"wheel\"\n          : document.onmousewheel !== undefined\n            ? 'mousewheel' // Webkit and IE support at least \"mousewheel\"\n            : 'wheel'; // let's assume that remaining browsers are older Firefox\n      d3.select('.legendBox').on(support, function () {\n        // isFirefox ? 'wheel' : 'mousewheel.zoom'\n        //Chrome & IE: mousewheel.zoom | Firefox: DOMMouseScroll (not supported yet).\n        var evt = d3.event;\n        evt.preventDefault();\n        scrollTop = isFirefox ? evt.deltaY : evt.wheelDelta;\n        render(true);\n      });\n      render(true);\n      drawScrollLegend(visibleRows);\n    }\n\n    function drawScrollLegend(visibleRows) {\n      var scrollLegend = d3\n        .select('.legendBox')\n        .append('g')\n        .attr('class', 'scroll-legend')\n        .append('text')\n        .attr('transform', `translate(0,${visibleRows * 25})`);\n\n      scrollLegend\n        .append('tspan')\n        .attr('class', 'material-icons expand-more')\n        .text('mouse');\n\n      scrollLegend\n        .append('tspan')\n        .attr('x', 30)\n        .attr('y', -12)\n        .text('Desplázate con el');\n\n      scrollLegend\n        .append('tspan')\n        .attr('x', 60)\n        .attr('y', -1)\n        .text('cursor');\n\n      if (totalRows < visibleRows) {\n        d3.selectAll('.scroll-legend').style('display', 'none');\n      } else {\n        d3.selectAll('.scroll-legend').style('display', 'flex');\n      }\n    }\n\n    virtualscroller.render = function (resize) { };\n\n    virtualscroller.data = function (_, __) {\n      if (!arguments.length) return data;\n      data = _;\n      dataid = __;\n      return virtualscroller;\n    };\n\n    virtualscroller.dataid = function (_) {\n      if (!arguments.length) return dataid;\n      dataid = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.enter = function (_) {\n      if (!arguments.length) return enter;\n      enter = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.update = function (_) {\n      if (!arguments.length) return update;\n      update = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.exit = function (_) {\n      if (!arguments.length) return exit;\n      exit = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.totalRows = function (_) {\n      if (!arguments.length) return totalRows;\n      totalRows = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.rowHeight = function (_) {\n      if (!arguments.length) return rowHeight;\n      rowHeight = +_;\n      return virtualscroller;\n    };\n\n    virtualscroller.totalHeight = function (_) {\n      if (!arguments.length) return totalHeight;\n      totalHeight = +_;\n      return virtualscroller;\n    };\n\n    virtualscroller.position = function (_) {\n      if (!arguments.length) return position;\n      position = +_;\n      if (viewport) {\n        viewport.node().scrollTop = position;\n      }\n      return virtualscroller;\n    };\n\n    virtualscroller.svg = function (_) {\n      if (!arguments.length) return svg;\n      svg = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.viewport = function (_) {\n      if (!arguments.length) return viewport;\n      viewport = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.delta = function () {\n      return delta;\n    };\n\n    virtualscroller.legendTitle = function (_) {\n      return legendTitle;\n    };\n\n    virtualscroller.lineNumber = function (_) {\n      if (!arguments.length) return lineNumber;\n      lineNumber = _;\n      return virtualscroller;\n    };\n\n    const rebind = function (target, source) {\n      var i = 1,\n        n = arguments.length,\n        method;\n      while (++i < n)\n        target[(method = arguments[i])] = d3_rebind(\n          target,\n          source,\n          source[method]\n        );\n      return target;\n    };\n\n    // Method is assumed to be a standard D3 getter-setter:\n    // If passed with no arguments, gets the value.\n    // If passed with arguments, sets the value and returns the target.\n    function d3_rebind(target, source, method) {\n      return function () {\n        var value = method.apply(source, arguments);\n        return value === source ? target : value;\n      };\n    }\n\n    return virtualscroller;\n  };\n\n  return Helper;\n}\n","import Helper from './helper.js';\n\nimport * as d3 from 'd3';\nimport * as _ from 'lodash';\n\n/**\n * Dbox Chart core\n */\n\n/**\n * Creates a chart type object\n * @constructor\n * @param {Object} config - Object with params to set chart size, xAxis and yAxis properties\n */\n\nexport default function Chart(config) {\n  var Chart = {};\n  // Internet Explorer 6-11\n  var isIE;\n  try {\n    isIE = /*@cc_on!@*/ false || (document && !!document.documentMode);\n  } catch (err) {\n    isIE = false;\n  }\n  // Edge 20+\n  var isEdge;\n  try {\n    isEdge = !isIE && window && !!window.StyleMedia;\n  } catch (err) {\n    isEdge = false;\n  }\n\n  /**\n   * Initialize chart object configuration\n   * @param {Object} config - Object with params to configure the chart (developer's configure)\n   */\n  Chart.init = function (config) {\n    var vm = this;\n\n    /**\n     * Set default size and default margins\n     * for chart container (SVG)\n     */\n    var defaultConfig = {\n      size: {\n        width: 800,\n        height: 600,\n        margin: {\n          left: 0,\n          right: 0,\n          top: 0,\n          bottom: 0\n        }\n      }\n    };\n\n    var defaultStyle = {\n      chart: {\n        backgroundColor: {\n          color: 'transparent'\n          // linearGradient : { x1: 0, y1: 0, x2: 1, y2: 1 },\n          // stops: [ [0, '#FCFCFC'], [1, '#F3F2F2'] ]\n        }\n      },\n      title: {\n        textColor: '#E6B537',\n        fontSize: '30px',\n        fontWeight: 600,\n        textAlign: 'center',\n        hr: {\n          enabled: true,\n          borderWidth: '1px',\n          borderColor: '#fff'\n        }\n      },\n      legend: {\n        position: 'bottom',\n        figure: 'circle',\n        text: {\n          textColor: '#fff',\n          fontSize: '12px',\n          fontWeight: 600\n        }\n      },\n      tooltip: {\n        backgroundColor: '#757575',\n        opacity: 0.9,\n        text: {\n          textColor: '#fff',\n          fontSize: '12px',\n          fontWeight: 600,\n          textAlign: 'center',\n          fontFamily: 'sans-serif',\n          padding: '0.8em'\n        },\n        border: {\n          color: '#5A5C5D',\n          radius: '5px',\n          width: '1px'\n        }\n      },\n      yAxis: {\n        enabled: true,\n        axis: {\n          strokeWidth: 3,\n          strokeColor: '#5F6C6C',\n          strokeOpacity: 0,\n          paddingTick: 0\n        },\n        ticks: {\n          strokeWidth: 3,\n          strokeColor: '#929D9E',\n          grid: 'dashed',\n          gridDashed: '3, 5',\n          opacity: 0.6\n        },\n        labels: {\n          fontSize: 12,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'end'\n        },\n        title: {\n          fontSize: 17,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'middle'\n          // rotation\n          // text align or position\n        }\n      },\n      xAxis: {\n        enabled: true,\n        axis: {\n          strokeWidth: 3,\n          strokeColor: '#5F6C6C',\n          strokeOpacity: 1, //???\n          paddingTick: 5\n        },\n        ticks: {\n          strokeWidth: 1,\n          strokeColor: '#5F6C6C'\n          // ticksize\n        },\n        labels: {\n          fontSize: 12,\n          fontWeight: 400,\n          textColor: '#fff',\n          textAnchor: 'middle'\n        },\n        title: {\n          fontSize: 17,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'middle'\n          // text align\n        }\n      }\n    };\n\n    /**\n     * Clone recursively the config object if it has content.\n     * Keep default configuration in other case.\n     */\n    vm._config = config ? _.cloneDeep(config) : defaultConfig;\n\n    if (vm._config.xAxis) {\n      vm._config.xAxis.axis = 'xAxis';\n      /**\n       * @deprecated Allow to use general config if axis-based is not especified\n       */\n      if (\n        vm._config.xAxis.decimals === undefined &&\n        vm._config.decimals !== undefined\n      ) {\n        vm._config.xAxis.decimals = vm._config.decimals;\n      }\n      if (\n        vm._config.xAxis.formatPreffix === undefined &&\n        vm._config.formatPreffix !== undefined\n      ) {\n        vm._config.xAxis.formatPreffix = vm._config.formatPreffix;\n      }\n      if (\n        vm._config.xAxis.formatSuffix === undefined &&\n        vm._config.formatSuffix !== undefined\n      ) {\n        vm._config.xAxis.formatSuffix = vm._config.formatSuffix;\n      }\n    }\n    if (vm._config.yAxis) {\n      vm._config.yAxis.axis = 'yAxis';\n      /**\n       * @deprecated Allow to use general config if axis-based is not especified\n       */\n      if (\n        vm._config.yAxis.decimals === undefined &&\n        vm._config.decimals !== undefined\n      ) {\n        vm._config.yAxis.decimals = vm._config.decimals;\n      }\n      if (\n        vm._config.yAxis.formatPreffix === undefined &&\n        vm._config.formatPreffix !== undefined\n      ) {\n        vm._config.yAxis.formatPreffix = vm._config.formatPreffix;\n      }\n      if (\n        vm._config.yAxis.formatSuffix === undefined &&\n        vm._config.formatSuffix !== undefined\n      ) {\n        vm._config.yAxis.formatSuffix = vm._config.formatSuffix;\n      }\n    }\n    // Initialize data array\n    vm._data = [];\n\n    // Define margin sizes and styles\n    vm._margin = vm._config.size.margin;\n    vm._addStyle = vm._config.addStyle ? vm._config.addStyle : defaultStyle;\n\n    // Define width and height\n    vm._width = vm._config.size.width - vm._margin.left - vm._margin.right;\n    vm._height = vm._config.size.height - vm._margin.top - vm._margin.bottom;\n    vm._svg = '';\n    vm._scales = {};\n    vm._axes = {};\n\n    // Public\n    vm.layers = [];\n\n    // Helper data/functions for layers to use\n    vm.helper = Helper.bind(vm)();\n  };\n\n  //------------------------\n  //User\n  /**\n   * User can set config object using this method\n   * @param {Object} config - Objec with params to configure the chart (user's configure)\n   */\n  Chart.config = function (config) {\n    var vm = this;\n    vm._config = _.cloneDeep(config);\n    return vm;\n  };\n\n  /**\n   * User can set size of the chart using this method\n   * @param {object} sizeObj - Size object\n   * @param {number} [sizeObj.height] - Height of the chart\n   * @param {number} [sizeObj.width] - Width of the chart\n   * @param {object} [sizeObj.margin] - Margins of the chart\n   * @param {number} [sizeObj.margin.top] - Margin top of the chart\n   * @param {number} [sizeObj.margin.right] - Margin right of the chart\n   * @param {number} [sizeObj.margin.bottom] - Margin bottom of the chart\n   * @param {number} [sizeObj.margin.left] - Margin left of the chart\n   */\n  Chart.size = function (sizeObj) {\n    var vm = this;\n    if (sizeObj) {\n      if (sizeObj.margin) {\n        if (sizeObj.margin.left == Number(sizeObj.margin.left)) {\n          vm._config.size.margin.left = sizeObj.margin.left;\n          vm._margin.left = sizeObj.margin.left;\n        }\n        if (sizeObj.margin.right == Number(sizeObj.margin.right)) {\n          vm._config.size.margin.right = sizeObj.margin.right;\n          vm._margin.right = sizeObj.margin.right;\n        }\n        if (sizeObj.margin.top == Number(sizeObj.margin.top)) {\n          vm._config.size.margin.top = sizeObj.margin.top;\n          vm._margin.top = sizeObj.margin.top;\n        }\n        if (sizeObj.margin.bottom == Number(sizeObj.margin.bottom)) {\n          vm._config.size.margin.bottom = sizeObj.margin.bottom;\n          vm._margin.bottom = sizeObj.margin.bottom;\n        }\n      }\n      if (sizeObj.width == Number(sizeObj.width)) {\n        vm._config.size.width = sizeObj.width;\n        vm._width = sizeObj.width;\n      }\n      if (sizeObj.height == Number(sizeObj.height)) {\n        vm._config.size.height = sizeObj.height;\n        vm._height = sizeObj.height;\n      }\n    }\n    return vm;\n  };\n\n  /**\n   * User can set a personalized style object\n   * @param {object} stylesObj\n   */\n  Chart.addStyle = function (stylesObj) {\n    var vm = this;\n    if (stylesObj) {\n      vm._addStyle = stylesObj;\n    }\n    return vm;\n  };\n\n  /**\n   * Set if background grid is enabled and should be drawn\n   * @param {boolean} enabled - Grid status\n   */\n  Chart.grid = function (enabled) {\n    var vm = this;\n    vm._config.grid = enabled ? true : false;\n    return vm;\n  };\n\n  /**\n   * Set selector of HTML node to embed the whole chart\n   * @param {string} selector - HTML node selector\n   */\n  Chart.bindTo = function (selector) {\n    var vm = this;\n    vm._config.bindTo = selector;\n    return vm;\n  };\n\n  /**\n   * Set data to be used in chart\n   * @param {Object[]} data - Data structure to be used\n   */\n  Chart.data = function (data) {\n    var vm = this;\n    if (vm._config.data !== undefined) {\n      vm._config.data = Object.assign({}, vm._config.data, data);\n    } else {\n      vm._config.data = data;\n    }\n    return vm;\n  };\n\n  /**\n   * Set configuration for legend\n   * @param {Object} legend - Legend configuration\n   */\n  Chart.legend = function (legend) {\n    var vm = this;\n    vm._config.legend = legend;\n    return vm;\n  };\n\n  Chart.legendType = function (legendType) {\n    var vm = this;\n    vm._config.legendType = legendType;\n    return vm;\n  };\n\n  Chart.legendTitle = function (legendTitle) {\n    var vm = this;\n    vm._config.legendTitle = legendTitle;\n    return vm;\n  };\n\n  Chart.layer = function (_layer, _config) {\n    var vm = this;\n    var layer;\n    var config = _config ? _config : vm._config;\n    if (_layer === undefined && _layer === null) {\n      //@Todo Throw Error\n    } else {\n      layer = _layer(config, vm.helper);\n      vm.layers.push(layer);\n      return layer;\n    }\n  };\n\n  Chart.getLayer = function (layerIndex) {\n    var vm = this;\n    return vm.layers[layerIndex];\n  };\n\n  Chart.draw = function () {\n    var vm = this,\n      q;\n    vm._scales = vm.scales();\n    //vm._axes   = vm.axes(); CALL THE AXES AFTER DATA LOADING IN ORDER TO UPDATE THE DOMAINS OF THE SCALES\n\n    q = vm.loadData();\n\n    q.awaitAll(function (error, results) {\n      if (error) throw error;\n\n      if (Array.isArray(results) && results.length == 1) {\n        vm._data = results[0];\n      } else {\n        vm._data = results;\n      }\n\n      vm.initLayers();\n      vm.drawSVG();\n\n      //@TODO, ONE MAIN AXES THEN ADD THE POSSIBILITY FOR THE LAYER TO OVERRIDE\n      vm._axes = vm.axes();\n      vm.drawAxes();\n\n      //Draw layers after axes\n      vm.drawLayers();\n\n      //Trigger load chart event\n      if (vm._config.events && vm._config.events.load) {\n        vm.dispatch.on('load.chart', vm._config.events.load(vm));\n      }\n    });\n    return vm;\n  };\n\n  Chart.addStyle = function (theme) {\n    var vm = this;\n    vm._addStyle = theme;\n    return vm;\n  };\n\n  //----------------------\n  // Helper functions\n  Chart.scales = function () {\n    var vm = this;\n\n    var scales = {};\n    // xAxis scale\n    if (vm._config.xAxis && vm._config.xAxis.scale) {\n      switch (vm._config.xAxis.scale) {\n        case 'linear':\n          scales.x = d3.scaleLinear().range([0, vm._width]);\n          break;\n\n        case 'time':\n          scales.x = d3.scaleTime().range([0, vm._width]);\n          break;\n\n        case 'ordinal':\n          scales.x = d3.scaleOrdinal().range([0, vm._width], 0.1);\n          break;\n\n        case 'band':\n          scales.x = d3\n            .scaleBand()\n            .rangeRound([0, vm._width])\n            .padding(0.1);\n          break;\n\n        case 'quantile':\n          scales.x = d3.scaleOrdinal().range([0, vm._width], 0.1);\n\n          scales.q = d3\n            .scaleQuantile()\n            .range(d3.range(vm._config.xAxis.buckets));\n          break;\n\n        default:\n          scales.x = d3.scaleLinear().range([0, vm._width]);\n          break;\n      }\n    } else {\n      scales.x = d3.scaleLinear().range([0, vm._width]);\n    }\n\n    //yAxis scale\n    if (vm._config.yAxis && vm._config.yAxis.scale) {\n      switch (vm._config.yAxis.scale) {\n        case 'linear':\n          scales.y = d3.scaleLinear().range([vm._height, 0]);\n          break;\n\n        case 'time':\n          scales.y = d3.scaleTime().range([vm._height, 0]);\n          break;\n\n        case 'ordinal':\n          scales.y = d3.scaleOrdinal().range([vm._height, 0], 0.1);\n          break;\n\n        case 'band':\n          scales.y = d3\n            .scaleBand()\n            .rangeRound([vm._height, 0])\n            .padding(0.1);\n          break;\n\n        case 'quantile':\n          scales.y = d3.scaleOrdinal().range([0, vm._width], 0.1);\n\n          scales.q = d3\n            .scaleQuantile()\n            .range(d3.range(vm._config.yAxis.buckets));\n          break;\n\n        default:\n          scales.y = d3.scaleLinear().range([vm._height, 0]);\n          break;\n      }\n    } else {\n      scales.y = d3.scaleLinear().range([vm._height, 0]);\n    }\n\n    scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n    if (vm._config.legend && vm._config.legend.length > 0) {\n      scales.color.domain(vm._config.legend.map(o => o.name));\n    }\n\n    return scales;\n  };\n\n  Chart.setScales = function () { };\n\n  Chart.axes = function () {\n    var vm = this,\n      axes = {};\n    axes.x = d3.axisBottom(vm._scales.x);\n    axes.y = d3.axisLeft(vm._scales.y);\n\n    //remove corners in axis line\n    axes.x.tickSizeOuter(0);\n    axes.y.tickSizeOuter(0);\n\n    //Replaced with *addStyle -check\n    if (\n      vm._config.xAxis &&\n      vm._config.xAxis.ticks &&\n      vm._config.xAxis.ticks.enabled === true &&\n      vm._config.xAxis.ticks.style\n    ) {\n      switch (vm._config.xAxis.ticks.style) {\n        case 'straightLine':\n          axes.x.tickSize(-vm._height, 0);\n          break;\n        case 'dashLine':\n          axes.x.tickSize(-vm._width, 0);\n          break;\n      }\n    }\n    //addStyle\n    if (vm._addStyle.xAxis.ticks.grid) {\n      switch (vm._addStyle.xAxis.ticks.grid) {\n        case 'straight':\n          axes.y\n            .tickSize(-vm._width, 0);\n          break;\n        case 'dashed':\n          axes.y\n            .tickSize(-vm._width, 0);\n          break;\n      }\n    }\n\n    if (\n      vm._config.xAxis &&\n      vm._config.xAxis.ticks &&\n      vm._config.xAxis.ticks.ticks\n    ) {\n      axes.x.ticks(vm._config.xAxis.ticks.ticks);\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.ticks && vm._config.xAxis.ticks.values) {\n      axes.x.tickValues(vm._config.xAxis.ticks.values);\n    }\n\n    if (\n      vm._config.xAxis &&\n      vm._config.xAxis.ticks &&\n      vm._config.xAxis.scale === 'linear'\n    ) {\n      vm._scales.x.domain()[1];\n      axes.x.tickFormat(vm.helper.utils.format(vm._config.xAxis, true));\n    }\n    if (\n      vm._config.xAxis &&\n      vm._config.xAxis.ticks &&\n      vm._config.xAxis.ticks.format\n    ) {\n      axes.x.tickFormat(vm._config.xAxis.ticks.format);\n    }\n\n    //Replaced with *addStyle -check\n    if (\n      vm._config.yAxis &&\n      vm._config.yAxis.ticks &&\n      vm._config.yAxis.ticks.enabled === true &&\n      vm._config.yAxis.ticks.style\n    ) {\n      switch (vm._config.yAxis.ticks.style) {\n        case 'straightLine':\n          axes.y\n            .tickSize(-vm._width, 0);\n          break;\n        case 'dashLine':\n          axes.y\n            .tickSize(-vm._width, 0);\n          break;\n      }\n    }\n    // addStyle\n    if (vm._addStyle.yAxis.ticks.grid) {\n      switch (vm._addStyle.yAxis.ticks.grid) {\n        case 'straight':\n          axes.y\n            .tickSize(-vm._width, 0);\n          break;\n        case 'dashed':\n          axes.y\n            .tickSize(-vm._width, 0);\n          break;\n      }\n    }\n    if (\n      vm._config.yAxis &&\n      vm._config.yAxis.ticks &&\n      vm._config.yAxis.scale === 'linear'\n    ) {\n      axes.y.tickFormat(vm.helper.utils.format(vm._config.yAxis, true));\n    }\n    if (\n      vm._config.yAxis &&\n      vm._config.yAxis.ticks &&\n      vm._config.yAxis.ticks.format\n    ) {\n      axes.y.tickFormat(vm._config.yAxis.ticks.format);\n    }\n    if (\n      vm._config.yAxis &&\n      vm._config.yAxis.ticks &&\n      vm._config.yAxis.ticks.ticks\n    ) {\n      axes.y.ticks(vm._config.yAxis.ticks.ticks);\n    }\n    return axes;\n  };\n\n  Chart.loadData = function () {\n    var vm = this;\n    var q;\n\n    if (vm._config.data.tsv) {\n      q = d3.queue().defer(d3.tsv, vm._config.data.tsv);\n    }\n\n    if (vm._config.data.json) {\n      q = d3.queue().defer(d3.json, vm._config.data.json);\n    }\n\n    if (vm._config.data.csv) {\n      q = d3.queue().defer(d3.csv, vm._config.data.csv);\n    }\n\n    if (vm._config.data.raw) {\n      q = d3.queue().defer(vm.mapData, vm._config.data.raw);\n    }\n\n    if (\n      vm._config.map &&\n      vm._config.map.topojson &&\n      vm._config.map.topojson.url\n    ) {\n      q.defer(d3.json, vm._config.map.topojson.url);\n    }\n\n    return q;\n  };\n\n  Chart.initLayers = function () {\n    var vm = this;\n    vm.layers.forEach(function (ly) {\n      ly.data(vm._data).scales();\n\n      //@TODO validate domains from multiple layers\n      vm._scales = ly._scales;\n    });\n  };\n\n  Chart.drawSVG = function () {\n    var vm = this;\n\n    //Remove any previous svg\n    d3.select(vm._config.bindTo)\n      .select('svg')\n      .remove();\n    d3.select(vm._config.bindTo).html('');\n\n    //Add the css template class\n    if (vm._config.template) {\n      d3.select(vm._config.bindTo).classed(vm._config.template, true);\n    }\n\n    //Add title to the chart\n    if (vm._config && vm._config.title) {\n      d3.select(vm._config.bindTo)\n        .append('div')\n        .attr('class', 'chart-title')\n        .html(vm._config.title)\n        .style('display', 'flex')\n        .style('justify-content', 'center')\n        .style('align-items', 'center')\n        .style('font-size', vm._addStyle.title.fontSize)\n        .style('font-weight', vm._addStyle.title.fontWeight)\n        .style('color', vm._addStyle.title.textColor)\n        .style('text-align', vm._addStyle.title.textAlign);\n\n      if (vm._addStyle.title.hr.enabled) {\n        d3.select(vm._config.bindTo)\n          .append('hr')\n          .attr('class', 'hr-title')\n          .style('width', '80%')\n          .style('margin-left', '10%')\n          .style('margin-top', '0.5em')\n          .style('border-width', vm._addStyle.title.hr.borderWidth)\n          .style('border-color', vm._addStyle.title.hr.borderColor);\n      }\n    }\n\n    //Add Legend to the chart\n    //@TODO - PASS THE STYLES TO DBOX.CSS\n    //@TODO - ALLOW DIFFERENT POSSITIONS FOR THE LEGEND\n    if (\n      vm._config.legend &&\n      vm._config.legend.enabled === true &&\n      vm._config.legend.position === 'top'\n    ) {\n      var legend = d3\n        .select(vm._config.bindTo)\n        .append('div')\n        .attr('class', 'chart-legend-top');\n\n      var html = '';\n      html +=\n        '<div style=\"background-color:#E2E2E1;text-align:center;height: 40px;margin: 0px 15px\">';\n      vm._config.legend.categories.forEach(function (c) {\n        html +=\n          '<div class=\"dbox-legend-category-title\" style=\"margin:0 20px;\"><span class=\"dbox-legend-category-color\" style=\"background-color:' +\n          c.color +\n          ';\"> </span><span style=\"height: 10px;float: left;margin: 10px 5px 5px 5px;border-radius: 50%;\">' +\n          c.title +\n          '</span></div>';\n      });\n      html += '</div>';\n      legend.html(html);\n    }\n\n    const width = vm._width + vm._margin.left + vm._margin.right;\n    const height = vm._height + vm._margin.top + vm._margin.bottom;\n    //Create the svg\n    vm._fullSvg = d3\n      .select(vm._config.bindTo)\n      .append('svg')\n      .style(\n        'font-size',\n        vm._config.chart\n          ? vm._config.chart['font-size']\n            ? vm._config.chart['font-size']\n            : '12px'\n          : '12px'\n      )\n      .attr('width', width)\n      .attr('height', height)\n      .attr('viewBox', `0 0 ${width} ${height}`);\n\n    vm._svg = vm._fullSvg\n      .append('g')\n      .attr(\n        'transform',\n        'translate(' + vm._margin.left + ',' + vm._margin.top + ')'\n      );\n\n    // Call the tip function\n    /*if (vm._config.data.tip){\n      vm._svg.call(vm._tip);\n    }*/\n\n    //Apply background color\n\n    d3.select(vm._config.bindTo + ' svg').style(\n      'background-color',\n      vm._addStyle.chart.backgroundColor.color\n    );\n\n    // Legend for average lines\n    /*\n    d3.select(vm._config.bindTo).append('div')\n      .attr('class', 'chart-legend-bottom');\n    if (vm._config.plotOptions && vm._config.plotOptions.bars\n      && vm._config.plotOptions.bars.averageLines && Array.isArray(vm._config.plotOptions.bars.averageLines)\n      && vm._config.plotOptions.bars.averageLines.length >0 ){\n\n      d3.select(vm._config.bindTo).append('div')\n        .attr('class', 'container-average-lines')\n        .append('div')\n          .attr('class', 'legend-average-lines')\n        .html('Average Lines Controller')\n    }\n    */\n\n    if (\n      vm._config.hasOwnProperty('legend') &&\n      vm._config.legendEnabled === true\n    ) {\n      vm.drawLegend();\n    }\n  };\n\n  Chart.drawLayers = function () {\n    var vm = this;\n    vm.layers.forEach(function (ly) {\n      ly.draw();\n    });\n  };\n\n  /**\n   * Draw chart legends section\n   */\n  Chart.drawLegend = function () {\n    // Reference to chart object\n    var vm = this,\n      legendBox,\n      virtualScroller,\n      legendX = vm._config.size.width - vm._config.size.margin.right + 10,\n      marginTop = vm._config.size.margin.top + 10;\n    // Set color domain\n    if (!vm._scales.color && vm._config.colors) {\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    }\n    if (vm._config.legend && vm._config.legend.length > 0) {\n      vm._scales.color.domain(vm._config.legend.map(o => o.name));\n    }\n    //Create information tips for each legend\n    const legendTip = vm.helper.utils.d3.tip().html(d => {\n      return '<div class=\"title-tip\">' + (d.name || d) + '</div>';\n    });\n    vm._fullSvg.call(legendTip);\n\n    // Draw legend, defaults to right\n    legendBox = vm._fullSvg\n      .append('g')\n      .attr('class', 'legendBox')\n      .attr('transform', 'translate(' + legendX + ', ' + marginTop + ')')\n      .attr('width', vm._width)\n      .attr('height', vm._height);\n    // Add legends title (on top of legendBox)\n    if (vm._config.legendTitle) {\n      legendBox\n        .append('g')\n        .attr('width', '150px')\n        .append('text')\n        .attr('class', 'legend-title')\n        .attr('x', 5)\n        .style('font-weight', 'bold')\n        .text(vm._config.legendTitle);\n      // wrap legend title if text size exceeds 70% of container\n      let lWidth = vm._config.size.margin.right;\n      var text = d3.selectAll('.legend-title'),\n        words = text\n          .text()\n          .split(/\\s+/)\n          .reverse(),\n        word,\n        line = [],\n        lineNumber = 1,\n        lineHeight = 1.1, // ems\n        y = text.attr('y'),\n        dy = 0,\n        tspan = text\n          .text(null)\n          .append('tspan')\n          .attr('x', 0)\n          .attr('y', y)\n          .attr('dy', dy + 'em');\n      while ((word = words.pop())) {\n        line.push(word);\n        tspan.text(line.join(' '));\n        if (tspan.node().getComputedTextLength() > lWidth) {\n          line.pop();\n          tspan.text(line.join(' '));\n          line = [word];\n          ++lineNumber;\n          tspan = text\n            .append('tspan')\n            .attr('x', -6)\n            .attr('y', y)\n            .attr('dy', lineHeight + 'em')\n            .text(word);\n        }\n      }\n    }\n\n    //Label width\n    let lbWidth = vm._config.size.margin.right * 0.8;\n    if (vm._config.legendType === 'checkbox') {\n      //Size and position of every checkbox\n      let size = 18,\n        x = 0,\n        y = 0,\n        rx = 2,\n        ry = 2,\n        markStrokeWidth = 3;\n\n      vm._scales.color.domain(vm._config.legend.map(o => o.name));\n\n      var legendEnter = function (legendCheck) {\n        legendCheck\n          .append('rect')\n          .attr('width', size)\n          .attr('height', size)\n          .attr('x', x)\n          .attr('rx', rx)\n          .attr('ry', ry)\n          .attr('fill-opacity', 1);\n        let coordinates = [\n          {\n            x: x + size / 8,\n            y: y + size / 2\n          },\n          {\n            x: x + size / 2.2,\n            y: y + size - size / 4\n          },\n          {\n            x: x + size - size / 8,\n            y: y + size / 10\n          }\n        ];\n\n        let line = d3\n          .line()\n          .x(function (d) {\n            return d.x;\n          })\n          .y(function (d) {\n            return d.y;\n          });\n\n        //Mark (inside checkbox)\n        legendCheck\n          .append('path')\n          .attr('d', line(coordinates))\n          .attr('stroke-width', markStrokeWidth)\n          .attr('stroke', 'white')\n          .attr('fill', 'none')\n          .attr('class', 'mark')\n          .property('checked', function (d) {\n            // External function call. It must be after all the internal code; allowing the user to overide\n            return d.active;\n          })\n          .attr('opacity', function () {\n            if (d3.select(this).property('checked')) {\n              return 1;\n            } else {\n              return 0;\n            }\n          });\n\n        legendCheck\n          .append('text')\n          .attr('class', 'labelText')\n          .attr('x', 20)\n          .attr('y', 9)\n          .attr('dy', '.35em')\n          .attr('text-anchor', 'start');\n\n        legendCheck.select('rect').attr('fill', function (d) {\n          return vm._scales.color(d.name);\n        });\n\n        legendCheck.select('text').text(function (d) {\n          // External function call. It must be after all the internal code; allowing the user to overide\n          // External function call. It must be after all the internal code; allowing the user to overide\n          // External function call. It must be after all the internal code; allowing the user to overide\n          return d.name;\n        });\n\n        //cut label text if text size exceeds 80% of container\n        legendCheck.selectAll('text').each(function (d) {\n          if (typeof d.name === 'string') {\n            // getComputedTextLenght: Returns a float representing the computed length for the text within the element.\n            if (this.getComputedTextLength() > lbWidth) {\n              d3.select(this)\n                .attr('title', d.name)\n                .on('mouseover', legendTip.show)\n                .on('mouseout', legendTip.hide);\n              let i = 1;\n              while (this.getComputedTextLength() > lbWidth) {\n                d3.select(this).text(function (d) {\n                  return d['name'].slice(0, -i) + '...';\n                });\n                ++i;\n              }\n            } else {\n              return d;\n            }\n          }\n        });\n      }; //legendEnter ends\n\n      // Let scroll legendBox from anywhere inside g container\n      legendBox\n        .append('rect')\n        .attr('class', 'legendBoxBackground')\n        .attr('width', '160px')\n        .attr('height', '90%')\n        .attr('transform', 'translate(0,0)')\n        .style('fill', 'transparent');\n\n      var legendUpdate = function (legendCheck) {\n        legendCheck.select('rect').attr('fill', function (d) {\n          return vm._scales.color(d.name);\n        });\n\n        legendCheck.select('text').text(function (d) {\n          // External function call. It must be after all the internal code; allowing the user to overide\n          // External function call. It must be after all the internal code; allowing the user to overide\n          // External function call. It must be after all the internal code; allowing the user to overide\n          return d.name;\n        });\n\n        legendCheck.selectAll('text').each(function (d) {\n          if (typeof d.name === 'string') {\n            // getComputedTextLenght: Returns a float representing the computed length for the text within the element.\n            if (this.getComputedTextLength() > lbWidth) {\n              d3.select(this)\n                .attr('title', d.name)\n                .on('mouseover', legendTip.show)\n                .on('mouseout', legendTip.hide);\n              let i = 1;\n              while (this.getComputedTextLength() > lbWidth) {\n                d3.select(this).text(function (d) {\n                  return d['name'].slice(0, -i) + '...';\n                });\n                ++i;\n              }\n            } else {\n              return d;\n            }\n          }\n        });\n      };\n\n      var legendExit = function (legendCheck) { };\n\n      virtualScroller = vm.helper.utils\n        .VirtualScroller()\n        .rowHeight(size)\n        .enter(legendEnter)\n        .update(legendUpdate)\n        .exit(legendExit)\n        .svg(vm._fullSvg)\n        .totalRows(vm._config.legend.length)\n        .viewport(d3.select('.empty-chart'))\n        .lineNumber(lineNumber);\n\n      virtualScroller.data(vm._config.legend, function (d) {\n        return d.name;\n      });\n      legendBox.call(virtualScroller);\n\n      //End of checkbox case\n    } else {\n      var legend;\n      if (vm._config.styles && vm._addStyle.legend.position === 'bottom') {\n        legend = legendBox\n          .selectAll('.legend')\n          .data(vm._config.legend)\n          .enter()\n          .append('g')\n          .attr('class', 'legend')\n          .attr('width', vm._width / (vm._config.legend.length + 1))\n          .attr('transform', function (d, i) {\n            //horizontal position\n            //what if there are too many legends?\n            return (\n              'translate(' +\n              (vm._width / (vm._config.legend.length + 1)) * i +\n              ',' +\n              (vm._config.legendTitle && lineNumber > 1\n                ? lineNumber * lineHeight\n                : 0) *\n              19 +\n              ')'\n            );\n          });\n      } else {\n        legend = legendBox\n          .selectAll('.legend')\n          .data(vm._config.legend)\n          .enter()\n          .append('g')\n          .attr('class', 'legend')\n          .attr('transform', function (d, i) {\n            return (\n              'translate(' +\n              5 +\n              ',' +\n              (vm._config.legendTitle && lineNumber > 1\n                ? lineNumber * lineHeight + i\n                : 1 + i) *\n              19 +\n              ')'\n            );\n          });\n      }\n\n      if (vm._addStyle.legend.figure === 'circle') {\n        legend\n          .append('circle')\n          .attr('cx', 2)\n          .attr('cy', 9)\n          .attr('r', 7)\n          .attr('stroke-width', 2)\n          .attr('stroke', function (d) {\n            return vm._scales.color(d.name);\n          })\n          .attr('fill', function (d) {\n            return vm._scales.color(d.name);\n          })\n          .attr('fill-opacity', 0.8);\n      } else {\n        legend\n          .append('rect')\n          .attr('x', 0)\n          .attr('width', 18)\n          .attr('height', 18)\n          .attr('fill', function (d) {\n            return vm._scales.color(d.name);\n          });\n      }\n\n      legend\n        .append('text')\n        .attr('x', 20)\n        .attr('y', 9)\n        .attr('dy', '.35em')\n        .attr('text-anchor', 'start')\n        .text(function (d) {\n          //External function call. It must be after all the internal code; allowing the user to overide\n          return d.name;\n        });\n\n      //cut label text if text size exceeds 80% of container\n      let lbWidth = vm._config.size.margin.right - 19;\n      legend.selectAll('text').each(function (d) {\n        if (typeof d.name === 'string') {\n          if (this.getComputedTextLength() > lbWidth) {\n            d3.select(this)\n              .attr('title', d.name)\n              .on('mouseover', legendTip.show)\n              .on('mouseout', legendTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > lbWidth) {\n              d3.select(this).text(function (d) {\n                return d['name'].slice(0, -i) + '...';\n              });\n              ++i;\n            }\n          } else {\n            return d;\n          }\n        }\n      });\n    }\n\n    /**\n     * Give some extra style\n     */\n\n    legendBox\n      .selectAll('.legend text')\n      .attr('fill', vm._addStyle.legend.text.textColor)\n      .attr('font-size', vm._addStyle.legend.text.fontSize)\n      .attr('font-weight', vm._addStyle.legend.text.fontWeight);\n\n    //Prevent default scrolling of all elements inside legendBox\n    let isFirefox = typeof InstallTrigger !== 'undefined';\n    let support =\n      'onwheel' in d3.select('.legendBox')\n        ? 'wheel' // Modern browsers support 'wheel'\n        : document.onmousewheel !== undefined\n          ? 'mousewheel' // Webkit and IE support at least 'mousewheel'\n          : 'DOMMouseScroll'; // let's assume that remaining browsers are older Firefox\n    if (isFirefox) {\n      // Newer Firefox versions support wheel events.\n      // DOMMouseScroll is not supported yet.\n      support = 'wheel';\n    }\n    d3.select('.legendBoxBackground').on(support, function () {\n      var evt = d3.event;\n      evt.preventDefault();\n    });\n\n    d3.select('.scroll-legend').on(support, function () {\n      var evt = d3.event;\n      evt.preventDefault();\n    });\n\n    legendBox.selectAll('text').on(support, function () {\n      var evt = d3.event;\n      evt.preventDefault();\n    });\n\n    legendBox.selectAll('rect').on(support, function () {\n      var evt = d3.event;\n      evt.preventDefault();\n    });\n\n    legendBox.selectAll('path').on(support, function () {\n      var evt = d3.event;\n      evt.preventDefault();\n    });\n  };\n\n  Chart.drawGrid = function () {\n    var vm = this;\n    return vm;\n  };\n\n  Chart.drawAxes = function () {\n    var vm = this;\n    var yAxis;\n\n    /**\n     * Draw axes depends on axes config and styles.\n     * Let's start with config.\n     */\n\n    //Axes tooltip\n    const axesTip = vm.helper.utils.d3.tip().html(d => {\n      return '<div class=\"title-tip\">' + d + '</div>';\n    });\n\n    if (\n      (!vm._config.yAxis ||\n        (vm._config.yAxis && vm._config.yAxis.enabled !== false)) &&\n      (!vm._config.xAxis ||\n        (vm._config.xAxis && vm._config.xAxis.enabled !== false))\n    ) {\n      vm._svg.call(axesTip);\n    }\n\n    /**\n     * Config axes\n     */\n\n    // y\n\n    if (\n      !vm._config.yAxis ||\n      (vm._config.yAxis && vm._config.yAxis.enabled !== false)\n    ) {\n      yAxis = vm._svg\n        .append('g')\n        .attr('class', 'y axis')\n        .call(vm._axes.y);\n\n      if (vm._config.yAxis && vm._config.yAxis.text) {\n        yAxis\n          .append('text')\n          .attr('class', 'axis-title')\n          .attr('y', -vm._margin.left * 0.7)\n          .attr('x', -vm._height / 2)\n          .attr('transform', 'rotate(-90)')\n          .attr('text-anchor', 'middle')\n          .text(vm._config.yAxis.text);\n      }\n\n      if (vm._config.yAxis && vm._config.yAxis.scaleText) {\n        yAxis\n          .append('text')\n          .attr('class', 'axis-scale-title')\n          .attr('y', -12)\n          .attr('x', -12)\n          .attr('font-weight', 'bold')\n          .attr('text-anchor', 'middle')\n          .text(vm._config.yAxis.scaleText);\n      }\n    }\n\n    if (\n      vm._config.yAxis.domain &&\n      vm._config.yAxis.domain.hasOwnProperty('enabled')\n    ) {\n      if (vm._config.yAxis.ticks) {\n        if (\n          vm._config.yAxis.domain.enabled === false &&\n          vm._config.yAxis.ticks.enabled === false\n        ) {\n          d3.select('g.y.axis .domain').remove();\n          d3.selectAll('g.y.axis .tick').remove();\n        } else if (\n          vm._config.yAxis.domain.enabled === false &&\n          vm._config.yAxis.ticks.enabled === true\n        ) {\n          d3.select('g.y.axis .domain').remove();\n          //d3.selectAll('g.y.axis .tick text').remove();\n        }\n      } else {\n        if (vm._config.yAxis.domain.enabled === false) {\n          d3.select('g.y.axis .domain').remove();\n          d3.selectAll('g.y.axis .tick').remove();\n        }\n      }\n    }\n\n    if (\n      !vm._config.yAxis ||\n      (vm._config.yAxis && vm._config.yAxis.enabled !== false)\n    ) {\n      // Add ellipsis to cut label text when too long\n      // for yAxis on the left\n      yAxis.selectAll('text').each(function (d) {\n        let element = this;\n        if (typeof d === 'string') {\n          if (this.getComputedTextLength() > 0.8 * vm._margin.left) {\n            d3.select(element)\n              .on('mouseover', axesTip.show)\n              .on('mouseout', axesTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > 0.8 * vm._margin.left) {\n              d3.select(this)\n                .text(function (d) {\n                  return d.slice(0, -i) + '...';\n                })\n                .attr('title', d);\n              ++i;\n            }\n          } else {\n            return d;\n          }\n        }\n      });\n    }\n\n    //Dropdown Y axis\n    if (\n      vm._config.yAxis &&\n      vm._config.yAxis.dropdown &&\n      vm._config.yAxis.dropdown.enabled === true\n    ) {\n      var yAxisDropDown = d3\n        .select(vm._config.bindTo)\n        .append('div')\n        .attr('class', 'dbox-yAxis-select')\n        .append('select')\n        .on('change', function () {\n          vm.updateAxis('y', this.value);\n        });\n\n      /*\n      .attr('style', function(){\n                              var x = -1*d3.select(vm._config.bindTo).node().getBoundingClientRect().width/2+ vm._chart._margin.left/4;\n                              var y = -1*d3.select(vm._config.bindTo).node().getBoundingClientRect().height/2;\n                              return 'transform: translate('+x+'px,'+y+'px) rotate(-90deg);'\n                            })\n      */\n\n      var x =\n        (-1 *\n          d3\n            .select(vm._config.bindTo)\n            .node()\n            .getBoundingClientRect().width) /\n        2 +\n        vm._margin.left / 2.5;\n      var y =\n        (-1 *\n          d3\n            .select(vm._config.bindTo)\n            .node()\n            .getBoundingClientRect().height) /\n        1.5;\n\n      if (vm._config.yAxis.dropdown.styles) {\n        var styles = vm._config.yAxis.dropdown.styles;\n        styles.display = 'block';\n        styles.transform = 'translate(' + x + 'px,' + y + 'px) rotate(-90deg)';\n        styles.margin = 'auto';\n        styles['text-align'] = 'center';\n        styles['text-align-last'] = 'center';\n\n        d3.select('.dbox-yAxis-select select').styles(styles);\n\n        d3.select('.dbox-yAxis-select select option').styles({\n          'text-align': 'left'\n        });\n      } else {\n        d3.select('.dbox-yAxis-select select').styles({\n          display: 'block',\n          transform: 'translate(' + x + 'px,' + y + 'px) rotate(-90deg)',\n          margin: 'auto',\n          'text-align': 'center',\n          'text-align-last': 'center'\n        });\n\n        d3.select('.dbox-yAxis-select select option').styles({\n          'text-align': 'left'\n        });\n      }\n\n      if (vm._config.yAxis.dropdown.options) {\n        yAxisDropDown\n          .selectAll('option')\n          .data(vm._config.yAxis.dropdown.options)\n          .enter()\n          .append('option')\n          .attr('class', function (d) {\n            return d.value;\n          })\n          .attr('value', function (d) {\n            return d.value;\n          })\n          .text(function (d) {\n            return d.title;\n          })\n          .property('selected', function (d) {\n            return d.selected;\n          });\n      } else {\n        console.log('No options present in config');\n      }\n    }\n\n    // y\n\n    /////////////////////////////\n\n    // x\n    if (\n      !vm._config.xAxis ||\n      (vm._config.xAxis && vm._config.xAxis.enabled !== false)\n    ) {\n      vm._xAxis = vm._svg\n        .append('g')\n        .attr('class', 'x axis')\n        .attr('transform', 'translate(0,' + vm._height + ')')\n        .call(vm._axes.x);\n\n      // Move axis domain line\n      if (vm._config.yAxis.scale === 'linear' && vm._scales.y.domain()[0] < 0) {\n        vm._xAxis\n          .select('.domain')\n          .attr(\n            'transform',\n            'translate(0,-' +\n            Math.abs(vm._scales.y.range()[0] - vm._scales.y(0)) +\n            ')'\n          );\n      }\n\n      //Do not show line if axis is disabled\n      if (vm._config.xAxis.line && vm._config.xAxis.line.enabled == false) {\n        vm._xAxis.selectAll('path').style('display', 'none');\n      }\n\n      //Set custom position for ticks\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.x) {\n        vm._xAxis.selectAll('text').attr('dx', vm._config.xAxis.ticks.x);\n      }\n\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.y) {\n        vm._xAxis.selectAll('text').attr('dy', vm._config.xAxis.ticks.y);\n      }\n\n      //Disable ticks when set to false\n      if (\n        vm._config.xAxis.ticks &&\n        vm._config.xAxis.ticks.line &&\n        vm._config.xAxis.ticks.line.enabled === false\n      ) {\n        vm._xAxis.selectAll('line').style('display', 'none');\n      }\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.text) {\n      vm._svg\n        .select('.x.axis')\n        .append('text')\n        .attr('class', 'axis-title')\n        .attr('x', vm._width / 2)\n        .attr('y', 40)\n        .style('text-anchor', 'middle')\n        .text(vm._config.xAxis.text);\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.scaleText && vm._xAxis) {\n      vm._xAxis\n        .append('text')\n        .attr('class', 'axis-scale-title')\n        .attr('x', vm._width)\n        .attr('y', 15)\n        .style('text-anchor', 'start')\n        .text(vm._config.xAxis.scaleText);\n    }\n\n    if (\n      vm._config.xAxis.domain !== undefined &&\n      vm._config.xAxis.domain.hasOwnProperty('enabled')\n    ) {\n      if (vm._config.xAxis.ticks) {\n        if (\n          vm._config.xAxis.domain.enabled === false &&\n          vm._config.xAxis.ticks.enabled === false\n        ) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          d3.selectAll('g.x.axis .tick').remove();\n        } else if (\n          vm._config.xAxis.domain.enabled === false &&\n          vm._config.xAxis.ticks.enabled === true\n        ) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          //d3.selectAll('g.x.axis .tick text').remove();\n        }\n      } else {\n        if (vm._config.xAxis.domain.enabled === false) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          d3.selectAll(vm._config.bindTo + ' g.x.axis .tick').remove();\n        }\n      }\n    }\n\n    //Dropdown X axis\n    if (\n      vm._config.xAxis &&\n      vm._config.xAxis.dropdown &&\n      vm._config.xAxis.dropdown.enabled === true\n    ) {\n      var xAxisDropDown = d3\n        .select(vm._config.bindTo)\n        .append('div')\n        .attr('class', 'dbox-xAxis-select')\n        .append('select')\n        .on('change', function () {\n          vm.updateAxis('x', this.value);\n        });\n\n      if (vm._config.xAxis.dropdown.styles) {\n        var styles = vm._config.xAxis.dropdown.styles;\n        styles.display = 'block';\n        styles.margin = 'auto';\n        styles['text-align'] = 'center';\n        styles['text-align-last'] = 'center';\n\n        d3.select('.dbox-xAxis-select select').styles(styles);\n\n        d3.select('.dbox-xAxis-select select option').styles({\n          'text-align': 'left'\n        });\n      } else {\n        d3.select('.dbox-xAxis-select select').styles({\n          display: 'block',\n          margin: 'auto',\n          'text-align': 'center',\n          'text-align-last': 'center'\n        });\n\n        d3.select('.dbox-xAxis-select select option').styles({\n          'text-align': 'left'\n        });\n      }\n\n      if (vm._config.xAxis.dropdown.options) {\n        xAxisDropDown\n          .selectAll('option')\n          .data(vm._config.xAxis.dropdown.options)\n          .enter()\n          .append('option')\n          .attr('class', function (d) {\n            return d.value;\n          })\n          .attr('value', function (d) {\n            return d.value;\n          })\n          .text(function (d) {\n            return d.title;\n          })\n          .property('selected', function (d) {\n            return d.selected;\n          });\n      } else {\n        console.log('No options present in config');\n      }\n    }\n\n    /**\n     * Let's style axes\n     */\n    //Style Y axis\n    if (vm._config.yAxis.enabled !== false && vm._addStyle.yAxis.enabled) {\n      //axis line\n      yAxis\n        .selectAll('.domain')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', vm._addStyle.yAxis.axis.strokeWidth)\n        .attr('stroke', vm._addStyle.yAxis.axis.strokeColor)\n        .attr('opacity', vm._addStyle.yAxis.axis.strokeOpacity);\n\n      //axis title\n      yAxis\n        .selectAll('.axis-title')\n        .attr('font-size', vm._addStyle.yAxis.title.fontSize)\n        .attr('font-weight', vm._addStyle.yAxis.title.fontWeight)\n        .attr('fill', vm._addStyle.yAxis.title.textColor)\n        .attr('text-anchor', vm._addStyle.yAxis.title.textAnchor);\n\n      //tick lines\n      yAxis\n        .selectAll('.tick line')\n        .attr('stroke-width', vm._addStyle.yAxis.ticks.strokeWidth)\n        .attr('stroke', vm._addStyle.yAxis.ticks.strokeColor)\n        .attr('stroke-opacity', vm._addStyle.yAxis.ticks.opacity)\n        .attr('width', vm._addStyle.yAxis.ticks.tickWidth)\n        //condition gridline\n        .attr('stroke-dasharray', vm._addStyle.yAxis.ticks.gridDashed)\n        .attr(\n          'transform',\n          'translate(-' + vm._addStyle.yAxis.axis.paddingTick + ', 0)'\n        );\n      //don't draw first tick when styled as grid\n      if (vm._addStyle.yAxis.ticks.grid) {\n        yAxis\n          .selectAll('.tick:first-of-type line:first-of-type')\n          .attr('stroke', 'none');\n      }\n\n      //tick text\n      yAxis\n        .selectAll('.tick text')\n        .attr('font-size', vm._addStyle.yAxis.labels.fontSize)\n        .attr('font-weight', vm._addStyle.yAxis.labels.fontWeight)\n        .attr('fill', vm._addStyle.yAxis.labels.textColor)\n        .attr('text-anchor', vm._addStyle.yAxis.labels.textAnchor)\n        .attr(\n          'transform',\n          'translate(-' + vm._addStyle.yAxis.axis.paddingTick + ', 0)'\n        );\n    }\n\n    //Style X axis\n    if (vm._config.xAxis.enabled !== false && vm._addStyle.xAxis.enabled) {\n      //axis line\n      vm._xAxis\n        .selectAll('.domain')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', vm._addStyle.xAxis.axis.strokeWidth)\n        .attr('stroke', vm._addStyle.xAxis.axis.strokeColor)\n        .attr('opacity', vm._addStyle.xAxis.axis.strokeOpacity);\n\n      //tick lines\n      vm._xAxis\n        .selectAll('.tick line')\n        .attr('stroke-width', vm._addStyle.xAxis.ticks.strokeWidth)\n        .attr('stroke', vm._addStyle.xAxis.ticks.strokeColor)\n        .attr(\n          'transform',\n          'translate(0, ' + vm._addStyle.xAxis.axis.paddingTick + ')'\n        );\n      //don't draw first tick when styled as grid\n      if (vm._addStyle.xAxis.ticks.grid) {\n        vm._xAxis\n          .selectAll('.tick:first-of-type line:first-of-type')\n          .attr('stroke', 'none');\n      }\n\n      //tick text\n      vm._xAxis\n        .selectAll('.tick text')\n        .attr('font-size', vm._addStyle.xAxis.labels.fontSize)\n        .attr('font-weight', vm._addStyle.xAxis.labels.fontWeight)\n        .attr('fill', vm._addStyle.xAxis.labels.textColor)\n        .attr('text-anchor', vm._addStyle.xAxis.labels.textAnchor)\n        .attr(\n          'transform',\n          vm._addStyle.xAxis.labels.rotate\n            ? 'translate(0,55) rotate(' +\n            vm._addStyle.xAxis.axis.labels.rotate +\n            ')'\n            : 'translate(0, ' + vm._addStyle.xAxis.axis.paddingTick + ')'\n        );\n    }\n\n    const biggestLabelWidth = d3.max(\n      d3\n        .select('.x.axis')\n        .selectAll('text')\n        .nodes()\n        .map(o => o.getComputedTextLength())\n    );\n    if (\n      !vm._config.xAxis ||\n      (vm._config.xAxis && vm._config.xAxis.enabled !== false)\n    ) {\n      // Add ellipsis to cut label text\n      // when it is too long\n\n      // Biggest label computed text length\n\n      let xBandWidth =\n        (vm._scales.x.bandwidth\n          ? vm._scales.x.bandwidth()\n          : (vm._config.size.width -\n            (vm._config.size.margin.left + vm._config.size.margin.right)) /\n          vm._scales.x.ticks()) - 5;\n      if (biggestLabelWidth > xBandWidth) {\n        vm._addStyle.xAxis.labels.rotate = true;\n        // Biggest label doesn't fit\n        vm._xAxis.selectAll('text').each(function (d) {\n          if (typeof d === 'string') {\n            // Vertical labels\n            d3.select(this)\n              .attr('text-anchor', 'end')\n              .attr('dy', 0)\n              .attr('transform', 'translate(-6,12)rotate(-90)');\n            // Still doesn't fit!\n            if (\n              this.getComputedTextLength() >\n              0.8 * vm._config.size.margin.bottom\n            ) {\n              d3.select(this)\n                .on('mouseover', axesTip.show)\n                .on('mouseout', axesTip.hide);\n              let i = 1;\n              while (\n                this.getComputedTextLength() >\n                0.8 * vm._config.size.margin.bottom\n              ) {\n                d3.select(this)\n                  .text(function (d) {\n                    return d.slice(0, -i) + '...';\n                  })\n                  .attr('title', d);\n                ++i;\n              }\n            } else {\n              return d;\n            }\n          }\n        });\n      }\n    }\n\n    if (vm._config.xAxis.enabled !== false && vm._addStyle.xAxis.enabled) {\n      //axis title\n      vm._xAxis\n        .selectAll('.axis-title')\n        .attr('font-size', vm._addStyle.xAxis.title.fontSize)\n        .attr('font-weight', vm._addStyle.xAxis.title.fontWeight)\n        .attr('fill', vm._addStyle.xAxis.title.textColor)\n        .attr('text-anchor', vm._addStyle.xAxis.title.textAnchor)\n        .attr(\n          'transform',\n          'translate(0, ' +\n          (vm._addStyle.xAxis.labels.rotate\n            ? d3.min([vm._config.size.margin.bottom * 0.7, biggestLabelWidth])\n            : vm._addStyle.xAxis.axis.paddingTick) +\n          ')'\n        );\n    }\n\n    /**\n     * Already replaced with addStyle\n     */\n    /*if (vm._config.yAxis && vm._config.yAxis.enabled !== false) {\n\n      if (vm._config.yAxis && vm._config.yAxis.text) {\n        yAxis.append('text')\n          .attr('class', 'label title')\n          .attr('transform', 'rotate(-90)')\n          .attr('y', vm._config.yAxis.y ? vm._config.yAxis.y : -50)\n          .attr('x', -150)\n          .attr('dy', '.71em')\n          .style('text-anchor', 'middle')\n          .style('fill', vm._config.yAxis.fill ? vm._config.yAxis.fill : 'black')\n          .style('font-size', vm._config.yAxis['font-size'] ? vm._config.yAxis['font-size'] : '12px')\n          .style('font-weight', vm._config.xAxis['font-weight'] ? vm._config.xAxis['font-weight'] : '600')\n          .text(vm._config.yAxis.text);\n      }\n    }*/\n\n    //Set ticks straight or dashed, to be replaced with *addStyle -checked\n    if (\n      vm._config.yAxis.ticks &&\n      vm._config.yAxis.ticks.enabled &&\n      vm._config.yAxis.ticks.style\n    ) {\n      switch (vm._config.yAxis.ticks.style) {\n        case 'straightLine':\n          break;\n        case 'dashLine':\n          d3.selectAll('g.y.axis .tick line').attr('stroke-dasharray', '5, 5');\n          break;\n      }\n    }\n    //To be replaced with *addStyle -checked\n    if (\n      vm._config.yAxis.domain &&\n      vm._config.yAxis.domain.enabled &&\n      vm._config.yAxis.domain.stroke\n    ) {\n      d3.select('g.y.axis .domain').attr(\n        'stroke',\n        vm._config.yAxis.domain.stroke\n      );\n    }\n\n    //To be replaced with *addStyle -checked\n    if (\n      vm._config.yAxis.domain &&\n      vm._config.yAxis.domain.enabled &&\n      vm._config.yAxis.domain['stroke-width']\n    ) {\n      d3.select('g.y.axis .domain').attr(\n        'stroke-width',\n        vm._config.yAxis.domain['stroke-width']\n      );\n    }\n\n    // y\n\n    /////////////////////////////\n\n    // x\n\n    if (\n      !vm._config.xAxis ||\n      (vm._config.xAxis && vm._config.xAxis.enabled !== false)\n    ) {\n      //To be replaced with *addStyle -checked\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.style) {\n        Object.keys(vm._config.xAxis.ticks.style).forEach(function (k) {\n          vm._xAxis.selectAll('text').style(k, vm._config.xAxis.ticks.style[k]);\n        });\n      }\n\n      //Set rotation for ticks, to be replaced with *addStyle -checked\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.rotate) {\n        vm._xAxis\n          .selectAll('text')\n          .attr('text-anchor', 'end')\n          .attr('transform', 'rotate(' + vm._config.xAxis.ticks.rotate + ')');\n      }\n\n      //Set ticks straight or dashed, to be replaced with *addStyle -checked\n      if (\n        vm._config.xAxis.ticks &&\n        vm._config.xAxis.ticks.enabled &&\n        vm._config.xAxis.ticks.style\n      ) {\n        switch (vm._config.xAxis.ticks.style) {\n          case 'straightLine':\n            break;\n          case 'dashLine':\n            d3.selectAll(vm._config.bindTo + ' g.x.axis .tick line').attr(\n              'stroke-dasharray',\n              '5, 5'\n            );\n            break;\n        }\n      }\n    }\n\n    //to be replaced with *addStyle -checked\n    if (\n      vm._config.xAxis.domain &&\n      vm._config.xAxis.domain.enabled &&\n      vm._config.xAxis.domain.stroke\n    ) {\n      d3.select(vm._config.bindTo + ' g.x.axis .domain').attr(\n        'stroke',\n        vm._config.xAxis.domain.stroke\n      );\n    }\n\n    //to be replaced with *addStyle -checked\n    if (\n      vm._config.xAxis.domain &&\n      vm._config.xAxis.domain.enabled &&\n      vm._config.xAxis.domain['stroke-width']\n    ) {\n      d3.select(vm._config.bindTo + ' g.x.axis .domain').attr(\n        'stroke-width',\n        vm._config.xAxis.domain['stroke-width']\n      );\n    }\n  };\n\n  Chart.updateAxis = function (axis, value) {\n    var vm = this;\n\n    if (axis === 'x') {\n      vm._config.xAxis.dropdown.options.map(obj => {\n        if (obj.value === value) {\n          obj.selected = true;\n        } else {\n          obj.selected = false;\n        }\n      });\n    } else if (axis === 'y') {\n      vm._config.yAxis.dropdown.options.map(obj => {\n        if (obj.value === value) {\n          obj.selected = true;\n        } else {\n          obj.selected = false;\n        }\n      });\n    }\n\n    vm._config[axis] = value;\n\n    var layer = vm.layers[0];\n\n    layer._config = vm._config;\n\n    vm.draw();\n\n    // Trigger update chart axis\n    if (vm._config.events && vm._config.events.change) {\n      vm.dispatch.on('change.axis', vm._config.events.change(vm));\n    }\n  };\n\n  Chart.dispatch = d3.dispatch('load', 'change');\n\n  Chart.mapData = function (data, callback) {\n    callback(null, data);\n  };\n\n  Chart.getDomains = function (data) {\n    var vm = this;\n\n    var domains = {};\n    var minMax = [];\n    var sorted = [];\n\n    // Default ascending function\n    var sortFunctionY = function (a, b) {\n      return vm.utils.sortAscending(a.y, b.y);\n    };\n    var sortFunctionX = function (a, b) {\n      return vm.utils.sortAscending(a.x, b.x);\n    };\n\n    // if applying sort\n    if (vm._config.data.sort && vm._config.data.sort.order) {\n      switch (vm._config.data.sort.order) {\n        case 'asc':\n          sortFunctionY = function (a, b) {\n            return vm.utils.sortAscending(a.y, b.y);\n          };\n          sortFunctionX = function (a, b) {\n            return vm.utils.sortAscending(a.x, b.x);\n          };\n          break;\n\n        case 'desc':\n          sortFunctionY = function (a, b) {\n            return vm.utils.sortDescending(a.y, b.y);\n          };\n          sortFunctionX = function (a, b) {\n            return vm.utils.sortDescending(a.x, b.x);\n          };\n          break;\n      }\n    }\n\n    // xAxis\n    if (vm._config.xAxis && vm._config.xAxis.scale) {\n      switch (vm._config.xAxis.scale) {\n        case 'linear':\n          minMax = d3.extent(data, function (d) {\n            return d.x;\n          });\n          domains.x = minMax;\n          break;\n\n        case 'time':\n          minMax = d3.extent(data, function (d) {\n            return d.x;\n          });\n          domains.x = minMax;\n          break;\n\n        case 'ordinal':\n          // If the xAxis' order depends on the yAxis values\n          if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n            sorted = data.sort(sortFunctionY);\n          } else {\n            sorted = data.sort(sortFunctionX);\n          }\n\n          domains.x = [];\n          sorted.forEach(function (d) {\n            domains.x.push(d.x);\n          });\n\n          break;\n\n        case 'quantile':\n          //The xAxis order depends on the yAxis values\n          if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n            sorted = data.sort(sortFunctionY);\n          } else {\n            sorted = data.sort(sortFunctionX);\n          }\n\n          domains.q = [];\n          sorted.forEach(function (d) {\n            domains.q.push(d.x);\n          });\n\n          domains.x = d3.range(vm._config.xAxis.buckets);\n\n          break;\n\n        default:\n          minMax = d3.extent(data, function (d) {\n            return d.x;\n          });\n          domains.x = minMax;\n          break;\n      }\n    } else {\n      minMax = d3.extent(data, function (d) {\n        return d.x;\n      });\n      domains.x = minMax;\n    }\n\n    //yAxis\n    if (vm._config.yAxis && vm._config.yAxis.scale) {\n      switch (vm._config.yAxis.scale) {\n        case 'linear':\n          minMax = d3.extent(data, function (d) {\n            return d.y;\n          });\n\n          //Adjust for min values greater than zero\n          //set the min value to -10%\n          if (minMax[0] > 0) {\n            minMax[0] = minMax[0] - (minMax[1] - minMax[0]) * 0.1;\n          }\n          domains.y = minMax;\n          break;\n\n        case 'time':\n          minMax = d3.extent(data, function (d) {\n            return d.y;\n          });\n          domains.y = minMax;\n          break;\n\n        case 'ordinal':\n          if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n            sorted = data.sort(function (a, b) {\n              return vm.utils.sortAscending(a.y, b.y);\n            });\n            domains.y = [];\n            sorted.forEach(function (d) {\n              domains.y.push(d.x);\n            });\n          } else {\n            domains.y = d3\n              .map(data, function (d) {\n                return d.y;\n              })\n              .keys()\n              .sort(function (a, b) {\n                return vm.utils.sortAscending(a, b);\n              });\n          }\n\n          break;\n\n        default:\n          minMax = d3.extent(data, function (d) {\n            return d.y;\n          });\n          domains.y = minMax;\n          break;\n      }\n    } else {\n      minMax = d3.extent(data, function (d) {\n        return d.y;\n      });\n      domains.y = minMax;\n    }\n\n    return domains;\n  };\n\n  Chart.destroy = function () {\n    var vm = this;\n    d3.select(vm._config.bindTo).html('');\n  };\n\n  Chart.init(config);\n\n  return Chart;\n}\n","/*\n * Simple Bar chart\n */\nexport default function(config) {\n\n  function Bars(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._config.colorScale = d3.schemeCategory20c;\n    vm._config._format = function(d){\n      if(d % 1 == 0){\n        return d3.format(\",.0f\")(d);\n      } else if(d < 1 && d > 0) {\n        return d3.format(\",.2f\")(d);\n      } else {\n        return d3.format(\",.1f\")(d);\n      }\n    };\n    vm._scales = {};\n    vm._axes = {};\n    //vm._tip = d3.tip().attr('class', 'd3-tip tip-bars').html(vm._config.data.tip || function(d){ return d;});\n    vm._tip = d3.tip()\n      .attr('class', 'd3-tip tip-treemap')\n      .direction('n')\n      .html(vm._config.tip || function(d){ return vm._config._format(d[vm._config.y])});\n  }\n\n  //-------------------------------\n  //User config functions\n  Bars.prototype.x = function(columnName) {\n    var vm = this;\n    vm._config.x = columnName;\n    return vm;\n  }\n\n  Bars.prototype.y = function(columnName) {\n    var vm = this;\n    vm._config.y = columnName;\n    return vm;\n  }\n\n  Bars.prototype.color = function(columnName) {\n    var vm = this;\n    vm._config.color = columnName;\n    return vm;\n  }\n\n  Bars.prototype.end = function() {\n    var vm = this;\n    return vm._chart;\n  }\n\n  Bars.prototype.colorScale = function(colorScale) {\n    var vm = this;\n    if(Array.isArray(colorScale)) {\n      vm._config.colorScale = colorScale;\n    } else {\n      vm._scales.color = colorScale;\n      vm._config.colorScale = colorScale.range();\n    }\n    return vm;\n  }\n\n  Bars.prototype.format = function(format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function)\n      vm._config._format = format;\n    else\n      vm._config._format = d3.format(format);\n    return vm;\n  }\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Bars.prototype.chart = function(chart) {\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  }\n\n  Bars.prototype.data = function(data) {\n    var vm = this;\n    vm._data = data.map(function(d) {\n      if(d[vm._config.x] == Number(d[vm._config.x]))\n        d[vm._config.x] = +d[vm._config.x];\n      if(d[vm._config.y] == Number(d[vm._config.y]))\n        d[vm._config.y] = +d[vm._config.y];\n      return d;\n    });\n    return vm;\n  }\n\n  Bars.prototype.scales = function(s) {\n    var vm = this;\n    //vm._scales = s;\n    /* Use\n    * vm._config.x\n    * vm._config.xAxis.scale\n    * vm._config.y\n    * vm._config.yAxis.scale\n    * vm._data\n    */\n    /* Generate x scale */\n    var config = {\n        column: vm._config.x,\n        type: vm._config.xAxis.scale,\n        range: [0, vm._chart._width],\n        minZero: true\n    };\n    vm._scales.x = vm._chart.generateScale(vm._data, config);\n\n    /* Generate y scale */\n    config = {\n        column: vm._config.y,\n        type: vm._config.yAxis.scale,\n        range: [vm._chart._height, 0],\n        minZero: true\n    };\n    vm._scales.y = vm._chart.generateScale(vm._data, config);\n    vm._chart._scales.x = vm._scales.x;\n    vm._chart._scales.y = vm._scales.y;\n\n    if(!vm._scales.color)\n      vm._scales.color = d3.scaleOrdinal(vm._config.colorScale);\n    return vm;\n  }\n\n  Bars.prototype.axes = function(a) {\n    var vm = this;\n    vm._axes = a;\n    return vm;\n  }\n\n  Bars.prototype.domains = function() {\n    var vm = this;\n    return vm;\n  };\n\n  Bars.prototype.draw = function() {\n    var vm = this;\n    vm._chart._svg.call(vm._tip);\n\n    /*if(vm._config.xAxis.enabled) {\n       vm._chart._svg.append(\"g\")\n          .attr(\"class\", \"xAxis axis\")\n          .attr(\"transform\", \"translate(0,\" + vm._chart._height + \")\")\n          .call(d3.axisBottom(vm._scales.x)\n            .tickValues(vm._config.xAxis.tickValues)\n            .tickFormat(vm._config.xAxis.tickFormat)\n          );\n        //vm._chart._svg.selectAll(\".xAxis.axis text\").attr(\"transform\", \"translate(0,10)rotate(-20)\");\n    }*/\n\n    /*if(vm._config.yAxis.enabled) {\n      if(vm._config.yAxis.position == 'right') {\n        var yAxis = d3.axisRight(vm._scales.y)\n              .ticks(vm._config.yAxis.ticks)\n              .tickValues(vm._config.yAxis.tickValues)\n              .tickFormat(vm._config.yAxis.tickFormat);\n      } else {\n        var yAxis = d3.axisLeft(vm._scales.y)\n              .ticks(vm._config.yAxis.ticks)\n              .tickValues(vm._config.yAxis.tickValues)\n              .tickFormat(vm._config.yAxis.tickFormat);\n      }\n      var axisY = vm._chart._svg.append(\"g\")\n          .attr(\"class\", \"yAxis axis\");\n      if(vm._config.yAxis.position == 'right')\n        axisY.attr(\"transform\", \"translate(\" + vm._chart._width + \",0)\");\n      axisY.call(yAxis);\n        /*\n        Axis Title\n        .append(\"text\")\n          .attr(\"transform\", \"rotate(-90)\")\n          .attr(\"y\", 6)\n          .attr(\"dy\", \"0.71em\")\n          .attr(\"text-anchor\", \"end\")\n          .text(\"Frequency\");\n        \n  }*/\n\n    vm._chart._svg.selectAll(\".bar\")\n        .data(vm._data)\n        .enter().append(\"rect\")\n          .attr(\"class\", \"bar\")\n          .attr(\"x\", function(d) { return vm._config.xAxis.scale == 'linear' && vm._config.yAxis.scale == 'linear'? 0 : vm._scales.x(d[vm._config.x]); })\n          .attr(\"y\", function(d) { return vm._scales.y(d[vm._config.y]);})\n          .attr(\"width\", function(d){ return vm._scales.x.bandwidth ? vm._scales.x.bandwidth() : vm._scales.x(d[vm._config.x]) })\n          .attr(\"height\", function(d) { return vm._chart._height - vm._scales.y(d[vm._config.y]); })\n          .attr(\"fill\", function(d){ return vm._scales.color(d[vm._config.color])})\n          .style(\"opacity\", 0.9)\n          .on('mouseover', function(d) {\n            vm._tip.show(d, d3.select(this).node());\n          })\n          .on('mouseout', function() {\n            vm._tip.hide();\n          })\n          .on('click', function() {\n\n          });\n    return vm;\n  }\n\n  return new Bars(config);\n}\n","import * as d3 from 'd3';\n/**\n * @fileOverview A D3 based distribution chart system. Supports: Box plots, Violin plots, Notched box plots, trend lines, beeswarm plot\n * @version 3.0\n */\n\n\n/**\n * Creates a box plot, violin plot, and or notched box plot\n * @param settings Configuration options for the base plot\n * @param settings.data The data for the plot\n * @param settings.xName The name of the column that should be used for the x groups\n * @param settings.yName The name of the column used for the y values\n * @param {string} settings.selector The selector string for the main chart div\n * @param [settings.axisLabels={}] Defaults to the xName and yName\n * @param [settings.yTicks = 1] 1 = default ticks. 2 =  double, 0.5 = half\n * @param [settings.scale='linear'] 'linear' or 'log' - y scale of the chart\n * @param [settings.chartSize={width:800, height:400}] The height and width of the chart itself (doesn't include the container)\n * @param [settings.margin={top: 15, right: 60, bottom: 40, left: 50}] The margins around the chart (inside the main div)\n * @param [settings.constrainExtremes=false] Should the y scale include outliers?\n * @returns {object} chart A chart object\n */\nexport default function makeDistroChart(settings) {\n    var chart = {};\n\n    // Defaults\n    chart.settings = {\n      data: null,\n      id: null,\n      idName: null,\n      events: null,\n      xName: null,\n      xSort:null,\n      yName: null,\n      selector: null,\n      axisLables: null,\n      yTicks: 1,\n      scale: 'linear',\n      chartSize: {width: 800, height: 400},\n      margin: {top: 15, right: 60, bottom: 40, left: 50},\n      constrainExtremes: false,\n      color: d3.scaleOrdinal(d3.schemeCategory10)\n    };\n    for (var setting in settings) {\n      chart.settings[setting] = settings[setting]\n    }\n\n\n    function formatAsFloat(d) {\n      if (d % 1 !== 0) {\n        return d3.format(\",.2f\")(d);\n      } else {\n        return d3.format(\",.0f\")(d);\n      }\n    }\n    function formatNumber(d) {\n      var value = '';\n        if (d % 1 == 0) {\n        value = d3.format(',.0f')(d);\n        } else if (d < 1 && d > 0) {\n        value = d3.format(',.2f')(d);\n        } else {\n        value = d3.format(',.1f')(d);\n        }\n        return value;\n    }\n\n    function formatRange(d) {\n        var range = d.split(' - ');\n        var value = '';\n        for(var i = 0; i < range.length; i++){\n          if (range[i] % 1 == 0) {\n            value += d3.format(',.0f')(range[i]);\n          } else if (range[i] < 1 && range[i] > 0) {\n            value += d3.format(',.2f')(range[i]);\n          } else {\n            value += d3.format(',.1f')(range[i]);\n          }\n          if (i === 0) {\n            value += ' - ';\n          }\n        }\n        return value;\n      }\n\n    function logFormatNumber(d) {\n      var x = Math.log(d) / Math.log(10) + 1e-6;\n      return Math.abs(x - Math.floor(x)) < 0.6 ? formatAsFloat(d) : \"\";\n    }\n\n    chart.yFormatter = formatNumber;\n    chart.xFormatter = formatRange;\n\n    chart.data = chart.settings.data;\n\n    chart.groupObjs = {}; //The data organized by grouping and sorted as well as any metadata for the groups\n    chart.objs = {mainDiv: null, chartDiv: null, g: null, xAxis: null, yAxis: null};\n    chart.colorFunct = null;\n\n    /**\n     * Takes an array, function, or object mapping and created a color function from it\n     * @param {function|[]|object} colorOptions\n     * @returns {function} Function to be used to determine chart colors\n     */\n    function getColorFunct(colorOptions) {\n        if (typeof colorOptions == 'function') {\n            return colorOptions\n        } else if (Array.isArray(colorOptions)) {\n            //  If an array is provided, map it to the domain\n            var colorMap = {}, cColor = 0;\n            /* @TODO - REVIEW PREVIOUS CODE \n            for (var cName in chart.groupObjs) {\n                \n                colorMap[cName] = colorOptions[cColor];\n                cColor = (cColor + 1) % colorOptions.length;\n            }*/\n            if (Array.isArray(chart.settings.xSort)){\n                chart.settings.xSort.forEach(function(key, index){\n                    colorMap[key] = colorOptions[index];\n                })\n            }else{\n                Object.keys(chart.groupObjs).sort(d3.ascending).forEach(function(key, index){\n                    colorMap[key] = colorOptions[index];\n                })\n            }\n            return function (group) {\n                return colorMap[group];\n            }\n        } else if (typeof colorOptions == 'object') {\n            // if an object is provided, assume it maps to  the colors\n            return function (group) {\n                return colorOptions[group];\n            }\n        } else {\n            return d3.scaleOrdinal(d3.schemeCategory10);\n        }\n    }\n\n    /**\n     * Takes a percentage as returns the values that correspond to that percentage of the group range witdh\n     * @param objWidth Percentage of range band\n     * @param gName The bin name to use to get the x shift\n     * @returns {{left: null, right: null, middle: null}}\n     */\n    function getObjWidth(objWidth, gName) {\n        var objSize = {left: null, right: null, middle: null};\n        var width = chart.xScale.bandwidth() * (objWidth / 100);\n        var padding = (chart.xScale.bandwidth() - width) / 2;\n        var gShift = chart.xScale(gName);\n        objSize.middle = chart.xScale.bandwidth() / 2 + gShift;\n        objSize.left = padding + gShift;\n        objSize.right = objSize.left + width;\n        return objSize;\n    }\n\n    /**\n     * Adds jitter to the  scatter point plot\n     * @param doJitter true or false, add jitter to the point\n     * @param width percent of the range band to cover with the jitter\n     * @returns {number}\n     */\n    function addJitter(doJitter, width) {\n        if (doJitter !== true || width == 0) {\n            return 0\n        }\n        return Math.floor(Math.random() * width) - width / 2;\n    }\n\n    function shallowCopy(oldObj) {\n        var newObj = {};\n        for (var i in oldObj) {\n            if (oldObj.hasOwnProperty(i)) {\n                newObj[i] = oldObj[i];\n            }\n        }\n        return newObj;\n    }\n\n    /**\n     * Closure that creates the tooltip hover function\n     * @param groupName Name of the x group\n     * @param metrics Object to use to get values for the group\n     * @returns {Function} A function that provides the values for the tooltip\n     */\n    function tooltipHover(groupName, metrics, pointName = '', pointValue = undefined, boxpart = '') {\n        var tooltipString = pointName;\n        tooltipString += pointValue ? '<br>' + pointValue.toLocaleString() + '<br><hr style=\"height: 1px; background-color: #ADADAE; border: none; margin: 0.5em;\">': '';\n        tooltipString += groupName;\n        tooltipString += boxpart ? '' : \"<br\\>Max: \" + formatAsFloat(metrics.max, 0.1);\n        tooltipString += boxpart ? '' : \"<br\\>Q3: \" + formatAsFloat(metrics.quartile3);\n        tooltipString += boxpart ? boxpart === 'mean' ? \"<br\\>Media: \" + formatAsFloat(metrics.mean) : '' : \"<br\\>Media: \" + formatAsFloat(metrics.mean);\n        tooltipString += boxpart ? boxpart  === 'median' ? \"<br\\>Mediana: \" + formatAsFloat(metrics.median) : '' : \"<br\\>Mediana: \" + formatAsFloat(metrics.median);\n        tooltipString += boxpart ? '' : \"<br\\>Q1: \" + formatAsFloat(metrics.quartile1);\n        tooltipString += boxpart ? '' : \"<br\\>Min: \" + formatAsFloat(metrics.min);\n        return function () {\n            chart.objs.tooltip.transition().duration(200).style(\"opacity\", 0.8);\n            chart.objs.tooltip.html(tooltipString)\n        };\n    }\n\n    function idSelection(id) {\n        console.log('this ', id, 'is selected');\n        chart.objs.mainDiv.select('.point.distro-' + id).attr('class', 'active');\n    };\n\n    //chart.idSelect = idSelection;\n\n    /**\n     * Parse the data and calculates base values for the plots\n     */\n    !function prepareData() {\n        function calcMetrics(values) {\n\n            var metrics = { //These are the original non�scaled values\n                max: null,\n                upperOuterFence: null,\n                upperInnerFence: null,\n                quartile3: null,\n                median: null,\n                mean: null,\n                iqr: null,\n                quartile1: null,\n                lowerInnerFence: null,\n                lowerOuterFence: null,\n                min: null\n            };\n\n            metrics.min = d3.min(values);\n            metrics.quartile1 = d3.quantile(values, 0.25);\n            metrics.median = d3.median(values);\n            metrics.mean = d3.mean(values);\n            metrics.quartile3 = d3.quantile(values, 0.75);\n            metrics.max = d3.max(values);\n            metrics.iqr = metrics.quartile3 - metrics.quartile1;\n\n            //The inner fences are the closest value to the IQR without going past it (assumes sorted lists)\n            var LIF = metrics.quartile1 - (1.5 * metrics.iqr);\n            var UIF = metrics.quartile3 + (1.5 * metrics.iqr);\n            for (var i = 0; i <= values.length; i++) {\n                if (values[i] < LIF) {\n                    continue;\n                }\n                if (!metrics.lowerInnerFence && values[i] >= LIF) {\n                    metrics.lowerInnerFence = values[i];\n                    continue;\n                }\n                if (values[i] > UIF) {\n                    metrics.upperInnerFence = values[i - 1];\n                    break;\n                }\n            }\n\n\n            metrics.lowerOuterFence = metrics.quartile1 - (3 * metrics.iqr);\n            metrics.upperOuterFence = metrics.quartile3 + (3 * metrics.iqr);\n            if (!metrics.lowerInnerFence) {\n                metrics.lowerInnerFence = metrics.min;\n            }\n            if (!metrics.upperInnerFence) {\n                metrics.upperInnerFence = metrics.max;\n            }\n            return metrics\n        }\n\n        var current_x = null;\n        var current_y = null;\n        var current_id = null;\n        var current_idName = null;\n        var current_row;\n\n        // Group the values\n        for (current_row = 0; current_row < chart.data.length; current_row++) {\n            current_x = chart.data[current_row][chart.settings.xName];\n            current_y = chart.data[current_row][chart.settings.yName];\n            current_id = chart.settings.id ? chart.data[current_row][chart.settings.id] : null;\n            current_idName = chart.settings.idName ? chart.data[current_row][chart.settings.idName] : null;\n\n            if (chart.groupObjs.hasOwnProperty(current_x)) {\n                if (chart.settings.id) {\n                    chart.groupObjs[current_x].valuesInfo.push({\n                        value: current_y,\n                        id: current_id,\n                        idName: current_idName\n                    });\n                } else{\n                    chart.groupObjs[current_x].values.push(current_y);\n                }\n            } else {\n                if (chart.settings.id) {\n                    chart.groupObjs[current_x] = {};\n                    chart.groupObjs[current_x].valuesInfo = [{\n                        value: current_y,\n                        id: current_id,\n                        idName: current_idName\n                    }];\n                } else{\n                    chart.groupObjs[current_x] = {};\n                    chart.groupObjs[current_x].values = [current_y];\n                }\n            }\n\n\n            //original\n            /*if (chart.groupObjs.hasOwnProperty(current_x)) {\n                chart.groupObjs[current_x].values.push(current_y);\n            } else {\n                chart.groupObjs[current_x] = {};\n                chart.groupObjs[current_x].values = [current_y];\n            }*/\n        }\n\n        for (var cName in chart.groupObjs) {\n            if (chart.settings.id) {\n                chart.groupObjs[cName].values = [];\n                //in order to keep the array chart.groupObjs[cName].values \n                for (let index = 0; index < chart.groupObjs[cName].valuesInfo.length; index++){\n                    chart.groupObjs[cName].values.push(chart.groupObjs[cName].valuesInfo[index].value);\n                }\n\n                chart.groupObjs[cName].valuesInfo.sort(function(x,y) { return d3.ascending(x.value, y.value) });\n            }\n\n            //original\n            chart.groupObjs[cName].values.sort(d3.ascending);\n            chart.groupObjs[cName].metrics = {};\n            chart.groupObjs[cName].metrics =  calcMetrics(chart.groupObjs[cName].values);\n        }\n    }();\n\n    /**\n     * Prepare the chart settings and chart div and svg\n     */\n    !function prepareSettings() {\n        var domain = ''; \n        //Set base settings\n        chart.margin = chart.settings.margin;\n        chart.divWidth = chart.settings.chartSize.width;\n        chart.divHeight = chart.settings.chartSize.height;\n        chart.width = chart.divWidth - chart.margin.left - chart.margin.right;\n        chart.height = chart.divHeight - chart.margin.top - chart.margin.bottom;\n\n        if (chart.settings.axisLabels) {\n            chart.xAxisLable = chart.settings.axisLabels.xAxis;\n            chart.yAxisLable = chart.settings.axisLabels.yAxis;\n        } else {\n            chart.xAxisLable = chart.settings.xName;\n            chart.yAxisLable = chart.settings.yName;\n        }\n\n        if (chart.settings.scale === 'log') {\n            chart.yScale = d3.scaleLog();\n            chart.yFormatter = logFormatNumber;\n        } else {\n            chart.yScale = d3.scaleLinear();\n        }\n\n        if (chart.settings.constrainExtremes === true) {\n            var fences = [];\n            for (var cName in chart.groupObjs) {\n                fences.push(chart.groupObjs[cName].metrics.lowerInnerFence);\n                fences.push(chart.groupObjs[cName].metrics.upperInnerFence);\n            }\n            chart.range = d3.extent(fences);\n\n        } else {\n            chart.range = d3.extent(chart.data, function (d) {return d[chart.settings.yName];});\n        }\n\n        chart.colorFunct = getColorFunct(chart.settings.colors);\n\n        // Build Scale functions\n        chart.yScale.range([chart.height, 0]).domain(chart.range).nice().clamp(true);\n        \n        if (chart.settings.xSort === null) {\n            domain = Object.keys(chart.groupObjs)\n        } else {\n            domain = Array.isArray(chart.settings.xSort) ? chart.settings.xSort : Object.keys(chart.groupObjs).sort(d3.ascending)\n        }\n        chart.xScale = d3.scaleBand().domain(domain).rangeRound([0, chart.width]);\n\n        //Build Axes Functions\n        chart.objs.yAxis = d3.axisLeft()\n            .scale(chart.yScale)\n            .tickFormat(chart.yFormatter)\n            .tickSizeOuter(0)\n            .tickSizeInner(-chart.width + (chart.margin.right + chart.margin.left));\n        //chart.objs.yAxis.ticks(chart.objs.yAxis.ticks()*chart.settings.yTicks);\n        chart.objs.xAxis = d3.axisBottom()\n            .scale(chart.xScale)\n            //.tickFormat(chart.xFormatter)\n            .tickSizeOuter(0)\n            .tickSize(5); \n    }();\n\n    /**\n     * Updates the chart based on the current settings and window size\n     * @returns {*}\n     */\n    chart.update = function () {\n        // Update chart size based on view port size\n        chart.width = parseInt(chart.objs.chartDiv.style(\"width\"), 10) - (chart.margin.left + chart.margin.right);\n        chart.height = parseInt(chart.objs.chartDiv.style(\"height\"), 10) - (chart.margin.top + chart.margin.bottom);\n        // Update scale functions\n        chart.xScale.rangeRound([0, chart.width]);\n        chart.yScale.range([chart.height, 0]);\n\n        // Update the yDomain if the Violin plot clamp is set to -1 meaning it will extend the violins to make nice points\n        if (chart.violinPlots && chart.violinPlots.options.show == true && chart.violinPlots.options._yDomainVP != null) {\n            chart.yScale.domain(chart.violinPlots.options._yDomainVP).nice().clamp(true);\n        } else {\n            chart.yScale.domain(chart.range).nice().clamp(true);\n        }\n\n        //Update axes\n        chart.objs.g.select('.x.axis').attr(\"transform\", \"translate(0,\" + chart.height + \")\").call(chart.objs.xAxis)\n            .selectAll(\".tick text\")\n            .attr(\"y\", 5)\n            .attr(\"x\", -5)\n            .attr(\"transform\", \"rotate(-40)\")\n            .style(\"text-anchor\", \"end\");\n        chart.objs.g.select('.x.axis .label').attr(\"x\", chart.width / 2);\n        chart.objs.g.select('.y.axis').call(chart.objs.yAxis.tickSizeInner(-chart.width));\n        chart.objs.g.select('.y.axis .label').attr(\"x\", -chart.height / 2);\n        chart.objs.chartDiv.select('svg').attr(\"width\", chart.width + (chart.margin.left + chart.margin.right)).attr(\"height\", chart.height + (chart.margin.top + chart.margin.bottom));\n\n        return chart;\n    };\n\n    /**\n     * Prepare the chart html elements\n     */\n    !function prepareChart() {\n      // Build main div and chart div\n      chart.objs.mainDiv = d3.select(chart.settings.selector)\n        .style(\"width\", chart.divWidth + \"px\")\n        .style(\"height\", chart.divHeight+ \"px\");\n      // Add all the divs to make it centered and responsive\n      chart.objs.mainDiv.append(\"div\")\n        .attr(\"class\", \"inner-wrapper\")\n        .style(\"padding-bottom\", \"5%\")\n        .style(\"height\", chart.divHeight + \"px\")\n        .append(\"div\").attr(\"class\", \"outer-box\")\n        .append(\"div\").attr(\"class\", \"inner-box\");\n      // Capture the inner div for the chart (where the chart actually is)\n      chart.selector = chart.settings.selector + \" .inner-box\";   \n      chart.objs.chartDiv = d3.select(chart.selector);\n      d3.select(window).on('resize.' + chart.selector, chart.update);\n\n      // Create the svg\n      chart.objs.g = chart.objs.chartDiv.append(\"svg\")\n        .attr(\"class\", \"chart-area\")\n        .attr(\"width\", chart.width + (chart.margin.left + chart.margin.right))\n        .attr(\"height\", chart.height + (chart.margin.top + chart.margin.bottom))\n        .append(\"g\")\n        .attr(\"transform\", \"translate(\" + chart.margin.left + \",\" + chart.margin.top + \")\");\n      \n      // Create axes\n      chart.objs.axes = chart.objs.g.append(\"g\").attr(\"class\", \"axis\");\n      chart.objs.axes.append(\"g\")\n          .attr(\"class\", \"x axis\")\n          .attr(\"transform\", \"translate(0,\" + chart.height + \")\")\n          .call(chart.objs.xAxis)\n          .append(\"text\")\n          .attr(\"class\", \"label\")\n          .attr(\"y\", chart.margin.bottom - 20)\n          .attr(\"x\", -chart.width / 2)\n          .attr(\"dy\", \".71em\")\n          .attr('fill', '#fff')\n          .style(\"text-anchor\", \"middle\")\n          .text(chart.xAxisLable);\n\n      chart.objs.axes.append(\"g\")\n          .attr(\"class\", \"y axis\")\n          .call(chart.objs.yAxis)\n          .append(\"text\")\n          .attr(\"class\", \"label\")\n          .attr(\"transform\", \"rotate(-90)\")\n          .attr(\"y\", -chart.margin.left * 0.9)\n          .attr(\"x\", -chart.height / 2)\n          .attr(\"dy\", \".71em\")\n          .attr('fill', '#fff')\n          .style(\"text-anchor\", \"middle\")\n          .text(chart.yAxisLable);\n\n      // Create tooltip div\n      chart.objs.tooltip = chart.objs.mainDiv.append('div').attr('class', 'tooltip').style(\"display\", \"none\");\n      for (var cName in chart.groupObjs) {\n          chart.groupObjs[cName].g = chart.objs.g.append(\"g\").attr(\"class\", \"group\");\n          /*chart.groupObjs[cName].g.on(\"mouseover\", function () {\n              chart.objs.tooltip\n                  .style(\"display\", null)\n                  .style(\"left\", (d3.event.pageX) + \"px\")\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\n          }).on(\"mouseout\", function () {\n            chart.objs.tooltip.style(\"display\", \"none\");\n          }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics));*/\n      }\n      chart.update();\n    }();\n\n    /**\n     * Render a violin plot on the current chart\n     * @param options\n     * @param [options.showViolinPlot=true] True or False, show the violin plot\n     * @param [options.resolution=100 default]\n     * @param [options.bandwidth=10 default] May need higher bandwidth for larger data sets\n     * @param [options.width=50] The max percent of the group rangeBand that the violin can be\n     * @param [options.curve=''] How to render the violin\n     * @param [options.clamp=0 default]\n     *   0 = keep data within chart min and max, clamp once data = 0. May extend beyond data set min and max\n     *   1 = clamp at min and max of data set. Possibly no tails\n     *  -1 = extend chart axis to make room for data to interpolate to 0. May extend axis and data set min and max\n     * @param [options.colors=chart default] The color mapping for the violin plot\n     * @returns {*} The chart object\n     */\n    chart.renderViolinPlot = function (options) {\n        chart.violinPlots = {};\n\n        var defaultOptions = {\n            show: true,\n            showViolinPlot: true,\n            resolution: 100,\n            bandwidth: 20,\n            width: 50,\n            curve: d3.curveCardinal,\n            clamp: 1,\n            colors: chart.colorFunct,\n            _yDomainVP: null // If the Violin plot is set to close all violin plots, it may need to extend the domain, that extended domain is stored here\n        };\n        chart.violinPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.violinPlots.options[option] = options[option]\n        }\n        var vOpts = chart.violinPlots.options;\n\n        // Create violin plot objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].violin = {};\n            chart.groupObjs[cName].violin.objs = {};\n        }\n\n        /**\n         * Take a new set of options and redraw the violin\n         * @param updateOptions\n         */\n        chart.violinPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    vOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].violin.objs.g.remove()\n            }\n\n            chart.violinPlots.prepareViolin();\n            chart.violinPlots.update();\n        };\n\n        chart.violinPlots.reset = function () {\n            chart.violinPlots.change(defaultOptions)\n        };\n        chart.violinPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.violinPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.violinPlots.change(opts);\n\n        };\n\n        chart.violinPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.violinPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.violinPlots.change(opts);\n\n        };\n\n        /**\n         * Update the violin obj values\n         */\n        chart.violinPlots.update = function () {\n            var cName, cViolinPlot;\n\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                // Build the violins sideways, so use the yScale for the xScale and make a new yScale\n                var xVScale = chart.yScale.copy();\n\n\n                // Create the Kernel Density Estimator Function\n                cViolinPlot.kde = kernelDensityEstimator(eKernel(vOpts.bandwidth), xVScale.ticks(vOpts.resolution));\n                cViolinPlot.kdedata = cViolinPlot.kde(chart.groupObjs[cName].values);\n\n                var interpolateMax = chart.groupObjs[cName].metrics.max,\n                    interpolateMin = chart.groupObjs[cName].metrics.min;\n\n                if (vOpts.clamp == 0 || vOpts.clamp == -1) { //\n                    // When clamp is 0, calculate the min and max that is needed to bring the violin plot to a point\n                    // interpolateMax = the Minimum value greater than the max where y = 0\n                    interpolateMax = d3.min(cViolinPlot.kdedata.filter(function (d) {\n                        return (d.x > chart.groupObjs[cName].metrics.max && d.y == 0)\n                    }), function (d) {\n                        return d.x;\n                    });\n                    // interpolateMin = the Maximum value less than the min where y = 0\n                    interpolateMin = d3.max(cViolinPlot.kdedata.filter(function (d) {\n                        return (d.x < chart.groupObjs[cName].metrics.min && d.y == 0)\n                    }), function (d) {\n                        return d.x;\n                    });\n                    // If clamp is -1 we need to extend the axises so that the violins come to a point\n                    if (vOpts.clamp == -1) {\n                        kdeTester = eKernelTest(eKernel(vOpts.bandwidth), chart.groupObjs[cName].values);\n                        if (!interpolateMax) {\n                            var interMaxY = kdeTester(chart.groupObjs[cName].metrics.max);\n                            var interMaxX = chart.groupObjs[cName].metrics.max;\n                            var count = 25; // Arbitrary limit to make sure we don't get an infinite loop\n                            while (count > 0 && interMaxY != 0) {\n                                interMaxY = kdeTester(interMaxX);\n                                interMaxX += 1;\n                                count -= 1;\n                            }\n                            interpolateMax = interMaxX;\n                        }\n                        if (!interpolateMin) {\n                            var interMinY = kdeTester(chart.groupObjs[cName].metrics.min);\n                            var interMinX = chart.groupObjs[cName].metrics.min;\n                            var count = 25;  // Arbitrary limit to make sure we don't get an infinite loop\n                            while (count > 0 && interMinY != 0) {\n                                interMinY = kdeTester(interMinX);\n                                interMinX -= 1;\n                                count -= 1;\n                            }\n                            interpolateMin = interMinX;\n                        }\n\n                    }\n                    // Check to see if the new values are outside the existing chart range\n                    //   If they are assign them to the master _yDomainVP\n                    if (!vOpts._yDomainVP) vOpts._yDomainVP = chart.range.slice(0);\n                    if (interpolateMin && interpolateMin < vOpts._yDomainVP[0]) {\n                        vOpts._yDomainVP[0] = interpolateMin;\n                    }\n                    if (interpolateMax && interpolateMax > vOpts._yDomainVP[1]) {\n                        vOpts._yDomainVP[1] = interpolateMax;\n                    }\n\n\n                }\n\n\n                if (vOpts.showViolinPlot) {\n                    chart.update();\n                    xVScale = chart.yScale.copy();\n\n                    // Need to recalculate the KDE because the xVScale changed\n                    cViolinPlot.kde = kernelDensityEstimator(eKernel(vOpts.bandwidth), xVScale.ticks(vOpts.resolution));\n                    cViolinPlot.kdedata = cViolinPlot.kde(chart.groupObjs[cName].values);\n                }\n\n                cViolinPlot.kdedata = cViolinPlot.kdedata\n                    .filter(function (d) {\n                        return (!interpolateMin || d.x >= interpolateMin)\n                    })\n                    .filter(function (d) {\n                        return (!interpolateMax || d.x <= interpolateMax)\n                    });\n            }\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                // Get the violin width\n                var objBounds = getObjWidth(vOpts.width, cName);\n                var width = (objBounds.right - objBounds.left) / 2;\n\n                var yVScale = d3.scaleLinear()\n                    .range([width, 0])\n                    .domain([0, d3.max(cViolinPlot.kdedata, function (d) {return d.y;})])\n                    .clamp(true);\n\n                var area = d3.area()\n                    .curve(vOpts.curve)\n                    .x(function (d) {return xVScale(d.x);})\n                    .y0(width)\n                    .y1(function (d) {return yVScale(d.y);});\n\n                var line = d3.line()\n                    .curve(vOpts.curve)\n                    .x(function (d) {return xVScale(d.x);})\n                    .y(function (d) {return yVScale(d.y)});\n\n                if (cViolinPlot.objs.left.area) {\n                    cViolinPlot.objs.left.area\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", area);\n                    cViolinPlot.objs.left.line\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", line);\n\n                    cViolinPlot.objs.right.area\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", area);\n                    cViolinPlot.objs.right.line\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", line);\n                }\n\n                // Rotate the violins\n                cViolinPlot.objs.left.g.attr(\"transform\", \"rotate(90,0,0)   translate(0,-\" + objBounds.left + \")  scale(1,-1)\");\n                cViolinPlot.objs.right.g.attr(\"transform\", \"rotate(90,0,0)  translate(0,-\" + objBounds.right + \")\");\n            }\n        };\n\n        /**\n         * Create the svg elements for the violin plot\n         */\n        chart.violinPlots.prepareViolin = function () {\n            var cName, cViolinPlot;\n\n            if (vOpts.colors) {\n                chart.violinPlots.color = getColorFunct(vOpts.colors);\n            } else {\n                chart.violinPlots.color = chart.colorFunct\n            }\n\n            if (vOpts.show == false) {return}\n\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                cViolinPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"violin-plot\");\n                cViolinPlot.objs.left = {area: null, line: null, g: null};\n                cViolinPlot.objs.right = {area: null, line: null, g: null};\n\n                cViolinPlot.objs.left.g = cViolinPlot.objs.g.append(\"g\");\n                cViolinPlot.objs.right.g = cViolinPlot.objs.g.append(\"g\");\n\n                if (vOpts.showViolinPlot !== false) {\n                    //Area\n                    cViolinPlot.objs.left.area = cViolinPlot.objs.left.g.append(\"path\")\n                        .attr(\"class\", \"area\")\n                        .style(\"fill\", chart.violinPlots.color(cName));\n                    cViolinPlot.objs.right.area = cViolinPlot.objs.right.g.append(\"path\")\n                        .attr(\"class\", \"area\")\n                        .style(\"fill\", chart.violinPlots.color(cName));\n\n                    //Lines\n                    cViolinPlot.objs.left.line = cViolinPlot.objs.left.g.append(\"path\")\n                        .attr(\"class\", \"line\")\n                        .attr(\"fill\", 'none')\n                        .style(\"stroke\", chart.violinPlots.color(cName));\n                    cViolinPlot.objs.right.line = cViolinPlot.objs.right.g.append(\"path\")\n                        .attr(\"class\", \"line\")\n                        .attr(\"fill\", 'none')\n                        .style(\"stroke\", chart.violinPlots.color(cName));\n                }\n\n            }\n\n        };\n\n\n        function kernelDensityEstimator(kernel, x) {\n            return function (sample) {\n                return x.map(function (x) {\n                    return {x:x, y:d3.mean(sample, function (v) {return kernel(x - v);})};\n                });\n            };\n        }\n\n        function eKernel(scale) {\n            return function (u) {\n                return Math.abs(u /= scale) <= 1 ? .75 * (1 - u * u) / scale : 0;\n            };\n        }\n\n        // Used to find the roots for adjusting violin axis\n        // Given an array, find the value for a single point, even if it is not in the domain\n        function eKernelTest(kernel, array) {\n            return function (testX) {\n                return d3.mean(array, function (v) {return kernel(testX - v);})\n            }\n        }\n\n        chart.violinPlots.prepareViolin();\n\n        d3.select(window).on('resize.' + chart.selector + '.violinPlot', chart.violinPlots.update);\n        chart.violinPlots.update();\n        return chart;\n    };\n\n    /**\n     * Render a box plot on the current chart\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showBox=true] Show the box part of the box plot\n     * @param [options.showWhiskers=true] Show the whiskers\n     * @param [options.showMedian=true] Show the median line\n     * @param [options.showMean=false] Show the mean line\n     * @param [options.medianCSize=3] The size of the circle on the median\n     * @param [options.showOutliers=true] Plot outliers\n     * @param [options.boxwidth=30] The max percent of the group rangeBand that the box can be\n     * @param [options.lineWidth=boxWidth] The max percent of the group rangeBand that the line can be\n     * @param [options.outlierScatter=false] Spread out the outliers so they don't all overlap (in development)\n     * @param [options.outlierCSize=2] Size of the outliers\n     * @param [options.colors=chart default] The color mapping for the box plot\n     * @returns {*} The chart object\n     */\n    chart.renderBoxPlot = function (options) {\n        chart.boxPlots = {};\n\n        // Defaults\n        var defaultOptions = {\n            show: true,\n            showBox: true,\n            showWhiskers: true,\n            showMedian: true,\n            showMean: false,\n            medianCSize: 3.5,\n            showOutliers: true,\n            boxWidth: 30,\n            lineWidth: null,\n            scatterOutliers: false,\n            outlierCSize: 2.5,\n            colors: chart.colorFunct\n        };\n        chart.boxPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.boxPlots.options[option] = options[option]\n        }\n        var bOpts = chart.boxPlots.options;\n\n        //Create box plot objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].boxPlot = {};\n            chart.groupObjs[cName].boxPlot.objs = {};\n        }\n\n\n        /**\n         * Calculates all the outlier points for each group\n         */\n        !function calcAllOutliers() {\n\n            /**\n             * Create lists of the outliers for each content group\n             * @param cGroup The object to modify\n             * @return null Modifies the object in place\n             */\n            function calcOutliers(cGroup) {\n                var cExtremes = [];\n                var cOutliers = [];\n                var cOut, idx;\n                for (idx = 0; idx <= cGroup.values.length; idx++) {\n                    cOut = {value: cGroup.values[idx]};\n\n                    if (cOut.value < cGroup.metrics.lowerInnerFence) {\n                        if (cOut.value < cGroup.metrics.lowerOuterFence) {\n                            cExtremes.push(cOut);\n                        } else {\n                            cOutliers.push(cOut);\n                        }\n                    } else if (cOut.value > cGroup.metrics.upperInnerFence) {\n                        if (cOut.value > cGroup.metrics.upperOuterFence) {\n                            cExtremes.push(cOut);\n                        } else {\n                            cOutliers.push(cOut);\n                        }\n                    }\n                }\n                cGroup.boxPlot.objs.outliers = cOutliers;\n                cGroup.boxPlot.objs.extremes = cExtremes;\n            }\n\n            for (var cName in chart.groupObjs) {\n                calcOutliers(chart.groupObjs[cName]);\n            }\n        }();\n\n        /**\n         * Take updated options and redraw the box plot\n         * @param updateOptions\n         */\n        chart.boxPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    bOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].boxPlot.objs.g.remove()\n            }\n            chart.boxPlots.prepareBoxPlot();\n            chart.boxPlots.update()\n        };\n\n        chart.boxPlots.reset = function () {\n            chart.boxPlots.change(defaultOptions)\n        };\n        chart.boxPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.boxPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.boxPlots.change(opts)\n\n        };\n        chart.boxPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.boxPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.boxPlots.change(opts)\n        };\n\n        /**\n         * Update the box plot obj values\n         */\n        chart.boxPlots.update = function () {\n            var cName, cBoxPlot;\n\n            for (cName in chart.groupObjs) {\n                cBoxPlot = chart.groupObjs[cName].boxPlot;\n\n                // Get the box width\n                var objBounds = getObjWidth(bOpts.boxWidth, cName);\n                var width = (objBounds.right - objBounds.left);\n\n                var sMetrics = {}; //temp var for scaled (plottable) metric values\n                for (var attr in chart.groupObjs[cName].metrics) {\n                    sMetrics[attr] = null;\n                    sMetrics[attr] = chart.yScale(chart.groupObjs[cName].metrics[attr]);\n                }\n\n                // Box\n                if (cBoxPlot.objs.box) {\n                    cBoxPlot.objs.box\n                        .attr(\"x\", objBounds.left)\n                        .attr('width', width)\n                        .attr(\"y\", sMetrics.quartile3)\n                        .attr(\"rx\", 1)\n                        .attr(\"ry\", 1)\n                        .attr(\"height\", -sMetrics.quartile3 + sMetrics.quartile1)\n                }\n\n                // Lines\n                var lineBounds = null;\n                if (bOpts.lineWidth) {\n                    lineBounds = getObjWidth(bOpts.lineWidth, cName)\n                } else {\n                    lineBounds = objBounds\n                }\n                // --Whiskers\n                if (cBoxPlot.objs.upperWhisker) {\n                    cBoxPlot.objs.upperWhisker.fence\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.upperInnerFence)\n                        .attr(\"y2\", sMetrics.upperInnerFence);\n                    cBoxPlot.objs.upperWhisker.line\n                        .attr(\"x1\", lineBounds.middle)\n                        .attr(\"x2\", lineBounds.middle)\n                        .attr('y1', sMetrics.quartile3)\n                        .attr(\"y2\", sMetrics.upperInnerFence);\n\n                    cBoxPlot.objs.lowerWhisker.fence\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.lowerInnerFence)\n                        .attr(\"y2\", sMetrics.lowerInnerFence);\n                    cBoxPlot.objs.lowerWhisker.line\n                        .attr(\"x1\", lineBounds.middle)\n                        .attr(\"x2\", lineBounds.middle)\n                        .attr('y1', sMetrics.quartile1)\n                        .attr(\"y2\", sMetrics.lowerInnerFence);\n                }\n\n                // --Median\n                if (cBoxPlot.objs.median) {\n                    cBoxPlot.objs.median.line\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.median)\n                        .attr(\"y2\", sMetrics.median);\n                    cBoxPlot.objs.median.circle\n                        .attr(\"cx\", lineBounds.middle)\n                        .attr(\"cy\", sMetrics.median)\n                }\n\n                // --Mean\n                if (cBoxPlot.objs.mean) {\n                    cBoxPlot.objs.mean.line\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.mean)\n                        .attr(\"y2\", sMetrics.mean);\n                    cBoxPlot.objs.mean.circle\n                        .attr(\"cx\", lineBounds.middle)\n                        .attr(\"cy\", sMetrics.mean);\n                }\n\n                // Outliers\n\n                var pt;\n                if (cBoxPlot.objs.outliers) {\n                    for (pt in cBoxPlot.objs.outliers) {\n                        cBoxPlot.objs.outliers[pt].point\n                            .attr(\"cx\", objBounds.middle + addJitter(bOpts.scatterOutliers, width))\n                            .attr(\"cy\", chart.yScale(cBoxPlot.objs.outliers[pt].value));\n                    }\n                }\n                if (cBoxPlot.objs.extremes) {\n                    for (pt in cBoxPlot.objs.extremes) {\n                        cBoxPlot.objs.extremes[pt].point\n                            .attr(\"cx\", objBounds.middle + addJitter(bOpts.scatterOutliers, width))\n                            .attr(\"cy\", chart.yScale(cBoxPlot.objs.extremes[pt].value));\n                    }\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the box plot\n         */\n        chart.boxPlots.prepareBoxPlot = function () {\n            var cName, cBoxPlot;\n\n            if (bOpts.colors) {\n                chart.boxPlots.colorFunct = getColorFunct(bOpts.colors);\n            } else {\n                chart.boxPlots.colorFunct = chart.colorFunct\n            }\n\n            if (bOpts.show == false) {\n                return\n            }\n\n            for (cName in chart.groupObjs) {\n                cBoxPlot = chart.groupObjs[cName].boxPlot;\n\n                cBoxPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"box-plot\");\n\n                //Plot Box (default show)\n                if (bOpts.showBox) {\n                    cBoxPlot.objs.box = cBoxPlot.objs.g.append(\"rect\")\n                        .attr(\"class\", \"box\")\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName))\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    //A stroke is added to the box with the group color, it is\n                    // hidden by default and can be shown through css with stroke-width\n                }\n\n                //Plot Median (default show)\n                if (bOpts.showMedian) {\n                    cBoxPlot.objs.median = {line: null, circle: null};\n                    cBoxPlot.objs.median.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"median\");\n                    cBoxPlot.objs.median.circle = cBoxPlot.objs.g.append(\"circle\")\n                        .attr(\"class\", \"median\")\n                        .attr('r', bOpts.medianCSize)\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName))\n                        .on(\"mouseover\", function () {\n                            chart.objs.tooltip\n                                .style(\"display\", null)\n                                .style(\"left\", (d3.event.pageX) + \"px\")\n                                .style(\"top\", (d3.event.pageY - 28) + \"px\");\n                        }).on(\"mouseout\", function () {\n                          chart.objs.tooltip.style(\"display\", \"none\");\n                        }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics, '', '', 'median'));\n                }\n\n                // Plot Mean (default no plot)\n                if (bOpts.showMean) {\n                    cBoxPlot.objs.mean = {line: null, circle: null};\n                    cBoxPlot.objs.mean.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"mean\");\n                    cBoxPlot.objs.mean.circle = cBoxPlot.objs.g.append(\"circle\")\n                        .attr(\"class\", \"mean\")\n                        .attr('r', bOpts.medianCSize)\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName))\n                        .on(\"mouseover\", function () {\n                            chart.objs.tooltip\n                                .style(\"display\", null)\n                                .style(\"left\", (d3.event.pageX) + \"px\")\n                                .style(\"top\", (d3.event.pageY - 28) + \"px\");\n                        }).on(\"mouseout\", function () {\n                          chart.objs.tooltip.style(\"display\", \"none\");\n                        }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics, '', '', 'mean'));\n                }\n\n                // Plot Whiskers (default show)\n                if (bOpts.showWhiskers) {\n                    cBoxPlot.objs.upperWhisker = {fence: null, line: null};\n                    cBoxPlot.objs.lowerWhisker = {fence: null, line: null};\n                    cBoxPlot.objs.upperWhisker.fence = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    cBoxPlot.objs.upperWhisker.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n\n                    cBoxPlot.objs.lowerWhisker.fence = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    cBoxPlot.objs.lowerWhisker.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                }\n\n                // Plot outliers (default show)\n                if (bOpts.showOutliers) {\n                    if (!cBoxPlot.objs.outliers) calcAllOutliers();\n                    var pt;\n                    if (cBoxPlot.objs.outliers.length) {\n                        var outDiv = cBoxPlot.objs.g.append(\"g\").attr(\"class\", \"boxplot outliers\");\n                        for (pt in cBoxPlot.objs.outliers) {\n                            cBoxPlot.objs.outliers[pt].point = outDiv.append(\"circle\")\n                                .attr(\"class\", \"outlier\")\n                                .attr('r', bOpts.outlierCSize)\n                                .style(\"fill\", chart.boxPlots.colorFunct(cName));\n                        }\n                    }\n\n                    if (cBoxPlot.objs.extremes.length) {\n                        var extDiv = cBoxPlot.objs.g.append(\"g\").attr(\"class\", \"boxplot extremes\");\n                        for (pt in cBoxPlot.objs.extremes) {\n                            cBoxPlot.objs.extremes[pt].point = extDiv.append(\"circle\")\n                                .attr(\"class\", \"extreme\")\n                                .attr('r', bOpts.outlierCSize)\n                                .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                        }\n                    }\n                }\n\n\n            }\n        };\n        chart.boxPlots.prepareBoxPlot();\n\n        d3.select(window).on('resize.' + chart.selector + '.boxPlot', chart.boxPlots.update);\n        chart.boxPlots.update();\n        return chart;\n\n    };\n\n    /**\n     * Render a notched box on the current chart\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showNotchBox=true] Show the notch box\n     * @param [options.showLines=false] Show lines at the confidence intervals\n     * @param [options.boxWidth=35] The width of the widest part of the box\n     * @param [options.medianWidth=20] The width of the narrowist part of the box\n     * @param [options.lineWidth=50] The width of the confidence interval lines\n     * @param [options.notchStyle=null] null=traditional style, 'box' cuts out the whole notch in right angles\n     * @param [options.colors=chart default] The color mapping for the notch boxes\n     * @returns {*} The chart object\n     */\n    chart.renderNotchBoxes = function (options) {\n        chart.notchBoxes = {};\n\n        //Defaults\n        var defaultOptions = {\n            show: true,\n            showNotchBox: true,\n            showLines: false,\n            boxWidth: 35,\n            medianWidth: 20,\n            lineWidth: 50,\n            notchStyle: null,\n            colors: null\n        };\n        chart.notchBoxes.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.notchBoxes.options[option] = options[option]\n        }\n        var nOpts = chart.notchBoxes.options;\n\n        //Create notch objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].notchBox = {};\n            chart.groupObjs[cName].notchBox.objs = {};\n        }\n\n        /**\n         * Makes the svg path string for a notched box\n         * @param cNotch Current notch box object\n         * @param notchBounds objBound object\n         * @returns {string} A string in the proper format for a svg polygon\n         */\n        function makeNotchBox(cNotch, notchBounds) {\n            var scaledValues = [];\n            if (nOpts.notchStyle == 'box') {\n                scaledValues = [\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile1)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile1)]\n                ];\n            } else {\n                scaledValues = [\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile1)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile1)]\n                ];\n            }\n            return scaledValues.map(function (d) {\n                return [d[0], d[1]].join(\",\");\n            }).join(\" \");\n        }\n\n        /**\n         * Calculate the confidence intervals\n         */\n        !function calcNotches() {\n            var cNotch, modifier;\n            for (var cName in chart.groupObjs) {\n                cNotch = chart.groupObjs[cName];\n                modifier = (1.57 * (cNotch.metrics.iqr / Math.sqrt(cNotch.values.length)));\n                cNotch.metrics.upperNotch = cNotch.metrics.median + modifier;\n                cNotch.metrics.lowerNotch = cNotch.metrics.median - modifier;\n            }\n        }();\n\n        /**\n         * Take a new set of options and redraw the notch boxes\n         * @param updateOptions\n         */\n        chart.notchBoxes.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    nOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].notchBox.objs.g.remove()\n            }\n            chart.notchBoxes.prepareNotchBoxes();\n            chart.notchBoxes.update();\n        };\n\n        chart.notchBoxes.reset = function () {\n            chart.notchBoxes.change(defaultOptions)\n        };\n        chart.notchBoxes.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.notchBoxes.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.notchBoxes.change(opts)\n        };\n        chart.notchBoxes.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.notchBoxes.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.notchBoxes.change(opts)\n        };\n\n        /**\n         * Update the notch box obj values\n         */\n        chart.notchBoxes.update = function () {\n            var cName, cGroup;\n\n            for (cName in chart.groupObjs) {\n                cGroup = chart.groupObjs[cName];\n\n                // Get the box size\n                var boxBounds = getObjWidth(nOpts.boxWidth, cName);\n                var medianBounds = getObjWidth(nOpts.medianWidth, cName);\n\n                var notchBounds = {\n                    boxLeft: boxBounds.left,\n                    boxRight: boxBounds.right,\n                    middle: boxBounds.middle,\n                    medianLeft: medianBounds.left,\n                    medianRight: medianBounds.right\n                };\n\n                // Notch Box\n                if (cGroup.notchBox.objs.notch) {\n                    cGroup.notchBox.objs.notch\n                        .attr(\"points\", makeNotchBox(cGroup, notchBounds));\n                }\n                if (cGroup.notchBox.objs.upperLine) {\n                    var lineBounds = null;\n                    if (nOpts.lineWidth) {\n                        lineBounds = getObjWidth(nOpts.lineWidth, cName)\n                    } else {\n                        lineBounds = objBounds\n                    }\n\n                    var confidenceLines = {\n                        upper: chart.yScale(cGroup.metrics.upperNotch),\n                        lower: chart.yScale(cGroup.metrics.lowerNotch)\n                    };\n                    cGroup.notchBox.objs.upperLine\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', confidenceLines.upper)\n                        .attr(\"y2\", confidenceLines.upper);\n                    cGroup.notchBox.objs.lowerLine\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', confidenceLines.lower)\n                        .attr(\"y2\", confidenceLines.lower);\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the notch boxes\n         */\n        chart.notchBoxes.prepareNotchBoxes = function () {\n            var cName, cNotch;\n\n            if (nOpts && nOpts.colors) {\n                chart.notchBoxes.colorFunct = getColorFunct(nOpts.colors);\n            } else {\n                chart.notchBoxes.colorFunct = chart.colorFunct\n            }\n\n            if (nOpts.show == false) {\n                return\n            }\n\n            for (cName in chart.groupObjs) {\n                cNotch = chart.groupObjs[cName].notchBox;\n\n                cNotch.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"notch-plot\");\n\n                // Plot Box (default show)\n                if (nOpts.showNotchBox) {\n                    cNotch.objs.notch = cNotch.objs.g.append(\"polygon\")\n                        .attr(\"class\", \"notch\")\n                        .style(\"fill\", chart.notchBoxes.colorFunct(cName))\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n                    //A stroke is added to the notch with the group color, it is\n                    // hidden by default and can be shown through css with stroke-width\n                }\n\n                //Plot Confidence Lines (default hide)\n                if (nOpts.showLines) {\n                    cNotch.objs.upperLine = cNotch.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper confidence line\")\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n\n                    cNotch.objs.lowerLine = cNotch.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower confidence line\")\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n                }\n            }\n        };\n        chart.notchBoxes.prepareNotchBoxes();\n\n        d3.select(window).on('resize.' + chart.selector + '.notchBox', chart.notchBoxes.update);\n        chart.notchBoxes.update();\n        return chart;\n    };\n\n    /**\n     * Render a raw data in various forms\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showPlot=false] True or false, show points\n     * @param [options.plotType='none'] Options: no scatter = (false or 'none'); scatter points= (true or [amount=% of width (default=10)]); beeswarm points = ('beeswarm')\n     * @param [options.pointSize=6] Diameter of the circle in pizels (not the radius)\n     * @param [options.showLines=['median']] Can equal any of the metrics lines\n     * @param [options.showbeanLines=false] Options: no lines = false\n     * @param [options.beanWidth=20] % width\n     * @param [options.colors=chart default]\n     * @returns {*} The chart object\n     *\n     */\n    chart.renderDataPlots = function (options) {\n        chart.dataPlots = {};\n\n\n        //Defaults\n        var defaultOptions = {\n            show: true,\n            showPlot: false,\n            plotType: 'none',\n            pointSize: 7,\n            showLines: false,//['median'],\n            showBeanLines: false,\n            beanWidth: 20,\n            colors: null\n        };\n        chart.dataPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.dataPlots.options[option] = options[option]\n        }\n        var dOpts = chart.dataPlots.options;\n\n        //Create notch objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].dataPlots = {};\n            chart.groupObjs[cName].dataPlots.objs = {};\n        }\n        // The lines don't fit into a group bucket so they live under the dataPlot object\n        chart.dataPlots.objs = {};\n\n        /**\n         * Take updated options and redraw the data plots\n         * @param updateOptions\n         */\n        chart.dataPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    dOpts[key] = updateOptions[key]\n                }\n            }\n\n            chart.dataPlots.objs.g.remove();\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].dataPlots.objs.g.remove()\n            }\n            chart.dataPlots.preparePlots();\n            chart.dataPlots.update()\n        };\n\n        chart.dataPlots.reset = function () {\n            chart.dataPlots.change(defaultOptions)\n        };\n        chart.dataPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.dataPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.dataPlots.change(opts)\n        };\n        chart.dataPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.dataPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.dataPlots.change(opts)\n        };\n\n        /**\n         * Update the data plot obj values\n         */\n        chart.dataPlots.update = function () {\n            var cName, cGroup, cPlot;\n\n            // Metrics lines\n            if (chart.dataPlots.objs.g) {\n                var halfBand = chart.xScale.bandwidth() / 2; // find the middle of each band\n                for (var cMetric in chart.dataPlots.objs.lines) {\n                    chart.dataPlots.objs.lines[cMetric].line\n                        .x(function (d) {\n                            return chart.xScale(d.x) + halfBand\n                        });\n                    chart.dataPlots.objs.lines[cMetric].g\n                        .datum(chart.dataPlots.objs.lines[cMetric].values)\n                        .attr('d', chart.dataPlots.objs.lines[cMetric].line);\n                }\n            }\n\n\n            for (cName in chart.groupObjs) {\n                cGroup = chart.groupObjs[cName];\n                cPlot = cGroup.dataPlots;\n\n                if (cPlot.objs.points) {\n                    if (dOpts.plotType == 'beeswarm') {\n                        var swarmBounds = getObjWidth(100, cName);\n                        var yPtScale = chart.yScale.copy()\n                            .range([Math.floor(chart.yScale.range()[0] / dOpts.pointSize), 0])\n                            .interpolate(d3.interpolateRound)\n                            .domain(chart.yScale.domain());\n                        var maxWidth = Math.floor(chart.xScale.bandwidth() / dOpts.pointSize);\n                        var ptsObj = {};\n                        var cYBucket = null;\n                        //  Bucket points\n                        for (var pt = 0; pt < cGroup.values.length; pt++) {\n                            cYBucket = yPtScale(cGroup.values[pt]);\n                            if (ptsObj.hasOwnProperty(cYBucket) !== true) {\n                                ptsObj[cYBucket] = [];\n                            }\n                            ptsObj[cYBucket].push(cPlot.objs.points.pts[pt]\n                                .attr(\"cx\", swarmBounds.middle)\n                                .attr(\"cy\", yPtScale(cGroup.values[pt]) * dOpts.pointSize));\n                        }\n                        //  Plot buckets\n                        var rightMax = Math.min(swarmBounds.right - dOpts.pointSize);\n                        for (var row in ptsObj) {\n                            var leftMin = swarmBounds.left + (Math.max((maxWidth - ptsObj[row].length) / 2, 0) * dOpts.pointSize);\n                            var col = 0;\n                            for (pt in ptsObj[row]) {\n                                ptsObj[row][pt].attr(\"cx\", Math.min(leftMin + col * dOpts.pointSize, rightMax) + dOpts.pointSize / 2);\n                                col++\n                            }\n                        }\n                    } else { // For scatter points and points with no scatter\n                        var plotBounds = null,\n                            scatterWidth = 0,\n                            width = 0;\n                        if (dOpts.plotType == 'scatter' || typeof dOpts.plotType == 'number') {\n                            //Default scatter percentage is 20% of box width\n                            scatterWidth = typeof dOpts.plotType == 'number' ? dOpts.plotType : 20;\n                        }\n\n                        plotBounds = getObjWidth(scatterWidth, cName);\n                        width = plotBounds.right - plotBounds.left;\n\n                        for (var pt = 0; pt < cGroup.values.length; pt++) {\n                            cPlot.objs.points.pts[pt]\n                                .attr(\"cx\", plotBounds.middle + addJitter(true, width))\n                                .attr(\"cy\", chart.yScale(cGroup.values[pt]));\n                        }\n                    }\n                }\n\n\n                if (cPlot.objs.bean) {\n                    var beanBounds = getObjWidth(dOpts.beanWidth, cName);\n                    for (var pt = 0; pt < cGroup.values.length; pt++) {\n                        cPlot.objs.bean.lines[pt]\n                            .attr(\"x1\", beanBounds.left)\n                            .attr(\"x2\", beanBounds.right)\n                            .attr('y1', chart.yScale(cGroup.values[pt]))\n                            .attr(\"y2\", chart.yScale(cGroup.values[pt]));\n                    }\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the data plots\n         */\n        chart.dataPlots.preparePlots = function () {\n            var cName, cPlot;\n            \n            if (dOpts && dOpts.colors) {\n                chart.dataPlots.colorFunct = getColorFunct(dOpts.colors);\n            } else {\n                chart.dataPlots.colorFunct = chart.colorFunct\n            }\n\n            if (dOpts.show == false) {\n                return\n            }\n\n            // Metrics lines\n            chart.dataPlots.objs.g = chart.objs.g.append(\"g\").attr(\"class\", \"metrics-lines\");\n            if (dOpts.showLines && dOpts.showLines.length > 0) {\n                chart.dataPlots.objs.lines = {};\n                var cMetric;\n                for (var line in dOpts.showLines) {\n                    cMetric = dOpts.showLines[line];\n                    chart.dataPlots.objs.lines[cMetric] = {};\n                    chart.dataPlots.objs.lines[cMetric].values = [];\n                    for (var cGroup in chart.groupObjs) {\n                        chart.dataPlots.objs.lines[cMetric].values.push({\n                            x: cGroup,\n                            y: chart.groupObjs[cGroup].metrics[cMetric]\n                        })\n                    }\n                    chart.dataPlots.objs.lines[cMetric].line = d3.line()\n                        .curve(d3.curveCardinal)\n                        .y(function (d) {\n                            return chart.yScale(d.y)\n                        });\n                    chart.dataPlots.objs.lines[cMetric].g = chart.dataPlots.objs.g.append(\"path\")\n                        .attr(\"class\", \"line \" + cMetric)\n                        .attr(\"data-metric\", cMetric)\n                        .style(\"fill\", 'none')\n                        .style(\"stroke\", chart.colorFunct(cMetric));\n                }\n\n            }\n\n\n            for (cName in chart.groupObjs) {\n                cPlot = chart.groupObjs[cName].dataPlots;\n                cPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"data-plot\");\n                // Points Plot\n                if (dOpts.showPlot) {\n                    cPlot.objs.points = {g: null, pts: []};\n                    cPlot.objs.points.g = cPlot.objs.g.append(\"g\").attr(\"class\", \"points-plot\");\n                    for (var pt = 0; pt < chart.groupObjs[cName].values.length; pt++) {\n                        let val = chart.groupObjs[cName].values[pt];\n                        let valInfo = chart.groupObjs[cName].valuesInfo[pt];\n                        cPlot.objs.points.pts.push(cPlot.objs.points.g.append(\"circle\")\n                            .attr(\"class\", \"point\")\n                            //class id so it can be selected\n                            .attr('class', function() { var id = chart.settings.id ? chart.settings.id : false;\n                            return id ? 'distro-' + valInfo.id : '';})\n                            .attr('r', dOpts.pointSize / 2)// Options is diameter, r takes radius so divide by 2\n                            .style(\"fill\", chart.dataPlots.colorFunct(cName))\n                            .style(\"fill-opacity\", 0.6)\n                            .style(\"stroke\", chart.dataPlots.colorFunct(cName))\n                            .style(\"stroke-width\", \"2px\")\n                            .on('mouseover', ()=>{\n                                chart.objs.tooltip\n                                    .style(\"display\", null)\n                                    .style(\"left\", (d3.event.pageX) + \"px\")\n                                    .style(\"top\", (d3.event.pageY - 28) + \"px\");\n                            }).on(\"mouseout\", function () {\n                                chart.objs.tooltip.style(\"display\", \"none\");\n                            }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics, valInfo.idName, val))\n                            .on('click', function(){\n                                if (chart.settings.events.onClickElement) {\n                                    chart.settings.events.onClickElement.call(this, valInfo);\n                                }\n                            }));\n                    }\n                }\n\n\n                // Bean lines\n                if (dOpts.showBeanLines) {\n                    cPlot.objs.bean = {g: null, lines: []};\n                    cPlot.objs.bean.g = cPlot.objs.g.append(\"g\").attr(\"class\", \"bean-plot\");\n                    for (var pt = 0; pt < chart.groupObjs[cName].values.length; pt++) {\n                        cPlot.objs.bean.lines.push(cPlot.objs.bean.g.append(\"line\")\n                            .attr(\"class\", \"bean line\")\n                            .style(\"stroke-width\", '1')\n                            .style(\"stroke\", chart.dataPlots.colorFunct(cName)));\n                    }\n                }\n            }\n\n        };\n        chart.dataPlots.preparePlots();\n\n        d3.select(window).on('resize.' + chart.selector + '.dataPlot', chart.dataPlots.update);\n        chart.dataPlots.update();\n        return chart;\n    };\n\n    return chart;\n}","import * as d3 from 'd3';\n\nimport makeDistroChart from './distrochart';\n\n/* Simple Distro example\n * Single and multiline Distros\n */\nexport default function(config, helper) {\n  var Distro = Object.create(helper);\n\n  Distro.init = function(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n\n    vm._tip = vm.utils.d3\n      .tip()\n      .attr('class', 'd3-tip')\n      .html(\n        vm._config.tip\n          ? vm._config.tip\n          : function(d) {\n              var html = '';\n              //html += d.x ? ('<span>' + (Number.isNaN(+d.x) ? d.x : vm.utils.format(vm._config.xAxis)(d.x)) + '</span></br>') : '';\n              html += d.y\n                ? '<span>' +\n                  (Number.isNaN(+d.y)\n                    ? d.y\n                    : vm.utils.format(vm._config.yAxis)(d.y)) +\n                  '</span></br>'\n                : '';\n              /* html += d.magnitude ? ('<span>' + (Number.isNaN(+d.magnitude) ? d.magnitude : vm.utils.format()(d.magnitude)) + '</span></br>') : '';\n        html += d.color ? ('<span>' + (Number.isNaN(+d.color) ? d.color : vm.utils.format()(d.color)) + '</span>') : ''; */\n              return html;\n            }\n      );\n  };\n\n  //-------------------------------\n  //User config functions\n  Distro.type = function(type) {\n    var vm = this;\n    vm._config.type = type;\n    return vm;\n  };\n\n  Distro.x = function(col) {\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  };\n\n  Distro.y = function(col) {\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  };\n\n  Distro.sortBy = function(opt) {\n    var vm = this;\n    vm._config.sortBy = opt;\n    return vm;\n  };\n\n  Distro.fill = function(col) {\n    var vm = this;\n    vm._config.fill = col;\n    return vm;\n  };\n\n  Distro.id = function(col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  };\n\n  Distro.colors = function(colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range\n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Distro.tip = function(tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Distro.data = function(data) {\n    var vm = this;\n\n    vm._data = [];\n    data.forEach(function(d) {\n      d.x = d[vm._config.x];\n      d.y = +d[vm._config.y];\n      d.color = vm._config.fill ? d[vm._config.fill] : 'red';\n      delete d[vm._config.x];\n      delete d[vm._config.y];\n      if (vm._config.fill) delete d[vm._config.x];\n\n      vm._data.push(d);\n    });\n\n    return vm;\n  };\n\n  Distro.scales = function() {\n    var vm = this;\n\n    return vm;\n  };\n\n  Distro.draw = function() {\n    var vm = this;\n    //Call the tip\n    //vm.chart.svg().call(vm._tip);\n\n    vm.chart.fullSvg().remove();\n\n    var chart1 = makeDistroChart({\n      chart: vm.chart,\n      data: vm._data,\n      id: vm._config.id,\n      idName: vm._config.idName,\n      events: vm._config.events,\n      xName: 'x',\n      xSort:\n        typeof vm._config.sortBy === 'object' && vm._config.sortBy.x\n          ? vm._config.sortBy.x\n          : null,\n      yName: 'y',\n      axisLabels: {\n        xAxis: vm._config.axisLabels.xAxis,\n        yAxis: vm._config.axisLabels.yAxis,\n      },\n      selector: '#distro',\n      colors: ['#fff5ca', '#fbc43a', '#5cbd00', '#084c1f'],\n      chartSize: {\n        height: vm._config.size.height,\n        width: vm._config.size.width,\n      },\n      margin: {\n        top: vm._config.size.margin.top,\n        right: vm._config.size.margin.right,\n        bottom: vm._config.size.margin.bottom,\n        left: vm._config.size.margin.left,\n      },\n      constrainExtremes: true,\n    });\n\n    if (vm.chart.config.styles) {\n      d3.select('#distro .tooltip')\n        .style('background-color', vm.chart.style.tooltip.backgroundColor)\n        .style('line-height', 1)\n        .style('font-weight', vm.chart.style.tooltip.text.fontWeight)\n        .style('font-size', vm.chart.style.tooltip.text.fontSize)\n        .style('color', vm.chart.style.tooltip.text.textColor)\n        .style('font-family', vm.chart.style.tooltip.text.fontFamily)\n        .style('background-color', vm.chart.style.tooltip.backgroundColor)\n        .style('padding', vm.chart.style.tooltip.text.padding)\n        .style(\n          'border',\n          vm.chart.style.tooltip.border.width +\n            ' solid ' +\n            vm.chart.style.tooltip.border.color\n        )\n        .style('border-radius', vm.chart.style.tooltip.border.radius);\n    }\n\n    chart1.renderBoxPlot();\n    chart1.renderDataPlots();\n    chart1.renderNotchBoxes({ showNotchBox: false });\n    chart1.renderViolinPlot({ showViolinPlot: false });\n\n    chart1.boxPlots.show({\n      reset: true,\n      showWhiskers: false,\n      showOutliers: false,\n      showMean: true,\n      showMedian: true,\n      showBox: false,\n    });\n    chart1.dataPlots.change({ showPlot: true });\n    chart1.violinPlots.show({ reset: true, clamp: 0, width: 100 });\n    //Box Plot\n    /* chart1.violinPlots.hide();\n    chart1.boxPlots.show({reset:true});\n    chart1.notchBoxes.hide();\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false});  */\n\n    //Notched Box Plot\n    /*  chart1.violinPlots.hide();\n    chart1.notchBoxes.show({reset:true});\n    chart1.boxPlots.show({reset:true, showBox:false,showOutliers:true,boxWidth:20,scatterOutliers:true});\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false}); */\n\n    //Violin Plot Unbound\n    /* chart1.violinPlots.show({reset:true,clamp:0});\n    chart1.boxPlots.show({reset:true, showWhiskers:false,showOutliers:false,boxWidth:10,lineWidth:15,colors:['#555']});\n    chart1.notchBoxes.hide();\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false})  */\n\n    //Violin Plot Clamp to Data\n    if (vm._config.type === 'violin') {\n      chart1.violinPlots.show({ reset: true, clamp: 1, width: 50 });\n      chart1.boxPlots.show({\n        reset: true,\n        showWhiskers: false,\n        showOutliers: false,\n        boxWidth: 10,\n        lineWidth: 15,\n        colors: ['#555'],\n      });\n      chart1.notchBoxes.hide();\n      chart1.dataPlots.change({ showPlot: false, showBeanLines: false });\n    }\n\n    //Bean Plot\n    /* chart1.violinPlots.show({reset:true, width:75, clamp:0, resolution:30, bandwidth:50});\n    chart1.dataPlots.show({showBeanLines:true,beanWidth:15,showPlot:false,colors:['#555']});\n    chart1.boxPlots.hide();\n    chart1.notchBoxes.hide(); */\n\n    //Beeswarm Plot\n    /* chart1.violinPlots.hide();\n    chart1.dataPlots.show({showPlot:true, plotType:'beeswarm',showBeanLines:false, colors:null});\n    chart1.notchBoxes.hide();\n    chart1.boxPlots.hide(); */\n\n    //Scatter Plot\n    if (vm._config.type === 'scatter') {\n      chart1.violinPlots.hide();\n      chart1.dataPlots.show({\n        showPlot: true,\n        plotType: 40,\n        showBeanLines: false,\n        colors: null,\n      });\n      chart1.notchBoxes.hide();\n      //chart1.boxPlots.hide();\n    }\n\n    //Trend Lines\n    /* if(chart1.dataPlots.options.showLines){\n        chart1.dataPlots.change({showLines:false});\n    } else {\n        chart1.dataPlots.change({showLines:['median','quartile1','quartile3']});\n    } */\n\n    return vm;\n  };\n\n  Distro.select = function(id) {\n    var vm = this;\n    return d3.select('#distro .distro-' + id);\n  };\n\n  Distro.selectAll = function(id) {\n    var vm = this;\n    return d3.selectAll('#distro ' + id);\n  };\n\n  Distro.init(config);\n  return Distro;\n}\n","/*\n * Heatmap Chart\n */\n\nexport default function(config) {\n\n  function Heatmap(config){\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales ={};\n    vm._axes = {};\n    vm._gridSize = Math.floor(vm._config.size.width / 16);\n    vm._legendElementWidth = vm._gridSize;\n\n    vm._config._format     = d3.format(\",.1f\");\n\n    vm._tip = d3.tip().attr('class', 'd3-tip');\n  }\n\n  //-------------------------------\n  //User config functions\n  Heatmap.prototype.x = function(columns){\n    var vm = this;\n    vm._config.x = columns;\n    return vm;\n  }\n\n  Heatmap.prototype.y = function(columns){\n    var vm = this;\n    vm._config.y = columns;\n    return vm;\n  }\n\n  Heatmap.prototype.colors = function(colors){\n    var vm = this;\n    vm._config.colors = colors;\n    return vm;\n  }\n\n  Heatmap.prototype.tip = function(tip){\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  }\n\n  Heatmap.prototype.buckets = function(b){\n    var vm = this;\n    vm._config.buckets = buckets;\n    return vm;\n  }\n\n  Heatmap.prototype.end = function(){\n    var vm = this;\n    return vm._chart;\n  }\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Heatmap.prototype.chart = function(chart){\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  }\n\n  Heatmap.prototype.data = function(data){\n    var vm = this;\n    vm._data = data.map(function(d){\n      var m = {\n        y: d.edad_mujer,\n        x: d.edad_hombre,\n        value: +d.tot,\n        percentage : +d.por,\n      };\n      return m;\n    });\n    return vm;\n  }\n\n  Heatmap.prototype.scales = function(s){\n    var vm = this;\n    vm._scales = s;\n    return vm;\n  }\n\n  Heatmap.prototype.axes = function(a){\n    var vm = this;\n    vm._axes = a;\n    return vm;\n  }\n\n  Heatmap.prototype.domains = function(){\n    var vm = this;\n    return vm;\n  };\n\n  Heatmap.prototype.draw = function(){\n    var vm = this;\n\n    //Call the tip\n    vm._chart._svg.call(vm._tip)\n\n    if(vm._config.xAxis){\n      vm._config.xAxis.y =  vm._config.y.length * vm._gridSize+25;\n    }else{\n      vm._config.xAxis = { 'y' : vm._config.y.length * vm._gridSize };\n    }\n\n    vm._dayLabels = vm._chart._svg.selectAll(\".dayLabel\")\n          .data(vm._config.y)\n          .enter().append(\"text\")\n            .text(function (d) { return d; })\n            .attr(\"x\", 0)\n            .attr(\"y\", function (d, i) { return i * vm._gridSize; })\n            .style(\"text-anchor\", \"end\")\n            .attr(\"transform\", \"translate(-6,\" + vm._gridSize / 1.5 + \")\")\n            .attr(\"class\", \"dayLabel mono axis\");\n            //.attr(\"class\", function (d, i) { return ((i >= 0 && i <= 4) ? \"dayLabel mono axis axis-workweek\" : \"dayLabel mono axis\"); });\n\n    vm._timeLabels = vm._chart._svg.selectAll(\".timeLabel\")\n        .data(vm._config.x)\n        .enter().append(\"text\")\n          .text(function(d) { return d; })\n          .attr(\"x\", function(d, i) { return i * vm._gridSize; })\n          .attr(\"y\", vm._config.xAxis.y)\n          .style(\"text-anchor\", \"middle\")\n          .attr(\"transform\", \"translate(\" + vm._gridSize / 2 + \", -6)\")\n          .attr(\"class\", \"timeLabel mono axis\");\n          //.attr(\"class\", function(d, i) { return ((i >= 7 && i <= 16) ? \"timeLabel mono axis axis-worktime\" : \"timeLabel mono axis\"); });\n\n\n    var colorScale = d3.scaleQuantile()\n        .domain([0, d3.max(vm._data, function (d) { return d.value; })])\n        .range(vm._config.colors);\n\n    var cards = vm._chart._svg.selectAll(\".hour\")\n        .data(vm._data, function(d) {\n          return d.y+':'+d.x;\n        });\n\n    cards.enter().append(\"rect\")\n        .attr(\"x\", function(d) { return (vm._config.x.indexOf(d.x) ) * vm._gridSize; })\n        .attr(\"y\", function(d) { return (vm._config.y.indexOf(d.y)) * vm._gridSize; })\n        .attr(\"rx\", 4)\n        .attr(\"ry\", 4)\n        .attr(\"class\", \"hour bordered\")\n        .attr(\"id\", function(d){ return 'x' + d.x + 'y' + d.y;})\n        .attr(\"width\", vm._gridSize)\n        .attr(\"height\", vm._gridSize)\n        .on('mouseover', function(d,i){\n          /*if(vm._config.data.mouseover){\n            vm._config.data.mouseover.call(vm, d,i);\n          }*/\n          vm._tip.show(d, d3.select(this).node());\n        })\n        .on('mouseout', function(d,i){\n          /*if(vm._config.data.mouseout){\n            vm._config.data.mouseout.call(this, d,i);\n          }*/\n          vm._tip.hide(d, d3.select(this).node());\n        })\n        .on(\"click\", function(d,i){\n          if(vm._config.data.onclick){\n            vm._config.data.onclick.call(this, d, i);\n          }\n        })\n        .style(\"fill\", vm._config.colors[0])\n      .transition()\n        .duration(3000)\n        .ease(d3.easeLinear)\n        .style(\"fill\", function(d) { return colorScale(d.value); });\n\n\n  /*\n    var legend = vm._chart._svg.selectAll(\".legend\")\n        .data([0].concat(colorScale.quantiles()), function(d) { return d; });\n\n    var lgroup = legend.enter().append(\"g\")\n        .attr(\"class\", \"legend\");\n\n    lgroup.append(\"rect\")\n        .attr(\"x\", function(d, i) {  return vm._legendElementWidth * i; })\n        .attr(\"y\", vm._config.size.height - vm._config.size.margin.bottom*2)\n        .attr(\"width\", vm._legendElementWidth)\n        .attr(\"height\", vm._gridSize / 2)\n        .style(\"fill\", function(d, i) { return vm._config.colors[i]; });\n\n    lgroup.append(\"text\")\n        .attr(\"class\", \"mono\")\n        .text(function(d) { return \"≥ \" + Math.round(d); })\n        .attr(\"x\", function(d, i) { return vm._legendElementWidth * i; })\n        .attr(\"y\", vm._config.size.height - vm._config.size.margin.bottom*2 + vm._gridSize);\n\n    legend.exit().remove();*/\n    return vm;\n  }\n\n  return new Heatmap(config);\n}\n","import * as d3 from 'd3';\n/**\n * Leaflet Chart\n */\n\nexport default function (config, helper) {\n\n  var Leaflet = Object.create(helper);\n\n  Leaflet.init = function (config) {\n    const vm = this;\n    vm._config = config ? config : {};\n    vm._scales = {};\n    vm._axes = {};\n    vm._data = [];\n\n    vm._scales.color = d3.scaleQuantize().range([\"#fee5d9\", \"#fcae91\", \"#fb6a4a\", \"#de2d26\", \"#a50f15\"\n    ]);\n  }\n\n  Leaflet.id = function (col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  }\n\n  Leaflet.fill = function (col) {\n    var vm = this;\n    vm._config.fill = col;\n    return vm\n  }\n\n  Leaflet.opacity = function (value) {\n    var vm = this;\n    vm._config.opacity = value;\n    return vm;\n  }\n\n  Leaflet.colors = function (colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    if (colors && Array.isArray(colors)) {\n      vm._scales.color.range(colors);\n    } else if (typeof colors === 'function') {\n      vm._scales.color = colors;\n    }\n    return vm;\n  }\n\n  Leaflet.colorLegend = function (legendTitle) {\n    var vm = this;\n    vm._config.legendTitle = legendTitle;\n    return vm;\n  };\n\n  // -------------------------------\n  // Triggered by chart.js;\n  Leaflet.data = function (data) {\n    var vm = this;\n    vm._topojson = data[1] ? data[1] : false; //Topojson\n    data = data[0]; //User data\n\n    if (vm._config.data.filter) {\n      data = data.filter(vm._config.data.filter);\n    }\n\n    vm._data = data;\n    //vm._quantiles = vm._setQuantile(data);\n    vm._minMax = d3.extent(data, function(d) { return +d[vm._config.fill]; })\n\n    vm._scales.color.domain(vm._minMax);\n\n    var objects = vm._config.map.topojson.objects;\n\n    vm._nodes = [];\n    if (Array.isArray(objects)) {\n      for (let idx = 0; idx < objects.length; idx++) {\n        const obj = objects[idx];\n        vm._topojson.objects[obj].geometries.forEach(function (geom) {\n          geom.id = vm._config.map.topojson.parser(geom);\n          var found = vm._data.filter(o => o[vm._config.id] == geom.id)[0];\n          if (found) {\n            geom.properties[vm._config.fill] = found[vm._config.fill];\n          }\n          vm._nodes.push(geom);\n        });\n      }\n    } else if (objects) {\n      vm._topojson.objects[objects].geometries.forEach(function (geom) {\n        geom.id = vm._config.map.topojson.parser(geom);\n        var found = vm._data.filter(o => o[vm._config.id] == geom.id)[0];\n        if (found) {\n          geom.properties[vm._config.fill] = found[vm._config.fill];\n        }\n        vm._nodes.push(geom);\n      });\n    }\n\n    // vm._config.map.min = vm._minMax[0];\n    // vm._config.map.max = vm._minMax[1];\n    return vm\n  }\n\n  Leaflet.scales = function () {\n    var vm = this;\n    return vm\n  }\n\n  Leaflet.drawColorLegend = function () {\n    var vm = this;\n    \n    var range = vm._scales.color.range().length;\n    var step = (vm._minMax[1] - vm._minMax[0]) / (range - 1);\n    var domain = vm._config.colors;\n\n    var quantilePosition = d3.scaleBand().rangeRound([vm._config.size.height * 0.8, 0]).domain(domain);\n    //Add gradient legend \n    //defaults to right position\n    var legend = d3.select('#' + vm._config.bindTo)\n      .append('svg')\n        .attr('width', 120)\n        .attr('height', vm._config.size.height)\n        .style('z-index', 401)\n        .style('position', 'absolute')\n        .style('top', '4px')\n        .style('right', '2px')\n      .append('g')\n      .attr('class', 'legend quantized')\n      .attr('transform', 'translate(50,25)');\n    \n    // legend background\n    legend.append('rect')\n      .attr('x', -50)\n      .attr('y', -35)\n      .attr('width', 100)\n      .attr('height', vm._config.size.height - 10)\n      .attr('rx', 10)\n      .attr('ry', 10)\n      .attr('class', 'legend-background')\n      .attr('fill', 'rgba(255,255,255,0.6)');\n    \n      // legend title\n    legend.append('text')\n      .attr('x', 0)\n      .attr('y', -12)\n      .attr('class', 'legend-title')\n      .attr('text-anchor', 'middle')\n      .text(vm._config.legendTitle);\n\n    var quantiles = legend.selectAll('.quantile')\n      .data(vm._config.colors)\n      .enter()\n      .append('g')\n      .attr('class', 'quantile')\n      .attr('transform', function(d) {\n        return 'translate(-20, ' + quantilePosition(d)\n         + ')';\n      })\n\n    // Rect\n    quantiles.append('rect')\n      .attr('x', -10)\n      .attr('y', 0)\n      .attr('width', 18)\n      .attr('height', quantilePosition.bandwidth())\n      .attr('fill', function (d) {\n        return d;\n      });\n    \n\n    //top text is the max value\n    quantiles.append('text')\n      .attr('x', 17)\n      .attr('y', 5)\n      .attr('class', 'top-label')\n      .attr('text-anchor', 'left')\n      .text(function(d){\n        let max = (vm._scales.color.invertExtent(d)[1]);\n        if (vm._config.legendTitle === 'Porcentaje' && max > 100) {\n          max = 100;\n        }\n        if (vm._config.map.formatLegend) {\n          return vm._config.map.formatLegend(max);\n        } else {\n          return vm.utils.format(max);\n        }\n      });\n\n    //bottom text is the min value\n    quantiles.append('text')\n      .attr('x', 17)\n      .attr('y', vm._config.size.height / 5 - 11)\n      .attr('class', 'bottom-label')\n      .attr('text-anchor', 'left')\n      .text(function(d, i){\n        if (i === 0) {\n          let min = (vm._scales.color.invertExtent(d)[0]);\n          if (vm._config.map.formatLegend) {\n            return vm._config.map.formatLegend(min);\n          } else {\n            return vm.utils.format(min);\n          }\n        } else {\n          return '';\n        }\n      });\n  };\n\n  Leaflet.draw = function () {\n    var vm = this;\n\n    var urlTopojson = vm._config.map.topojson.url;\n    var objects = vm._config.map.topojson.objects; //'states'\n    var tran = vm._config.map.topojson.translate; //var tran = [2580, 700];\n    var scale = vm._config.map.topojson.scale; //1300\n    var parser = vm._config.map.topojson.parser;\n    var id = vm._config.map.topojson.id;\n\n    L.TopoJSON = L.GeoJSON.extend({\n      addData: function (jsonData) {\n        var geojson, key;\n        if (jsonData.type === 'Topology') {\n          if (objects) {\n            if (Array.isArray(objects)) {\n              for (let idx = 0; idx < objects.length; idx++) {\n                const obj = objects[idx];\n                geojson = topojson.feature(jsonData, jsonData.objects[obj]);\n                L.GeoJSON.prototype.addData.call(this, geojson);\n              }\n            } else {\n              geojson = topojson.feature(jsonData, jsonData.objects[objects]);\n              L.GeoJSON.prototype.addData.call(this, geojson);\n            }\n          } else {\n            for (key in jsonData.objects) {\n              geojson = topojson.feature(jsonData, jsonData.objects[key]);\n              L.GeoJSON.prototype.addData.call(this, geojson);\n            }\n          }\n        } else {\n          L.GeoJSON.prototype.addData.call(this, jsonData);\n        }\n      }\n    });\n\n    var LatLng = {\n      lat: 25.5629994, \n      lon: -100.6405644\n    }\n    if (vm._config.map.topojson.center && vm._config.map.topojson.center.length === 2) {\n      LatLng.lat = vm._config.map.topojson.center[0]\n      LatLng.lon = vm._config.map.topojson.center[1]\n    }\n\n    var bounds = new L.LatLngBounds(new L.LatLng(LatLng.lat + 5, LatLng.lon - 5), new L.LatLng(LatLng.lat - 5, LatLng.lon + 5));\n\n    vm._map = new L.Map(vm._config.bindTo, {\n        center: bounds.getCenter(),\n        zoom: vm._config.map.topojson.zoom || 7,\n        maxZoom: vm._config.map.topojson.maxZoom || 10,\n        minZoom: vm._config.map.topojson.minZoom || 3,\n        maxBounds: bounds,\n        maxBoundsViscosity: 1.0\n      });\n\n    var mapTiles = L.tileLayer('http://b.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {\n        attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n      });\n    var topoLayer = new L.TopoJSON();\n    \n    mapTiles.addTo(vm._map);\n    addTopoData(vm._topojson);\n\n    // vm._map.on('zoomend', function() {\n    //   d3.selectAll('.dbox-label').remove();\n    //   Object.values(vm._map._layers)\n    //     .filter(obj => obj.feature)\n    //     .forEach(function(layer) {\n    //     vm.drawLabel(layer);\n    //   });\n    // });\n\n    function addTopoData(topoData) {\n      topoLayer.addData(topoData);\n      topoLayer.addTo(vm._map);\n      topoLayer.eachLayer(handleLayer);\n    }\n\n    var tip = vm.utils.d3.tip()\n      .html(vm._config.tip ? vm._config.tip.bind(this) : function(d) {\n        let html = '<div class=\"d3-tip\" style=\"z-index: 99999;\"><span>' + (d.feature.properties.NOM_ENT || d.feature.properties.NOM_MUN) + '</span><br/><span>' +\n          vm.utils.format()(d.feature.properties[vm._config.fill]) + '</span></div>';\n        return html;\n      });\n    d3.select('#' + vm._config.bindTo).select('svg.leaflet-zoom-animated').call(tip);\n\n    /**\n     * Set each layer\n     * @param {obj} layer \n     */\n    function handleLayer(layer) {\n      var value = layer.feature.properties[vm._config.fill];\n      if (!value) {\n        // Remove polygons without data\n        /** @todo validate what to do with NA's */\n        d3.select(layer._path).remove();\n      } else {\n        var fillColor = vm._scales.color(value);\n        \n        layer.setStyle({\n          fillColor: fillColor,\n          fillOpacity: vm._config.opacity || 0.7,\n          color: '#555',\n          weight: 1,\n          opacity: .5\n        });\n\n        vm.drawLabel(layer);\n\n        layer.on({\n          mouseover: function() {\n            enterLayer(layer)\n          },\n          mouseout: function() {\n            leaveLayer(layer);\n          }\n        });\n      }\n    }\n\n    function enterLayer(layer) {\n      tip.show(layer, d3.select(layer._path).node());\n    }\n\n    function leaveLayer(layer) {\n      tip.hide(layer);\n    }\n\n    /**\n     * Draw Legend\n     */\n    if (typeof vm._config.legend === 'function') {\n      vm._config.legend.call(this, vm._nodes);\n    }\n\n    Leaflet.drawColorLegend();\n\n    return vm\n  }\n\n  /**\n   * Add labels for each path (layer) to display value\n   */\n  Leaflet.drawLabel = function(layer) {\n    const vm = this;\n    const props = layer.feature.properties;\n    const path = d3.select(layer._path).node();\n    const bbox = path.getBBox();\n    var svg = d3.select('#' + vm._config.bindTo)\n      .select('svg.leaflet-zoom-animated');\n    \n    if (props[vm._config.fill] !== undefined) {\n      svg.append('text')\n        .attr('class', 'dbox-label')\n        .attr('x', bbox.x + (bbox.width / 2))\n        .attr('y', bbox.y + (d3.min([bbox.height / 2, 30])))\n        .attr('text-anchor', 'middle')\n        .text((props.NOM_ENT || props.NOM_MUN) + ': ' + vm.utils.format(props[vm._config.fill]));\n    }\n    return vm;\n  }\n  \n\n  Leaflet.init(config);\n\n  return Leaflet;\n}\n","/*\n * Map \n */\n\nexport default function(config) {\n\n  function Map(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    vm._tip = d3.tip().attr('class', 'd3-tip');\n\n    vm._formatWithZeroDecimals  = d3.format(\",.0f\");\n    vm._formatWithOneDecimal    = d3.format(\",.1f\");\n    vm._formatWithTwoDecimals   = d3.format(\",.2f\");\n    vm._formatWithThreeDecimals = d3.format(\",.3f\");\n\n    vm._format = {};\n    vm._format.total = vm._formatWithZeroDecimals;\n    vm._format.percentage = function(d){return d3.format(\",.1f\")(d) + '%';} ;\n    vm._format.change =  d3.format(\",.1f\");\n\n  }\n\n  //-------------------------------\n  //User config functions\n\n  Map.prototype.id = function(col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  }\n\n  Map.prototype.color = function(col) {\n    var vm = this;\n    vm._config.color = col;\n    return vm;\n  }\n\n  Map.prototype.tip = function(tip){\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  }\n\n  Map.prototype.onclick = function(onclick){\n    var vm = this;\n    vm._config.onclick = onclick;\n    return vm;\n  }\n\n  Map.prototype.end = function() {\n    var vm = this;\n    return vm._chart;\n  }\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Map.prototype.chart = function(chart) {\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  }\n\n \n  Map.prototype.data = function(data) {\n    var vm = this;\n    \n    if(vm._config.data.filter){\n      data = data.filter(vm._config.data.filter);\n    }\n  \n    vm._data = data;\n    vm._quantiles = vm._setQuantile(data);\n    vm._minMax = d3.extent(data, function(d) { return +d[vm._config.color]; })\n\n    vm._config.map.min = vm._minMax[0];\n    vm._config.map.max = vm._minMax[1];\n\n    return vm;\n  }\n\n  Map.prototype.scales = function(s) {\n    var vm = this;\n    vm._scales = s;\n    return vm;\n  }\n\n  Map.prototype.axes = function(a) {\n    var vm = this;\n    vm._axes = a;\n    return vm;\n  }\n\n  Map.prototype.domains = function() {\n    var vm = this;\n    return vm;\n  };\n\n  Map.prototype.draw  = function(){\n    var vm = this;\n\n    //@config\n    var urlTopojson = vm._config.map.topojson.url;\n    var objects = vm._config.map.topojson.objects; //'states'\n    var tran = vm._config.map.topojson.translate; //var tran = [2580, 700];\n    var scale = vm._config.map.topojson.scale;\n  \n    /*function(d) {\n        d.id = d.properties.state_code.toString();\n        if(d.id.length === 1) d.id = '0'+d.id;\n        return d.id;\n    }*/\n    var parser = vm._config.map.topojson.parser;\n    /*function(d) {\n            return \"state-\" + d.id;\n        }\n    */\n    var id = vm._config.map.topojson.id;\n\n    //Call the tip\n    vm._chart._svg.call(vm._tip)\n\n    vm._projection = d3.geoMercator()\n        //.scale(1300)\n        .scale(scale)\n        .translate(tran);\n\n    vm.path = d3.geoPath()\n        .projection(vm._projection);\n\n    vm._polygons = vm._chart._svg.append(\"g\")\n        .attr(\"id\", \"dbox-map-polygons\")\n        .style('display', 'true')\n        .attr(\"transform\", function() {\n            return \"translate(\" + (vm._config.size.translateX) + \",100) scale(\" + vm._config.size.scale + \")\"\n        });\n    \n    d3.json(urlTopojson, function(error, t) {\n      var features = topojson.feature(t, t.objects[objects]).features;\n      //console.log('topojson features', features);\n      if (typeof vm._config.map.topojson.filter != 'undefined') {\n        var filter = vm._config.map.topojson.filter;\n        console.log(filter);\n        Object.keys(filter).map(function(key) {\n          features = features.filter(feature => feature.properties[key] === filter[key]);\n        });\n      }\n      vm._polygons.selectAll(\"path\")\n          .data(features, parser)\n          .enter().append(\"path\")\n          .attr(\"d\", d3.geoPath().projection(vm._projection))\n          .attr(\"id\", id) \n          .attr(\"data-geotype\", objects)\n          .attr(\"fill\", \"#808080\")\n          .attr('stroke', '#a0a0a0')\n          .style('stroke-width', '1px')\n          .on('mouseover', function(d, i) {\n            if (vm._config.data.onmouseover) { //External function call\n              vm._config.data.onmouseover.call(this, d, i);\n            }\n            \n            if(vm._config.map.quantiles.colorsOnHover){ //OnHover colors\n              d3.select(this).attr('fill', function(d) {\n                  return vm._getQuantileColor(d[vm._config.color],'onHover');\n              })\n            }\n\n            vm._tip.show(d, d3.select(this).node()) //Show TIP\n          })\n          .on('mouseout', function(d, i) {\n              if (vm._config.data.onmouseout) { //External function call\n                  vm._config.data.onmouseout.call(this, d, i)\n              }\n              \n              if(vm._config.map.quantiles.colorsOnHover){ //OnHover reset default color\n                d3.select(this).attr('fill', function(d) {\n                    return vm._getQuantileColor(d[vm._config.color],'default');\n                })\n              }\n              //Hide tip\n              vm._tip.hide(d, d3.select(this).node()) \n              \n          })\n          .on(\"click\", function(d, i) {\n              if (vm._config.data.onclick) {\n                  vm._config.data.onclick.call(this, d, i)\n              }\n          })\n\n      vm._polygonsDefault = vm._polygons.selectAll(\"path\").data();\n\n      vm._polygons.selectAll(\"path\").attr(\"stroke\", \"#333\").attr('stroke-width', 0.2);\n      vm._polygons.selectAll(\"path\").attr(\"fill\", \"red\");\n      vm._polygons.selectAll(\"path\").attr('data-total', null);\n      vm._polygons.selectAll(\"path\")\n          .data(vm._data, function(d) {\n            //@TODO WHY THE F..K IS D3 ITERATING OVER THE OLD DATA\n            return d.id ? d.id : d[vm._config.id];\n          })\n          .attr('fill', function(d) {\n              return vm._getQuantileColor(d[vm._config.color],'default');\n          })\n          .attr('data-total', function(d) {\n              return +d[vm._config.color];\n          })\n\n      //Resets the map paths data to topojson\n      vm._polygons.selectAll(\"path\").data(vm._polygonsDefault, function(d) {\n          return d.id;\n      });\n    });\n\n  };\n\n  Map.prototype._setQuantile = function(data){\n    var vm = this; \n    var values = [];\n    var quantile = []; \n\n    if(vm._config.map.quantiles &&  vm._config.map.quantiles.predefinedQuantiles \n        && vm._config.map.quantiles.predefinedQuantiles.length > 0){\n      return vm._config.map.quantiles.predefinedQuantiles;\n    }\n\n    data.forEach(function(d){      \n      values.push(+d[vm._config.color]);\n    });\n\n    values.sort(d3.ascending);\n    \n    //@TODO use quantile scale instead of manual calculations \n    if(vm._config && vm._config.map && vm._config.map.quantiles && vm._config.map.quantiles.buckets){\n\n      if(vm._config.map.quantiles.ignoreZeros === true){\n        var aux = _.dropWhile(values, function(o) { return o <= 0 });\n        //aux.unshift(values[0]);  \n\n        quantile.push(values[0]);\n        quantile.push(0);\n        \n        for(var i = 1; i <= vm._config.map.quantiles.buckets - 1; i++ ){        \n          quantile.push( d3.quantile(aux,  i* 1/(vm._config.map.quantiles.buckets - 1) ) )\n        }\n\n      }else{\n        quantile.push( d3.quantile(values, 0) )\n        for(var i = 1; i <= vm._config.map.quantiles.buckets; i++ ){        \n          quantile.push( d3.quantile(values,  i* 1/vm._config.map.quantiles.buckets ) )\n        }\n      }\n        \n    }else{\n      quantile = [ d3.quantile(values, 0), d3.quantile(values, 0.2), d3.quantile(values, 0.4), d3.quantile(values, 0.6), d3.quantile(values, 0.8), d3.quantile(values,1) ];\n    }\n   \n    //@TODO - VALIDATE WHEN ZEROS NEED TO BE PUT ON QUANTILE 1 AND RECALCULATE NON ZERO VALUES INTO THE REST OF THE BUCKETS\n    if( vm._config.map.quantiles && vm._config.map.quantiles.buckets \n        && vm._config.map.quantiles.buckets === 5){\n\n      if( quantile[1] === quantile[2] && quantile[2] === quantile[3] && quantile[3] === quantile[4] && quantile[4] === quantile[5]){\n        quantile = [ d3.quantile(values, 0), d3.quantile(values, 0.2) ];\n      }\n    }\n   \n    return quantile;\n  }\n\n  Map.prototype._getQuantileColor = function(d,type){\n    var vm = this; \n    var total = parseFloat(d);\n\n    //@TODO use quantile scale instead of manual calculations \n    if(vm._config && vm._config.map && vm._config.map.quantiles && vm._config.map.quantiles.colors){\n      if(vm._quantiles.length > 2){\n\n        if(vm._config && vm._config.map && vm._config.map.min !== undefined && vm._config.map.max !== undefined){\n          if(total < vm._config.map.min || total > vm._config.map.max){\n            console.log('outOfRangeColor', total, vm._config.map.min ,vm._config.map.max)\n            return vm._config.map.quantiles.outOfRangeColor; \n          }\n        }else{\n          if(total < vm._minMax[0] || total > vm._minMax[1]){\n            console.log('outOfRangeColor', total, vm._config.map.min ,vm._config.map.max)\n            return vm._config.map.quantiles.outOfRangeColor; \n          }\n        }\n\n        if(type == 'default'){\n          if(total <= vm._quantiles[1]){\n            return vm._config.map.quantiles.colors[0];//\"#f7c7c5\";\n          }else if(total <= vm._quantiles[2]){\n            return vm._config.map.quantiles.colors[1];//\"#e65158\";\n          }else if(total <= vm._quantiles[3]){\n            return vm._config.map.quantiles.colors[2];//\"#c20216\";\n          }else if(total <= vm._quantiles[4]){\n            return vm._config.map.quantiles.colors[3];//\"#750000\";\n          }else if(total <= vm._quantiles[5]){\n            return vm._config.map.quantiles.colors[4];//\"#480000\";\n          }\n        }\n\n        if(type == 'onHover' && vm._config.map.quantiles.colorsOnHover){\n          if(total <= vm._quantiles[1]){\n            return vm._config.map.quantiles.colorsOnHover[0];//\"#f7c7c5\";\n          }else if(total <= vm._quantiles[2]){\n            return vm._config.map.quantiles.colorsOnHover[1];//\"#e65158\";\n          }else if(total <= vm._quantiles[3]){\n            return vm._config.map.quantiles.colorsOnHover[2];//\"#c20216\";\n          }else if(total <= vm._quantiles[4]){\n            return vm._config.map.quantiles.colorsOnHover[3];//\"#750000\";\n          }else if(total <= vm._quantiles[5]){\n            return vm._config.map.quantiles.colorsOnHover[4];//\"#480000\";\n          }\n        }\n\n      }\n    }\n\n    if(vm._quantiles.length == 2){\n      /*if(total === 0 ){\n        return d4theme.colors.quantiles[0];//return '#fff';\n      }else if(total <= vm._quantiles[1]){\n        return d4theme.colors.quantiles[1];//return \"#f7c7c5\";\n      }*/\n      if(total <= vm._quantiles[1]){\n        return vm._config.map.quantiles.colors[0];//\"#f7c7c5\";\n      }\n    }\n\n  }\n\n\n\n return new Map(config);\n}","/*\n * Build a radar chart.\n */\n\nexport default function(config) {\n  function Radar(config) {\n    var vm = this, size;\n\n    vm.CIRCLE_RADIANS = 2 * Math.PI;\n\n    // The first axis must be at the circle's top.\n    vm.RADIANS_TO_ROTATE = vm.CIRCLE_RADIANS / -4;\n\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    vm._axesData = {};\n    vm._filter = null;\n    vm._minMax = [0, 0];\n    vm._viewData = [];\n    vm._colorMap = {};\n    vm._ticks = 0;\n    vm._scale = null;\n    vm._excludedPolygons = [];\n\n    // Set defaults.\n    if(!vm._config.ticks) {\n      vm._config.ticks = 10;\n    }\n\n    if(!vm._config.transitionDuration) {\n      vm._config.transitionDuration = 400;\n    }\n\n    if(!vm._config.axisLabelMargin) {\n      vm._config.axisLabelMargin = 24;\n    }\n\n    if(!vm._config.legend) {\n      vm._config.legend = {\n        enable: true\n      };\n    }\n\n    if(!vm._config.legend.at) {\n      vm._config.legend.at = {\n        x: 20,\n        y: 20\n      };\n    }\n\n    if('undefined' == typeof vm._config.styleDefaults) {\n      vm._config.styleDefaults = true;\n    }\n\n    // Calculate basic data.\n    size = vm._config.size;\n\n    vm._center = {\n      x: (size.width / 2) - size.margin.left,\n      y: (size.height / 2) - size.margin.top\n    };\n\n    vm._radius = Math.min(\n      (size.width - size.margin.left - size.margin.right) / 2,\n      (size.height - size.margin.top - size.margin.bottom) / 2\n    );\n  }\n\n  // User API.\n\n  Radar.prototype.polygonsFrom = function(column) {\n    var vm = this;\n    vm._config.polygonsFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.axesFrom = function(column) {\n    var vm = this;\n    vm._config.axesFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.valuesFrom = function(column) {\n    var vm = this;\n    vm._config.valuesFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.ticks = function(ticks) {\n    var vm = this;\n    vm._config.ticks = ticks;\n    return vm;\n  };\n\n  Radar.prototype.colors = function(colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    return vm;\n  };\n\n  Radar.prototype.end = function() {\n    var vm = this;\n    return vm._chart;\n  };\n\n  // Internal helpers.\n\n  Radar.prototype.drawTicks = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      dur = vm._config.transitionDuration,\n      sel;\n\n    sel = svg.select('g.ticks');\n\n    if(sel.empty()) {\n      sel = svg.append('g').attr('class', 'ticks');\n    }\n\n    sel = sel.selectAll('circle.tick')\n      .data(\n        // Add an explicit index for keying the chart with their original array\n        // indexes, then reverse it so rendering occurs from bigger to smaller\n        // circles, allowing to set a fill color to the concentric cirlces\n        // without getting the more external cirlce capping all the others.\n        vm._ticks.map((val, idx) => [idx, val]).reverse(),\n        d => d[0]);\n\n    sel\n      .transition()\n      .duration(dur)\n      .attr('r', function(d) { return vm._scale(d[1]); });\n\n    sel.enter()\n      .append('circle')\n      .classed('tick', true)\n      .attr('cx', vm._center.x)\n      .attr('cy', vm._center.y)\n      .style('fill', vm._ifStyleDefaults('none'))\n      .style('stroke', vm._ifStyleDefaults('gray'))\n      .attr('r', function(d) { return vm._scale(d[1]); })\n      .attr('opacity', 0)\n      .transition()\n      .duration(dur)\n      .attr('opacity', 1);\n\n    sel.exit()\n      .transition()\n      .duration(dur)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.drawTicksLabels = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      margin = 2,\n      dur = vm._config.transitionDuration,\n      sel;\n\n    sel = svg.select('g.ticks-labels');\n\n    if(sel.empty()) {\n      sel = svg.append('g').attr('class', 'ticks-labels');\n    }\n\n    sel = sel.selectAll('text.tick-label')\n      .data(vm._ticks);\n\n    sel\n      .transition()\n      .duration(dur)\n      .text(function(d) { return d; })\n      .attr('y', function(d) { return vm._center.y - margin - vm._scale(d); });\n\n    sel.enter()\n      .append('text')\n      .text(function(d) { return d; })\n      .attr('class', 'tick-label')\n      .attr('x', vm._center.x + margin)\n      .attr('y', function(d) { return vm._center.y - margin - vm._scale(d); })\n      .attr('fill', vm._ifStyleDefaults('gray'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'))\n      .attr('opacity', 0)\n      .transition()\n      .duration(dur)\n      .attr('opacity', 1);\n\n    sel.exit()\n      .transition()\n      .duration(dur)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.extractAxes = function(data) {\n    var result,\n      vm = this,\n      axes = vm._config.axesFrom,\n      radiansPerAxis;\n\n    result = data.reduce(\n      function(prev, item) {\n        return prev.indexOf(item[axes]) > -1\n          ? prev\n          : prev.concat(item[axes]);\n      }, []);\n\n    radiansPerAxis = (vm.CIRCLE_RADIANS / result.length);\n\n    result = result.map(\n      function(item, idx) {\n        return {\n          axis: item,\n          rads: (idx * radiansPerAxis) + vm.RADIANS_TO_ROTATE\n        };\n      });\n\n    return {\n      list: result,\n      hash: result.reduce(function(hashed, el) {\n        hashed[el.axis] = el;\n        return hashed;\n      }, {})\n    };\n  };\n\n  Radar.prototype.buildColorMap = function(data) {\n    var vm = this,\n      colors = vm._config.colors;\n    return data.reduce(function(cMap, row) {\n      var polyg = row[vm._config.polygonsFrom],\n        cIdx = cMap.index.indexOf(polyg);\n\n      if(cIdx == -1) {\n        cIdx = cMap.index.push(polyg) - 1;\n        cMap.hash[polyg] = colors[cIdx];\n        cMap.list.push({polygon: polyg, color: colors[cIdx]});\n      }\n      return cMap;\n    }, {index: [], hash: {}, list: []});\n  };\n\n  Radar.prototype.drawAxes = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      selection;\n\n    selection = svg.selectAll('line.axis')\n      .data(vm._axesData.list, function(d) { return d.axis; });\n\n    selection.enter()\n      .append('line')\n      .classed('axis', true)\n      .attr('x1', vm._center.x)\n      .attr('y1', vm._center.y)\n      .style('stroke', vm._ifStyleDefaults('gray'))\n      .attr('x2', vm._center.x)\n      .attr('y2', vm._center.y)\n      .transition()\n      .duration(duration)\n      .attr('x2', function(d) {\n        return vm.xOf(d.rads, vm._radius + 8);\n      })\n      .attr('y2', function(d) {\n        return vm.yOf(d.rads, vm._radius + 8);\n      });\n\n    selection\n      .transition()\n      .duration(duration)\n      .attr('x2', function(d) {\n        return vm.xOf(d.rads, vm._radius + 8);\n      })\n      .attr('y2', function(d) {\n        return vm.yOf(d.rads, vm._radius + 8);\n      });\n\n    selection.exit()\n      .transition()\n      .duration(duration)\n      .attr('x2', vm._center.x)\n      .attr('y2', vm._center.y)\n      .remove();\n  };\n\n  Radar.prototype.drawAxesLabels = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      fromCenter = vm._radius + vm._config.axisLabelMargin,\n      labels;\n\n    labels = svg.selectAll('text.axis-label')\n      .data(vm._axesData.list, function(d) { return d.axis; });\n\n    labels\n      .transition()\n      .duration(duration)\n      .attr('x', (d) => vm.xOf(d.rads, fromCenter))\n      .attr('y', (d) => vm.yOf(d.rads, fromCenter));\n\n    labels.enter()\n      .append('text')\n      .attr('class', 'axis-label')\n      .attr('text-anchor', 'middle')\n      .attr('fill', vm._ifStyleDefaults('gray'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'))\n      .text(function(d) { return d.axis; })\n      .attr('x', (d) => vm.xOf(d.rads, fromCenter))\n      .attr('y', (d) => vm.yOf(d.rads, fromCenter))\n      .attr('opacity', 0)\n      .transition()\n      .duration(duration)\n      .attr('opacity', 1);\n\n    labels.exit()\n      .transition()\n      .duration(duration)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.drawPolygons = function() {\n    var vm = this,\n      data = vm._viewData,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      groupedData,\n      gs, gsExit, gsEnter;\n\n    // Prepare the data.\n    groupedData = data.reduce(function(bundle, row) {\n      var polygIdx = bundle.keys.indexOf(row.polygon);\n      if(polygIdx == -1) {\n        polygIdx = bundle.keys.push(row.polygon) - 1;\n        bundle.polygons.push({\n          polygon: row.polygon,\n          color: row.color,\n          points: [],\n          values: []\n        });\n      }\n      bundle.polygons[polygIdx].values.push(row);\n      bundle.polygons[polygIdx].points.push(row.xy.join(','));\n      return bundle;\n    }, {keys: [], polygons:[]}).polygons;\n\n    gs = svg.selectAll('g.polygon-container')\n      .data(groupedData, function(d) { return d.polygon + '-container'; });\n\n    gsEnter = gs.enter()\n      .append('g')\n      .attr('class', 'polygon-container');\n\n    gsExit = gs.exit();\n    gsExit.transition().duration(duration).remove();\n\n    vm._buildNestedPolygons(gs, gsEnter, gsExit);\n    vm._buildNestedVertexes(gs, gsEnter, gsExit);\n  };\n\n  Radar.prototype._buildNestedVertexes = function(update, enter, exit) {\n    var vm = this,\n      duration = vm._config.transitionDuration,\n      selector = 'circle.vertex',\n      toUpdate;\n\n    function appendHelper(selection) {\n      selection\n        .append('circle')\n        .attr('class', 'vertex')\n        .attr('cx', vm._center.x)\n        .attr('cy', vm._center.y)\n        .attr('r', 4)\n        .attr('fill', d => d.color)\n        .call(updateHelper)\n        .on('mouseover', d => {\n          var x = d.xy[0] + 10,\n            y = d.xy[1] - 10;\n          vm._showTooltip(x, y, d.polygon, d.value);\n        })\n        .on('mouseout', () => {\n          vm._hideTooltip();\n        });\n    }\n\n    function removeHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('cx', vm._center.x)\n        .attr('cy', vm._center.y)\n        .remove();\n    }\n\n    function updateHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('cx', function(d) { return d.xy[0]; })\n        .attr('cy', function(d) { return d.xy[1]; });\n    }\n\n    function dataFunc(d) { return d.values; }\n\n    function keyFunc(d) { return d.polygon + '-' + d.axis; }\n\n    toUpdate = update.selectAll(selector)\n      .data(dataFunc, keyFunc);\n\n    toUpdate\n      .call(updateHelper);\n\n    toUpdate.enter()\n      .call(appendHelper);\n\n    toUpdate.exit()\n      .call(removeHelper);\n\n    enter.selectAll(selector)\n      .data(dataFunc, keyFunc)\n      .enter()\n      .call(appendHelper);\n\n    exit.selectAll(selector)\n      .call(removeHelper);\n  };\n\n  /**\n   * Draw a tooltip at the given X, Y possition.\n   * @param  {int} x       The X coordinate\n   * @param  {int} y       The Y coordinate\n   * @param  {string} val1 The value to show as the first line\n   * @param  {string} val2 The value to show in the second line\n   * @return {selection}   Return the created tooltip as a D3 selection\n   */\n  Radar.prototype._showTooltip = function(x, y, val1, val2) {\n    var tt, subtt, bg, bbox,\n      padding = 2,\n      vm = this,\n      svg = vm._chart._svg;\n\n    tt = svg.append('g')\n      .attr('class', 'tooltip')\n      .attr('opacity', 0);\n\n    bg = tt.append('rect').attr('class', 'tooltip-background');\n\n    subtt = tt\n      .append('text')\n      .attr('y', y)\n      .attr('x', x)\n      .style('fill', vm._ifStyleDefaults('white'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'));\n\n    subtt.append('tspan')\n      .text(val2);\n\n    subtt.append('tspan')\n      .attr('dy', '-1.2em')\n      .attr('x', x)\n      .text(val1);\n\n    bbox = tt.node().getBBox();\n\n    bg.attr('x', bbox.x - padding)\n      .attr('y', bbox.y - padding)\n      .attr('width', bbox.width + (padding * 2))\n      .attr('height', bbox.height + (padding + 2))\n      .style('fill', vm._ifStyleDefaults('gray'));\n\n    tt.transition()\n      .duration(200)\n      .attr('opacity', .9);\n\n    return tt;\n  };\n\n  /**\n   * Remove the tooltip created by _showTooltip()\n   * @return {undefined}\n   */\n  Radar.prototype._hideTooltip = function() {\n    this._chart._svg.selectAll('g.tooltip')\n      .transition()\n      .duration(200)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype._buildNestedPolygons = function(update, enter, exit) {\n    var vm = this,\n      duration = vm._config.transitionDuration,\n      selector = 'polygon.category',\n      toUpdate;\n\n    // Used for the transitions where the polygons expand from\n    // or shrink to the center.\n    function centerPoints(data) {\n      var center = [vm._center.x, vm._center.y].join(',');\n      return data.points.map(function() {\n        // All polygon's points move to the center.\n        return center;\n      }).join(' ');\n    }\n\n    function appendHelper(selection) {\n      selection\n        .append('polygon')\n        .attr('class', 'category')\n        .attr('points', centerPoints)\n        .style('stroke', function(d) { return d.color; })\n        .style('fill', function(d) { return d.color; })\n        .style('fill-opacity', 0.4)\n        .style('stroke-width', vm._ifStyleDefaults('1px'))\n        .call(updateHelper);\n    }\n\n    function removeHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('points', centerPoints)\n        .remove();\n    }\n\n    function updateHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('points', function(d) { return d.points.join(' '); });\n    }\n\n    function dataFunc(d) { return [d]; }\n\n    function keyFunc(d) { return d.polygon; }\n\n    toUpdate = update.selectAll(selector)\n      .data(dataFunc, keyFunc);\n\n    toUpdate\n      .call(updateHelper);\n\n    toUpdate.enter()\n      .call(appendHelper);\n\n    toUpdate.exit()\n      .call(removeHelper);\n\n    enter.selectAll(selector)\n      .data(dataFunc, keyFunc)\n      .enter()\n      .call(appendHelper);\n\n    exit.selectAll(selector)\n      .call(removeHelper);\n\n  };\n\n  Radar.prototype.drawLegend = function() {\n    var vm = this,\n      cMap = vm._colorMap.list,\n      svg = vm._chart._svg,\n      at = vm._config.legend.at,\n      side = 14,\n      margin = 4,\n      legend, newLegend;\n\n    legend = svg.selectAll('g.legend-item')\n      .data(cMap, function(d) { return d.polygon; })\n      .attr('opacity', d => {\n        return vm._excludedPolygons.indexOf(d.polygon) > -1 ? .4 : 1;\n      });\n\n    newLegend = legend.enter()\n      .append('g')\n      .on('click', (d) => {\n        vm._excludedPolygons = vm._toggleList(\n          vm._excludedPolygons, [d.polygon]);\n        vm.draw();\n      })\n      .attr('class', 'legend-item');\n\n    newLegend\n      .append('text')\n      .text(d => d.polygon)\n      .attr('x', at.x + side + margin)\n      .attr('y', (d, i) => ((side + margin) * i) + at.y + side)\n      .style('font-family', vm._ifStyleDefaults('sans-serif'));\n\n    newLegend\n      .append('rect')\n      .attr('fill', d => d.color)\n      .attr('width', side)\n      .attr('height', side)\n      .attr('x', at.x)\n      .attr('y', (d, i) => ((side + margin) * i) + at.y);\n  };\n\n  /**\n   * Return value if config styleDefaults is true, else null.\n   * @param  {string} value The value to use as default\n   * @return {string}       The value itself or null\n   */\n  Radar.prototype._ifStyleDefaults = function(value) {\n    return this._config.styleDefaults ? value : null;\n  };\n\n  /**\n   * Append items not present in base from items and pop those which are.\n   * @param  {array} base   Array to append to remove from.\n   * @param  {array} items  Items to be toogled (appended or removed).\n   * @return {array}        A new array.\n   */\n  Radar.prototype._toggleList = (base, items) => {\n    var newItems = items.filter(it => base.indexOf(it) == -1);\n    return base.filter(it => items.indexOf(it) == -1).concat(newItems);\n  };\n\n  Radar.prototype.xOf = function(rads, value) {\n    var vm = this;\n    return vm._center.x + (value * Math.cos(rads));\n  };\n\n  Radar.prototype.yOf = function(rads, value) {\n    var vm = this;\n    return vm._center.y + (value * Math.sin(rads));\n  };\n\n  Radar.prototype.minMax = function(data) {\n    var vm = this;\n    return data.reduce(function(minMax, row) {\n      var val = parseInt(row[vm._config.valuesFrom]);\n      if(minMax.length == 0) {\n        return [val, val];\n      }\n      return [\n        val < minMax[0] ? val : minMax[0],\n        val > minMax[1] ? val : minMax[1]\n      ];\n    }, []);\n  };\n\n  // Build the data with coords.\n  Radar.prototype.dataForVisualization = function(data) {\n    var vm = this,\n      scale = vm._scale,\n      axisKey = vm._config.axesFrom,\n      valKey = vm._config.valuesFrom,\n      polygKey = vm._config.polygonsFrom,\n      axesHash = vm._axesData.hash;\n\n    return data.map(function(row) {\n      var axis = row[axisKey],\n        rads = axesHash[axis].rads,\n        polygon = row[polygKey],\n        val = row[valKey],\n        scVal = scale(val);\n      return {\n        xy: [\n          vm.xOf(rads, scVal),\n          vm.yOf(rads, scVal)\n        ],\n        value: val,\n        polygon: polygon,\n        axis: axis,\n        color: vm._colorMap.hash[polygon],\n        rawData: row\n      };\n    });\n  };\n\n  Radar.prototype.filter = function(fun) {\n    var vm = this;\n    vm._filter = fun;\n    return vm;\n  };\n\n  // DBOX internals.\n\n  Radar.prototype.chart = function(chart) {\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  };\n\n  Radar.prototype.data = function(data) {\n    var vm = this;\n    vm._data = data;\n    return vm;\n  };\n\n  Radar.prototype.scales = function(scales) {\n    var vm = this;\n    vm._scales = scales;\n    // We only need one scale.\n    vm._scale = vm._scales.x;\n    vm._scale.range([0, vm._radius]);\n    return vm;\n  };\n\n  Radar.prototype.axes = function(axes) {\n    var vm = this;\n    // TODO Do nothing?\n    return vm;\n  };\n\n  Radar.prototype.domains = function() {\n    var vm = this;\n    vm._calcDomains(vm._data);\n    return vm;\n  };\n\n  Radar.prototype._calcDomains = function(data) {\n    var vm = this;\n    vm._minMax = vm.minMax(data);\n    vm._scale.domain([0, vm._minMax[1]]);\n    vm._ticks = vm._scale.ticks(vm._config.ticks);\n    // Exclude 0 from ticks if it is the first element.\n    // We don't need to have the 0 actually rendered.\n    if(vm._ticks.length > 0 && vm._ticks[0] === 0) {\n      vm._ticks = vm._ticks.slice(1);\n    }\n  };\n\n  Radar.prototype.draw = function() {\n    var vm = this,\n      data = vm._data;\n\n    // Build the color map previusly to filtering in order to keep the\n    // association between colors and polygons even when some of them (the\n    // polygons) have been filtered out.\n    vm._colorMap = vm.buildColorMap(data);\n\n    // Apply the filter function, if it's present.\n    if(typeof vm._filter === 'function') {\n      data = data.filter(vm._filter);\n    }\n\n    // Filter out excluded polygons from.\n    if(vm._excludedPolygons.length > 0) {\n      data = data.filter(it => {\n        return vm._excludedPolygons.indexOf(\n          it[vm._config.polygonsFrom]) == -1;\n      });\n    }\n\n    vm._calcDomains(data);\n    vm._axesData = vm.extractAxes(data);\n    vm._viewData = vm.dataForVisualization(data);\n\n    vm.drawTicks();\n    vm.drawAxes();\n    vm.drawAxesLabels();\n    vm.drawTicksLabels();\n    vm.drawPolygons();\n    vm.drawLegend();\n  };\n\n  return new Radar(config);\n\n}\n","/*\n * Simple Scatter chart\n */\n\nexport default function(config) {\n  \n  function Scatter(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    vm._tip = d3.tip().attr('class', 'd3-tip');\n  }\n\n  //-------------------------------\n  //User config functions\n  Scatter.prototype.x = function(col) {\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  }\n\n  Scatter.prototype.y = function(col) {\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  }\n\n  Scatter.prototype.radius = function(radius) {\n    var vm = this;\n    vm._config.radius = radius;\n    return vm;\n  }\n\n  Scatter.prototype.radiusRange = function(radiusRange) {\n    var vm = this;\n    vm._config.radiusRange = radiusRange;\n    return vm;\n  }\n\n  Scatter.prototype.properties = function(properties){\n    var vm = this;\n    vm._config.properties = properties;\n    return vm;\n  }\n\n  Scatter.prototype.color = function(col) {\n    var vm = this;\n    vm._config.color = col;\n    return vm;\n  }\n\n  Scatter.prototype.opacity = function(opacity) {\n    var vm = this;\n    vm._config.opacity = opacity;\n    return vm;\n  }\n\n  Scatter.prototype.tip = function(tip){\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  }\n\n  Scatter.prototype.end = function() {\n    var vm = this;\n    return vm._chart;\n  }\n\n  //-------------------------------\n  //Triggered by chart.js;\n  Scatter.prototype.chart = function(chart) {\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  }\n\n  Scatter.prototype.data = function(data) {\n    var vm = this;\n    vm._data = [];\n    data.forEach(function(d, i) {\n      var m = {};\n      m.datum = d;\n      m.x = vm._config.xAxis.scale == 'linear' ? +d[vm._config.x] : d[vm._config.x];\n      m.y = vm._config.yAxis.scale == 'linear'? +d[vm._config.y] : d[vm._config.y];\n      m.color = vm._config.color.slice(0,1) !== '#' ? d[vm._config.color] : vm._config.color;\n      m.radius = vm._config.radius !== undefined ? isNaN(vm._config.radius) ? +d[vm._config.radius] : vm._config.radius : 5;\n      \n      if(vm._config.properties !== undefined && Array.isArray(vm._config.properties) && vm._config.properties.length > 0){\n        vm._config.properties.forEach(function(p){\n          m[p] = d[p];\n        })\n      }\n      vm._data.push(m);\n    });\n    return vm;\n  }\n\n  Scatter.prototype.scales = function(s) {\n    var vm = this;\n    vm._scales = s;\n    return vm;\n  }\n\n  Scatter.prototype.axes = function(a) {\n    var vm = this;\n    vm._axes = a;\n    return vm;\n  }\n\n  Scatter.prototype.domains = function() {\n    var vm = this;\n    var xMinMax = d3.extent(vm._data, function(d) {\n        return d.x;\n      }),\n      yMinMax = d3.extent(vm._data, function(d) {\n        return d.y;\n      }), \n      radiusMinMax = d3.extent(vm._data, function(d) {\n        return d.radius;\n      }); \n\n    var arrOk = [0, 0];\n\n    if (vm._config.fixTo45) {\n      if (xMinMax[1] > yMinMax[1]) {\n        arrOk[1] = xMinMax[1];\n      } else {\n        arrOk[1] = yMinMax[1];\n      }\n\n      if (xMinMax[0] < yMinMax[0]) {\n        //yMinMax = xMinMax;\n        arrOk[0] = xMinMax[0];\n      } else {\n        arrOk[0] = yMinMax[0];\n      }\n\n      vm._scales.x.domain(arrOk).nice();\n      vm._scales.y.domain(arrOk).nice();\n      vm._scales.radius = d3.scaleLinear()\n                          .range(vm._config.radiusRange != undefined ? vm._config.radiusRange : [5, 15])\n                          .domain(radiusMinMax).nice(); \n\n    } else {\n      vm._scales.x.domain(xMinMax); //.nice();\n      vm._scales.y.domain(yMinMax); //.nice();\n      if(vm._scales.x.nice) {\n        vm._scales.x.nice();\n      }\n      if(vm._scales.y.nice) {\n        vm._scales.y.nice();\n      }\n      vm._scales.radius = d3.scaleLinear()\n                          .range(vm._config.radiusRange != undefined ? vm._config.radiusRange : [5, 15])\n                          .domain(radiusMinMax).nice(); \n      if(vm._config.xAxis && vm._config.xAxis.scale !== 'linear') {\n        vm._scales.x.domain(vm._data.map(function(m){ return m.x; }));\n      }\n      if(vm._config.yAxis && vm._config.yAxis.scale !== 'linear') {\n        vm._scales.y.domain(vm._data.map(function(m){ return m.y}));\n      }\n    }\n\n    if(vm._config.xAxis.scaleDomain && Array.isArray(vm._config.xAxis.scaleDomain)) {\n      vm._scales.x.domain(vm._config.xAxis.scaleDomain);\n      \n    } \n    if(vm._config.yAxis.scaleDomain && Array.isArray(vm._config.yAxis.scaleDomain)) {\n      vm._scales.y.domain(vm._config.yAxis.scaleDomain);\n    }\n    return vm;\n  };\n\n  Scatter.prototype.draw = function() {\n    var vm = this;\n    \n    //Call the tip\n    vm._chart._svg.call(vm._tip)\n    \n    var circles = vm._chart._svg.selectAll(\".dot\")\n      .data(vm._data)\n      //.data(vm._data, function(d){ return d.key})\n      .enter().append(\"circle\")\n      .attr(\"class\", \"dot\")\n      .attr(\"class\",function(d,i){\n        return d.properties !== undefined &&  d.properties.id !== undefined ? \"scatter-\"+d.properties.id : \"scatter-\"+i;\n      })\n      .attr(\"r\", function(d){\n        return vm._scales.radius(d.radius);\n      })\n      .attr(\"cx\", function(d) {\n        if(vm._config.xAxis.scale == 'ordinal' || vm._config.xAxis.scale == 'band')\n          return vm._scales.x(d.x) + (Math.random() * (vm._scales.x.bandwidth() - (d.size * 2)));\n        else \n          return vm._scales.x(d.x);\n      })\n      .attr(\"cy\", function(d) {\n        if(vm._config.yAxis.scale == 'ordinal' || vm._config.yAxis.scale == 'band')\n          return vm._scales.y(d.y) + (Math.random() * (vm._scales.y.bandwidth() - (d.size * 2)));\n        else \n          return vm._scales.y(d.y);\n      })\n      .style(\"fill\", function(d) {\n        return d.color.slice(0,1) !== '#' ?  vm._scales.color(d.color) : d.color;\n      })\n      .style(\"opacity\", vm._config.opacity !== undefined ? vm._config.opacity  : 1 )\n      .on('mouseover', function(d, i) {\n        if (vm._config.mouseover) {\n          vm._config.mouseover.call(vm, d, i);\n        }\n        vm._tip.show(d, d3.select(this).node());\n      })\n      .on('mouseout', function(d, i) {\n        if (vm._config.mouseout) {\n          vm._config.mouseout.call(this, d, i);\n        }\n        vm._tip.hide(d, d3.select(this).node());\n      })\n      .on(\"click\", function(d, i) {\n        if (vm._config.onclick) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n    return vm;\n  }\n\n  Scatter.prototype.select = function(id){\n    var vm = this; \n    return vm._chart._svg.select(\"circle.scatter-\"+id);\n  }\n\n  Scatter.prototype.selectAll = function(id){\n    var vm = this; \n    return vm._chart._svg.selectAll(\"circle\");\n  }\n\n  return new Scatter(config);\n}\n","import * as d3 from 'd3';\nimport * as _ from 'lodash';\n\n/*\n * Simple Spineplot\n */\nexport default function (config, helper) {\n\n  //Link Spineplot to the helper object in helper.js\n  var Spineplot = Object.create(helper);\n\n  Spineplot.init = function (config) {\n    var vm = this;\n\n    vm._config = config ? config : {};\n    vm._config.orientation = 'horizontal';\n    vm._data = [];\n    vm._scales = {};\n    vm._tip = vm.utils.d3.tip()\n      .attr(\n        'class', \n        'd3-tip ' + \n          (vm._config.tooltip && vm._config.tooltip.classed\n            ? vm._config.tooltip.classed\n            : '')\n      )\n      .direction('n')\n      .html(vm._config.tip || function (d) {\n        var html = '<div>';\n        html += '<span>' + d[vm._config.category] + '</span>';\n        html += '</br><span>' + vm.utils.format()(d[vm._config.value]) + '</span>';\n        html += '</div>';\n        return html;\n      });\n\n  };\n\n\n  //-------------------------------\n  //User config functions\n  Spineplot.id = function (columnName) {\n    var vm = this;\n    vm._config.id = columnName;\n    return vm;\n  };\n\n  Spineplot.category = function (columnName) {\n    var vm = this;\n    vm._config.category = columnName;\n    return vm;\n  };\n\n  Spineplot.value = function (columnName) {\n    var vm = this;\n    vm._config.value = columnName;\n    return vm;\n  };\n\n  Spineplot.orientation = function (orientation) {\n    var vm = this;\n    vm._config.orientation = orientation;\n    return vm;\n  };\n\n  /**\n   * Used to draw a bar chart stacked with multiple bars per group\n   * @param {array} columns \n   */\n  Spineplot.stackBy = function (columnName) {\n    var vm = this;\n    vm._config.stackBy = columnName;\n    return vm;\n  };\n\n  /**\n   * column name used for the domain values\n   * @param {string} columnName \n   */\n  Spineplot.fill = function (columnName) {\n    var vm = this;\n    vm._config.fill = columnName;\n    return vm;\n  };\n\n  /**\n   * array of values used \n   * @param {array or scale} columnName \n   */\n  Spineplot.colors = function (colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Spineplot.sortBy = function (option) {\n    //option = string [asc,desc] \n    //option = array for groupBy and stackBy\n    var vm = this;\n    vm._config.sortBy = option;\n    return vm;\n  };\n\n  Spineplot.format = function (format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function)\n      vm.utils.format = format;\n    else\n      vm.utils.format = d3.format(format);\n    return vm;\n  };\n\n  Spineplot.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    return vm;\n  };\n\n  Spineplot.legend = function (legend) {\n    var vm = this;\n    vm._config.legend = legend;\n    return vm;\n  };\n\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Spineplot.data = function (data) {\n    var vm = this;\n\n    if (vm._config.filter) {\n      // In case we want to filter observations\n      data = data.filter(vm._config.filter);\n    }\n    //@TODO - ALLOW MULITPLE SORTS\n    if (vm._config.sortBy) {\n      if (vm._config.sortBy.category) {\n        data = data.sort(function (a, b) {\n          return vm._config.sortBy.category === 'desc' ? vm.utils.sortDescending(a[vm._config.category], b[vm._config.category]) : vm.utils.sortAscending(a[vm._config.category], b[vm._config.category]);\n        });\n      }\n      if (vm._config.sortBy.value) {\n        data = data.sort(function (a, b) {\n          return vm._config.sortBy.value === 'desc' ? vm.utils.sortDescending(a[vm._config.value], b[vm._config.value]) : vm.utils.sortAscending(a[vm._config.value], b[vm._config.value]);\n        });\n      }\n    } else {\n      data = data.sort(function (a, b) {\n        return vm.utils.sortAscending(a[vm._config.category], b[vm._config.category]);\n      });\n    }\n\n    var total = 0;\n    vm._data = data.map(function(d) {\n      d.x0 = total;\n      d.x1 = total + d[vm._config.value];\n      total += +d[vm._config.value];\n      if (vm._config.hasOwnProperty('stackBy') && Array.isArray(vm._config.stackBy) && vm._config.stackBy.length > 0) {\n        d.stackValues = d3.stack().keys(vm._config.stackBy)([d]);\n        d.totalCollapse = d3.sum(d.stackValues, function(stack) {\n          return stack[0][1] - stack[0][0];\n        });\n      }\n      return d;\n    });\n\n    if (vm._config.hasOwnProperty('quantiles')) {\n      vm._quantiles = vm._setQuantile(data);\n      vm._minMax = d3.extent(data, function (d) {\n        return +d[vm._config.fill];\n      });\n    }\n\n    return vm;\n  };\n\n  Spineplot.scales = function () {\n    var vm = this;\n    var config;\n    //vm._scales = s;\n    /* Use\n     * vm._config.category\n     * vm._config.categoryAxis.scale\n     * vm._config.value\n     * vm._config.valueAxis.scale\n     * vm._data\n     */\n    // Normal bars \n    if (vm._config.hasOwnProperty('category') && vm._config.hasOwnProperty('value')) {\n      config = {\n        column: 'x1',\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      config = {\n        column: vm._config.value,\n        type: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n\n    //Stack bars on the xAxis\n    if (vm._config.orientation === 'horizontal' && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: 'x1',\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate y scale */\n      config = {\n        column: '',\n        type: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.y = d3.scaleLinear().range(config.range).domain([0, 1]);\n    }\n\n    //Stack bars on the yAxis\n    if (vm._config.orientation === 'vertical' && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: '',\n        txpe: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.x = d3.scaleLinear().range(config.range).domain([0, 1]);\n\n      /* Generate y scale */\n      config = {\n        column: vm._config.value,\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n      \n    }\n    //vm.chart.scales.x = vm._scales.x;\n    //vm.chart.scales.y = vm._scales.y;\n\n    if (vm._config.hasOwnProperty('colors'))\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    else\n      vm._scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    return vm;\n  };\n\n  Spineplot.drawLabels = function() {\n    var vm = this;\n    var groups = vm.chart.svg().selectAll('.division');\n    groups.each(function(dat) {\n      var el = this;\n      dat.stackValues.forEach(function(sv) {\n        var rectW = vm._scales.x(sv[0].data[vm._config.value]);\n        var rectH = vm._scales.y((sv[0][0] / sv[0].data.totalCollapse)) - vm._scales.y(sv[0][1] / sv[0].data.totalCollapse);\n        if (rectH > 25 && rectW > 112) {\n          d3.select(el).append('text')\n            .attr('class', 'dbox-label')\n            .attr('text-anchor', 'middle')\n            .attr('transform', function() {\n              return 'translate(' + (vm._scales.x(sv[0].data.x0) + rectW/2) + ',' + (sv[0][1] ? vm._scales.y(sv[0][1] / sv[0].data.totalCollapse) + 20 : vm._scales.y(0) + 20) + ')';\n            })\n            .text(function() {\n              return 'X: ' + vm.utils.format(vm._config.xAxis)(sv[0].data[vm._config.value]) + ', Y: ' + vm.utils.format(vm._config.yAxis)(sv[0].data[sv.key]);\n            });\n        }\n      });\n    });\n  };\n\n  Spineplot.draw = function() {\n    var vm = this;\n    if (vm._config.hasOwnProperty('stackBy')) {\n      if (vm._config.orientation === 'horizontal') vm._drawStackByXAxis();\n      if (vm._config.orientation === 'vertical') vm._drawStackByYAxis();\n      return vm;\n    }\n\n    vm.chart.svg().call(vm._tip);\n\n    const axesTip = vm.utils.d3.tip()\n      .attr('class', 'title-tip')\n      .html(d => {\n        return d[vm._config.category];\n      });\n    vm.chart.svg().call(axesTip);\n\n    if (vm._config.orientation === 'horizontal') {\n\n      /**\n       * x axis tick labels\n       */\n      let posX = [];\n      vm._xLabels = vm.chart.svg().append('g')\n        .attr('class', 'x axis')\n        .attr('transform', 'translate(0,' + (vm.chart.height + 20) + ')')\n        .selectAll('.tick')\n        .data(vm._data)\n        .enter()\n        .append('g')\n        .attr('class', 'tick')\n        .attr('transform', d => {\n          const x = vm._scales.x(d.x0) + (vm._scales.x(d.x1 - d.x0) / 2);\n          posX.push(x);\n          return 'translate(' + x + ', 8)'; \n        })\n        .append('text')\n        .attr('text-anchor', 'middle')\n        .text(function(d) {\n          return d[vm._config.category];\n        });\n\n      let labelMaxWidth = d3.min(vm._data, function (d) {\n        return (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n      });\n      const largestLabelWidth = d3.max(vm._xLabels.nodes(), function (node) {\n        return node.getComputedTextLength();\n      });\n      let removed = [];\n\n      vm._xLabels.each(function (d, index, el) {\n        //const currentWidth = this.getComputedTextLength();\n        //let labelMaxWidth = (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n        if (largestLabelWidth < (labelMaxWidth * 2)) {\n          d3.select(this).call(vm.utils.wrap, labelMaxWidth, axesTip);\n        } else {\n          d3.select(this)\n            .attr('text-anchor', 'end')\n            .attr('dy', 0)\n            .attr('transform', 'translate(3,-8)rotate(-90)');\n          let newLabelMaxWidth = vm._config.size.margin.bottom * 0.9;\n          if (this.getComputedTextLength() > newLabelMaxWidth) {\n            d3.select(this)\n              .on('mouseover', axesTip.show)\n              .on('mouseout', axesTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > newLabelMaxWidth) {\n              d3.select(this).text(function (d) {\n                return (d[vm._config.category] + '').slice(0, -i) + '...';\n              }).attr('title', d);\n              ++i;\n            }\n          }\n        }\n\n        let textSize = window.getComputedStyle(this, null).getPropertyValue('font-size');\n        let numSize = Number(textSize.replace(/\\D/g,''));\n\n        if (index !== 0 && index !== vm._data.length - 1) {\n          let diffPos1 = posX[index] - posX[index - 1];\n          let diffPos2 = posX[index + 1] - posX[index];\n\n          let lessThanPrev = d.value < vm._data[index - 1].value;\n          let lessThanPost = d.value < vm._data[index + 1].value;\n\n          if (diffPos1 < numSize - 2 || diffPos2 < numSize - 2) {\n            if (lessThanPrev || lessThanPost) {\n              d3.select(this).remove();\n              removed.push(index);\n            }\n          }\n        }\n      });\n      \n\n      vm.chart.svg().selectAll('.bar')\n        .data(vm._data)\n        .enter().append('rect')\n        .attr('class', 'bar')\n        .attr('id', (d, i) => {\n          var id = 'spineplot-' + i;\n          if (vm._config.id) {\n            id = 'spineplot-' + d[vm._config.id];\n          }\n          return id;\n        })\n        .attr('x', (d) => vm._scales.x(d.x0) )\n        .attr('y', 0)\n        .attr('width', d => vm._scales.x(d[vm._config.value]) )\n        .attr('height', vm.chart.height ? vm.chart.height : 100)\n        .attr('fill', (d) => {\n          return vm._scales.color !== false ? vm._scales.color(d[vm._config.fill]) : vm._getQuantileColor(d[vm._config.fill], 'default');\n        })\n        .attr('stroke', 'white')\n        .attr('stroke-width', 1)\n        .style('opacity', 0.9)\n        .on('mouseover', function(d, i) {\n          if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n            d3.select(this).attr('fill', function (d) {\n              return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n            });\n          }\n          vm._tip.show(d, d3.select(this).node());\n\n          if (vm._config.hasOwnProperty('onmouseover')) { //External function call, must be after all the internal code; allowing the user to overide \n            vm._config.onmouseover.call(this, d, i);\n          }\n\n        })\n        .on('mouseout', function (d, i) {\n          if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n            d3.select(this).attr('fill', function (d) {\n              return vm._getQuantileColor(d[vm._config.fill], 'default');\n            });\n          }\n          vm._tip.hide();\n\n          if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n            vm._config.onmouseout.call(this, d, i);\n          }\n        })\n        .on('click', function (d, i) {\n          if (vm._config.hasOwnProperty('click')) {\n            vm._config.onclick.call(this, d, i);\n          }\n        });\n    }\n    return vm;\n  };\n\n\n  //\n  /** \n   * Draw bars grouped by \n   */\n  Spineplot._drawStackByXAxis = function () {\n    var vm = this;\n    vm._tip.html(vm._config.tip || function (d) {\n      var cat = '';\n      cat += '<span>' + d.key + '</span>';\n      if (d.key !== d[0].data[vm._config.category]) {\n        cat += '<br><span>Y: ' + vm.utils.format(vm._config.yAxis)(d[0].data[d.key]) + '</span>';\n        cat += '<br><span>' + d[0].data[vm._config.category] + '</span>';\n        cat += '<br><span>X: ' + vm.utils.format(vm._config.xAxis)(d[0].data[vm._config.value]) + '</span>';\n      } else {\n        cat += '<br><span>' + vm.utils.format()(d[0].data[d.key]) + '</span>';\n      }\n      return cat;\n    });\n    vm.chart.svg().call(vm._tip);\n\n    const axesTip = vm.utils.d3.tip()\n      .attr('class', 'title-tip')\n      .html(d => {\n        return d[vm._config.category];\n      });\n    vm.chart.svg().call(axesTip);\n\n    /**\n     * x axis labels\n     */\n    vm._xLabels = vm.chart.svg().append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(0,' + (vm.chart.height + 20) + ')')\n      .selectAll('g')\n      .data(vm._data)\n      .enter()\n      .append('g')\n      .attr('class', 'tick')\n      .attr('transform', d => {\n        const x = vm._scales.x(d.x0) + (vm._scales.x(d.x1 - d.x0) / 2);\n        return 'translate(' + x + ', 0)';\n      })\n      .append('text')\n      .attr('text-anchor', 'middle')\n      .text(d => d[vm._config.category]);\n\n    let labelMaxWidth = d3.min(vm._data, function(d) {\n      return (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n    });\n    const largestLabelWidth = d3.max(vm._xLabels.nodes(), function (node) {\n      return node.getComputedTextLength();\n    });\n    \n    vm._xLabels.each(function (d) {\n      //const currentWidth = this.getComputedTextLength();\n      //let labelMaxWidth = (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n      if (largestLabelWidth < (labelMaxWidth * 2)) {\n        d3.select(this).call(vm.utils.wrap, labelMaxWidth, axesTip);\n      } else {\n        d3.select(this)\n          .attr('text-anchor', 'end')\n          .attr('dy', 0)\n          .attr('transform', 'translate(3,-8)rotate(-90)');\n        let newLabelMaxWidth = vm._config.size.margin.bottom * 0.9;\n        if (this.getComputedTextLength() > newLabelMaxWidth) {\n          d3.select(this)\n            .on('mouseover', axesTip.show)\n            .on('mouseout', axesTip.hide);\n          let i = 1;\n          while (this.getComputedTextLength() > newLabelMaxWidth) {\n            d3.select(this).text(function (d) {\n              return (d[vm._config.category] + '').slice(0, -i) + '...';\n            }).attr('title', d);\n            ++i;\n          }\n        }\n      }\n    });\n      \n    var groups = vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('class', 'division');\n\n    groups.selectAll('rect')\n      .data(function (d) {\n        return d.stackValues;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return d[0][1] ? vm._scales.y(d[0][1] / d[0].data.totalCollapse) : vm._scales.y(0);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d[0].data.x0);\n      })\n      .attr('width', function (d) {\n        return vm._scales.x(d[0].data[vm._config.value]);\n      })\n      .attr('height', function (d) {\n        var h = vm._scales.y((d[0][0] / d[0].data.totalCollapse)) - vm._scales.y(d[0][1] / d[0].data.totalCollapse);\n        return h;\n      })\n      .attr('stroke', 'white')\n      .attr('stroke-width', 1)\n      .attr('fill', function (d) {\n        return vm._scales.color(d[vm._config.fill]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n    Spineplot.drawLabels();\n  };\n\n  Spineplot._drawStackByYAxis = function () {\n    var vm = this;\n\n    vm._tip.html(vm._config.tip || function (d) {\n      var html = '<div><span>' + d[vm._config.category] + '<span><br>';\n      for (var k in d.data) {\n        if ((d[1] - d[0]) == d.data[k]) {\n          html += '<span>' + k + '</span>';\n        }\n      }\n      html += '<br>' + vm.utils.format()(d[1] - d[0]);\n      return html;\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('class', 'division')\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      .selectAll('rect')\n      .data(function (d) {\n        return d;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return vm._scales.y(d.data[vm._config.value]);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d[0]);\n      })\n      .attr('height', vm._scales.y.bandwidth())\n      .attr('width', function (d) {\n        return vm._scales.x(d[1]) - vm._scales.x(d[0]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n  };\n\n  Spineplot._setQuantile = function (data) {\n    var vm = this;\n    var values = [];\n    var quantile = [];\n\n    if (vm._config.quantiles && vm._config.quantiles.predefinedQuantiles &&\n      vm._config.quantiles.predefinedQuantiles.length > 0) {\n      return vm._config.quantiles.predefinedQuantiles;\n    }\n\n    data.forEach(function (d) {\n      values.push(+d[vm._config.fill]);\n    });\n\n    values.sort(vm.utils.sortAscending);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.quantiles && vm._config.quantiles.buckets) {\n\n      if (vm._config.quantiles.ignoreZeros === true) {\n        var aux = _.dropWhile(values, function (o) {\n          return o <= 0;\n        });\n        //aux.unshift(values[0]);  \n\n        quantile.push(values[0]);\n        quantile.push(0);\n\n        for (var i = 1; i <= vm._config.quantiles.buckets - 1; i++) {\n          quantile.push(d3.quantile(aux, i * 1 / (vm._config.quantiles.buckets - 1)));\n        }\n\n      } else {\n        quantile.push(d3.quantile(values, 0));\n        for (var j = 1; j <= vm._config.quantiles.buckets; j++) {\n          quantile.push(d3.quantile(values, j * 1 / vm._config.quantiles.buckets));\n        }\n      }\n\n    } else {\n      quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2), d3.quantile(values, 0.4), d3.quantile(values, 0.6), d3.quantile(values, 0.8), d3.quantile(values, 1)];\n    }\n\n    //@TODO - VALIDATE WHEN ZEROS NEED TO BE PUT ON QUANTILE 1 AND RECALCULATE NON ZERO VALUES INTO THE REST OF THE BUCKETS\n    if (vm._config.quantiles && vm._config.quantiles.buckets && vm._config.quantiles.buckets === 5) {\n\n      if (quantile[1] === quantile[2] && quantile[2] === quantile[3] && quantile[3] === quantile[4] && quantile[4] === quantile[5]) {\n        quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2)];\n      }\n    }\n\n    return quantile;\n  };\n\n  Spineplot._getQuantileColor = function (d, type) {\n    var vm = this;\n    var total = parseFloat(d);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.bars.quantiles && vm._config.bars.quantiles.colors) {\n      if (vm._quantiles.length > 2) {\n\n        if (vm._config && vm._config.bars.min !== undefined && vm._config.bars.max !== undefined) {\n          if (total < vm._config.bars.min || total > vm._config.bars.max) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        } else {\n          if (total < vm._minMax[0] || total > vm._minMax[1]) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        }\n\n        if (type == 'default') {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.bars.quantiles.colors[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.bars.quantiles.colors[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.bars.quantiles.colors[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colors[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colors[4]; //'#480000';\n          }\n        }\n\n        if (type == 'onHover' && vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.quantiles.colorsOnHover[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.quantiles.colorsOnHover[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.quantiles.colorsOnHover[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colorsOnHover[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colorsOnHover[4]; //'#480000';\n          }\n        }\n\n      }\n    }\n\n    if (vm._quantiles.length == 2) {\n      /*if(total === 0 ){\n        return d4theme.colors.quantiles[0];//return '#fff';\n      }else if(total <= vm._quantiles[1]){\n        return d4theme.colors.quantiles[1];//return '#f7c7c5';\n      }*/\n      if (total <= vm._quantiles[1]) {\n        return vm._config.quantiles.colors[0]; //'#f7c7c5';\n      }\n    }\n\n  };\n\n  Spineplot.init(config);\n  return Spineplot;\n}\n","/* Simple timeline example\n * Single and multiline timelines\n */\n\nexport default function(config) {\n\n  var parseDate = d3.timeParse('%Y-%m-%d');\n\n  function Timeline(config){\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales ={};\n    vm._axes = {};\n\n    vm._line = d3.line()\n      .curve(d3.curveBasis)\n      .x(function(d) { return vm._scales.x(d.x); })\n      .y(function(d) { return vm._scales.y(d.y); });\n\n\n    vm._area = d3.area()\n      .curve(d3.curveBasis)\n      .x(function(d) {\n        if (d.alreadyScaled && d.alreadyScaled === true){\n          return d.x;\n        }else{\n          return vm._scales.x(d.x);\n        }\n      })\n      .y1(function(d) {\n        if (d.alreadyScaled && d.alreadyScaled === true){\n          return d.y;\n        }else{\n          return vm._scales.y(d.y);\n        }\n\n      });\n\n  }\n\n  //-------------------------------\n  //User config functions\n  Timeline.prototype.x = function(col){\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  }\n\n  Timeline.prototype.y = function(col){\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  }\n\n  Timeline.prototype.series = function(arr){\n    var vm = this;\n    vm._config.series = arr;\n    return vm;\n  }\n\n  Timeline.prototype.color = function(col){\n    var vm = this;\n    vm._config.color = col;\n    return vm;\n  }\n\n  Timeline.prototype.end = function(){\n    var vm = this;\n    return vm._chart;\n  }\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Timeline.prototype.chart = function(chart){\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  }\n\n\n  Timeline.prototype.data = function(data){\n    var vm = this;\n\n    vm._data = data.map(function(d){\n      d.x = parseDate(d[vm._config.x]);\n      d.color = d[vm._config.color];\n      delete(d[vm._config.x]);\n      return d;\n    });\n\n    vm._lines = vm._config.y ? vm._config.y : vm._config.series;\n\n    vm._lines = vm._lines.map(function(name) {\n      return {\n        name: name,\n        values: data.map(function(d) {\n          return {x: d.x, y: +d[name]};\n        })\n      };\n    });\n\n    return vm;\n  }\n\n  Timeline.prototype.scales = function(s){\n    var vm = this;\n    vm._scales = s;\n    return vm;\n  }\n\n  Timeline.prototype.axes = function(a){\n    var vm = this;\n    vm._axes = a;\n    return vm;\n  }\n\n  Timeline.prototype.domains = function(){\n    var vm = this;\n    vm._xMinMax = d3.extent(vm._data, function(d) { return d.x; });\n\n    vm._yMinMax = [\n      d3.min(vm._lines, function(c) { return d3.min(c.values, function(v) { return v.y; }); }),\n      d3.max(vm._lines, function(c) { return d3.max(c.values, function(v) { return v.y; }); })\n    ];\n\n    vm._scales.x.domain(vm._xMinMax)\n    vm._scales.y.domain(vm._yMinMax)\n\n    console.log(vm._scales.x.domain(), vm._chart._scales.x.domain())\n\n    vm._chart._scales = vm._scales;\n\n    return vm;\n  };\n\n  Timeline.prototype.draw = function(){\n    var vm = this;\n\n    var lines = vm._chart._svg.selectAll(\".lines\")\n      .data(vm._lines)\n    .enter().append(\"g\")\n      .attr(\"class\", \"lines\");\n\n    var path = vm._chart._svg.selectAll(\".lines\").append(\"path\")\n      .attr(\"class\", \"line\")\n      .attr(\"d\", function(d) {\n        return vm._line(d.values);\n      })\n      .style(\"stroke\", function(d){\n        if (d.name == \"Airbus\"){\n          return \"rgb(000,255,000)\";\n        }else {\n          return \"#000\";\n        }\n      });\n\n\n    var t = textures.lines().thicker();\n\n    vm._chart._svg.call(t);\n\n\n    vm._area.y0(vm._scales.y(vm._yMinMax[0]));\n\n    var areas = vm._chart._svg.selectAll(\".areas\")\n      .data(vm._lines)\n    .enter().append(\"g\")\n      .attr(\"class\", \"areas\");\n\n    var pathArea  = vm._chart._svg.selectAll(\".areas\").append(\"path\")\n      .attr(\"class\", \"area\")\n      .attr(\"d\", function(d) {\n        return vm._area(d.values);\n      })\n      .attr(\"fill\", t.url());\n\n    return vm;\n  }\n\n  return new Timeline(config);\n}\n","/* \n * Simple SVG Treemap Chart\n */\n\nexport default function(config) {\n  function Treemap(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._config._padding = 3;\n    vm._config._colorScale = d3.scaleOrdinal(d3.schemeCategory20c);\n    vm._config._format = d3.format(\",.1f\");\n    vm._config._labels = true;\n    vm._config.tip = function(d) {\n      return d.data.name + \"\\n\" + vm._config._format(d.value);\n    };\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    vm._tip = d3.tip()\n      .attr('class', 'd3-tip tip-treemap')\n      .direction('n')\n      .html(vm._config.tip);\n  }\n\n  //-------------------------------\n  //User config functions\n  Treemap.prototype.end = function() {\n    var vm = this;\n    return vm._chart;\n  }\n\n  Treemap.prototype.size = function(col) {\n    var vm = this;\n    vm._config._size = col;\n    return vm;\n  }\n\n  Treemap.prototype.colorScale = function(arrayOfColors) {\n    var vm = this;\n    vm._config._colorScale = d3.scaleOrdinal(arrayOfColors);\n    return vm;\n  }\n\n  Treemap.prototype.padding = function(padding) {\n    var vm = this;\n    vm._config._padding = padding;\n    return vm;\n  }\n\n  Treemap.prototype.nestBy = function(keys) {\n    var vm = this;\n    if (Array.isArray(keys)) {\n      if (keys.length == 0)\n        throw \"Error: nestBy() array is empty\";\n      vm._config._keys = keys;\n    } else if (typeof keys === 'string' || keys instanceof String) {\n      vm._config._keys = [keys];\n    } else {\n      if (keys == undefined || keys == null)\n        throw \"Error: nestBy() expects column names to deaggregate data\";\n      vm._config._keys = [keys.toString()];\n      console.warning(\"nestBy() expected name of columns. Argument will be forced to string version .toString()\");\n    }\n    vm._config._labelName = vm._config._keys[vm._config._keys.length - 1]; //label will be last key\n    return vm;\n  }\n\n  Treemap.prototype.format = function(format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function)\n      vm._config._format = format;\n    else\n      vm._config._format = d3.format(format);\n    return vm;\n  }\n\n  Treemap.prototype.labels = function(bool) {\n    var vm = this;\n    vm._config._labels = Boolean(bool);\n    return vm;\n  };\n\n  Treemap.prototype.tip = function(tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  }\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Treemap.prototype.chart = function(chart) {\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  }\n\n  Treemap.prototype.scales = function() {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.prototype.axes = function() {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.prototype.domains = function() {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.prototype.isValidStructure = function(datum) {\n    var vm = this;\n    if ((typeof datum.name === 'string' || datum.name instanceof String) && Array.isArray(datum.children)) {\n      var res = true;\n      datum.children.forEach(function(child) {\n        res = res && vm.isValidStructure(child);\n      });\n      return res;\n    } else if ((typeof datum.name === 'string' || datum.name instanceof String) && Number(datum[vm._config._size]) == datum[vm._config._size]) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  Treemap.prototype.formatNestedData = function(data) {\n    var vm = this;\n    if (data.key) {\n      data.name = data.key;\n      delete data.key;\n    } else {\n      if (!Array.isArray(data.values)) {\n        data.name = data[vm._config._labelName];\n      }\n    }\n    if (Array.isArray(data.values)) {\n      var children = [];\n      data.values.forEach(function(v) {\n        children.push(vm.formatNestedData(v))\n      });\n      data.children = children;\n      delete data.values;\n    }\n    if (!data[vm._config._size] && data.value) {\n      data[vm._config._size] = data.value;\n    }\n    return data;\n  }\n\n  function nestKey(nest, key, callback) {\n    callback(null, nest.key(function(d) {\n      return d[key];\n    }))\n  }\n\n  Treemap.prototype.data = function(data) {\n    var vm = this;\n    // Validate structure like [{name: '', children: [{},{}]}]\n    if (data) {\n      if (Array.isArray(data) && data.length > 0) {\n        if (!vm.isValidStructure(data[0])) {\n          data.forEach(function(d) {\n            d[vm._config._size] = +d[vm._config._size];\n          });\n          try {\n            if (!vm._config._keys)\n              throw \"nestBy() in layer was not configured\";\n            var nested = d3.nest();\n            var queue = d3.queue();\n            for (var i = 0; i < vm._config._keys.length; i++)\n              queue.defer(nestKey, nested, vm._config._keys[i])\n            queue.awaitAll(function(error, nested) {\n              var nestedData = nested[0].rollup(function(leaves) {\n                return d3.sum(leaves, function(d) {\n                  return d[vm._config._size];\n                })\n              }).entries(data);\n              var aux = {};\n              aux.key = 'data';\n              aux.values = _.cloneDeep(nestedData); // WARN: Lodash dependency\n              data = vm.formatNestedData(aux);\n              vm._data = data;\n            });\n\n          } catch (err) {\n            console.error(err);\n          }\n        }\n      } else {\n        if (!vm.isValidStructure(data)) {\n          try {\n            if (!data.key)\n              throw \"Property 'key' not found\";\n            if (data[vm._config._size] !== Number(data[vm._config._size]))\n              throw \"Value used for treemap rect size is not a number\";\n            data = vm.formatNestedData(data);\n            vm._data = data;\n          } catch (err) {\n            console.error(err);\n          }\n        }\n      }\n    }\n    return vm;\n  }\n\n  Treemap.prototype.draw = function() {\n    var vm = this;\n    vm._chart._svg.call(vm._tip);\n\n    var treemap = d3.treemap()\n      .tile(d3.treemapResquarify)\n      .size([vm._chart._width, vm._chart._height])\n      .round(true)\n      .paddingInner(vm._config._padding);\n\n    var root = d3.hierarchy(vm._data)\n      .eachBefore(function(d) {\n        d.data.id = (d.parent ? d.parent.data.id + \".\" : \"\") + d.data.name;\n      })\n      .sum(function(d) {\n        return d[vm._config._size];\n      })\n      .sort(function(a, b) {\n        return b.height - a.height || b.value - a.value;\n      });\n\n    treemap(root);\n\n    var cell = vm._chart._svg.selectAll(\"g\")\n      .data(root.leaves())\n      .enter().append(\"g\")\n      .attr(\"transform\", function(d) {\n        return \"translate(\" + d.x0 + \",\" + d.y0 + \")\";\n      });\n\n    var rect = cell.append(\"rect\")\n      .attr(\"id\", function(d) {\n        return d.data.id;\n      })\n      .attr(\"width\", function(d) {\n        return d.x1 - d.x0;\n      })\n      .attr(\"height\", function(d) {\n        return d.y1 - d.y0;\n      })\n      .attr(\"fill\", function(d) {\n        return vm._config._colorScale(d.data.id);\n      });\n\n    cell.append(\"clipPath\")\n      .attr(\"id\", function(d) {\n        return \"clip-\" + d.data.id;\n      })\n      .append(\"use\")\n      .attr(\"xlink:href\", function(d) {\n        return \"#\" + d.data.id;\n      });\n\n    if (vm._config._labels) {\n      var text = cell.append(\"text\")\n        .attr(\"clip-path\", function(d) {\n          return \"url(#clip-\" + d.data.id + \")\";\n        })\n      text.append(\"tspan\")\n        .attr('class', 'capitalize')\n        .attr(\"x\", 8)\n        .attr(\"y\", 25)\n        .text(function(d) {\n          if (d.value > 2) {\n            var arr = d.data.id.replace('data.', '').split('.');\n            return arr.length > 1 ? arr.slice(arr.length - 2, arr.length).join(' / ') : arr[arr.length - 1].toString();\n          } else\n            return '';\n        });\n      text.append(\"tspan\")\n        .attr('class', 'capitalize')\n        .attr(\"x\", 8)\n        .attr(\"y\", 45)\n        .text(function(d) {\n          return d.value > 2 ? vm._config._format(d.value) : '';\n        });\n    }\n\n    rect.on('mouseover', function(d) {\n        /*if(vm._config.data.mouseover){\n          vm._config.data.mouseover.call(vm, d,i);\n        }*/\n        vm._tip.show(d, d3.select(this).node());\n      })\n      .on('mouseout', function(d) {\n        /*if(vm._config.data.mouseout){\n          vm._config.data.mouseout.call(this, d,i);\n        }*/\n        vm._tip.hide(d, d3.select(this).node());\n      })\n\n    return vm;\n  }\n  return new Treemap(config);\n}\n","/*\n * Dboxjs\n *\n * You can import other modules here, including external packages. When\n * bundling using rollup you can mark those modules as external and have them\n * excluded or, if they have a jsnext:main entry in their package.json (like\n * this package does), let rollup bundle them into your dist file.\n */\n\n/* Core */\nexport { default as chart } from './lib/chart';\n\n/* Chart modules */\nexport { default as bars } from '@dboxjs/bars';\n\nexport { default as distro } from '@dboxjs/distro';\n\nexport { default as heatmap } from '@dboxjs/heatmap';\n\nexport { default as leaflet } from '@dboxjs/leaflet';\n\nexport { default as map } from '@dboxjs/map';\n\nexport { default as radar } from '@dboxjs/radar';\n\nexport { default as scatter } from '@dboxjs/scatter';\n\nexport { default as spineplot } from '@dboxjs/spineplot';\n\nexport { default as timeline } from '@dboxjs/timeline';\n\nexport { default as treemap } from '@dboxjs/treemap';\n"],"names":["d3Tip","require","_","vm","Helper","chart","config","_config","width","_width","height","_height","style","_addStyle","fullSvg","_fullSvg","svg","_svg","utils","d3","tip","default","generateScale","data","scale","domains","range","groupBy","map","d","column","stackBy","serie","undefined","type","minZero","Array","isArray","rangeRound","domain","nice","padding","bins","format","smallNumber","linearAxis","yAxis","xAxis","decimals","axis","formatPreffix","formatSuffix","Number","isNaN","floatingPoints","isInteger","value","suffix","currentAxis","mean","_scales","replace","ticks","scaleText","floats","toString","split","points","index","length","number","indexOf","wrap","text","tooltip","each","words","reverse","word","line","lineNumber","lineHeight","y","attr","dy","parseFloat","tspan","append","pop","push","join","node","getComputedTextLength","on","show","hide","i","slice","sortAscending","a","b","sortDescending","VirtualScroller","enter","update","exit","dataid","viewport","totalRows","position","rowHeight","totalHeight","viewportHeight","visibleRows","delta","scrollTop","virtualscroller","container","render","resize","parseInt","Math","ceil","lastPosition","scrollRenderFrame","scrollPosition","position0","max","min","position1","rowSelection","selectAll","call","remove","legendTitle","findIndex","x","name","events","onClickLegend","stopPropagation","order","rowUpdateSelection","isFirefox","InstallTrigger","support","document","onmousewheel","evt","preventDefault","deltaY","wheelDelta","drawScrollLegend","scrollLegend","__","arguments","Chart","isIE","documentMode","err","isEdge","window","StyleMedia","init","defaultConfig","size","margin","left","right","top","bottom","defaultStyle","backgroundColor","color","title","textColor","fontSize","fontWeight","textAlign","hr","enabled","borderWidth","borderColor","legend","figure","opacity","fontFamily","border","radius","strokeWidth","strokeColor","strokeOpacity","paddingTick","grid","gridDashed","labels","textAnchor","_data","_margin","addStyle","_axes","layers","helper","bind","sizeObj","stylesObj","bindTo","selector","Object","assign","legendType","layer","_layer","getLayer","layerIndex","draw","q","scales","loadData","awaitAll","error","results","initLayers","drawSVG","axes","drawAxes","drawLayers","load","dispatch","theme","buckets","o","setScales","tickSizeOuter","tickSize","values","tickValues","tickFormat","tsv","defer","json","csv","raw","mapData","topojson","url","forEach","ly","select","html","template","classed","categories","c","hasOwnProperty","legendEnabled","drawLegend","legendBox","virtualScroller","legendX","marginTop","colors","legendTip","lWidth","lbWidth","rx","ry","markStrokeWidth","legendEnter","legendCheck","coordinates","property","active","legendUpdate","legendExit","styles","drawGrid","axesTip","element","dropdown","yAxisDropDown","updateAxis","getBoundingClientRect","display","transform","options","selected","console","log","_xAxis","abs","xAxisDropDown","tickWidth","rotate","biggestLabelWidth","nodes","xBandWidth","bandwidth","stroke","keys","k","obj","change","callback","getDomains","minMax","sorted","sortFunctionY","sortFunctionX","sort","destroy","Bars","colorScale","schemeCategory20c","_format","_tip","direction","prototype","columnName","end","_chart","Function","s","scaleOrdinal","makeDistroChart","settings","id","idName","xName","xSort","yName","axisLables","yTicks","chartSize","constrainExtremes","setting","formatAsFloat","formatNumber","formatRange","logFormatNumber","floor","yFormatter","xFormatter","groupObjs","objs","mainDiv","chartDiv","g","colorFunct","getColorFunct","colorOptions","colorMap","key","group","getObjWidth","objWidth","gName","objSize","middle","xScale","gShift","addJitter","doJitter","random","shallowCopy","oldObj","newObj","tooltipHover","groupName","metrics","pointName","pointValue","boxpart","tooltipString","toLocaleString","quartile3","median","quartile1","transition","duration","prepareData","calcMetrics","upperOuterFence","upperInnerFence","iqr","lowerInnerFence","lowerOuterFence","LIF","UIF","current_x","current_y","current_id","current_idName","current_row","valuesInfo","cName","prepareSettings","divWidth","divHeight","axisLabels","xAxisLable","yAxisLable","yScale","fences","clamp","tickSizeInner","violinPlots","_yDomainVP","prepareChart","renderViolinPlot","defaultOptions","showViolinPlot","resolution","curve","option","vOpts","violin","updateOptions","prepareViolin","reset","opts","cViolinPlot","xVScale","copy","kde","kernelDensityEstimator","eKernel","kdedata","interpolateMax","interpolateMin","filter","kdeTester","eKernelTest","interMaxY","interMaxX","count","interMinY","interMinX","objBounds","yVScale","area","y0","y1","datum","kernel","sample","v","u","array","testX","renderBoxPlot","boxPlots","showBox","showWhiskers","showMedian","showMean","medianCSize","showOutliers","boxWidth","lineWidth","scatterOutliers","outlierCSize","bOpts","boxPlot","calcAllOutliers","calcOutliers","cGroup","cExtremes","cOutliers","cOut","idx","outliers","extremes","prepareBoxPlot","cBoxPlot","sMetrics","box","lineBounds","upperWhisker","fence","lowerWhisker","circle","pt","point","pageX","pageY","outDiv","extDiv","renderNotchBoxes","notchBoxes","showNotchBox","showLines","medianWidth","notchStyle","nOpts","notchBox","makeNotchBox","cNotch","notchBounds","scaledValues","boxLeft","lowerNotch","medianLeft","upperNotch","boxRight","medianRight","calcNotches","modifier","sqrt","prepareNotchBoxes","boxBounds","medianBounds","notch","upperLine","confidenceLines","upper","lower","lowerLine","renderDataPlots","dataPlots","showPlot","plotType","pointSize","showBeanLines","beanWidth","dOpts","preparePlots","cPlot","halfBand","cMetric","lines","swarmBounds","yPtScale","interpolate","maxWidth","ptsObj","cYBucket","pts","rightMax","row","leftMin","col","plotBounds","scatterWidth","bean","beanBounds","val","valInfo","onClickElement","Distro","create","sortBy","opt","fill","chart1","babelHelpers.typeof","Heatmap","_gridSize","_legendElementWidth","columns","m","edad_mujer","edad_hombre","tot","percentage","por","_dayLabels","_timeLabels","scaleQuantile","cards","onclick","ease","easeLinear","Leaflet","colorLegend","_topojson","_minMax","objects","_nodes","geometries","geom","parser","found","properties","drawColorLegend","step","quantilePosition","quantiles","invertExtent","formatLegend","urlTopojson","tran","translate","L","TopoJSON","GeoJSON","extend","addData","jsonData","geojson","feature","LatLng","lat","lon","center","bounds","LatLngBounds","_map","Map","getCenter","zoom","maxZoom","minZoom","maxBounds","maxBoundsViscosity","mapTiles","tileLayer","attribution","topoLayer","addTo","addTopoData","topoData","eachLayer","handleLayer","NOM_ENT","NOM_MUN","_path","fillColor","setStyle","fillOpacity","weight","drawLabel","mouseover","enterLayer","mouseout","leaveLayer","props","path","bbox","getBBox","_formatWithZeroDecimals","_formatWithOneDecimal","_formatWithTwoDecimals","_formatWithThreeDecimals","total","_quantiles","_setQuantile","extent","_projection","geoMercator","geoPath","projection","_polygons","translateX","t","features","onmouseover","colorsOnHover","_getQuantileColor","onmouseout","_polygonsDefault","quantile","predefinedQuantiles","ascending","ignoreZeros","aux","dropWhile","outOfRangeColor","Radar","CIRCLE_RADIANS","PI","RADIANS_TO_ROTATE","_axesData","_filter","_viewData","_colorMap","_ticks","_scale","_excludedPolygons","transitionDuration","axisLabelMargin","enable","at","styleDefaults","_center","_radius","polygonsFrom","axesFrom","valuesFrom","drawTicks","dur","sel","empty","_ifStyleDefaults","drawTicksLabels","extractAxes","result","radiansPerAxis","reduce","prev","item","concat","rads","list","hash","hashed","el","buildColorMap","cMap","polyg","cIdx","polygon","selection","xOf","yOf","drawAxesLabels","fromCenter","drawPolygons","groupedData","gs","gsExit","gsEnter","bundle","polygIdx","polygons","xy","_buildNestedPolygons","_buildNestedVertexes","toUpdate","appendHelper","updateHelper","_showTooltip","_hideTooltip","removeHelper","dataFunc","keyFunc","val1","val2","tt","subtt","bg","centerPoints","side","newLegend","_toggleList","base","items","newItems","it","cos","sin","dataForVisualization","axisKey","valKey","polygKey","axesHash","scVal","rawData","fun","_calcDomains","Scatter","radiusRange","p","xMinMax","yMinMax","radiusMinMax","arrOk","fixTo45","scaleLinear","scaleDomain","circles","Spineplot","orientation","category","x0","x1","stackValues","totalCollapse","stack","txpe","drawLabels","groups","dat","sv","rectW","rectH","_drawStackByXAxis","_drawStackByYAxis","posX","_xLabels","labelMaxWidth","largestLabelWidth","newLabelMaxWidth","textSize","getComputedStyle","getPropertyValue","numSize","diffPos1","diffPos2","lessThanPrev","lessThanPost","removed","cat","h","j","bars","parseDate","timeParse","Timeline","_line","curveBasis","_area","alreadyScaled","series","arr","_lines","_xMinMax","_yMinMax","textures","thicker","areas","pathArea","Treemap","_padding","_colorScale","_labels","_size","arrayOfColors","nestBy","_keys","String","warning","_labelName","bool","Boolean","isValidStructure","children","res","child","formatNestedData","nestKey","nest","nested","queue","nestedData","rollup","leaves","sum","entries","cloneDeep","treemap","tile","treemapResquarify","round","paddingInner","root","hierarchy","eachBefore","parent","cell","rect"],"mappings":";;;;;;EACA,IAAIA,QAAQC,QAAQ,QAAR,CAAZ;EACA,IAAIC,MAAID,QAAQ,QAAR,CAAR;;AAEA,EAAe,mBAAY;EACzB,MAAIE,KAAK,IAAT,CADyB;;EAGzB,MAAIC,SAAS;EACXC,WAAO;EACLC,cAAQH,GAAGI,OADN;EAELC,aAAOL,GAAGM,MAFL;EAGLC,cAAQP,GAAGQ,OAHN;EAILC,aAAOT,GAAGU,SAJL;EAKLC,eAAS,mBAAY;EACnB,eAAOX,GAAGY,QAAV;EACD,OAPI;EAQLC,WAAK,eAAY;EACf,eAAOb,GAAGc,IAAV;EACD;EAVI,KADI;EAaXC,WAAO;EACLC,UAAI;EADC;EAbI,GAAb;EAiBAf,SAAOc,KAAP,CAAaC,EAAb,CAAgBC,GAAhB,GAAsB,OAAOpB,KAAP,KAAiB,UAAjB,GAA8BA,KAA9B,GAAsCA,MAAMqB,OAAlE;;EAEA;;;;;;EAMAjB,SAAOc,KAAP,CAAaI,aAAb,GAA6B,UAAUC,IAAV,EAAgBjB,MAAhB,EAAwB;EACnD,QAAIkB,QAAQ,EAAZ;EACA,QAAIC,OAAJ;EACA,QAAI,CAACnB,OAAOoB,KAAZ,EAAmB;EACjB,YAAM,sBAAN;EACD;EACD;EACA,QAAIpB,OAAOqB,OAAP,IAAkBrB,OAAOqB,OAAP,IAAkB,QAAxC,EAAkD;EAChD;EACAF,gBAAUF,KAAKK,GAAL,CAAS,UAAUC,CAAV,EAAa;EAC9B,eAAOA,EAAEvB,OAAOwB,MAAT,CAAP;EACD,OAFS,CAAV;EAGD,KALD,MAKO,IAAIxB,OAAOyB,OAAP,IAAkBzB,OAAOyB,OAAP,IAAkB,QAAxC,EAAkD;EACvDN,gBAAUF,KAAK,CAAL,EAAQK,GAAR,CAAY,UAAUC,CAAV,EAAa;EACjC,eAAOA,EAAEN,IAAF,CAAOjB,OAAOwB,MAAd,CAAP;EACD,OAFS,CAAV;EAGD,KAJM,MAIA,IAAIxB,OAAOqB,OAAP,IAAkB,UAAtB,EAAkC;EACvC;EACAF,gBAAUnB,OAAOwB,MAAjB;EACD,KAHM,MAGA,IAAIxB,OAAOqB,OAAP,IAAkB,MAAtB,EAA8B;EACnC;EACAF,gBAAU,CACR,CADQ,EAERN,QAAA,CAAOI,IAAP,EAAa,UAAUM,CAAV,EAAa;EACxB,eAAOV,QAAA,CAAOb,OAAOwB,MAAd,EAAsB,UAAUA,MAAV,EAAkB;EAC7C,iBAAOD,EAAEC,MAAF,CAAP;EACD,SAFM,CAAP;EAGD,OAJD,CAFQ,CAAV;EAQD,KAVM,MAUA,IAAIxB,OAAOyB,OAAP,IAAkB,MAAtB,EAA8B;EACnC;EACAN,gBAAU,CACR,CADQ,EAERN,QAAA,CAAOI,IAAP,EAAa,UAAUS,KAAV,EAAiB;EAC5B,eAAOb,QAAA,CAAOa,KAAP,EAAc,UAAUH,CAAV,EAAa;EAChC,iBAAOA,EAAE,CAAF,CAAP;EACD,SAFM,CAAP;EAGD,OAJD,CAFQ,CAAV;EAQD,KAVM,MAUA,IAAIvB,OAAOqB,OAAP,IAAkBM,SAAlB,IAA+B3B,OAAO4B,IAAP,IAAe,MAAlD,EAA0D;EAC/D;EACAT,gBAAUF,KAAKK,GAAL,CAAS,UAAUC,CAAV,EAAa;EAC9B,eAAOA,EAAEvB,OAAOwB,MAAT,CAAP;EACD,OAFS,CAAV;EAGD,KALM,MAKA,IAAIxB,OAAO4B,IAAP,KAAgB,QAApB,EAA8B;EACnC;EACA,UAAI5B,OAAO6B,OAAX,EAAoB;EAClBV,kBAAU,CACR,CADQ,EAERN,QAAA,CAAOI,IAAP,EAAa,UAAUM,CAAV,EAAa;EACxB,iBAAO,CAACA,EAAEvB,OAAOwB,MAAT,CAAR;EACD,SAFD,CAFQ,CAAV;EAMD,OAPD,MAOO;EACLL,kBAAUN,WAAA,CAAUI,IAAV,EAAgB,UAAUM,CAAV,EAAa;EACrC,iBAAO,CAACA,EAAEvB,OAAOwB,MAAT,CAAR;EACD,SAFS,CAAV;EAGD;EACF,KAdM,MAcA;EACL;EACAL,gBAAUF,KAAKK,GAAL,CAAS,UAAUC,CAAV,EAAa;EAC9B,eAAOA,EAAEvB,OAAOwB,MAAT,CAAP;EACD,OAFS,CAAV;EAGD;;EAED,QAAIxB,OAAOmB,OAAP,IAAkBW,MAAMC,OAAN,CAAc/B,OAAOmB,OAArB,CAAtB,EAAqD;EACnDA,gBAAUnB,OAAOmB,OAAjB;EACD;;EAED,QAAInB,OAAO4B,IAAX,EAAiB;EACf,cAAQ5B,OAAO4B,IAAf;EACE,aAAK,QAAL;EACEV,kBAAQL,gBAAA,GAELmB,UAFK,CAEMhC,OAAOoB,KAFb,EAGLa,MAHK,CAGEd,OAHF,EAILe,IAJK,EAAR;EAKA;;EAEF,aAAK,MAAL;EACEhB,kBAAQL,cAAA,GAAeO,KAAf,CAAqBpB,OAAOoB,KAA5B,CAAR;EACA;EACA;;EAEF,aAAK,SAAL;EACEF,kBAAQL,cAAA,GAELmB,UAFK,CAEMhC,OAAOoB,KAFb,EAGLe,OAHK,CAGG,GAHH,EAILF,MAJK,CAIEd,OAJF,CAAR;EAKA;;EAEF,aAAK,MAAL;EACED,kBAAQL,cAAA,GAELmB,UAFK,CAEMhC,OAAOoB,KAFb,EAGLa,MAHK,CAGEd,OAHF,EAILgB,OAJK,CAIG,GAJH,CAAR;EAKA;;EAEF,aAAK,UAAL;EACEjB,kBAAQL,cAAA,GAELmB,UAFK,CAEMhC,OAAOoB,KAFb,EAGLe,OAHK,CAGG,GAHH,EAILF,MAJK,CAKJhB,KAAKK,GAAL,CAAS,UAAUC,CAAV,EAAa;EACpB,mBAAOA,EAAEvB,OAAOwB,MAAT,CAAP;EACD,WAFD,CALI,CAAR;EASA,cAAI,CAACxB,OAAOoC,IAAZ,EAAkB;EAChBpC,mBAAOoC,IAAP,GAAc,EAAd;EACD;EACDlB,kBAAQL,kBAAA,GAAmBO,KAAnB,CAAyBP,UAAA,CAASb,OAAOoC,IAAhB,CAAzB,CAAR;EACA;;EAEF;EACElB,kBAAQL,gBAAA,GAELmB,UAFK,CAEMhC,OAAOoB,KAFb,EAGLa,MAHK,CAGEd,OAHF,EAILe,IAJK,EAAR;EAKA;EApDJ;EAsDD,KAvDD,MAuDO;EACLhB,cAAQL,gBAAA,GAELmB,UAFK,CAEMhC,OAAOoB,KAFb,EAGLa,MAHK,CAGEd,OAHF,EAILe,IAJK,EAAR;EAKD;;EAED,WAAOhB,KAAP;EACD,GArID;;EAuIA;;;;;;;;;;EAUApB,SAAOc,KAAP,CAAayB,MAAb,GAAsB,UAAUrC,MAAV,EAAkBsC,WAAlB,EAA+B;EACnD,QAAI,CAACtC,MAAL,EAAa;EACX;EACA,UAAIuC,aACF1C,GAAGI,OAAH,CAAWuC,KAAX,IAAoB3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAjB,KAA2B,QAA/C,GACI,OADJ,GAEIrB,GAAGI,OAAH,CAAWwC,KAAX,IAAoB5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAAjB,KAA2B,QAA/C,GACE,OADF,GAEE,EALR;EAMAlB,eAAS;EACP0C,kBAAU7C,GAAGI,OAAH,CAAWyC,QADd;EAEPC,cAAMJ,UAFC;EAGPK,uBAAe/C,GAAGI,OAAH,CAAW2C,aAHnB;EAIPC,sBAAchD,GAAGI,OAAH,CAAW4C;EAJlB,OAAT;EAMD;EACD,WAAO,UAAUtB,CAAV,EAAa;EAClB,UAAIuB,OAAOC,KAAP,CAAaD,OAAOvB,CAAP,CAAb,CAAJ,EAA6B;EAC3B;EACA,eAAOA,CAAP;EACD;AACD,EACA,UAAIyB,iBAAiB,CAArB,CANkB;EAOlB,UAAIhD,OAAO0C,QAAP,KAAoBf,SAApB,IAAiCmB,OAAOG,SAAP,CAAiBjD,OAAO0C,QAAxB,CAArC,EAAwE;EACtEM,yBAAiBF,OAAO9C,OAAO0C,QAAd,CAAjB;EACD;EACD,UAAIQ,QAAQ,EAAZ;EACA,UAAIlD,OAAO4C,aAAX,EAA0B;EACxBM,iBAASlD,OAAO4C,aAAhB;EACD;EACD,UAAIO,SAAS,EAAb;;EAEA,UAAIb,WAAJ,EAAiB;EACf,YAAIc,cAAcpD,OAAO2C,IAAzB;EACA,YAAIU,OAAOD,cACPvC,SAAA,CAAQhB,GAAGyD,OAAH,CAAWF,YAAYG,OAAZ,CAAoB,MAApB,EAA4B,EAA5B,CAAX,EAA4CC,KAA5C,EAAR,CADO,GAEPjC,CAFJ;;EAIA,YAAI8B,QAAQ,aAAZ,EAA2B;EACzB,cAAID,WAAJ,EAAiB;EACfvD,eAAGI,OAAH,CAAWmD,WAAX,EAAwBK,SAAxB,GAAoC,UAApC;EACD,WAFD,MAEO;EACLN,qBAAS,WAAT;EACD;EACD5B,cAAIA,IAAI,aAAR;EACD,SAPD,MAOO,IAAI8B,QAAQ,UAAZ,EAAwB;EAC7B;EACA,cAAID,WAAJ,EAAiB;EACfvD,eAAGI,OAAH,CAAWmD,WAAX,EAAwBK,SAAxB,GAAoC,mBAApC;EACD,WAFD,MAEO;EACLN,qBAAS,eAAT;EACD;EACD5B,cAAIA,IAAI,UAAR;EACD,SARM,MAQA,IAAI8B,QAAQ,OAAZ,EAAqB;EAC1B;EACA,cAAID,WAAJ,EAAiB;EACfvD,eAAGI,OAAH,CAAWmD,WAAX,EAAwBK,SAAxB,GAAoC,UAApC;EACD,WAFD,MAEO;EACLN,qBAAS,WAAT;EACD;EACD5B,cAAIA,IAAI,OAAR;EACD,SARM,MAQA,IAAI8B,QAAQ,KAAZ,EAAmB;EACxB;EACA,cAAID,WAAJ,EAAiB;EACfvD,eAAGI,OAAH,CAAWmD,WAAX,EAAwBK,SAAxB,GAAoC,OAApC;EACD,WAFD,MAEO;EACLN,qBAAS,MAAT;EACD;EACD5B,cAAIA,IAAI,IAAR;EACD;EACF;;EAED,UAAIuB,OAAOG,SAAP,CAAiB1B,CAAjB,CAAJ,EAAyB;EACvB2B,iBAASrC,WAAA,CAAU,MAAV,EAAkBU,CAAlB,CAAT;EACD,OAFD,MAEO,IAAIA,IAAI,CAAR,EAAW;EAChB2B,iBAASrC,WAAA,CAAU,OAAOmC,cAAP,GAAwB,GAAlC,EAAuCzB,CAAvC,CAAT;EACD,OAFM,MAEA;EACL,YAAImC,SAASnC,EAAEoC,QAAF,GAAaC,KAAb,CAAmB,GAAnB,EAAwB,CAAxB,CAAb;EACA,YAAIC,SAAS,CAAb;EACA,YAAIH,MAAJ,EAAY;EACV,eAAK,IAAII,QAAQ,CAAjB,EAAoBA,QAAQJ,OAAOK,MAAnC,EAA2CD,OAA3C,EAAoD;EAClD,gBAAME,SAASlB,OAAOY,OAAOI,KAAP,CAAP,CAAf;EACA,gBAAIE,WAAW,CAAf,EAAkB;EAChBH,wBAAU,CAAV;EACD,aAFD,MAEO;EACL;EACD;EACF;EACDX,mBAASrC,WAAA,CAAU,OAAOgD,MAAP,GAAgB,GAA1B,EAA+BtC,CAA/B,CAAT;EACD;EACF;EACD2B,eAASC,MAAT;;EAEA,UAAInD,OAAO6C,YAAP,IAAuBK,MAAMe,OAAN,CAAcjE,OAAO6C,YAArB,IAAqC,CAAhE,EAAmE;EACjEK,iBAASlD,OAAO6C,YAAhB;EACD;EACD,aAAOK,KAAP;EACD,KAjFD;EAkFD,GAlGD;;EAoGA;EACApD,SAAOc,KAAP,CAAasD,IAAb,GAAoB,UAAUC,IAAV,EAAgBjE,KAAhB,EAAuBkE,OAAvB,EAAgC;EAClDD,SAAKE,IAAL,CAAU,YAAY;EACpB,UAAIF,OAAOtD,WAAA,CAAU,IAAV,CAAX;EAAA,UACEyD,QAAQH,KACLA,IADK,GAELP,KAFK,CAEC,KAFD,EAGLW,OAHK,EADV;EAAA,UAKEC,IALF;EAAA,UAMEC,OAAO,EANT;EAAA,UAOEC,aAAa,CAPf;EAAA,UAQEC,aAAa,GARf;EAAA;EASEC,UAAIT,KAAKU,IAAL,CAAU,GAAV,CATN;EAAA,UAUEC,KAAKC,WAAWZ,KAAKU,IAAL,CAAU,IAAV,CAAX,KAA+B,CAVtC;EAAA,UAWEG,QAAQb,KACLA,IADK,CACA,IADA,EAELc,MAFK,CAEE,OAFF,EAGLJ,IAHK,CAGA,GAHA,EAGK,CAHL,EAILA,IAJK,CAIA,GAJA,EAIKD,CAJL,EAKLC,IALK,CAKA,IALA,EAKMC,KAAK,IALX,CAXV;;EAkBA,aAAQN,OAAOF,MAAMY,GAAN,EAAf,EAA6B;EAC3BT,aAAKU,IAAL,CAAUX,IAAV;EACAQ,cAAMb,IAAN,CAAWM,KAAKW,IAAL,CAAU,GAAV,CAAX;EACA,YAAIJ,MAAMK,IAAN,GAAaC,qBAAb,KAAuCpF,KAA3C,EAAkD;EAChDuE,eAAKS,GAAL;EACAF,gBAAMb,IAAN,CAAWM,KAAKW,IAAL,CAAU,GAAV,CAAX;EACAX,iBAAO,CAACD,IAAD,CAAP;EACAQ,kBAAQb,KACLc,MADK,CACE,OADF,EAELJ,IAFK,CAEA,GAFA,EAEK,CAFL,EAGLA,IAHK,CAGA,GAHA,EAGKD,CAHL,EAILC,IAJK,CAIA,IAJA,EAIM,EAAEH,UAAF,GAAeC,UAAf,GAA4BG,EAA5B,GAAiC,IAJvC,EAKLX,IALK,CAKAK,IALA,CAAR;;EAOA,cAAIE,aAAa,CAAjB,EAAoB;EAClB,gBACEJ,MAAMP,MAAN,GAAe,CAAf,IACAiB,MAAMK,IAAN,GAAaC,qBAAb,KAAuCpF,KAFzC,EAGE;EAAA;EACA,oBAAIkE,OAAJ,EAAa;EACXD,uBAAKoB,EAAL,CAAQ,WAAR,EAAqBnB,QAAQoB,IAA7B,EAAmCD,EAAnC,CAAsC,UAAtC,EAAkDnB,QAAQqB,IAA1D;EACD;EACD,oBAAIC,IAAI,CAAR;EACA,uBAAOV,MAAMK,IAAN,GAAaC,qBAAb,KAAuCpF,KAA9C,EAAqD;EACnD8E,wBAAMb,IAAN,CAAW,YAAY;EACrB,2BAAOa,MAAMb,IAAN,GAAawB,KAAb,CAAmB,CAAnB,EAAsB,CAACD,CAAvB,IAA4B,KAAnC;EACD,mBAFD;EAGA,oBAAEA,CAAF;EACD;EAVD;EAWD;EACDpB,oBAAQ,EAAR;EACD,WAjBD,MAiBO;EAAA;EACL,kBAAIoB,IAAI,CAAR;EACA,qBAAOV,MAAMK,IAAN,GAAaC,qBAAb,KAAuCpF,KAA9C,EAAqD;EACnD8E,sBAAMb,IAAN,CAAW,YAAY;EACrB,yBAAOa,MAAMb,IAAN,GAAawB,KAAb,CAAmB,CAAnB,EAAsB,CAACD,CAAvB,IAA4B,KAAnC;EACD,iBAFD;EAGA,kBAAEA,CAAF;EACD;EAPI;EAQN;EACF;EACF;EACF,KA7DD;EA8DD,GA/DD;;EAiEA5F,SAAOc,KAAP,CAAagF,aAAb,GAA6B,UAAUC,CAAV,EAAaC,CAAb,EAAgB;EAC3C,QAAI,CAAChD,OAAOC,KAAP,CAAa,CAAC8C,CAAd,CAAD,IAAqB,CAAC/C,OAAOC,KAAP,CAAa,CAAC+C,CAAd,CAA1B,EAA4C;EAC1C;EACA,aAAOhD,OAAO+C,CAAP,IAAY/C,OAAOgD,CAAP,CAAnB;EACD,KAHD,MAGO,IAAI,CAAChD,OAAOC,KAAP,CAAa,CAAC8C,CAAd,CAAD,IAAqB/C,OAAOC,KAAP,CAAa,CAAC+C,CAAd,CAAzB,EAA2C;EAChD,aAAO,CAAC,CAAR;EACD,KAFM,MAEA,IAAIhD,OAAOC,KAAP,CAAa,CAAC8C,CAAd,KAAoB,CAAC/C,OAAOC,KAAP,CAAa,CAAC+C,CAAd,CAAzB,EAA2C;EAChD,aAAO,CAAP;EACD,KAFM,MAEA,IAAID,KAAKC,CAAT,EAAY;EACjB,aAAO,CAAC,CAAR;EACD,KAFM,MAEA;EACL,aAAO,CAAP;EACD;EACF,GAbD;;EAeAhG,SAAOc,KAAP,CAAamF,cAAb,GAA8B,UAAUF,CAAV,EAAaC,CAAb,EAAgB;EAC5C,QAAI,CAAChD,OAAOC,KAAP,CAAa,CAAC+C,CAAd,CAAD,IAAqB,CAAChD,OAAOC,KAAP,CAAa,CAAC8C,CAAd,CAA1B,EAA4C;EAC1C;EACA,aAAO/C,OAAOgD,CAAP,IAAYhD,OAAO+C,CAAP,CAAnB;EACD,KAHD,MAGO,IAAI,CAAC/C,OAAOC,KAAP,CAAa,CAAC+C,CAAd,CAAD,IAAqBhD,OAAOC,KAAP,CAAa,CAAC8C,CAAd,CAAzB,EAA2C;EAChD,aAAO,CAAC,CAAR;EACD,KAFM,MAEA,IAAI/C,OAAOC,KAAP,CAAa,CAAC+C,CAAd,KAAoB,CAAChD,OAAOC,KAAP,CAAa,CAAC8C,CAAd,CAAzB,EAA2C;EAChD,aAAO,CAAP;EACD,KAFM,MAEA,IAAIC,KAAKD,CAAT,EAAY;EACjB,aAAO,CAAC,CAAR;EACD,KAFM,MAEA;EACL,aAAO,CAAP;EACD;EACF,GAbD;;EAeA/F,SAAOc,KAAP,CAAaoF,eAAb,GAA+B,YAAY;EACzC,QAAIC,QAAQ,IAAZ;EAAA,QACEC,SAAS,IADX;EAAA,QAEEC,OAAO,IAFT;EAAA,QAGElF,OAAO,EAHT;EAAA,QAIEmF,SAAS,IAJX;EAAA,QAKE1F,MAAM,IALR;EAAA,QAME2F,WAAW,IANb;EAAA,QAOEC,YAAY,CAPd;EAAA,QAQEC,WAAW,CARb;EAAA,QASEC,YAAY,EATd;EAAA,QAUEC,cAAc,CAVhB;EAAA,QAWEC,iBAAiB,CAXnB;EAAA,QAYEC,cAAc,CAZhB;EAAA,QAaEC,QAAQ,CAbV;EAAA,QAcElC,aAAa,CAdf;EAAA,QAeEC,aAAa,GAff;EAAA;EAgBEkC,gBAAY,CAhBd;;EAkBA,aAASC,eAAT,CAAyBC,SAAzB,EAAoC;EAClC,eAASC,MAAT,CAAgBC,MAAhB,EAAwB;EACtB,YAAIA,MAAJ,EAAY;EACV;;;;;EAKAP,2BAAiBQ,SAASb,SAAS/F,KAAT,CAAe,QAAf,CAAT,IAAqC,GAAtD;EACAqG,wBAAcQ,KAAKC,IAAL,CAAUV,iBAAiBF,SAA3B,CAAd;EACD;EACD,YAAIa,eAAed,QAAnB;EACA,YAAIA,WAAWtF,KAAK8C,MAAhB,IAA0BwC,YAAY,CAAtC,IAA2CM,YAAY,CAA3D,EAA8D;EAC5DN,sBAAY,CAAZ;EACD,SAFD,MAEO,IAAIA,YAAYtF,KAAK8C,MAAjB,IAA2BwC,WAAW,CAAtC,IAA2CM,YAAY,CAA3D,EAA8D;EACnEN,sBAAY,CAAZ;EACD;EACDK,gBAAQL,WAAWc,YAAnB;EACAC,0BAAkBf,QAAlB;EACD;;EAED,eAASe,iBAAT,CAA2BC,cAA3B,EAA2C;EACzC,YAAIC,YAAYL,KAAKM,GAAL,CACd,CADc,EAEdN,KAAKO,GAAL,CAASH,cAAT,EAAyBjB,YAAYK,WAAZ,GAA0B,CAAnD,CAFc,CAAhB;EAAA,YAIEgB,YAAYH,YAAYb,WAJ1B;EAKAI,kBAAU1C,IAAV,CAAe,YAAY;EACzB,cAAIuD,eAAeb,UAChBc,SADgB,CACN,kBADM,EAEhB5G,IAFgB,CAGfA,KAAK0E,KAAL,CAAW6B,SAAX,EAAsBL,KAAKO,GAAL,CAASC,SAAT,EAAoBrB,SAApB,CAAtB,CAHe,EAIfF,MAJe,CAAnB;EAMAwB,uBACGzB,IADH,GAEG2B,IAFH,CAEQ3B,IAFR,EAGG4B,MAHH;EAIAH,uBACG3B,KADH,GAEGhB,MAFH,CAEU,GAFV,EAGGJ,IAHH,CAGQ,OAHR,EAGiB,wBAHjB,EAIGA,IAJH,CAIQ,QAJR,EAIkB,UAAUtD,CAAV,EAAa;EAC3B,mBAAOA,CAAP;EACD,WANH,EAOGuG,IAPH,CAOQ7B,KAPR,EAQGpB,IARH,CAQQ,WARR,EAQqB,UAAUtD,CAAV,EAAamE,CAAb,EAAgB;EACjC,mBACE,iBACA,CAAC7F,GAAGI,OAAH,CAAW+H,WAAX,IAA0BtD,aAAa,CAAvC,GACGA,aAAaC,UAAb,GAA0Be,CAD7B,GAEG,IAAIA,CAFR,IAGA,EAJA,GAKA,GANF;EAQD,WAjBH,EAkBGH,EAlBH,CAkBM,OAlBN,EAkBe,UAAUhE,CAAV,EAAa;EACxB;EACA,gBAAImE,IAAIzE,KAAKgH,SAAL,CAAe;EAAA,qBAAKC,EAAEC,IAAF,IAAU5G,EAAE4G,IAAjB;EAAA,aAAf,CAAR;EACA,gBAAI,OAAOtI,GAAGI,OAAH,CAAWmI,MAAX,CAAkBC,aAAzB,KAA2C,UAA/C,EAA2D;EACzDxI,iBAAGI,OAAH,CAAWmI,MAAX,CAAkBC,aAAlB,CAAgCP,IAAhC,CAAqC,IAArC,EAA2CvG,CAA3C,EAA8CmE,CAA9C;EACD;EACD7E,sBAAA,CAASyH,eAAT;EACD,WAzBH;;EA2BAV,uBAAaW,KAAb;EACA,cAAIC,qBAAqBzB,UAAUc,SAAV,CAAoB,kBAApB,CAAzB;;EAEAW,6BAAmBV,IAAnB,CAAwB5B,MAAxB;;EAEAsC,6BAAmBnE,IAAnB,CAAwB,UAAU9C,CAAV,EAAamE,CAAb,EAAgB;EACtC7E,uBAAA,CAAU,IAAV,EACGgE,IADH,CACQ,aADR,EACuB,MADvB,EAEGA,IAFH,CAEQ,WAFR,EAEqB,UAAUtD,CAAV,EAAa;EAC9B,qBACE,iBACA,CAAC1B,GAAGI,OAAH,CAAW+H,WAAX,IAA0BtD,aAAa,CAAvC,GACGA,aAAaC,UAAb,GAA0Be,CAD7B,GAEG,IAAIA,CAFR,IAGA,EAJA,GAKA,GANF;EAQD,aAXH;EAYD,WAbD;;EAeA;;;;;;EAMD,SAhED;EAiED;;EAEDoB,sBAAgBE,MAAhB,GAAyBA,MAAzB;EACA,UAAIyB,YAAY,OAAOC,cAAP,KAA0B,WAA1C;EACA,UAAIC,UACF,aAAa9H,WAAA,CAAU,YAAV,CAAb,GACI,OADJ;EAAA,QAEI+H,SAASC,YAAT,KAA0BlH,SAA1B,GACE,YADF;EAAA,QAEE,OALR,CAhGkC;EAsGlCd,iBAAA,CAAU,YAAV,EAAwB0E,EAAxB,CAA2BoD,OAA3B,EAAoC,YAAY;EAC9C;EACA;EACA,YAAIG,MAAMjI,UAAV;EACAiI,YAAIC,cAAJ;EACAlC,oBAAY4B,YAAYK,IAAIE,MAAhB,GAAyBF,IAAIG,UAAzC;EACAjC,eAAO,IAAP;EACD,OAPD;EAQAA,aAAO,IAAP;EACAkC,uBAAiBvC,WAAjB;EACD;;EAED,aAASuC,gBAAT,CAA0BvC,WAA1B,EAAuC;EACrC,UAAIwC,eAAetI,WAAA,CACT,YADS,EAEhBoE,MAFgB,CAET,GAFS,EAGhBJ,IAHgB,CAGX,OAHW,EAGF,eAHE,EAIhBI,MAJgB,CAIT,MAJS,EAKhBJ,IALgB,CAKX,WALW,mBAKiB8B,cAAc,EAL/B,OAAnB;;EAOAwC,mBACGlE,MADH,CACU,OADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,4BAFjB,EAGGV,IAHH,CAGQ,OAHR;;EAKAgF,mBACGlE,MADH,CACU,OADV,EAEGJ,IAFH,CAEQ,GAFR,EAEa,EAFb,EAGGA,IAHH,CAGQ,GAHR,EAGa,CAAC,EAHd,EAIGV,IAJH,CAIQ,mBAJR;;EAMAgF,mBACGlE,MADH,CACU,OADV,EAEGJ,IAFH,CAEQ,GAFR,EAEa,EAFb,EAGGA,IAHH,CAGQ,GAHR,EAGa,CAAC,CAHd,EAIGV,IAJH,CAIQ,QAJR;;EAMA,UAAImC,YAAYK,WAAhB,EAA6B;EAC3B9F,sBAAA,CAAa,gBAAb,EAA+BP,KAA/B,CAAqC,SAArC,EAAgD,MAAhD;EACD,OAFD,MAEO;EACLO,sBAAA,CAAa,gBAAb,EAA+BP,KAA/B,CAAqC,SAArC,EAAgD,MAAhD;EACD;EACF;;EAEDwG,oBAAgBE,MAAhB,GAAyB,UAAUC,MAAV,EAAkB,EAA3C;;EAEAH,oBAAgB7F,IAAhB,GAAuB,UAAUrB,CAAV,EAAawJ,EAAb,EAAiB;EACtC,UAAI,CAACC,UAAUtF,MAAf,EAAuB,OAAO9C,IAAP;EACvBA,aAAOrB,CAAP;EACAwG,eAASgD,EAAT;EACA,aAAOtC,eAAP;EACD,KALD;;EAOAA,oBAAgBV,MAAhB,GAAyB,UAAUxG,CAAV,EAAa;EACpC,UAAI,CAACyJ,UAAUtF,MAAf,EAAuB,OAAOqC,MAAP;EACvBA,eAASxG,CAAT;EACA,aAAOkH,eAAP;EACD,KAJD;;EAMAA,oBAAgBb,KAAhB,GAAwB,UAAUrG,CAAV,EAAa;EACnC,UAAI,CAACyJ,UAAUtF,MAAf,EAAuB,OAAOkC,KAAP;EACvBA,cAAQrG,CAAR;EACA,aAAOkH,eAAP;EACD,KAJD;;EAMAA,oBAAgBZ,MAAhB,GAAyB,UAAUtG,CAAV,EAAa;EACpC,UAAI,CAACyJ,UAAUtF,MAAf,EAAuB,OAAOmC,MAAP;EACvBA,eAAStG,CAAT;EACA,aAAOkH,eAAP;EACD,KAJD;;EAMAA,oBAAgBX,IAAhB,GAAuB,UAAUvG,CAAV,EAAa;EAClC,UAAI,CAACyJ,UAAUtF,MAAf,EAAuB,OAAOoC,IAAP;EACvBA,aAAOvG,CAAP;EACA,aAAOkH,eAAP;EACD,KAJD;;EAMAA,oBAAgBR,SAAhB,GAA4B,UAAU1G,CAAV,EAAa;EACvC,UAAI,CAACyJ,UAAUtF,MAAf,EAAuB,OAAOuC,SAAP;EACvBA,kBAAY1G,CAAZ;EACA,aAAOkH,eAAP;EACD,KAJD;;EAMAA,oBAAgBN,SAAhB,GAA4B,UAAU5G,CAAV,EAAa;EACvC,UAAI,CAACyJ,UAAUtF,MAAf,EAAuB,OAAOyC,SAAP;EACvBA,kBAAY,CAAC5G,CAAb;EACA,aAAOkH,eAAP;EACD,KAJD;;EAMAA,oBAAgBL,WAAhB,GAA8B,UAAU7G,CAAV,EAAa;EACzC,UAAI,CAACyJ,UAAUtF,MAAf,EAAuB,OAAO0C,WAAP;EACvBA,oBAAc,CAAC7G,CAAf;EACA,aAAOkH,eAAP;EACD,KAJD;;EAMAA,oBAAgBP,QAAhB,GAA2B,UAAU3G,CAAV,EAAa;EACtC,UAAI,CAACyJ,UAAUtF,MAAf,EAAuB,OAAOwC,QAAP;EACvBA,iBAAW,CAAC3G,CAAZ;EACA,UAAIyG,QAAJ,EAAc;EACZA,iBAAShB,IAAT,GAAgBwB,SAAhB,GAA4BN,QAA5B;EACD;EACD,aAAOO,eAAP;EACD,KAPD;;EASAA,oBAAgBpG,GAAhB,GAAsB,UAAUd,CAAV,EAAa;EACjC,UAAI,CAACyJ,UAAUtF,MAAf,EAAuB,OAAOrD,GAAP;EACvBA,YAAMd,CAAN;EACA,aAAOkH,eAAP;EACD,KAJD;;EAMAA,oBAAgBT,QAAhB,GAA2B,UAAUzG,CAAV,EAAa;EACtC,UAAI,CAACyJ,UAAUtF,MAAf,EAAuB,OAAOsC,QAAP;EACvBA,iBAAWzG,CAAX;EACA,aAAOkH,eAAP;EACD,KAJD;;EAMAA,oBAAgBF,KAAhB,GAAwB,YAAY;EAClC,aAAOA,KAAP;EACD,KAFD;;EAIAE,oBAAgBkB,WAAhB,GAA8B,UAAUpI,CAAV,EAAa;EACzC,aAAOoI,WAAP;EACD,KAFD;;EAIAlB,oBAAgBpC,UAAhB,GAA6B,UAAU9E,CAAV,EAAa;EACxC,UAAI,CAACyJ,UAAUtF,MAAf,EAAuB,OAAOW,UAAP;EACvBA,mBAAa9E,CAAb;EACA,aAAOkH,eAAP;EACD,KAJD;;EA6BA,WAAOA,eAAP;EACD,GAnRD;;EAqRA,SAAOhH,MAAP;EACD;;ECtoBD;;;;EAIA;;;;;;AAMA,EAAe,SAASwJ,KAAT,CAAetJ,MAAf,EAAuB;EACpC,MAAIsJ,QAAQ,EAAZ;EACA;EACA,MAAIC,IAAJ;EACA,MAAI;EACFA,uBAAoB,SAAUX,YAAY,CAAC,CAACA,SAASY,YAArD;EACD,GAFD,CAEE,OAAOC,GAAP,EAAY;EACZF,WAAO,KAAP;EACD;EACD;EACA,MAAIG,MAAJ;EACA,MAAI;EACFA,aAAS,CAACH,IAAD,IAASI,MAAT,IAAmB,CAAC,CAACA,OAAOC,UAArC;EACD,GAFD,CAEE,OAAOH,GAAP,EAAY;EACZC,aAAS,KAAT;EACD;;EAED;;;;EAIAJ,QAAMO,IAAN,GAAa,UAAU7J,MAAV,EAAkB;EAC7B,QAAIH,KAAK,IAAT;;EAEA;;;;EAIA,QAAIiK,gBAAgB;EAClBC,YAAM;EACJ7J,eAAO,GADH;EAEJE,gBAAQ,GAFJ;EAGJ4J,gBAAQ;EACNC,gBAAM,CADA;EAENC,iBAAO,CAFD;EAGNC,eAAK,CAHC;EAINC,kBAAQ;EAJF;EAHJ;EADY,KAApB;;EAaA,QAAIC,eAAe;EACjBtK,aAAO;EACLuK,yBAAiB;EACfC,iBAAO;EACP;EACA;EAHe;EADZ,OADU;EAQjBC,aAAO;EACLC,mBAAW,SADN;EAELC,kBAAU,MAFL;EAGLC,oBAAY,GAHP;EAILC,mBAAW,QAJN;EAKLC,YAAI;EACFC,mBAAS,IADP;EAEFC,uBAAa,KAFX;EAGFC,uBAAa;EAHX;EALC,OARU;EAmBjBC,cAAQ;EACN1E,kBAAU,QADJ;EAEN2E,gBAAQ,QAFF;EAGN/G,cAAM;EACJsG,qBAAW,MADP;EAEJC,oBAAU,MAFN;EAGJC,sBAAY;EAHR;EAHA,OAnBS;EA4BjBvG,eAAS;EACPkG,yBAAiB,SADV;EAEPa,iBAAS,GAFF;EAGPhH,cAAM;EACJsG,qBAAW,MADP;EAEJC,oBAAU,MAFN;EAGJC,sBAAY,GAHR;EAIJC,qBAAW,QAJP;EAKJQ,sBAAY,YALR;EAMJjJ,mBAAS;EANL,SAHC;EAWPkJ,gBAAQ;EACNd,iBAAO,SADD;EAENe,kBAAQ,KAFF;EAGNpL,iBAAO;EAHD;EAXD,OA5BQ;EA6CjBsC,aAAO;EACLsI,iBAAS,IADJ;EAELnI,cAAM;EACJ4I,uBAAa,CADT;EAEJC,uBAAa,SAFT;EAGJC,yBAAe,CAHX;EAIJC,uBAAa;EAJT,SAFD;EAQLlI,eAAO;EACL+H,uBAAa,CADR;EAELC,uBAAa,SAFR;EAGLG,gBAAM,QAHD;EAILC,sBAAY,MAJP;EAKLT,mBAAS;EALJ,SARF;EAeLU,gBAAQ;EACNnB,oBAAU,EADJ;EAENC,sBAAY,GAFN;EAGNF,qBAAW,MAHL;EAINqB,sBAAY;EAJN,SAfH;EAqBLtB,eAAO;EACLE,oBAAU,EADL;EAELC,sBAAY,GAFP;EAGLF,qBAAW,MAHN;EAILqB,sBAAY;EACZ;EACA;EANK;EArBF,OA7CU;EA2EjBrJ,aAAO;EACLqI,iBAAS,IADJ;EAELnI,cAAM;EACJ4I,uBAAa,CADT;EAEJC,uBAAa,SAFT;EAGJC,yBAAe,CAHX;EAIJC,uBAAa;EAJT,SAFD;EAQLlI,eAAO;EACL+H,uBAAa,CADR;EAELC,uBAAa;EACb;EAHK,SARF;EAaLK,gBAAQ;EACNnB,oBAAU,EADJ;EAENC,sBAAY,GAFN;EAGNF,qBAAW,MAHL;EAINqB,sBAAY;EAJN,SAbH;EAmBLtB,eAAO;EACLE,oBAAU,EADL;EAELC,sBAAY,GAFP;EAGLF,qBAAW,MAHN;EAILqB,sBAAY;EACZ;EALK;EAnBF;EA3EU,KAAnB;;EAwGA;;;;EAIAjM,OAAGI,OAAH,GAAaD,SAASJ,aAAA,CAAYI,MAAZ,CAAT,GAA+B8J,aAA5C;;EAEA,QAAIjK,GAAGI,OAAH,CAAWwC,KAAf,EAAsB;EACpB5C,SAAGI,OAAH,CAAWwC,KAAX,CAAiBE,IAAjB,GAAwB,OAAxB;EACA;;;EAGA,UACE9C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBC,QAAjB,KAA8Bf,SAA9B,IACA9B,GAAGI,OAAH,CAAWyC,QAAX,KAAwBf,SAF1B,EAGE;EACA9B,WAAGI,OAAH,CAAWwC,KAAX,CAAiBC,QAAjB,GAA4B7C,GAAGI,OAAH,CAAWyC,QAAvC;EACD;EACD,UACE7C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBG,aAAjB,KAAmCjB,SAAnC,IACA9B,GAAGI,OAAH,CAAW2C,aAAX,KAA6BjB,SAF/B,EAGE;EACA9B,WAAGI,OAAH,CAAWwC,KAAX,CAAiBG,aAAjB,GAAiC/C,GAAGI,OAAH,CAAW2C,aAA5C;EACD;EACD,UACE/C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBI,YAAjB,KAAkClB,SAAlC,IACA9B,GAAGI,OAAH,CAAW4C,YAAX,KAA4BlB,SAF9B,EAGE;EACA9B,WAAGI,OAAH,CAAWwC,KAAX,CAAiBI,YAAjB,GAAgChD,GAAGI,OAAH,CAAW4C,YAA3C;EACD;EACF;EACD,QAAIhD,GAAGI,OAAH,CAAWuC,KAAf,EAAsB;EACpB3C,SAAGI,OAAH,CAAWuC,KAAX,CAAiBG,IAAjB,GAAwB,OAAxB;EACA;;;EAGA,UACE9C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBE,QAAjB,KAA8Bf,SAA9B,IACA9B,GAAGI,OAAH,CAAWyC,QAAX,KAAwBf,SAF1B,EAGE;EACA9B,WAAGI,OAAH,CAAWuC,KAAX,CAAiBE,QAAjB,GAA4B7C,GAAGI,OAAH,CAAWyC,QAAvC;EACD;EACD,UACE7C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBI,aAAjB,KAAmCjB,SAAnC,IACA9B,GAAGI,OAAH,CAAW2C,aAAX,KAA6BjB,SAF/B,EAGE;EACA9B,WAAGI,OAAH,CAAWuC,KAAX,CAAiBI,aAAjB,GAAiC/C,GAAGI,OAAH,CAAW2C,aAA5C;EACD;EACD,UACE/C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBK,YAAjB,KAAkClB,SAAlC,IACA9B,GAAGI,OAAH,CAAW4C,YAAX,KAA4BlB,SAF9B,EAGE;EACA9B,WAAGI,OAAH,CAAWuC,KAAX,CAAiBK,YAAjB,GAAgChD,GAAGI,OAAH,CAAW4C,YAA3C;EACD;EACF;EACD;EACAhD,OAAGkM,KAAH,GAAW,EAAX;;EAEA;EACAlM,OAAGmM,OAAH,GAAanM,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAA7B;EACAnK,OAAGU,SAAH,GAAeV,GAAGI,OAAH,CAAWgM,QAAX,GAAsBpM,GAAGI,OAAH,CAAWgM,QAAjC,GAA4C5B,YAA3D;;EAEA;EACAxK,OAAGM,MAAH,GAAYN,GAAGI,OAAH,CAAW8J,IAAX,CAAgB7J,KAAhB,GAAwBL,GAAGmM,OAAH,CAAW/B,IAAnC,GAA0CpK,GAAGmM,OAAH,CAAW9B,KAAjE;EACArK,OAAGQ,OAAH,GAAaR,GAAGI,OAAH,CAAW8J,IAAX,CAAgB3J,MAAhB,GAAyBP,GAAGmM,OAAH,CAAW7B,GAApC,GAA0CtK,GAAGmM,OAAH,CAAW5B,MAAlE;EACAvK,OAAGc,IAAH,GAAU,EAAV;EACAd,OAAGyD,OAAH,GAAa,EAAb;EACAzD,OAAGqM,KAAH,GAAW,EAAX;;EAEA;EACArM,OAAGsM,MAAH,GAAY,EAAZ;;EAEA;EACAtM,OAAGuM,MAAH,GAAYtM,OAAOuM,IAAP,CAAYxM,EAAZ,GAAZ;EACD,GArMD;;EAuMA;EACA;EACA;;;;EAIAyJ,QAAMtJ,MAAN,GAAe,UAAUA,MAAV,EAAkB;EAC/B,QAAIH,KAAK,IAAT;EACAA,OAAGI,OAAH,GAAaL,aAAA,CAAYI,MAAZ,CAAb;EACA,WAAOH,EAAP;EACD,GAJD;;EAMA;;;;;;;;;;;EAWAyJ,QAAMS,IAAN,GAAa,UAAUuC,OAAV,EAAmB;EAC9B,QAAIzM,KAAK,IAAT;EACA,QAAIyM,OAAJ,EAAa;EACX,UAAIA,QAAQtC,MAAZ,EAAoB;EAClB,YAAIsC,QAAQtC,MAAR,CAAeC,IAAf,IAAuBnH,OAAOwJ,QAAQtC,MAAR,CAAeC,IAAtB,CAA3B,EAAwD;EACtDpK,aAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBC,IAAvB,GAA8BqC,QAAQtC,MAAR,CAAeC,IAA7C;EACApK,aAAGmM,OAAH,CAAW/B,IAAX,GAAkBqC,QAAQtC,MAAR,CAAeC,IAAjC;EACD;EACD,YAAIqC,QAAQtC,MAAR,CAAeE,KAAf,IAAwBpH,OAAOwJ,QAAQtC,MAAR,CAAeE,KAAtB,CAA5B,EAA0D;EACxDrK,aAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBE,KAAvB,GAA+BoC,QAAQtC,MAAR,CAAeE,KAA9C;EACArK,aAAGmM,OAAH,CAAW9B,KAAX,GAAmBoC,QAAQtC,MAAR,CAAeE,KAAlC;EACD;EACD,YAAIoC,QAAQtC,MAAR,CAAeG,GAAf,IAAsBrH,OAAOwJ,QAAQtC,MAAR,CAAeG,GAAtB,CAA1B,EAAsD;EACpDtK,aAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBG,GAAvB,GAA6BmC,QAAQtC,MAAR,CAAeG,GAA5C;EACAtK,aAAGmM,OAAH,CAAW7B,GAAX,GAAiBmC,QAAQtC,MAAR,CAAeG,GAAhC;EACD;EACD,YAAImC,QAAQtC,MAAR,CAAeI,MAAf,IAAyBtH,OAAOwJ,QAAQtC,MAAR,CAAeI,MAAtB,CAA7B,EAA4D;EAC1DvK,aAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBI,MAAvB,GAAgCkC,QAAQtC,MAAR,CAAeI,MAA/C;EACAvK,aAAGmM,OAAH,CAAW5B,MAAX,GAAoBkC,QAAQtC,MAAR,CAAeI,MAAnC;EACD;EACF;EACD,UAAIkC,QAAQpM,KAAR,IAAiB4C,OAAOwJ,QAAQpM,KAAf,CAArB,EAA4C;EAC1CL,WAAGI,OAAH,CAAW8J,IAAX,CAAgB7J,KAAhB,GAAwBoM,QAAQpM,KAAhC;EACAL,WAAGM,MAAH,GAAYmM,QAAQpM,KAApB;EACD;EACD,UAAIoM,QAAQlM,MAAR,IAAkB0C,OAAOwJ,QAAQlM,MAAf,CAAtB,EAA8C;EAC5CP,WAAGI,OAAH,CAAW8J,IAAX,CAAgB3J,MAAhB,GAAyBkM,QAAQlM,MAAjC;EACAP,WAAGQ,OAAH,GAAaiM,QAAQlM,MAArB;EACD;EACF;EACD,WAAOP,EAAP;EACD,GA/BD;;EAiCA;;;;EAIAyJ,QAAM2C,QAAN,GAAiB,UAAUM,SAAV,EAAqB;EACpC,QAAI1M,KAAK,IAAT;EACA,QAAI0M,SAAJ,EAAe;EACb1M,SAAGU,SAAH,GAAegM,SAAf;EACD;EACD,WAAO1M,EAAP;EACD,GAND;;EAQA;;;;EAIAyJ,QAAMqC,IAAN,GAAa,UAAUb,OAAV,EAAmB;EAC9B,QAAIjL,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW0L,IAAX,GAAkBb,UAAU,IAAV,GAAiB,KAAnC;EACA,WAAOjL,EAAP;EACD,GAJD;;EAMA;;;;EAIAyJ,QAAMkD,MAAN,GAAe,UAAUC,QAAV,EAAoB;EACjC,QAAI5M,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWuM,MAAX,GAAoBC,QAApB;EACA,WAAO5M,EAAP;EACD,GAJD;;EAMA;;;;EAIAyJ,QAAMrI,IAAN,GAAa,UAAUA,IAAV,EAAgB;EAC3B,QAAIpB,KAAK,IAAT;EACA,QAAIA,GAAGI,OAAH,CAAWgB,IAAX,KAAoBU,SAAxB,EAAmC;EACjC9B,SAAGI,OAAH,CAAWgB,IAAX,GAAkByL,OAAOC,MAAP,CAAc,EAAd,EAAkB9M,GAAGI,OAAH,CAAWgB,IAA7B,EAAmCA,IAAnC,CAAlB;EACD,KAFD,MAEO;EACLpB,SAAGI,OAAH,CAAWgB,IAAX,GAAkBA,IAAlB;EACD;EACD,WAAOpB,EAAP;EACD,GARD;;EAUA;;;;EAIAyJ,QAAM2B,MAAN,GAAe,UAAUA,MAAV,EAAkB;EAC/B,QAAIpL,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWgL,MAAX,GAAoBA,MAApB;EACA,WAAOpL,EAAP;EACD,GAJD;;EAMAyJ,QAAMsD,UAAN,GAAmB,UAAUA,UAAV,EAAsB;EACvC,QAAI/M,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW2M,UAAX,GAAwBA,UAAxB;EACA,WAAO/M,EAAP;EACD,GAJD;;EAMAyJ,QAAMtB,WAAN,GAAoB,UAAUA,WAAV,EAAuB;EACzC,QAAInI,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW+H,WAAX,GAAyBA,WAAzB;EACA,WAAOnI,EAAP;EACD,GAJD;;EAMAyJ,QAAMuD,KAAN,GAAc,UAAUC,MAAV,EAAkB7M,OAAlB,EAA2B;EACvC,QAAIJ,KAAK,IAAT;EACA,QAAIgN,KAAJ;EACA,QAAI7M,SAASC,UAAUA,OAAV,GAAoBJ,GAAGI,OAApC;EACA,QAAI6M,WAAWnL,SAAX,IAAwBmL,WAAW,IAAvC,EAA6C;EAC3C;EACD,KAFD,MAEO;EACLD,cAAQC,OAAO9M,MAAP,EAAeH,GAAGuM,MAAlB,CAAR;EACAvM,SAAGsM,MAAH,CAAUhH,IAAV,CAAe0H,KAAf;EACA,aAAOA,KAAP;EACD;EACF,GAXD;;EAaAvD,QAAMyD,QAAN,GAAiB,UAAUC,UAAV,EAAsB;EACrC,QAAInN,KAAK,IAAT;EACA,WAAOA,GAAGsM,MAAH,CAAUa,UAAV,CAAP;EACD,GAHD;;EAKA1D,QAAM2D,IAAN,GAAa,YAAY;EACvB,QAAIpN,KAAK,IAAT;EAAA,QACEqN,CADF;EAEArN,OAAGyD,OAAH,GAAazD,GAAGsN,MAAH,EAAb;EACA;;EAEAD,QAAIrN,GAAGuN,QAAH,EAAJ;;EAEAF,MAAEG,QAAF,CAAW,UAAUC,KAAV,EAAiBC,OAAjB,EAA0B;EACnC,UAAID,KAAJ,EAAW,MAAMA,KAAN;;EAEX,UAAIxL,MAAMC,OAAN,CAAcwL,OAAd,KAA0BA,QAAQxJ,MAAR,IAAkB,CAAhD,EAAmD;EACjDlE,WAAGkM,KAAH,GAAWwB,QAAQ,CAAR,CAAX;EACD,OAFD,MAEO;EACL1N,WAAGkM,KAAH,GAAWwB,OAAX;EACD;;EAED1N,SAAG2N,UAAH;EACA3N,SAAG4N,OAAH;;EAEA;EACA5N,SAAGqM,KAAH,GAAWrM,GAAG6N,IAAH,EAAX;EACA7N,SAAG8N,QAAH;;EAEA;EACA9N,SAAG+N,UAAH;;EAEA;EACA,UAAI/N,GAAGI,OAAH,CAAWmI,MAAX,IAAqBvI,GAAGI,OAAH,CAAWmI,MAAX,CAAkByF,IAA3C,EAAiD;EAC/ChO,WAAGiO,QAAH,CAAYvI,EAAZ,CAAe,YAAf,EAA6B1F,GAAGI,OAAH,CAAWmI,MAAX,CAAkByF,IAAlB,CAAuBhO,EAAvB,CAA7B;EACD;EACF,KAvBD;EAwBA,WAAOA,EAAP;EACD,GAjCD;;EAmCAyJ,QAAM2C,QAAN,GAAiB,UAAU8B,KAAV,EAAiB;EAChC,QAAIlO,KAAK,IAAT;EACAA,OAAGU,SAAH,GAAewN,KAAf;EACA,WAAOlO,EAAP;EACD,GAJD;;EAMA;EACA;EACAyJ,QAAM6D,MAAN,GAAe,YAAY;EACzB,QAAItN,KAAK,IAAT;;EAEA,QAAIsN,SAAS,EAAb;EACA;EACA,QAAItN,GAAGI,OAAH,CAAWwC,KAAX,IAAoB5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAAzC,EAAgD;EAC9C,cAAQrB,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAAzB;EACE,aAAK,QAAL;EACEiM,iBAAOjF,CAAP,GAAWrH,gBAAA,GAAiBO,KAAjB,CAAuB,CAAC,CAAD,EAAIvB,GAAGM,MAAP,CAAvB,CAAX;EACA;;EAEF,aAAK,MAAL;EACEgN,iBAAOjF,CAAP,GAAWrH,cAAA,GAAeO,KAAf,CAAqB,CAAC,CAAD,EAAIvB,GAAGM,MAAP,CAArB,CAAX;EACA;;EAEF,aAAK,SAAL;EACEgN,iBAAOjF,CAAP,GAAWrH,iBAAA,GAAkBO,KAAlB,CAAwB,CAAC,CAAD,EAAIvB,GAAGM,MAAP,CAAxB,EAAwC,GAAxC,CAAX;EACA;;EAEF,aAAK,MAAL;EACEgN,iBAAOjF,CAAP,GAAWrH,cAAA,GAERmB,UAFQ,CAEG,CAAC,CAAD,EAAInC,GAAGM,MAAP,CAFH,EAGRgC,OAHQ,CAGA,GAHA,CAAX;EAIA;;EAEF,aAAK,UAAL;EACEgL,iBAAOjF,CAAP,GAAWrH,iBAAA,GAAkBO,KAAlB,CAAwB,CAAC,CAAD,EAAIvB,GAAGM,MAAP,CAAxB,EAAwC,GAAxC,CAAX;;EAEAgN,iBAAOD,CAAP,GAAWrM,kBAAA,GAERO,KAFQ,CAEFP,UAAA,CAAShB,GAAGI,OAAH,CAAWwC,KAAX,CAAiBuL,OAA1B,CAFE,CAAX;EAGA;;EAEF;EACEb,iBAAOjF,CAAP,GAAWrH,gBAAA,GAAiBO,KAAjB,CAAuB,CAAC,CAAD,EAAIvB,GAAGM,MAAP,CAAvB,CAAX;EACA;EA9BJ;EAgCD,KAjCD,MAiCO;EACLgN,aAAOjF,CAAP,GAAWrH,gBAAA,GAAiBO,KAAjB,CAAuB,CAAC,CAAD,EAAIvB,GAAGM,MAAP,CAAvB,CAAX;EACD;;EAED;EACA,QAAIN,GAAGI,OAAH,CAAWuC,KAAX,IAAoB3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAzC,EAAgD;EAC9C,cAAQrB,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAzB;EACE,aAAK,QAAL;EACEiM,iBAAOvI,CAAP,GAAW/D,gBAAA,GAAiBO,KAAjB,CAAuB,CAACvB,GAAGQ,OAAJ,EAAa,CAAb,CAAvB,CAAX;EACA;;EAEF,aAAK,MAAL;EACE8M,iBAAOvI,CAAP,GAAW/D,cAAA,GAAeO,KAAf,CAAqB,CAACvB,GAAGQ,OAAJ,EAAa,CAAb,CAArB,CAAX;EACA;;EAEF,aAAK,SAAL;EACE8M,iBAAOvI,CAAP,GAAW/D,iBAAA,GAAkBO,KAAlB,CAAwB,CAACvB,GAAGQ,OAAJ,EAAa,CAAb,CAAxB,EAAyC,GAAzC,CAAX;EACA;;EAEF,aAAK,MAAL;EACE8M,iBAAOvI,CAAP,GAAW/D,cAAA,GAERmB,UAFQ,CAEG,CAACnC,GAAGQ,OAAJ,EAAa,CAAb,CAFH,EAGR8B,OAHQ,CAGA,GAHA,CAAX;EAIA;;EAEF,aAAK,UAAL;EACEgL,iBAAOvI,CAAP,GAAW/D,iBAAA,GAAkBO,KAAlB,CAAwB,CAAC,CAAD,EAAIvB,GAAGM,MAAP,CAAxB,EAAwC,GAAxC,CAAX;;EAEAgN,iBAAOD,CAAP,GAAWrM,kBAAA,GAERO,KAFQ,CAEFP,UAAA,CAAShB,GAAGI,OAAH,CAAWuC,KAAX,CAAiBwL,OAA1B,CAFE,CAAX;EAGA;;EAEF;EACEb,iBAAOvI,CAAP,GAAW/D,gBAAA,GAAiBO,KAAjB,CAAuB,CAACvB,GAAGQ,OAAJ,EAAa,CAAb,CAAvB,CAAX;EACA;EA9BJ;EAgCD,KAjCD,MAiCO;EACL8M,aAAOvI,CAAP,GAAW/D,gBAAA,GAAiBO,KAAjB,CAAuB,CAACvB,GAAGQ,OAAJ,EAAa,CAAb,CAAvB,CAAX;EACD;;EAED8M,WAAO5C,KAAP,GAAe1J,iBAAA,CAAgBA,qBAAhB,CAAf;EACA,QAAIhB,GAAGI,OAAH,CAAWgL,MAAX,IAAqBpL,GAAGI,OAAH,CAAWgL,MAAX,CAAkBlH,MAAlB,GAA2B,CAApD,EAAuD;EACrDoJ,aAAO5C,KAAP,CAAatI,MAAb,CAAoBpC,GAAGI,OAAH,CAAWgL,MAAX,CAAkB3J,GAAlB,CAAsB;EAAA,eAAK2M,EAAE9F,IAAP;EAAA,OAAtB,CAApB;EACD;;EAED,WAAOgF,MAAP;EACD,GAtFD;;EAwFA7D,QAAM4E,SAAN,GAAkB,YAAY,EAA9B;;EAEA5E,QAAMoE,IAAN,GAAa,YAAY;EACvB,QAAI7N,KAAK,IAAT;EAAA,QACE6N,OAAO,EADT;EAEAA,SAAKxF,CAAL,GAASrH,eAAA,CAAchB,GAAGyD,OAAH,CAAW4E,CAAzB,CAAT;EACAwF,SAAK9I,CAAL,GAAS/D,aAAA,CAAYhB,GAAGyD,OAAH,CAAWsB,CAAvB,CAAT;;EAEA;EACA8I,SAAKxF,CAAL,CAAOiG,aAAP,CAAqB,CAArB;EACAT,SAAK9I,CAAL,CAAOuJ,aAAP,CAAqB,CAArB;;EAEA;EACA,QACEtO,GAAGI,OAAH,CAAWwC,KAAX,IACA5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KADjB,IAEA3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBsH,OAAvB,KAAmC,IAFnC,IAGAjL,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBlD,KAJzB,EAKE;EACA,cAAQT,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBlD,KAA/B;EACE,aAAK,cAAL;EACEoN,eAAKxF,CAAL,CAAOkG,QAAP,CAAgB,CAACvO,GAAGQ,OAApB,EAA6B,CAA7B;EACA;EACF,aAAK,UAAL;EACEqN,eAAKxF,CAAL,CAAOkG,QAAP,CAAgB,CAACvO,GAAGM,MAApB,EAA4B,CAA5B;EACA;EANJ;EAQD;EACD;EACA,QAAIN,GAAGU,SAAH,CAAakC,KAAb,CAAmBe,KAAnB,CAAyBmI,IAA7B,EAAmC;EACjC,cAAQ9L,GAAGU,SAAH,CAAakC,KAAb,CAAmBe,KAAnB,CAAyBmI,IAAjC;EACE,aAAK,UAAL;EACE+B,eAAK9I,CAAL,CACGwJ,QADH,CACY,CAACvO,GAAGM,MADhB,EACwB,CADxB;EAEA;EACF,aAAK,QAAL;EACEuN,eAAK9I,CAAL,CACGwJ,QADH,CACY,CAACvO,GAAGM,MADhB,EACwB,CADxB;EAEA;EARJ;EAUD;;EAED,QACEN,GAAGI,OAAH,CAAWwC,KAAX,IACA5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KADjB,IAEA3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBA,KAHzB,EAIE;EACAkK,WAAKxF,CAAL,CAAO1E,KAAP,CAAa3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBA,KAApC;EACD;;EAED,QAAI3D,GAAGI,OAAH,CAAWwC,KAAX,IAAoB5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAArC,IAA8C3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuB6K,MAAzE,EAAiF;EAC/EX,WAAKxF,CAAL,CAAOoG,UAAP,CAAkBzO,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuB6K,MAAzC;EACD;;EAED,QACExO,GAAGI,OAAH,CAAWwC,KAAX,IACA5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KADjB,IAEA3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAAjB,KAA2B,QAH7B,EAIE;EACArB,SAAGyD,OAAH,CAAW4E,CAAX,CAAajG,MAAb,GAAsB,CAAtB;EACAyL,WAAKxF,CAAL,CAAOqG,UAAP,CAAkB1O,GAAGuM,MAAH,CAAUxL,KAAV,CAAgByB,MAAhB,CAAuBxC,GAAGI,OAAH,CAAWwC,KAAlC,EAAyC,IAAzC,CAAlB;EACD;EACD,QACE5C,GAAGI,OAAH,CAAWwC,KAAX,IACA5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KADjB,IAEA3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBnB,MAHzB,EAIE;EACAqL,WAAKxF,CAAL,CAAOqG,UAAP,CAAkB1O,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBnB,MAAzC;EACD;;EAED;EACA,QACExC,GAAGI,OAAH,CAAWuC,KAAX,IACA3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KADjB,IAEA3D,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBsH,OAAvB,KAAmC,IAFnC,IAGAjL,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBlD,KAJzB,EAKE;EACA,cAAQT,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBlD,KAA/B;EACE,aAAK,cAAL;EACEoN,eAAK9I,CAAL,CACGwJ,QADH,CACY,CAACvO,GAAGM,MADhB,EACwB,CADxB;EAEA;EACF,aAAK,UAAL;EACEuN,eAAK9I,CAAL,CACGwJ,QADH,CACY,CAACvO,GAAGM,MADhB,EACwB,CADxB;EAEA;EARJ;EAUD;EACD;EACA,QAAIN,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgB,KAAnB,CAAyBmI,IAA7B,EAAmC;EACjC,cAAQ9L,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgB,KAAnB,CAAyBmI,IAAjC;EACE,aAAK,UAAL;EACE+B,eAAK9I,CAAL,CACGwJ,QADH,CACY,CAACvO,GAAGM,MADhB,EACwB,CADxB;EAEA;EACF,aAAK,QAAL;EACEuN,eAAK9I,CAAL,CACGwJ,QADH,CACY,CAACvO,GAAGM,MADhB,EACwB,CADxB;EAEA;EARJ;EAUD;EACD,QACEN,GAAGI,OAAH,CAAWuC,KAAX,IACA3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KADjB,IAEA3D,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAjB,KAA2B,QAH7B,EAIE;EACAwM,WAAK9I,CAAL,CAAO2J,UAAP,CAAkB1O,GAAGuM,MAAH,CAAUxL,KAAV,CAAgByB,MAAhB,CAAuBxC,GAAGI,OAAH,CAAWuC,KAAlC,EAAyC,IAAzC,CAAlB;EACD;EACD,QACE3C,GAAGI,OAAH,CAAWuC,KAAX,IACA3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KADjB,IAEA3D,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBnB,MAHzB,EAIE;EACAqL,WAAK9I,CAAL,CAAO2J,UAAP,CAAkB1O,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBnB,MAAzC;EACD;EACD,QACExC,GAAGI,OAAH,CAAWuC,KAAX,IACA3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KADjB,IAEA3D,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBA,KAHzB,EAIE;EACAkK,WAAK9I,CAAL,CAAOpB,KAAP,CAAa3D,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBA,KAApC;EACD;EACD,WAAOkK,IAAP;EACD,GAzHD;;EA2HApE,QAAM8D,QAAN,GAAiB,YAAY;EAC3B,QAAIvN,KAAK,IAAT;EACA,QAAIqN,CAAJ;;EAEA,QAAIrN,GAAGI,OAAH,CAAWgB,IAAX,CAAgBuN,GAApB,EAAyB;EACvBtB,UAAIrM,UAAA,GAAW4N,KAAX,CAAiB5N,QAAjB,EAAyBhB,GAAGI,OAAH,CAAWgB,IAAX,CAAgBuN,GAAzC,CAAJ;EACD;;EAED,QAAI3O,GAAGI,OAAH,CAAWgB,IAAX,CAAgByN,IAApB,EAA0B;EACxBxB,UAAIrM,UAAA,GAAW4N,KAAX,CAAiB5N,SAAjB,EAA0BhB,GAAGI,OAAH,CAAWgB,IAAX,CAAgByN,IAA1C,CAAJ;EACD;;EAED,QAAI7O,GAAGI,OAAH,CAAWgB,IAAX,CAAgB0N,GAApB,EAAyB;EACvBzB,UAAIrM,UAAA,GAAW4N,KAAX,CAAiB5N,QAAjB,EAAyBhB,GAAGI,OAAH,CAAWgB,IAAX,CAAgB0N,GAAzC,CAAJ;EACD;;EAED,QAAI9O,GAAGI,OAAH,CAAWgB,IAAX,CAAgB2N,GAApB,EAAyB;EACvB1B,UAAIrM,UAAA,GAAW4N,KAAX,CAAiB5O,GAAGgP,OAApB,EAA6BhP,GAAGI,OAAH,CAAWgB,IAAX,CAAgB2N,GAA7C,CAAJ;EACD;;EAED,QACE/O,GAAGI,OAAH,CAAWqB,GAAX,IACAzB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QADf,IAEAjP,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBC,GAH1B,EAIE;EACA7B,QAAEuB,KAAF,CAAQ5N,SAAR,EAAiBhB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBC,GAAzC;EACD;;EAED,WAAO7B,CAAP;EACD,GA7BD;;EA+BA5D,QAAMkE,UAAN,GAAmB,YAAY;EAC7B,QAAI3N,KAAK,IAAT;EACAA,OAAGsM,MAAH,CAAU6C,OAAV,CAAkB,UAAUC,EAAV,EAAc;EAC9BA,SAAGhO,IAAH,CAAQpB,GAAGkM,KAAX,EAAkBoB,MAAlB;;EAEA;EACAtN,SAAGyD,OAAH,GAAa2L,GAAG3L,OAAhB;EACD,KALD;EAMD,GARD;;EAUAgG,QAAMmE,OAAN,GAAgB,YAAY;EAC1B,QAAI5N,KAAK,IAAT;;EAEA;EACAgB,eAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAArB,EACG0C,MADH,CACU,KADV,EAEGnH,MAFH;EAGAlH,eAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAArB,EAA6B2C,IAA7B,CAAkC,EAAlC;;EAEA;EACA,QAAItP,GAAGI,OAAH,CAAWmP,QAAf,EAAyB;EACvBvO,iBAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAArB,EAA6B6C,OAA7B,CAAqCxP,GAAGI,OAAH,CAAWmP,QAAhD,EAA0D,IAA1D;EACD;;EAED;EACA,QAAIvP,GAAGI,OAAH,IAAcJ,GAAGI,OAAH,CAAWuK,KAA7B,EAAoC;EAClC3J,iBAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAArB,EACGvH,MADH,CACU,KADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,aAFjB,EAGGsK,IAHH,CAGQtP,GAAGI,OAAH,CAAWuK,KAHnB,EAIGlK,KAJH,CAIS,SAJT,EAIoB,MAJpB,EAKGA,KALH,CAKS,iBALT,EAK4B,QAL5B,EAMGA,KANH,CAMS,aANT,EAMwB,QANxB,EAOGA,KAPH,CAOS,WAPT,EAOsBT,GAAGU,SAAH,CAAaiK,KAAb,CAAmBE,QAPzC,EAQGpK,KARH,CAQS,aART,EAQwBT,GAAGU,SAAH,CAAaiK,KAAb,CAAmBG,UAR3C,EASGrK,KATH,CASS,OATT,EASkBT,GAAGU,SAAH,CAAaiK,KAAb,CAAmBC,SATrC,EAUGnK,KAVH,CAUS,YAVT,EAUuBT,GAAGU,SAAH,CAAaiK,KAAb,CAAmBI,SAV1C;;EAYA,UAAI/K,GAAGU,SAAH,CAAaiK,KAAb,CAAmBK,EAAnB,CAAsBC,OAA1B,EAAmC;EACjCjK,mBAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAArB,EACGvH,MADH,CACU,IADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,UAFjB,EAGGvE,KAHH,CAGS,OAHT,EAGkB,KAHlB,EAIGA,KAJH,CAIS,aAJT,EAIwB,KAJxB,EAKGA,KALH,CAKS,YALT,EAKuB,OALvB,EAMGA,KANH,CAMS,cANT,EAMyBT,GAAGU,SAAH,CAAaiK,KAAb,CAAmBK,EAAnB,CAAsBE,WAN/C,EAOGzK,KAPH,CAOS,cAPT,EAOyBT,GAAGU,SAAH,CAAaiK,KAAb,CAAmBK,EAAnB,CAAsBG,WAP/C;EAQD;EACF;;EAED;EACA;EACA;EACA,QACEnL,GAAGI,OAAH,CAAWgL,MAAX,IACApL,GAAGI,OAAH,CAAWgL,MAAX,CAAkBH,OAAlB,KAA8B,IAD9B,IAEAjL,GAAGI,OAAH,CAAWgL,MAAX,CAAkB1E,QAAlB,KAA+B,KAHjC,EAIE;EACA,UAAI0E,SAASpK,WAAA,CACHhB,GAAGI,OAAH,CAAWuM,MADR,EAEVvH,MAFU,CAEH,KAFG,EAGVJ,IAHU,CAGL,OAHK,EAGI,kBAHJ,CAAb;;EAKA,UAAIsK,OAAO,EAAX;EACAA,cACE,wFADF;EAEAtP,SAAGI,OAAH,CAAWgL,MAAX,CAAkBqE,UAAlB,CAA6BN,OAA7B,CAAqC,UAAUO,CAAV,EAAa;EAChDJ,gBACE,qIACAI,EAAEhF,KADF,GAEA,iGAFA,GAGAgF,EAAE/E,KAHF,GAIA,eALF;EAMD,OAPD;EAQA2E,cAAQ,QAAR;EACAlE,aAAOkE,IAAP,CAAYA,IAAZ;EACD;;EAED,QAAMjP,QAAQL,GAAGM,MAAH,GAAYN,GAAGmM,OAAH,CAAW/B,IAAvB,GAA8BpK,GAAGmM,OAAH,CAAW9B,KAAvD;EACA,QAAM9J,SAASP,GAAGQ,OAAH,GAAaR,GAAGmM,OAAH,CAAW7B,GAAxB,GAA8BtK,GAAGmM,OAAH,CAAW5B,MAAxD;EACA;EACAvK,OAAGY,QAAH,GAAcI,WAAA,CACJhB,GAAGI,OAAH,CAAWuM,MADP,EAEXvH,MAFW,CAEJ,KAFI,EAGX3E,KAHW,CAIV,WAJU,EAKVT,GAAGI,OAAH,CAAWF,KAAX,GACIF,GAAGI,OAAH,CAAWF,KAAX,CAAiB,WAAjB,IACEF,GAAGI,OAAH,CAAWF,KAAX,CAAiB,WAAjB,CADF,GAEE,MAHN,GAII,MATM,EAWX8E,IAXW,CAWN,OAXM,EAWG3E,KAXH,EAYX2E,IAZW,CAYN,QAZM,EAYIzE,MAZJ,EAaXyE,IAbW,CAaN,SAbM,WAaY3E,KAbZ,SAaqBE,MAbrB,CAAd;;EAeAP,OAAGc,IAAH,GAAUd,GAAGY,QAAH,CACPwE,MADO,CACA,GADA,EAEPJ,IAFO,CAGN,WAHM,EAIN,eAAehF,GAAGmM,OAAH,CAAW/B,IAA1B,GAAiC,GAAjC,GAAuCpK,GAAGmM,OAAH,CAAW7B,GAAlD,GAAwD,GAJlD,CAAV;;EAOA;EACA;;;;EAIA;;EAEAtJ,eAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAAX,GAAoB,MAA9B,EAAsClM,KAAtC,CACE,kBADF,EAEET,GAAGU,SAAH,CAAaR,KAAb,CAAmBuK,eAAnB,CAAmCC,KAFrC;;EAKA;EACA;;;;;;;;;;;;;;EAeA,QACE1K,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,QAA1B,KACA3P,GAAGI,OAAH,CAAWwP,aAAX,KAA6B,IAF/B,EAGE;EACA5P,SAAG6P,UAAH;EACD;EACF,GA/HD;;EAiIApG,QAAMsE,UAAN,GAAmB,YAAY;EAC7B,QAAI/N,KAAK,IAAT;EACAA,OAAGsM,MAAH,CAAU6C,OAAV,CAAkB,UAAUC,EAAV,EAAc;EAC9BA,SAAGhC,IAAH;EACD,KAFD;EAGD,GALD;;EAOA;;;EAGA3D,QAAMoG,UAAN,GAAmB,YAAY;EAC7B;EACA,QAAI7P,KAAK,IAAT;EAAA,QACE8P,SADF;EAAA,QAEEC,eAFF;EAAA,QAGEC,UAAUhQ,GAAGI,OAAH,CAAW8J,IAAX,CAAgB7J,KAAhB,GAAwBL,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBE,KAA/C,GAAuD,EAHnE;EAAA,QAIE4F,YAAYjQ,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBG,GAAvB,GAA6B,EAJ3C;EAKA;EACA,QAAI,CAACtK,GAAGyD,OAAH,CAAWiH,KAAZ,IAAqB1K,GAAGI,OAAH,CAAW8P,MAApC,EAA4C;EAC1ClQ,SAAGyD,OAAH,CAAWiH,KAAX,GAAmB1J,iBAAA,CAAgBhB,GAAGI,OAAH,CAAW8P,MAA3B,CAAnB;EACD;EACD,QAAIlQ,GAAGI,OAAH,CAAWgL,MAAX,IAAqBpL,GAAGI,OAAH,CAAWgL,MAAX,CAAkBlH,MAAlB,GAA2B,CAApD,EAAuD;EACrDlE,SAAGyD,OAAH,CAAWiH,KAAX,CAAiBtI,MAAjB,CAAwBpC,GAAGI,OAAH,CAAWgL,MAAX,CAAkB3J,GAAlB,CAAsB;EAAA,eAAK2M,EAAE9F,IAAP;EAAA,OAAtB,CAAxB;EACD;EACD;EACA,QAAM6H,YAAYnQ,GAAGuM,MAAH,CAAUxL,KAAV,CAAgBC,EAAhB,CAAmBC,GAAnB,GAAyBqO,IAAzB,CAA8B,aAAK;EACnD,aAAO,6BAA6B5N,EAAE4G,IAAF,IAAU5G,CAAvC,IAA4C,QAAnD;EACD,KAFiB,CAAlB;EAGA1B,OAAGY,QAAH,CAAYqH,IAAZ,CAAiBkI,SAAjB;;EAEA;EACAL,gBAAY9P,GAAGY,QAAH,CACTwE,MADS,CACF,GADE,EAETJ,IAFS,CAEJ,OAFI,EAEK,WAFL,EAGTA,IAHS,CAGJ,WAHI,EAGS,eAAegL,OAAf,GAAyB,IAAzB,GAAgCC,SAAhC,GAA4C,GAHrD,EAITjL,IAJS,CAIJ,OAJI,EAIKhF,GAAGM,MAJR,EAKT0E,IALS,CAKJ,QALI,EAKMhF,GAAGQ,OALT,CAAZ;EAMA;EACA,QAAIR,GAAGI,OAAH,CAAW+H,WAAf,EAA4B;EAC1B2H,gBACG1K,MADH,CACU,GADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,OAFjB,EAGGI,MAHH,CAGU,MAHV,EAIGJ,IAJH,CAIQ,OAJR,EAIiB,cAJjB,EAKGA,IALH,CAKQ,GALR,EAKa,CALb,EAMGvE,KANH,CAMS,aANT,EAMwB,MANxB,EAOG6D,IAPH,CAOQtE,GAAGI,OAAH,CAAW+H,WAPnB;EAQA;EACA,UAAIiI,SAASpQ,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBE,KAApC;EACA,UAAI/F,OAAOtD,cAAA,CAAa,eAAb,CAAX;EAAA,UACEyD,QAAQH,KACLA,IADK,GAELP,KAFK,CAEC,KAFD,EAGLW,OAHK,EADV;EAAA,UAKEC,IALF;EAAA,UAMEC,OAAO,EANT;EAAA,UAOEC,aAAa,CAPf;EAAA,UAQEC,aAAa,GARf;EAAA;EASEC,UAAIT,KAAKU,IAAL,CAAU,GAAV,CATN;EAAA,UAUEC,KAAK,CAVP;EAAA,UAWEE,QAAQb,KACLA,IADK,CACA,IADA,EAELc,MAFK,CAEE,OAFF,EAGLJ,IAHK,CAGA,GAHA,EAGK,CAHL,EAILA,IAJK,CAIA,GAJA,EAIKD,CAJL,EAKLC,IALK,CAKA,IALA,EAKMC,KAAK,IALX,CAXV;EAiBA,aAAQN,OAAOF,MAAMY,GAAN,EAAf,EAA6B;EAC3BT,aAAKU,IAAL,CAAUX,IAAV;EACAQ,cAAMb,IAAN,CAAWM,KAAKW,IAAL,CAAU,GAAV,CAAX;EACA,YAAIJ,MAAMK,IAAN,GAAaC,qBAAb,KAAuC2K,MAA3C,EAAmD;EACjDxL,eAAKS,GAAL;EACAF,gBAAMb,IAAN,CAAWM,KAAKW,IAAL,CAAU,GAAV,CAAX;EACAX,iBAAO,CAACD,IAAD,CAAP;EACA,YAAEE,UAAF;EACAM,kBAAQb,KACLc,MADK,CACE,OADF,EAELJ,IAFK,CAEA,GAFA,EAEK,CAAC,CAFN,EAGLA,IAHK,CAGA,GAHA,EAGKD,CAHL,EAILC,IAJK,CAIA,IAJA,EAIMF,aAAa,IAJnB,EAKLR,IALK,CAKAK,IALA,CAAR;EAMD;EACF;EACF;;EAED;EACA,QAAI0L,UAAUrQ,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBE,KAAvB,GAA+B,GAA7C;EACA,QAAIrK,GAAGI,OAAH,CAAW2M,UAAX,KAA0B,UAA9B,EAA0C;EACxC;EACA,UAAI7C,OAAO,EAAX;EAAA,UACE7B,IAAI,CADN;EAAA,UAEEtD,KAAI,CAFN;EAAA,UAGEuL,KAAK,CAHP;EAAA,UAIEC,KAAK,CAJP;EAAA,UAKEC,kBAAkB,CALpB;;EAOAxQ,SAAGyD,OAAH,CAAWiH,KAAX,CAAiBtI,MAAjB,CAAwBpC,GAAGI,OAAH,CAAWgL,MAAX,CAAkB3J,GAAlB,CAAsB;EAAA,eAAK2M,EAAE9F,IAAP;EAAA,OAAtB,CAAxB;;EAEA,UAAImI,cAAc,SAAdA,WAAc,CAAUC,WAAV,EAAuB;EACvCA,oBACGtL,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiBkF,IAFjB,EAGGlF,IAHH,CAGQ,QAHR,EAGkBkF,IAHlB,EAIGlF,IAJH,CAIQ,GAJR,EAIaqD,CAJb,EAKGrD,IALH,CAKQ,IALR,EAKcsL,EALd,EAMGtL,IANH,CAMQ,IANR,EAMcuL,EANd,EAOGvL,IAPH,CAOQ,cAPR,EAOwB,CAPxB;EAQA,YAAI2L,cAAc,CAChB;EACEtI,aAAGA,IAAI6B,OAAO,CADhB;EAEEnF,aAAGA,KAAImF,OAAO;EAFhB,SADgB,EAKhB;EACE7B,aAAGA,IAAI6B,OAAO,GADhB;EAEEnF,aAAGA,KAAImF,IAAJ,GAAWA,OAAO;EAFvB,SALgB,EAShB;EACE7B,aAAGA,IAAI6B,IAAJ,GAAWA,OAAO,CADvB;EAEEnF,aAAGA,KAAImF,OAAO;EAFhB,SATgB,CAAlB;;EAeA,YAAItF,OAAO5D,SAAA,GAERqH,CAFQ,CAEN,UAAU3G,CAAV,EAAa;EACd,iBAAOA,EAAE2G,CAAT;EACD,SAJQ,EAKRtD,CALQ,CAKN,UAAUrD,CAAV,EAAa;EACd,iBAAOA,EAAEqD,CAAT;EACD,SAPQ,CAAX;;EASA;EACA2L,oBACGtL,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,GAFR,EAEaJ,KAAK+L,WAAL,CAFb,EAGG3L,IAHH,CAGQ,cAHR,EAGwBwL,eAHxB,EAIGxL,IAJH,CAIQ,QAJR,EAIkB,OAJlB,EAKGA,IALH,CAKQ,MALR,EAKgB,MALhB,EAMGA,IANH,CAMQ,OANR,EAMiB,MANjB,EAOG4L,QAPH,CAOY,SAPZ,EAOuB,UAAUlP,CAAV,EAAa;EAChC;EACA,iBAAOA,EAAEmP,MAAT;EACD,SAVH,EAWG7L,IAXH,CAWQ,SAXR,EAWmB,YAAY;EAC3B,cAAIhE,WAAA,CAAU,IAAV,EAAgB4P,QAAhB,CAAyB,SAAzB,CAAJ,EAAyC;EACvC,mBAAO,CAAP;EACD,WAFD,MAEO;EACL,mBAAO,CAAP;EACD;EACF,SAjBH;;EAmBAF,oBACGtL,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,WAFjB,EAGGA,IAHH,CAGQ,GAHR,EAGa,EAHb,EAIGA,IAJH,CAIQ,GAJR,EAIa,CAJb,EAKGA,IALH,CAKQ,IALR,EAKc,OALd,EAMGA,IANH,CAMQ,aANR,EAMuB,OANvB;;EAQA0L,oBAAYrB,MAAZ,CAAmB,MAAnB,EAA2BrK,IAA3B,CAAgC,MAAhC,EAAwC,UAAUtD,CAAV,EAAa;EACnD,iBAAO1B,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBhJ,EAAE4G,IAAnB,CAAP;EACD,SAFD;;EAIAoI,oBAAYrB,MAAZ,CAAmB,MAAnB,EAA2B/K,IAA3B,CAAgC,UAAU5C,CAAV,EAAa;EAC3C;EACA;EACA;EACA,iBAAOA,EAAE4G,IAAT;EACD,SALD;;EAOA;EACAoI,oBAAY1I,SAAZ,CAAsB,MAAtB,EAA8BxD,IAA9B,CAAmC,UAAU9C,CAAV,EAAa;EAAA;;EAC9C,cAAI,OAAOA,EAAE4G,IAAT,KAAkB,QAAtB,EAAgC;EAC9B;EACA,gBAAI,KAAK7C,qBAAL,KAA+B4K,OAAnC,EAA4C;EAAA;EAC1CrP,2BAAA,CAAU,KAAV,EACGgE,IADH,CACQ,OADR,EACiBtD,EAAE4G,IADnB,EAEG5C,EAFH,CAEM,WAFN,EAEmByK,UAAUxK,IAF7B,EAGGD,EAHH,CAGM,UAHN,EAGkByK,UAAUvK,IAH5B;EAIA,oBAAIC,IAAI,CAAR;EACA,uBAAO,MAAKJ,qBAAL,KAA+B4K,OAAtC,EAA+C;EAC7CrP,6BAAA,CAAU,KAAV,EAAgBsD,IAAhB,CAAqB,UAAU5C,CAAV,EAAa;EAChC,2BAAOA,EAAE,MAAF,EAAUoE,KAAV,CAAgB,CAAhB,EAAmB,CAACD,CAApB,IAAyB,KAAhC;EACD,mBAFD;EAGA,oBAAEA,CAAF;EACD;EAXyC;EAY3C,aAZD,MAYO;EACL,qBAAOnE,CAAP;EACD;EACF;EACF,SAnBD;EAoBD,OA7FD,CAXwC;;EA0GxC;EACAoO,gBACG1K,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,qBAFjB,EAGGA,IAHH,CAGQ,OAHR,EAGiB,OAHjB,EAIGA,IAJH,CAIQ,QAJR,EAIkB,KAJlB,EAKGA,IALH,CAKQ,WALR,EAKqB,gBALrB,EAMGvE,KANH,CAMS,MANT,EAMiB,aANjB;;EAQA,UAAIqQ,eAAe,SAAfA,YAAe,CAAUJ,WAAV,EAAuB;EACxCA,oBAAYrB,MAAZ,CAAmB,MAAnB,EAA2BrK,IAA3B,CAAgC,MAAhC,EAAwC,UAAUtD,CAAV,EAAa;EACnD,iBAAO1B,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBhJ,EAAE4G,IAAnB,CAAP;EACD,SAFD;;EAIAoI,oBAAYrB,MAAZ,CAAmB,MAAnB,EAA2B/K,IAA3B,CAAgC,UAAU5C,CAAV,EAAa;EAC3C;EACA;EACA;EACA,iBAAOA,EAAE4G,IAAT;EACD,SALD;;EAOAoI,oBAAY1I,SAAZ,CAAsB,MAAtB,EAA8BxD,IAA9B,CAAmC,UAAU9C,CAAV,EAAa;EAAA;;EAC9C,cAAI,OAAOA,EAAE4G,IAAT,KAAkB,QAAtB,EAAgC;EAC9B;EACA,gBAAI,KAAK7C,qBAAL,KAA+B4K,OAAnC,EAA4C;EAAA;EAC1CrP,2BAAA,CAAU,MAAV,EACGgE,IADH,CACQ,OADR,EACiBtD,EAAE4G,IADnB,EAEG5C,EAFH,CAEM,WAFN,EAEmByK,UAAUxK,IAF7B,EAGGD,EAHH,CAGM,UAHN,EAGkByK,UAAUvK,IAH5B;EAIA,oBAAIC,IAAI,CAAR;EACA,uBAAO,OAAKJ,qBAAL,KAA+B4K,OAAtC,EAA+C;EAC7CrP,6BAAA,CAAU,MAAV,EAAgBsD,IAAhB,CAAqB,UAAU5C,CAAV,EAAa;EAChC,2BAAOA,EAAE,MAAF,EAAUoE,KAAV,CAAgB,CAAhB,EAAmB,CAACD,CAApB,IAAyB,KAAhC;EACD,mBAFD;EAGA,oBAAEA,CAAF;EACD;EAXyC;EAY3C,aAZD,MAYO;EACL,qBAAOnE,CAAP;EACD;EACF;EACF,SAnBD;EAoBD,OAhCD;;EAkCA,UAAIqP,aAAa,SAAbA,UAAa,CAAUL,WAAV,EAAuB,EAAxC;;EAEAX,wBAAkB/P,GAAGuM,MAAH,CAAUxL,KAAV,CACfoF,eADe,GAEfQ,SAFe,CAELuD,IAFK,EAGf9D,KAHe,CAGTqK,WAHS,EAIfpK,MAJe,CAIRyK,YAJQ,EAKfxK,IALe,CAKVyK,UALU,EAMflQ,GANe,CAMXb,GAAGY,QANQ,EAOf6F,SAPe,CAOLzG,GAAGI,OAAH,CAAWgL,MAAX,CAAkBlH,MAPb,EAQfsC,QARe,CAQNxF,WAAA,CAAU,cAAV,CARM,EASf6D,UATe,CASJA,UATI,CAAlB;;EAWAkL,sBAAgB3O,IAAhB,CAAqBpB,GAAGI,OAAH,CAAWgL,MAAhC,EAAwC,UAAU1J,CAAV,EAAa;EACnD,eAAOA,EAAE4G,IAAT;EACD,OAFD;EAGAwH,gBAAU7H,IAAV,CAAe8H,eAAf;;EAEA;EACD,KAxKD,MAwKO;EACL,UAAI3E,MAAJ;EACA,UAAIpL,GAAGI,OAAH,CAAW4Q,MAAX,IAAqBhR,GAAGU,SAAH,CAAa0K,MAAb,CAAoB1E,QAApB,KAAiC,QAA1D,EAAoE;EAClE0E,iBAAS0E,UACN9H,SADM,CACI,SADJ,EAEN5G,IAFM,CAEDpB,GAAGI,OAAH,CAAWgL,MAFV,EAGNhF,KAHM,GAINhB,MAJM,CAIC,GAJD,EAKNJ,IALM,CAKD,OALC,EAKQ,QALR,EAMNA,IANM,CAMD,OANC,EAMQhF,GAAGM,MAAH,IAAaN,GAAGI,OAAH,CAAWgL,MAAX,CAAkBlH,MAAlB,GAA2B,CAAxC,CANR,EAONc,IAPM,CAOD,WAPC,EAOY,UAAUtD,CAAV,EAAamE,CAAb,EAAgB;EACjC;EACA;EACA,iBACE,eACC7F,GAAGM,MAAH,IAAaN,GAAGI,OAAH,CAAWgL,MAAX,CAAkBlH,MAAlB,GAA2B,CAAxC,CAAD,GAA+C2B,CAD/C,GAEA,GAFA,GAGA,CAAC7F,GAAGI,OAAH,CAAW+H,WAAX,IAA0BtD,aAAa,CAAvC,GACGA,aAAaC,UADhB,GAEG,CAFJ,IAGA,EANA,GAOA,GARF;EAUD,SApBM,CAAT;EAqBD,OAtBD,MAsBO;EACLsG,iBAAS0E,UACN9H,SADM,CACI,SADJ,EAEN5G,IAFM,CAEDpB,GAAGI,OAAH,CAAWgL,MAFV,EAGNhF,KAHM,GAINhB,MAJM,CAIC,GAJD,EAKNJ,IALM,CAKD,OALC,EAKQ,QALR,EAMNA,IANM,CAMD,WANC,EAMY,UAAUtD,CAAV,EAAamE,CAAb,EAAgB;EACjC,iBACE,eACA,CADA,GAEA,GAFA,GAGA,CAAC7F,GAAGI,OAAH,CAAW+H,WAAX,IAA0BtD,aAAa,CAAvC,GACGA,aAAaC,UAAb,GAA0Be,CAD7B,GAEG,IAAIA,CAFR,IAGA,EANA,GAOA,GARF;EAUD,SAjBM,CAAT;EAkBD;;EAED,UAAI7F,GAAGU,SAAH,CAAa0K,MAAb,CAAoBC,MAApB,KAA+B,QAAnC,EAA6C;EAC3CD,eACGhG,MADH,CACU,QADV,EAEGJ,IAFH,CAEQ,IAFR,EAEc,CAFd,EAGGA,IAHH,CAGQ,IAHR,EAGc,CAHd,EAIGA,IAJH,CAIQ,GAJR,EAIa,CAJb,EAKGA,IALH,CAKQ,cALR,EAKwB,CALxB,EAMGA,IANH,CAMQ,QANR,EAMkB,UAAUtD,CAAV,EAAa;EAC3B,iBAAO1B,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBhJ,EAAE4G,IAAnB,CAAP;EACD,SARH,EASGtD,IATH,CASQ,MATR,EASgB,UAAUtD,CAAV,EAAa;EACzB,iBAAO1B,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBhJ,EAAE4G,IAAnB,CAAP;EACD,SAXH,EAYGtD,IAZH,CAYQ,cAZR,EAYwB,GAZxB;EAaD,OAdD,MAcO;EACLoG,eACGhG,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,OAHR,EAGiB,EAHjB,EAIGA,IAJH,CAIQ,QAJR,EAIkB,EAJlB,EAKGA,IALH,CAKQ,MALR,EAKgB,UAAUtD,CAAV,EAAa;EACzB,iBAAO1B,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBhJ,EAAE4G,IAAnB,CAAP;EACD,SAPH;EAQD;;EAED8C,aACGhG,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,GAFR,EAEa,EAFb,EAGGA,IAHH,CAGQ,GAHR,EAGa,CAHb,EAIGA,IAJH,CAIQ,IAJR,EAIc,OAJd,EAKGA,IALH,CAKQ,aALR,EAKuB,OALvB,EAMGV,IANH,CAMQ,UAAU5C,CAAV,EAAa;EACjB;EACA,eAAOA,EAAE4G,IAAT;EACD,OATH;;EAWA;EACA,UAAI+H,WAAUrQ,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBE,KAAvB,GAA+B,EAA7C;EACAe,aAAOpD,SAAP,CAAiB,MAAjB,EAAyBxD,IAAzB,CAA8B,UAAU9C,CAAV,EAAa;EAAA;;EACzC,YAAI,OAAOA,EAAE4G,IAAT,KAAkB,QAAtB,EAAgC;EAC9B,cAAI,KAAK7C,qBAAL,KAA+B4K,QAAnC,EAA4C;EAAA;EAC1CrP,yBAAA,CAAU,MAAV,EACGgE,IADH,CACQ,OADR,EACiBtD,EAAE4G,IADnB,EAEG5C,EAFH,CAEM,WAFN,EAEmByK,UAAUxK,IAF7B,EAGGD,EAHH,CAGM,UAHN,EAGkByK,UAAUvK,IAH5B;EAIA,kBAAIC,IAAI,CAAR;EACA,qBAAO,OAAKJ,qBAAL,KAA+B4K,QAAtC,EAA+C;EAC7CrP,2BAAA,CAAU,MAAV,EAAgBsD,IAAhB,CAAqB,UAAU5C,CAAV,EAAa;EAChC,yBAAOA,EAAE,MAAF,EAAUoE,KAAV,CAAgB,CAAhB,EAAmB,CAACD,CAApB,IAAyB,KAAhC;EACD,iBAFD;EAGA,kBAAEA,CAAF;EACD;EAXyC;EAY3C,WAZD,MAYO;EACL,mBAAOnE,CAAP;EACD;EACF;EACF,OAlBD;EAmBD;;EAED;;;;EAIAoO,cACG9H,SADH,CACa,cADb,EAEGhD,IAFH,CAEQ,MAFR,EAEgBhF,GAAGU,SAAH,CAAa0K,MAAb,CAAoB9G,IAApB,CAAyBsG,SAFzC,EAGG5F,IAHH,CAGQ,WAHR,EAGqBhF,GAAGU,SAAH,CAAa0K,MAAb,CAAoB9G,IAApB,CAAyBuG,QAH9C,EAIG7F,IAJH,CAIQ,aAJR,EAIuBhF,GAAGU,SAAH,CAAa0K,MAAb,CAAoB9G,IAApB,CAAyBwG,UAJhD;;EAMA;EACA,QAAIlC,YAAY,OAAOC,cAAP,KAA0B,WAA1C;EACA,QAAIC,UACF,aAAa9H,WAAA,CAAU,YAAV,CAAb,GACI,OADJ;EAAA,MAEI+H,SAASC,YAAT,KAA0BlH,SAA1B,GACE,YADF;EAAA,MAEE,gBALR,CAxW6B;EA8W7B,QAAI8G,SAAJ,EAAe;EACb;EACA;EACAE,gBAAU,OAAV;EACD;EACD9H,eAAA,CAAU,sBAAV,EAAkC0E,EAAlC,CAAqCoD,OAArC,EAA8C,YAAY;EACxD,UAAIG,MAAMjI,UAAV;EACAiI,UAAIC,cAAJ;EACD,KAHD;;EAKAlI,eAAA,CAAU,gBAAV,EAA4B0E,EAA5B,CAA+BoD,OAA/B,EAAwC,YAAY;EAClD,UAAIG,MAAMjI,UAAV;EACAiI,UAAIC,cAAJ;EACD,KAHD;;EAKA4G,cAAU9H,SAAV,CAAoB,MAApB,EAA4BtC,EAA5B,CAA+BoD,OAA/B,EAAwC,YAAY;EAClD,UAAIG,MAAMjI,UAAV;EACAiI,UAAIC,cAAJ;EACD,KAHD;;EAKA4G,cAAU9H,SAAV,CAAoB,MAApB,EAA4BtC,EAA5B,CAA+BoD,OAA/B,EAAwC,YAAY;EAClD,UAAIG,MAAMjI,UAAV;EACAiI,UAAIC,cAAJ;EACD,KAHD;;EAKA4G,cAAU9H,SAAV,CAAoB,MAApB,EAA4BtC,EAA5B,CAA+BoD,OAA/B,EAAwC,YAAY;EAClD,UAAIG,MAAMjI,UAAV;EACAiI,UAAIC,cAAJ;EACD,KAHD;EAID,GA3YD;;EA6YAO,QAAMwH,QAAN,GAAiB,YAAY;EAC3B,QAAIjR,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAyJ,QAAMqE,QAAN,GAAiB,YAAY;EAC3B,QAAI9N,KAAK,IAAT;EACA,QAAI2C,KAAJ;;EAEA;;;;;EAKA;EACA,QAAMuO,UAAUlR,GAAGuM,MAAH,CAAUxL,KAAV,CAAgBC,EAAhB,CAAmBC,GAAnB,GAAyBqO,IAAzB,CAA8B,aAAK;EACjD,aAAO,4BAA4B5N,CAA5B,GAAgC,QAAvC;EACD,KAFe,CAAhB;;EAIA,QACE,CAAC,CAAC1B,GAAGI,OAAH,CAAWuC,KAAZ,IACE3C,GAAGI,OAAH,CAAWuC,KAAX,IAAoB3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBsI,OAAjB,KAA6B,KADpD,MAEC,CAACjL,GAAGI,OAAH,CAAWwC,KAAZ,IACE5C,GAAGI,OAAH,CAAWwC,KAAX,IAAoB5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBqI,OAAjB,KAA6B,KAHpD,CADF,EAKE;EACAjL,SAAGc,IAAH,CAAQmH,IAAR,CAAaiJ,OAAb;EACD;;EAED;;;;EAIA;;EAEA,QACE,CAAClR,GAAGI,OAAH,CAAWuC,KAAZ,IACC3C,GAAGI,OAAH,CAAWuC,KAAX,IAAoB3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBsI,OAAjB,KAA6B,KAFpD,EAGE;EACAtI,cAAQ3C,GAAGc,IAAH,CACLsE,MADK,CACE,GADF,EAELJ,IAFK,CAEA,OAFA,EAES,QAFT,EAGLiD,IAHK,CAGAjI,GAAGqM,KAAH,CAAStH,CAHT,CAAR;;EAKA,UAAI/E,GAAGI,OAAH,CAAWuC,KAAX,IAAoB3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiB2B,IAAzC,EAA+C;EAC7C3B,cACGyC,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,YAFjB,EAGGA,IAHH,CAGQ,GAHR,EAGa,CAAChF,GAAGmM,OAAH,CAAW/B,IAAZ,GAAmB,GAHhC,EAIGpF,IAJH,CAIQ,GAJR,EAIa,CAAChF,GAAGQ,OAAJ,GAAc,CAJ3B,EAKGwE,IALH,CAKQ,WALR,EAKqB,aALrB,EAMGA,IANH,CAMQ,aANR,EAMuB,QANvB,EAOGV,IAPH,CAOQtE,GAAGI,OAAH,CAAWuC,KAAX,CAAiB2B,IAPzB;EAQD;;EAED,UAAItE,GAAGI,OAAH,CAAWuC,KAAX,IAAoB3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBiB,SAAzC,EAAoD;EAClDjB,cACGyC,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,kBAFjB,EAGGA,IAHH,CAGQ,GAHR,EAGa,CAAC,EAHd,EAIGA,IAJH,CAIQ,GAJR,EAIa,CAAC,EAJd,EAKGA,IALH,CAKQ,aALR,EAKuB,MALvB,EAMGA,IANH,CAMQ,aANR,EAMuB,QANvB,EAOGV,IAPH,CAOQtE,GAAGI,OAAH,CAAWuC,KAAX,CAAiBiB,SAPzB;EAQD;EACF;;EAED,QACE5D,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,IACApC,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,CAAwBuN,cAAxB,CAAuC,SAAvC,CAFF,EAGE;EACA,UAAI3P,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAArB,EAA4B;EAC1B,YACE3D,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,CAAwB6I,OAAxB,KAAoC,KAApC,IACAjL,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBsH,OAAvB,KAAmC,KAFrC,EAGE;EACAjK,qBAAA,CAAU,kBAAV,EAA8BkH,MAA9B;EACAlH,wBAAA,CAAa,gBAAb,EAA+BkH,MAA/B;EACD,SAND,MAMO,IACLlI,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,CAAwB6I,OAAxB,KAAoC,KAApC,IACAjL,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBsH,OAAvB,KAAmC,IAF9B,EAGL;EACAjK,qBAAA,CAAU,kBAAV,EAA8BkH,MAA9B;EACA;EACD;EACF,OAdD,MAcO;EACL,YAAIlI,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,CAAwB6I,OAAxB,KAAoC,KAAxC,EAA+C;EAC7CjK,qBAAA,CAAU,kBAAV,EAA8BkH,MAA9B;EACAlH,wBAAA,CAAa,gBAAb,EAA+BkH,MAA/B;EACD;EACF;EACF;;EAED,QACE,CAAClI,GAAGI,OAAH,CAAWuC,KAAZ,IACC3C,GAAGI,OAAH,CAAWuC,KAAX,IAAoB3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBsI,OAAjB,KAA6B,KAFpD,EAGE;EACA;EACA;EACAtI,YAAMqF,SAAN,CAAgB,MAAhB,EAAwBxD,IAAxB,CAA6B,UAAU9C,CAAV,EAAa;EAAA;;EACxC,YAAIyP,UAAU,IAAd;EACA,YAAI,OAAOzP,CAAP,KAAa,QAAjB,EAA2B;EACzB,cAAI,KAAK+D,qBAAL,KAA+B,MAAMzF,GAAGmM,OAAH,CAAW/B,IAApD,EAA0D;EAAA;EACxDpJ,yBAAA,CAAUmQ,OAAV,EACGzL,EADH,CACM,WADN,EACmBwL,QAAQvL,IAD3B,EAEGD,EAFH,CAEM,UAFN,EAEkBwL,QAAQtL,IAF1B;EAGA,kBAAIC,IAAI,CAAR;EACA,qBAAO,OAAKJ,qBAAL,KAA+B,MAAMzF,GAAGmM,OAAH,CAAW/B,IAAvD,EAA6D;EAC3DpJ,2BAAA,CAAU,MAAV,EACGsD,IADH,CACQ,UAAU5C,CAAV,EAAa;EACjB,yBAAOA,EAAEoE,KAAF,CAAQ,CAAR,EAAW,CAACD,CAAZ,IAAiB,KAAxB;EACD,iBAHH,EAIGb,IAJH,CAIQ,OAJR,EAIiBtD,CAJjB;EAKA,kBAAEmE,CAAF;EACD;EAZuD;EAazD,WAbD,MAaO;EACL,mBAAOnE,CAAP;EACD;EACF;EACF,OApBD;EAqBD;;EAED;EACA,QACE1B,GAAGI,OAAH,CAAWuC,KAAX,IACA3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiByO,QADjB,IAEApR,GAAGI,OAAH,CAAWuC,KAAX,CAAiByO,QAAjB,CAA0BnG,OAA1B,KAAsC,IAHxC,EAIE;EACA,UAAIoG,gBAAgBrQ,WAAA,CACVhB,GAAGI,OAAH,CAAWuM,MADD,EAEjBvH,MAFiB,CAEV,KAFU,EAGjBJ,IAHiB,CAGZ,OAHY,EAGH,mBAHG,EAIjBI,MAJiB,CAIV,QAJU,EAKjBM,EALiB,CAKd,QALc,EAKJ,YAAY;EACxB1F,WAAGsR,UAAH,CAAc,GAAd,EAAmB,KAAKjO,KAAxB;EACD,OAPiB,CAApB;;EASA;;;;;;;;EAQA,UAAIgF,IACD,CAAC,CAAD,GACCrH,WAAA,CACUhB,GAAGI,OAAH,CAAWuM,MADrB,EAEGnH,IAFH,GAGG+L,qBAHH,GAG2BlR,KAJ7B,GAKA,CALA,GAMAL,GAAGmM,OAAH,CAAW/B,IAAX,GAAkB,GAPpB;EAQA,UAAIrF,IACD,CAAC,CAAD,GACC/D,WAAA,CACUhB,GAAGI,OAAH,CAAWuM,MADrB,EAEGnH,IAFH,GAGG+L,qBAHH,GAG2BhR,MAJ7B,GAKA,GANF;;EAQA,UAAIP,GAAGI,OAAH,CAAWuC,KAAX,CAAiByO,QAAjB,CAA0BJ,MAA9B,EAAsC;EACpC,YAAIA,SAAShR,GAAGI,OAAH,CAAWuC,KAAX,CAAiByO,QAAjB,CAA0BJ,MAAvC;EACAA,eAAOQ,OAAP,GAAiB,OAAjB;EACAR,eAAOS,SAAP,GAAmB,eAAepJ,CAAf,GAAmB,KAAnB,GAA2BtD,CAA3B,GAA+B,oBAAlD;EACAiM,eAAO7G,MAAP,GAAgB,MAAhB;EACA6G,eAAO,YAAP,IAAuB,QAAvB;EACAA,eAAO,iBAAP,IAA4B,QAA5B;;EAEAhQ,mBAAA,CAAU,2BAAV,EAAuCgQ,MAAvC,CAA8CA,MAA9C;;EAEAhQ,mBAAA,CAAU,kCAAV,EAA8CgQ,MAA9C,CAAqD;EACnD,wBAAc;EADqC,SAArD;EAGD,OAbD,MAaO;EACLhQ,mBAAA,CAAU,2BAAV,EAAuCgQ,MAAvC,CAA8C;EAC5CQ,mBAAS,OADmC;EAE5CC,qBAAW,eAAepJ,CAAf,GAAmB,KAAnB,GAA2BtD,CAA3B,GAA+B,oBAFE;EAG5CoF,kBAAQ,MAHoC;EAI5C,wBAAc,QAJ8B;EAK5C,6BAAmB;EALyB,SAA9C;;EAQAnJ,mBAAA,CAAU,kCAAV,EAA8CgQ,MAA9C,CAAqD;EACnD,wBAAc;EADqC,SAArD;EAGD;;EAED,UAAIhR,GAAGI,OAAH,CAAWuC,KAAX,CAAiByO,QAAjB,CAA0BM,OAA9B,EAAuC;EACrCL,sBACGrJ,SADH,CACa,QADb,EAEG5G,IAFH,CAEQpB,GAAGI,OAAH,CAAWuC,KAAX,CAAiByO,QAAjB,CAA0BM,OAFlC,EAGGtL,KAHH,GAIGhB,MAJH,CAIU,QAJV,EAKGJ,IALH,CAKQ,OALR,EAKiB,UAAUtD,CAAV,EAAa;EAC1B,iBAAOA,EAAE2B,KAAT;EACD,SAPH,EAQG2B,IARH,CAQQ,OARR,EAQiB,UAAUtD,CAAV,EAAa;EAC1B,iBAAOA,EAAE2B,KAAT;EACD,SAVH,EAWGiB,IAXH,CAWQ,UAAU5C,CAAV,EAAa;EACjB,iBAAOA,EAAEiJ,KAAT;EACD,SAbH,EAcGiG,QAdH,CAcY,UAdZ,EAcwB,UAAUlP,CAAV,EAAa;EACjC,iBAAOA,EAAEiQ,QAAT;EACD,SAhBH;EAiBD,OAlBD,MAkBO;EACLC,gBAAQC,GAAR,CAAY,8BAAZ;EACD;EACF;;EAED;;EAEA;;EAEA;EACA,QACE,CAAC7R,GAAGI,OAAH,CAAWwC,KAAZ,IACC5C,GAAGI,OAAH,CAAWwC,KAAX,IAAoB5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBqI,OAAjB,KAA6B,KAFpD,EAGE;EACAjL,SAAG8R,MAAH,GAAY9R,GAAGc,IAAH,CACTsE,MADS,CACF,GADE,EAETJ,IAFS,CAEJ,OAFI,EAEK,QAFL,EAGTA,IAHS,CAGJ,WAHI,EAGS,iBAAiBhF,GAAGQ,OAApB,GAA8B,GAHvC,EAITyH,IAJS,CAIJjI,GAAGqM,KAAH,CAAShE,CAJL,CAAZ;;EAMA;EACA,UAAIrI,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAjB,KAA2B,QAA3B,IAAuCrB,GAAGyD,OAAH,CAAWsB,CAAX,CAAa3C,MAAb,GAAsB,CAAtB,IAA2B,CAAtE,EAAyE;EACvEpC,WAAG8R,MAAH,CACGzC,MADH,CACU,SADV,EAEGrK,IAFH,CAGI,WAHJ,EAII,kBACAsC,KAAKyK,GAAL,CAAS/R,GAAGyD,OAAH,CAAWsB,CAAX,CAAaxD,KAAb,GAAqB,CAArB,IAA0BvB,GAAGyD,OAAH,CAAWsB,CAAX,CAAa,CAAb,CAAnC,CADA,GAEA,GANJ;EAQD;;EAED;EACA,UAAI/E,GAAGI,OAAH,CAAWwC,KAAX,CAAiBgC,IAAjB,IAAyB5E,GAAGI,OAAH,CAAWwC,KAAX,CAAiBgC,IAAjB,CAAsBqG,OAAtB,IAAiC,KAA9D,EAAqE;EACnEjL,WAAG8R,MAAH,CAAU9J,SAAV,CAAoB,MAApB,EAA4BvH,KAA5B,CAAkC,SAAlC,EAA6C,MAA7C;EACD;;EAED;EACA,UAAIT,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,IAA0B3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuB0E,CAArD,EAAwD;EACtDrI,WAAG8R,MAAH,CAAU9J,SAAV,CAAoB,MAApB,EAA4BhD,IAA5B,CAAiC,IAAjC,EAAuChF,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuB0E,CAA9D;EACD;;EAED,UAAIrI,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,IAA0B3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBoB,CAArD,EAAwD;EACtD/E,WAAG8R,MAAH,CAAU9J,SAAV,CAAoB,MAApB,EAA4BhD,IAA5B,CAAiC,IAAjC,EAAuChF,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBoB,CAA9D;EACD;;EAED;EACA,UACE/E,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,IACA3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBiB,IADvB,IAEA5E,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBiB,IAAvB,CAA4BqG,OAA5B,KAAwC,KAH1C,EAIE;EACAjL,WAAG8R,MAAH,CAAU9J,SAAV,CAAoB,MAApB,EAA4BvH,KAA5B,CAAkC,SAAlC,EAA6C,MAA7C;EACD;EACF;;EAED,QAAIT,GAAGI,OAAH,CAAWwC,KAAX,IAAoB5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiB0B,IAAzC,EAA+C;EAC7CtE,SAAGc,IAAH,CACGuO,MADH,CACU,SADV,EAEGjK,MAFH,CAEU,MAFV,EAGGJ,IAHH,CAGQ,OAHR,EAGiB,YAHjB,EAIGA,IAJH,CAIQ,GAJR,EAIahF,GAAGM,MAAH,GAAY,CAJzB,EAKG0E,IALH,CAKQ,GALR,EAKa,EALb,EAMGvE,KANH,CAMS,aANT,EAMwB,QANxB,EAOG6D,IAPH,CAOQtE,GAAGI,OAAH,CAAWwC,KAAX,CAAiB0B,IAPzB;EAQD;;EAED,QAAItE,GAAGI,OAAH,CAAWwC,KAAX,IAAoB5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBgB,SAArC,IAAkD5D,GAAG8R,MAAzD,EAAiE;EAC/D9R,SAAG8R,MAAH,CACG1M,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,kBAFjB,EAGGA,IAHH,CAGQ,GAHR,EAGahF,GAAGM,MAHhB,EAIG0E,IAJH,CAIQ,GAJR,EAIa,EAJb,EAKGvE,KALH,CAKS,aALT,EAKwB,OALxB,EAMG6D,IANH,CAMQtE,GAAGI,OAAH,CAAWwC,KAAX,CAAiBgB,SANzB;EAOD;;EAED,QACE5D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,KAA4BN,SAA5B,IACA9B,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,CAAwBuN,cAAxB,CAAuC,SAAvC,CAFF,EAGE;EACA,UAAI3P,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAArB,EAA4B;EAC1B,YACE3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,CAAwB6I,OAAxB,KAAoC,KAApC,IACAjL,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBsH,OAAvB,KAAmC,KAFrC,EAGE;EACAjK,qBAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAAX,GAAoB,mBAA9B,EAAmDzE,MAAnD;EACAlH,wBAAA,CAAa,gBAAb,EAA+BkH,MAA/B;EACD,SAND,MAMO,IACLlI,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,CAAwB6I,OAAxB,KAAoC,KAApC,IACAjL,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBsH,OAAvB,KAAmC,IAF9B,EAGL;EACAjK,qBAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAAX,GAAoB,mBAA9B,EAAmDzE,MAAnD;EACA;EACD;EACF,OAdD,MAcO;EACL,YAAIlI,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,CAAwB6I,OAAxB,KAAoC,KAAxC,EAA+C;EAC7CjK,qBAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAAX,GAAoB,mBAA9B,EAAmDzE,MAAnD;EACAlH,wBAAA,CAAahB,GAAGI,OAAH,CAAWuM,MAAX,GAAoB,iBAAjC,EAAoDzE,MAApD;EACD;EACF;EACF;;EAED;EACA,QACElI,GAAGI,OAAH,CAAWwC,KAAX,IACA5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBwO,QADjB,IAEApR,GAAGI,OAAH,CAAWwC,KAAX,CAAiBwO,QAAjB,CAA0BnG,OAA1B,KAAsC,IAHxC,EAIE;EACA,UAAI+G,gBAAgBhR,WAAA,CACVhB,GAAGI,OAAH,CAAWuM,MADD,EAEjBvH,MAFiB,CAEV,KAFU,EAGjBJ,IAHiB,CAGZ,OAHY,EAGH,mBAHG,EAIjBI,MAJiB,CAIV,QAJU,EAKjBM,EALiB,CAKd,QALc,EAKJ,YAAY;EACxB1F,WAAGsR,UAAH,CAAc,GAAd,EAAmB,KAAKjO,KAAxB;EACD,OAPiB,CAApB;;EASA,UAAIrD,GAAGI,OAAH,CAAWwC,KAAX,CAAiBwO,QAAjB,CAA0BJ,MAA9B,EAAsC;EACpC,YAAIA,SAAShR,GAAGI,OAAH,CAAWwC,KAAX,CAAiBwO,QAAjB,CAA0BJ,MAAvC;EACAA,eAAOQ,OAAP,GAAiB,OAAjB;EACAR,eAAO7G,MAAP,GAAgB,MAAhB;EACA6G,eAAO,YAAP,IAAuB,QAAvB;EACAA,eAAO,iBAAP,IAA4B,QAA5B;;EAEAhQ,mBAAA,CAAU,2BAAV,EAAuCgQ,MAAvC,CAA8CA,MAA9C;;EAEAhQ,mBAAA,CAAU,kCAAV,EAA8CgQ,MAA9C,CAAqD;EACnD,wBAAc;EADqC,SAArD;EAGD,OAZD,MAYO;EACLhQ,mBAAA,CAAU,2BAAV,EAAuCgQ,MAAvC,CAA8C;EAC5CQ,mBAAS,OADmC;EAE5CrH,kBAAQ,MAFoC;EAG5C,wBAAc,QAH8B;EAI5C,6BAAmB;EAJyB,SAA9C;;EAOAnJ,mBAAA,CAAU,kCAAV,EAA8CgQ,MAA9C,CAAqD;EACnD,wBAAc;EADqC,SAArD;EAGD;;EAED,UAAIhR,GAAGI,OAAH,CAAWwC,KAAX,CAAiBwO,QAAjB,CAA0BM,OAA9B,EAAuC;EACrCM,sBACGhK,SADH,CACa,QADb,EAEG5G,IAFH,CAEQpB,GAAGI,OAAH,CAAWwC,KAAX,CAAiBwO,QAAjB,CAA0BM,OAFlC,EAGGtL,KAHH,GAIGhB,MAJH,CAIU,QAJV,EAKGJ,IALH,CAKQ,OALR,EAKiB,UAAUtD,CAAV,EAAa;EAC1B,iBAAOA,EAAE2B,KAAT;EACD,SAPH,EAQG2B,IARH,CAQQ,OARR,EAQiB,UAAUtD,CAAV,EAAa;EAC1B,iBAAOA,EAAE2B,KAAT;EACD,SAVH,EAWGiB,IAXH,CAWQ,UAAU5C,CAAV,EAAa;EACjB,iBAAOA,EAAEiJ,KAAT;EACD,SAbH,EAcGiG,QAdH,CAcY,UAdZ,EAcwB,UAAUlP,CAAV,EAAa;EACjC,iBAAOA,EAAEiQ,QAAT;EACD,SAhBH;EAiBD,OAlBD,MAkBO;EACLC,gBAAQC,GAAR,CAAY,8BAAZ;EACD;EACF;;EAED;;;EAGA;EACA,QAAI7R,GAAGI,OAAH,CAAWuC,KAAX,CAAiBsI,OAAjB,KAA6B,KAA7B,IAAsCjL,GAAGU,SAAH,CAAaiC,KAAb,CAAmBsI,OAA7D,EAAsE;EACpE;EACAtI,YACGqF,SADH,CACa,SADb,EAEGhD,IAFH,CAEQ,gBAFR,EAE0B,OAF1B,EAGGA,IAHH,CAGQ,cAHR,EAGwBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBG,IAAnB,CAAwB4I,WAHhD,EAIG1G,IAJH,CAIQ,QAJR,EAIkBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBG,IAAnB,CAAwB6I,WAJ1C,EAKG3G,IALH,CAKQ,SALR,EAKmBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBG,IAAnB,CAAwB8I,aAL3C;;EAOA;EACAjJ,YACGqF,SADH,CACa,aADb,EAEGhD,IAFH,CAEQ,WAFR,EAEqBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgI,KAAnB,CAAyBE,QAF9C,EAGG7F,IAHH,CAGQ,aAHR,EAGuBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgI,KAAnB,CAAyBG,UAHhD,EAIG9F,IAJH,CAIQ,MAJR,EAIgBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgI,KAAnB,CAAyBC,SAJzC,EAKG5F,IALH,CAKQ,aALR,EAKuBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgI,KAAnB,CAAyBsB,UALhD;;EAOA;EACAtJ,YACGqF,SADH,CACa,YADb,EAEGhD,IAFH,CAEQ,cAFR,EAEwBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgB,KAAnB,CAAyB+H,WAFjD,EAGG1G,IAHH,CAGQ,QAHR,EAGkBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgB,KAAnB,CAAyBgI,WAH3C,EAIG3G,IAJH,CAIQ,gBAJR,EAI0BhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgB,KAAnB,CAAyB2H,OAJnD,EAKGtG,IALH,CAKQ,OALR,EAKiBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgB,KAAnB,CAAyBsO,SAL1C;EAME;EANF,OAOGjN,IAPH,CAOQ,kBAPR,EAO4BhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgB,KAAnB,CAAyBoI,UAPrD,EAQG/G,IARH,CASI,WATJ,EAUI,gBAAgBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBG,IAAnB,CAAwB+I,WAAxC,GAAsD,MAV1D;EAYA;EACA,UAAI7L,GAAGU,SAAH,CAAaiC,KAAb,CAAmBgB,KAAnB,CAAyBmI,IAA7B,EAAmC;EACjCnJ,cACGqF,SADH,CACa,wCADb,EAEGhD,IAFH,CAEQ,QAFR,EAEkB,MAFlB;EAGD;;EAED;EACArC,YACGqF,SADH,CACa,YADb,EAEGhD,IAFH,CAEQ,WAFR,EAEqBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBqJ,MAAnB,CAA0BnB,QAF/C,EAGG7F,IAHH,CAGQ,aAHR,EAGuBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBqJ,MAAnB,CAA0BlB,UAHjD,EAIG9F,IAJH,CAIQ,MAJR,EAIgBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBqJ,MAAnB,CAA0BpB,SAJ1C,EAKG5F,IALH,CAKQ,aALR,EAKuBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBqJ,MAAnB,CAA0BC,UALjD,EAMGjH,IANH,CAOI,WAPJ,EAQI,gBAAgBhF,GAAGU,SAAH,CAAaiC,KAAb,CAAmBG,IAAnB,CAAwB+I,WAAxC,GAAsD,MAR1D;EAUD;;EAED;EACA,QAAI7L,GAAGI,OAAH,CAAWwC,KAAX,CAAiBqI,OAAjB,KAA6B,KAA7B,IAAsCjL,GAAGU,SAAH,CAAakC,KAAb,CAAmBqI,OAA7D,EAAsE;EACpE;EACAjL,SAAG8R,MAAH,CACG9J,SADH,CACa,SADb,EAEGhD,IAFH,CAEQ,gBAFR,EAE0B,OAF1B,EAGGA,IAHH,CAGQ,cAHR,EAGwBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmBE,IAAnB,CAAwB4I,WAHhD,EAIG1G,IAJH,CAIQ,QAJR,EAIkBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmBE,IAAnB,CAAwB6I,WAJ1C,EAKG3G,IALH,CAKQ,SALR,EAKmBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmBE,IAAnB,CAAwB8I,aAL3C;;EAOA;EACA5L,SAAG8R,MAAH,CACG9J,SADH,CACa,YADb,EAEGhD,IAFH,CAEQ,cAFR,EAEwBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmBe,KAAnB,CAAyB+H,WAFjD,EAGG1G,IAHH,CAGQ,QAHR,EAGkBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmBe,KAAnB,CAAyBgI,WAH3C,EAIG3G,IAJH,CAKI,WALJ,EAMI,kBAAkBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmBE,IAAnB,CAAwB+I,WAA1C,GAAwD,GAN5D;EAQA;EACA,UAAI7L,GAAGU,SAAH,CAAakC,KAAb,CAAmBe,KAAnB,CAAyBmI,IAA7B,EAAmC;EACjC9L,WAAG8R,MAAH,CACG9J,SADH,CACa,wCADb,EAEGhD,IAFH,CAEQ,QAFR,EAEkB,MAFlB;EAGD;;EAED;EACAhF,SAAG8R,MAAH,CACG9J,SADH,CACa,YADb,EAEGhD,IAFH,CAEQ,WAFR,EAEqBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmBoJ,MAAnB,CAA0BnB,QAF/C,EAGG7F,IAHH,CAGQ,aAHR,EAGuBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmBoJ,MAAnB,CAA0BlB,UAHjD,EAIG9F,IAJH,CAIQ,MAJR,EAIgBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmBoJ,MAAnB,CAA0BpB,SAJ1C,EAKG5F,IALH,CAKQ,aALR,EAKuBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmBoJ,MAAnB,CAA0BC,UALjD,EAMGjH,IANH,CAOI,WAPJ,EAQIhF,GAAGU,SAAH,CAAakC,KAAb,CAAmBoJ,MAAnB,CAA0BkG,MAA1B,GACI,4BACFlS,GAAGU,SAAH,CAAakC,KAAb,CAAmBE,IAAnB,CAAwBkJ,MAAxB,CAA+BkG,MAD7B,GAEF,GAHF,GAII,kBAAkBlS,GAAGU,SAAH,CAAakC,KAAb,CAAmBE,IAAnB,CAAwB+I,WAA1C,GAAwD,GAZhE;EAcD;;EAED,QAAMsG,oBAAoBnR,QAAA,CACxBA,WAAA,CACU,SADV,EAEGgH,SAFH,CAEa,MAFb,EAGGoK,KAHH,GAIG3Q,GAJH,CAIO;EAAA,aAAK2M,EAAE3I,qBAAF,EAAL;EAAA,KAJP,CADwB,CAA1B;EAOA,QACE,CAACzF,GAAGI,OAAH,CAAWwC,KAAZ,IACC5C,GAAGI,OAAH,CAAWwC,KAAX,IAAoB5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBqI,OAAjB,KAA6B,KAFpD,EAGE;EACA;EACA;;EAEA;;EAEA,UAAIoH,aACF,CAACrS,GAAGyD,OAAH,CAAW4E,CAAX,CAAaiK,SAAb,GACGtS,GAAGyD,OAAH,CAAW4E,CAAX,CAAaiK,SAAb,EADH,GAEG,CAACtS,GAAGI,OAAH,CAAW8J,IAAX,CAAgB7J,KAAhB,IACAL,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBC,IAAvB,GAA8BpK,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBE,KADrD,CAAD,IAEFrK,GAAGyD,OAAH,CAAW4E,CAAX,CAAa1E,KAAb,EAJF,IAI0B,CAL5B;EAMA,UAAIwO,oBAAoBE,UAAxB,EAAoC;EAClCrS,WAAGU,SAAH,CAAakC,KAAb,CAAmBoJ,MAAnB,CAA0BkG,MAA1B,GAAmC,IAAnC;EACA;EACAlS,WAAG8R,MAAH,CAAU9J,SAAV,CAAoB,MAApB,EAA4BxD,IAA5B,CAAiC,UAAU9C,CAAV,EAAa;EAAA;;EAC5C,cAAI,OAAOA,CAAP,KAAa,QAAjB,EAA2B;EACzB;EACAV,uBAAA,CAAU,IAAV,EACGgE,IADH,CACQ,aADR,EACuB,KADvB,EAEGA,IAFH,CAEQ,IAFR,EAEc,CAFd,EAGGA,IAHH,CAGQ,WAHR,EAGqB,6BAHrB;EAIA;EACA,gBACE,KAAKS,qBAAL,KACA,MAAMzF,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBI,MAF/B,EAGE;EAAA;EACAvJ,2BAAA,CAAU,MAAV,EACG0E,EADH,CACM,WADN,EACmBwL,QAAQvL,IAD3B,EAEGD,EAFH,CAEM,UAFN,EAEkBwL,QAAQtL,IAF1B;EAGA,oBAAIC,IAAI,CAAR;EACA,uBACE,OAAKJ,qBAAL,KACA,MAAMzF,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBI,MAF/B,EAGE;EACAvJ,6BAAA,CAAU,MAAV,EACGsD,IADH,CACQ,UAAU5C,CAAV,EAAa;EACjB,2BAAOA,EAAEoE,KAAF,CAAQ,CAAR,EAAW,CAACD,CAAZ,IAAiB,KAAxB;EACD,mBAHH,EAIGb,IAJH,CAIQ,OAJR,EAIiBtD,CAJjB;EAKA,oBAAEmE,CAAF;EACD;EAfD;EAgBD,aAnBD,MAmBO;EACL,qBAAOnE,CAAP;EACD;EACF;EACF,SA/BD;EAgCD;EACF;;EAED,QAAI1B,GAAGI,OAAH,CAAWwC,KAAX,CAAiBqI,OAAjB,KAA6B,KAA7B,IAAsCjL,GAAGU,SAAH,CAAakC,KAAb,CAAmBqI,OAA7D,EAAsE;EACpE;EACAjL,SAAG8R,MAAH,CACG9J,SADH,CACa,aADb,EAEGhD,IAFH,CAEQ,WAFR,EAEqBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmB+H,KAAnB,CAAyBE,QAF9C,EAGG7F,IAHH,CAGQ,aAHR,EAGuBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmB+H,KAAnB,CAAyBG,UAHhD,EAIG9F,IAJH,CAIQ,MAJR,EAIgBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmB+H,KAAnB,CAAyBC,SAJzC,EAKG5F,IALH,CAKQ,aALR,EAKuBhF,GAAGU,SAAH,CAAakC,KAAb,CAAmB+H,KAAnB,CAAyBsB,UALhD,EAMGjH,IANH,CAOI,WAPJ,EAQI,mBACChF,GAAGU,SAAH,CAAakC,KAAb,CAAmBoJ,MAAnB,CAA0BkG,MAA1B,GACGlR,QAAA,CAAO,CAAChB,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBI,MAAvB,GAAgC,GAAjC,EAAsC4H,iBAAtC,CAAP,CADH,GAEGnS,GAAGU,SAAH,CAAakC,KAAb,CAAmBE,IAAnB,CAAwB+I,WAH5B,IAIA,GAZJ;EAcD;;EAED;;;EAGA;;;;;;;;;;;;;;;;EAiBA;EACA,QACE7L,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,IACA3D,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBsH,OADvB,IAEAjL,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBlD,KAHzB,EAIE;EACA,cAAQT,GAAGI,OAAH,CAAWuC,KAAX,CAAiBgB,KAAjB,CAAuBlD,KAA/B;EACE,aAAK,cAAL;EACE;EACF,aAAK,UAAL;EACEO,wBAAA,CAAa,qBAAb,EAAoCgE,IAApC,CAAyC,kBAAzC,EAA6D,MAA7D;EACA;EALJ;EAOD;EACD;EACA,QACEhF,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,IACApC,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,CAAwB6I,OADxB,IAEAjL,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,CAAwBmQ,MAH1B,EAIE;EACAvR,iBAAA,CAAU,kBAAV,EAA8BgE,IAA9B,CACE,QADF,EAEEhF,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,CAAwBmQ,MAF1B;EAID;;EAED;EACA,QACEvS,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,IACApC,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,CAAwB6I,OADxB,IAEAjL,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,CAAwB,cAAxB,CAHF,EAIE;EACApB,iBAAA,CAAU,kBAAV,EAA8BgE,IAA9B,CACE,cADF,EAEEhF,GAAGI,OAAH,CAAWuC,KAAX,CAAiBP,MAAjB,CAAwB,cAAxB,CAFF;EAID;;EAED;;EAEA;;EAEA;;EAEA,QACE,CAACpC,GAAGI,OAAH,CAAWwC,KAAZ,IACC5C,GAAGI,OAAH,CAAWwC,KAAX,IAAoB5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBqI,OAAjB,KAA6B,KAFpD,EAGE;EACA;EACA,UAAIjL,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,IAA0B3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBlD,KAArD,EAA4D;EAC1DoM,eAAO2F,IAAP,CAAYxS,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBlD,KAAnC,EAA0C0O,OAA1C,CAAkD,UAAUsD,CAAV,EAAa;EAC7DzS,aAAG8R,MAAH,CAAU9J,SAAV,CAAoB,MAApB,EAA4BvH,KAA5B,CAAkCgS,CAAlC,EAAqCzS,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBlD,KAAvB,CAA6BgS,CAA7B,CAArC;EACD,SAFD;EAGD;;EAED;EACA,UAAIzS,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,IAA0B3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBuO,MAArD,EAA6D;EAC3DlS,WAAG8R,MAAH,CACG9J,SADH,CACa,MADb,EAEGhD,IAFH,CAEQ,aAFR,EAEuB,KAFvB,EAGGA,IAHH,CAGQ,WAHR,EAGqB,YAAYhF,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBuO,MAAnC,GAA4C,GAHjE;EAID;;EAED;EACA,UACElS,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,IACA3D,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBsH,OADvB,IAEAjL,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBlD,KAHzB,EAIE;EACA,gBAAQT,GAAGI,OAAH,CAAWwC,KAAX,CAAiBe,KAAjB,CAAuBlD,KAA/B;EACE,eAAK,cAAL;EACE;EACF,eAAK,UAAL;EACEO,0BAAA,CAAahB,GAAGI,OAAH,CAAWuM,MAAX,GAAoB,sBAAjC,EAAyD3H,IAAzD,CACE,kBADF,EAEE,MAFF;EAIA;EARJ;EAUD;EACF;;EAED;EACA,QACEhF,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,IACApC,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,CAAwB6I,OADxB,IAEAjL,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,CAAwBmQ,MAH1B,EAIE;EACAvR,iBAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAAX,GAAoB,mBAA9B,EAAmD3H,IAAnD,CACE,QADF,EAEEhF,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,CAAwBmQ,MAF1B;EAID;;EAED;EACA,QACEvS,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,IACApC,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,CAAwB6I,OADxB,IAEAjL,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,CAAwB,cAAxB,CAHF,EAIE;EACApB,iBAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAAX,GAAoB,mBAA9B,EAAmD3H,IAAnD,CACE,cADF,EAEEhF,GAAGI,OAAH,CAAWwC,KAAX,CAAiBR,MAAjB,CAAwB,cAAxB,CAFF;EAID;EACF,GA1pBD;;EA4pBAqH,QAAM6H,UAAN,GAAmB,UAAUxO,IAAV,EAAgBO,KAAhB,EAAuB;EACxC,QAAIrD,KAAK,IAAT;;EAEA,QAAI8C,SAAS,GAAb,EAAkB;EAChB9C,SAAGI,OAAH,CAAWwC,KAAX,CAAiBwO,QAAjB,CAA0BM,OAA1B,CAAkCjQ,GAAlC,CAAsC,eAAO;EAC3C,YAAIiR,IAAIrP,KAAJ,KAAcA,KAAlB,EAAyB;EACvBqP,cAAIf,QAAJ,GAAe,IAAf;EACD,SAFD,MAEO;EACLe,cAAIf,QAAJ,GAAe,KAAf;EACD;EACF,OAND;EAOD,KARD,MAQO,IAAI7O,SAAS,GAAb,EAAkB;EACvB9C,SAAGI,OAAH,CAAWuC,KAAX,CAAiByO,QAAjB,CAA0BM,OAA1B,CAAkCjQ,GAAlC,CAAsC,eAAO;EAC3C,YAAIiR,IAAIrP,KAAJ,KAAcA,KAAlB,EAAyB;EACvBqP,cAAIf,QAAJ,GAAe,IAAf;EACD,SAFD,MAEO;EACLe,cAAIf,QAAJ,GAAe,KAAf;EACD;EACF,OAND;EAOD;;EAED3R,OAAGI,OAAH,CAAW0C,IAAX,IAAmBO,KAAnB;;EAEA,QAAI2J,QAAQhN,GAAGsM,MAAH,CAAU,CAAV,CAAZ;;EAEAU,UAAM5M,OAAN,GAAgBJ,GAAGI,OAAnB;;EAEAJ,OAAGoN,IAAH;;EAEA;EACA,QAAIpN,GAAGI,OAAH,CAAWmI,MAAX,IAAqBvI,GAAGI,OAAH,CAAWmI,MAAX,CAAkBoK,MAA3C,EAAmD;EACjD3S,SAAGiO,QAAH,CAAYvI,EAAZ,CAAe,aAAf,EAA8B1F,GAAGI,OAAH,CAAWmI,MAAX,CAAkBoK,MAAlB,CAAyB3S,EAAzB,CAA9B;EACD;EACF,GAjCD;;EAmCAyJ,QAAMwE,QAAN,GAAiBjN,aAAA,CAAY,MAAZ,EAAoB,QAApB,CAAjB;;EAEAyI,QAAMuF,OAAN,GAAgB,UAAU5N,IAAV,EAAgBwR,QAAhB,EAA0B;EACxCA,aAAS,IAAT,EAAexR,IAAf;EACD,GAFD;;EAIAqI,QAAMoJ,UAAN,GAAmB,UAAUzR,IAAV,EAAgB;EACjC,QAAIpB,KAAK,IAAT;;EAEA,QAAIsB,UAAU,EAAd;EACA,QAAIwR,SAAS,EAAb;EACA,QAAIC,SAAS,EAAb;;EAEA;EACA,QAAIC,gBAAgB,uBAAUhN,CAAV,EAAaC,CAAb,EAAgB;EAClC,aAAOjG,GAAGe,KAAH,CAASgF,aAAT,CAAuBC,EAAEjB,CAAzB,EAA4BkB,EAAElB,CAA9B,CAAP;EACD,KAFD;EAGA,QAAIkO,gBAAgB,uBAAUjN,CAAV,EAAaC,CAAb,EAAgB;EAClC,aAAOjG,GAAGe,KAAH,CAASgF,aAAT,CAAuBC,EAAEqC,CAAzB,EAA4BpC,EAAEoC,CAA9B,CAAP;EACD,KAFD;;EAIA;EACA,QAAIrI,GAAGI,OAAH,CAAWgB,IAAX,CAAgB8R,IAAhB,IAAwBlT,GAAGI,OAAH,CAAWgB,IAAX,CAAgB8R,IAAhB,CAAqBxK,KAAjD,EAAwD;EACtD,cAAQ1I,GAAGI,OAAH,CAAWgB,IAAX,CAAgB8R,IAAhB,CAAqBxK,KAA7B;EACE,aAAK,KAAL;EACEsK,0BAAgB,uBAAUhN,CAAV,EAAaC,CAAb,EAAgB;EAC9B,mBAAOjG,GAAGe,KAAH,CAASgF,aAAT,CAAuBC,EAAEjB,CAAzB,EAA4BkB,EAAElB,CAA9B,CAAP;EACD,WAFD;EAGAkO,0BAAgB,uBAAUjN,CAAV,EAAaC,CAAb,EAAgB;EAC9B,mBAAOjG,GAAGe,KAAH,CAASgF,aAAT,CAAuBC,EAAEqC,CAAzB,EAA4BpC,EAAEoC,CAA9B,CAAP;EACD,WAFD;EAGA;;EAEF,aAAK,MAAL;EACE2K,0BAAgB,uBAAUhN,CAAV,EAAaC,CAAb,EAAgB;EAC9B,mBAAOjG,GAAGe,KAAH,CAASmF,cAAT,CAAwBF,EAAEjB,CAA1B,EAA6BkB,EAAElB,CAA/B,CAAP;EACD,WAFD;EAGAkO,0BAAgB,uBAAUjN,CAAV,EAAaC,CAAb,EAAgB;EAC9B,mBAAOjG,GAAGe,KAAH,CAASmF,cAAT,CAAwBF,EAAEqC,CAA1B,EAA6BpC,EAAEoC,CAA/B,CAAP;EACD,WAFD;EAGA;EAjBJ;EAmBD;;EAED;EACA,QAAIrI,GAAGI,OAAH,CAAWwC,KAAX,IAAoB5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAAzC,EAAgD;EAC9C,cAAQrB,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAAzB;EACE,aAAK,QAAL;EACEyR,mBAAS9R,WAAA,CAAUI,IAAV,EAAgB,UAAUM,CAAV,EAAa;EACpC,mBAAOA,EAAE2G,CAAT;EACD,WAFQ,CAAT;EAGA/G,kBAAQ+G,CAAR,GAAYyK,MAAZ;EACA;;EAEF,aAAK,MAAL;EACEA,mBAAS9R,WAAA,CAAUI,IAAV,EAAgB,UAAUM,CAAV,EAAa;EACpC,mBAAOA,EAAE2G,CAAT;EACD,WAFQ,CAAT;EAGA/G,kBAAQ+G,CAAR,GAAYyK,MAAZ;EACA;;EAEF,aAAK,SAAL;EACE;EACA,cAAI9S,GAAGI,OAAH,CAAWgB,IAAX,CAAgB8R,IAAhB,IAAwBlT,GAAGI,OAAH,CAAWgB,IAAX,CAAgB8R,IAAhB,CAAqBpQ,IAArB,KAA8B,GAA1D,EAA+D;EAC7DiQ,qBAAS3R,KAAK8R,IAAL,CAAUF,aAAV,CAAT;EACD,WAFD,MAEO;EACLD,qBAAS3R,KAAK8R,IAAL,CAAUD,aAAV,CAAT;EACD;;EAED3R,kBAAQ+G,CAAR,GAAY,EAAZ;EACA0K,iBAAO5D,OAAP,CAAe,UAAUzN,CAAV,EAAa;EAC1BJ,oBAAQ+G,CAAR,CAAU/C,IAAV,CAAe5D,EAAE2G,CAAjB;EACD,WAFD;;EAIA;;EAEF,aAAK,UAAL;EACE;EACA,cAAIrI,GAAGI,OAAH,CAAWgB,IAAX,CAAgB8R,IAAhB,IAAwBlT,GAAGI,OAAH,CAAWgB,IAAX,CAAgB8R,IAAhB,CAAqBpQ,IAArB,KAA8B,GAA1D,EAA+D;EAC7DiQ,qBAAS3R,KAAK8R,IAAL,CAAUF,aAAV,CAAT;EACD,WAFD,MAEO;EACLD,qBAAS3R,KAAK8R,IAAL,CAAUD,aAAV,CAAT;EACD;;EAED3R,kBAAQ+L,CAAR,GAAY,EAAZ;EACA0F,iBAAO5D,OAAP,CAAe,UAAUzN,CAAV,EAAa;EAC1BJ,oBAAQ+L,CAAR,CAAU/H,IAAV,CAAe5D,EAAE2G,CAAjB;EACD,WAFD;;EAIA/G,kBAAQ+G,CAAR,GAAYrH,UAAA,CAAShB,GAAGI,OAAH,CAAWwC,KAAX,CAAiBuL,OAA1B,CAAZ;;EAEA;;EAEF;EACE2E,mBAAS9R,WAAA,CAAUI,IAAV,EAAgB,UAAUM,CAAV,EAAa;EACpC,mBAAOA,EAAE2G,CAAT;EACD,WAFQ,CAAT;EAGA/G,kBAAQ+G,CAAR,GAAYyK,MAAZ;EACA;EApDJ;EAsDD,KAvDD,MAuDO;EACLA,eAAS9R,WAAA,CAAUI,IAAV,EAAgB,UAAUM,CAAV,EAAa;EACpC,eAAOA,EAAE2G,CAAT;EACD,OAFQ,CAAT;EAGA/G,cAAQ+G,CAAR,GAAYyK,MAAZ;EACD;;EAED;EACA,QAAI9S,GAAGI,OAAH,CAAWuC,KAAX,IAAoB3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAzC,EAAgD;EAC9C,cAAQrB,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAzB;EACE,aAAK,QAAL;EACEyR,mBAAS9R,WAAA,CAAUI,IAAV,EAAgB,UAAUM,CAAV,EAAa;EACpC,mBAAOA,EAAEqD,CAAT;EACD,WAFQ,CAAT;;EAIA;EACA;EACA,cAAI+N,OAAO,CAAP,IAAY,CAAhB,EAAmB;EACjBA,mBAAO,CAAP,IAAYA,OAAO,CAAP,IAAY,CAACA,OAAO,CAAP,IAAYA,OAAO,CAAP,CAAb,IAA0B,GAAlD;EACD;EACDxR,kBAAQyD,CAAR,GAAY+N,MAAZ;EACA;;EAEF,aAAK,MAAL;EACEA,mBAAS9R,WAAA,CAAUI,IAAV,EAAgB,UAAUM,CAAV,EAAa;EACpC,mBAAOA,EAAEqD,CAAT;EACD,WAFQ,CAAT;EAGAzD,kBAAQyD,CAAR,GAAY+N,MAAZ;EACA;;EAEF,aAAK,SAAL;EACE,cAAI9S,GAAGI,OAAH,CAAWgB,IAAX,CAAgB8R,IAAhB,IAAwBlT,GAAGI,OAAH,CAAWgB,IAAX,CAAgB8R,IAAhB,CAAqBpQ,IAArB,KAA8B,GAA1D,EAA+D;EAC7DiQ,qBAAS3R,KAAK8R,IAAL,CAAU,UAAUlN,CAAV,EAAaC,CAAb,EAAgB;EACjC,qBAAOjG,GAAGe,KAAH,CAASgF,aAAT,CAAuBC,EAAEjB,CAAzB,EAA4BkB,EAAElB,CAA9B,CAAP;EACD,aAFQ,CAAT;EAGAzD,oBAAQyD,CAAR,GAAY,EAAZ;EACAgO,mBAAO5D,OAAP,CAAe,UAAUzN,CAAV,EAAa;EAC1BJ,sBAAQyD,CAAR,CAAUO,IAAV,CAAe5D,EAAE2G,CAAjB;EACD,aAFD;EAGD,WARD,MAQO;EACL/G,oBAAQyD,CAAR,GAAY/D,QAAA,CACLI,IADK,EACC,UAAUM,CAAV,EAAa;EACtB,qBAAOA,EAAEqD,CAAT;EACD,aAHS,EAITyN,IAJS,GAKTU,IALS,CAKJ,UAAUlN,CAAV,EAAaC,CAAb,EAAgB;EACpB,qBAAOjG,GAAGe,KAAH,CAASgF,aAAT,CAAuBC,CAAvB,EAA0BC,CAA1B,CAAP;EACD,aAPS,CAAZ;EAQD;;EAED;;EAEF;EACE6M,mBAAS9R,WAAA,CAAUI,IAAV,EAAgB,UAAUM,CAAV,EAAa;EACpC,mBAAOA,EAAEqD,CAAT;EACD,WAFQ,CAAT;EAGAzD,kBAAQyD,CAAR,GAAY+N,MAAZ;EACA;EAhDJ;EAkDD,KAnDD,MAmDO;EACLA,eAAS9R,WAAA,CAAUI,IAAV,EAAgB,UAAUM,CAAV,EAAa;EACpC,eAAOA,EAAEqD,CAAT;EACD,OAFQ,CAAT;EAGAzD,cAAQyD,CAAR,GAAY+N,MAAZ;EACD;;EAED,WAAOxR,OAAP;EACD,GAjKD;;EAmKAmI,QAAM0J,OAAN,GAAgB,YAAY;EAC1B,QAAInT,KAAK,IAAT;EACAgB,eAAA,CAAUhB,GAAGI,OAAH,CAAWuM,MAArB,EAA6B2C,IAA7B,CAAkC,EAAlC;EACD,GAHD;;EAKA7F,QAAMO,IAAN,CAAW7J,MAAX;;EAEA,SAAOsJ,KAAP;EACD;;EC/iED;;;AAGA,EAAe,eAAStJ,MAAT,EAAiB;;EAE9B,WAASiT,IAAT,CAAcjT,MAAd,EAAsB;EACpB,QAAIH,KAAK,IAAT;EACAA,OAAGI,OAAH,GAAaD,SAASA,MAAT,GAAkB,EAA/B;EACAH,OAAGkM,KAAH,GAAW,EAAX;EACAlM,OAAGI,OAAH,CAAWiT,UAAX,GAAwBrS,GAAGsS,iBAA3B;EACAtT,OAAGI,OAAH,CAAWmT,OAAX,GAAqB,UAAS7R,CAAT,EAAW;EAC9B,UAAGA,IAAI,CAAJ,IAAS,CAAZ,EAAc;EACZ,eAAOV,GAAGwB,MAAH,CAAU,MAAV,EAAkBd,CAAlB,CAAP;EACD,OAFD,MAEO,IAAGA,IAAI,CAAJ,IAASA,IAAI,CAAhB,EAAmB;EACxB,eAAOV,GAAGwB,MAAH,CAAU,MAAV,EAAkBd,CAAlB,CAAP;EACD,OAFM,MAEA;EACL,eAAOV,GAAGwB,MAAH,CAAU,MAAV,EAAkBd,CAAlB,CAAP;EACD;EACF,KARD;EASA1B,OAAGyD,OAAH,GAAa,EAAb;EACAzD,OAAGqM,KAAH,GAAW,EAAX;EACA;EACArM,OAAGwT,IAAH,GAAUxS,GAAGC,GAAH,GACP+D,IADO,CACF,OADE,EACO,oBADP,EAEPyO,SAFO,CAEG,GAFH,EAGPnE,IAHO,CAGFtP,GAAGI,OAAH,CAAWa,GAAX,IAAkB,UAASS,CAAT,EAAW;EAAE,aAAO1B,GAAGI,OAAH,CAAWmT,OAAX,CAAmB7R,EAAE1B,GAAGI,OAAH,CAAW2E,CAAb,CAAnB,CAAP;EAA2C,KAHxE,CAAV;EAID;;EAED;EACA;EACAqO,OAAKM,SAAL,CAAerL,CAAf,GAAmB,UAASsL,UAAT,EAAqB;EACtC,QAAI3T,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWiI,CAAX,GAAesL,UAAf;EACA,WAAO3T,EAAP;EACD,GAJD;;EAMAoT,OAAKM,SAAL,CAAe3O,CAAf,GAAmB,UAAS4O,UAAT,EAAqB;EACtC,QAAI3T,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW2E,CAAX,GAAe4O,UAAf;EACA,WAAO3T,EAAP;EACD,GAJD;;EAMAoT,OAAKM,SAAL,CAAehJ,KAAf,GAAuB,UAASiJ,UAAT,EAAqB;EAC1C,QAAI3T,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWsK,KAAX,GAAmBiJ,UAAnB;EACA,WAAO3T,EAAP;EACD,GAJD;;EAMAoT,OAAKM,SAAL,CAAeE,GAAf,GAAqB,YAAW;EAC9B,QAAI5T,KAAK,IAAT;EACA,WAAOA,GAAG6T,MAAV;EACD,GAHD;;EAKAT,OAAKM,SAAL,CAAeL,UAAf,GAA4B,UAASA,UAAT,EAAqB;EAC/C,QAAIrT,KAAK,IAAT;EACA,QAAGiC,MAAMC,OAAN,CAAcmR,UAAd,CAAH,EAA8B;EAC5BrT,SAAGI,OAAH,CAAWiT,UAAX,GAAwBA,UAAxB;EACD,KAFD,MAEO;EACLrT,SAAGyD,OAAH,CAAWiH,KAAX,GAAmB2I,UAAnB;EACArT,SAAGI,OAAH,CAAWiT,UAAX,GAAwBA,WAAW9R,KAAX,EAAxB;EACD;EACD,WAAOvB,EAAP;EACD,GATD;;EAWAoT,OAAKM,SAAL,CAAelR,MAAf,GAAwB,UAASA,MAAT,EAAiB;EACvC,QAAIxC,KAAK,IAAT;EACA,QAAI,OAAOwC,MAAP,IAAiB,UAAjB,IAA+BA,kBAAkBsR,QAArD,EACE9T,GAAGI,OAAH,CAAWmT,OAAX,GAAqB/Q,MAArB,CADF,KAGExC,GAAGI,OAAH,CAAWmT,OAAX,GAAqBvS,GAAGwB,MAAH,CAAUA,MAAV,CAArB;EACF,WAAOxC,EAAP;EACD,GAPD;;EASA;EACA;EACAoT,OAAKM,SAAL,CAAexT,KAAf,GAAuB,UAASA,KAAT,EAAgB;EACrC,QAAIF,KAAK,IAAT;EACAA,OAAG6T,MAAH,GAAY3T,KAAZ;EACA,WAAOF,EAAP;EACD,GAJD;;EAMAoT,OAAKM,SAAL,CAAetS,IAAf,GAAsB,UAASA,IAAT,EAAe;EACnC,QAAIpB,KAAK,IAAT;EACAA,OAAGkM,KAAH,GAAW9K,KAAKK,GAAL,CAAS,UAASC,CAAT,EAAY;EAC9B,UAAGA,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,KAAmBpF,OAAOvB,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,CAAP,CAAtB,EACE3G,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,IAAkB,CAAC3G,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,CAAnB;EACF,UAAG3G,EAAE1B,GAAGI,OAAH,CAAW2E,CAAb,KAAmB9B,OAAOvB,EAAE1B,GAAGI,OAAH,CAAW2E,CAAb,CAAP,CAAtB,EACErD,EAAE1B,GAAGI,OAAH,CAAW2E,CAAb,IAAkB,CAACrD,EAAE1B,GAAGI,OAAH,CAAW2E,CAAb,CAAnB;EACF,aAAOrD,CAAP;EACD,KANU,CAAX;EAOA,WAAO1B,EAAP;EACD,GAVD;;EAYAoT,OAAKM,SAAL,CAAepG,MAAf,GAAwB,UAASyG,CAAT,EAAY;EAClC,QAAI/T,KAAK,IAAT;EACA;EACA;;;;;;;EAOA;EACA,QAAIG,SAAS;EACTwB,cAAQ3B,GAAGI,OAAH,CAAWiI,CADV;EAETtG,YAAM/B,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAFd;EAGTE,aAAO,CAAC,CAAD,EAAIvB,GAAG6T,MAAH,CAAUvT,MAAd,CAHE;EAIT0B,eAAS;EAJA,KAAb;EAMAhC,OAAGyD,OAAH,CAAW4E,CAAX,GAAerI,GAAG6T,MAAH,CAAU1S,aAAV,CAAwBnB,GAAGkM,KAA3B,EAAkC/L,MAAlC,CAAf;;EAEA;EACAA,aAAS;EACLwB,cAAQ3B,GAAGI,OAAH,CAAW2E,CADd;EAELhD,YAAM/B,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAFlB;EAGLE,aAAO,CAACvB,GAAG6T,MAAH,CAAUrT,OAAX,EAAoB,CAApB,CAHF;EAILwB,eAAS;EAJJ,KAAT;EAMAhC,OAAGyD,OAAH,CAAWsB,CAAX,GAAe/E,GAAG6T,MAAH,CAAU1S,aAAV,CAAwBnB,GAAGkM,KAA3B,EAAkC/L,MAAlC,CAAf;EACAH,OAAG6T,MAAH,CAAUpQ,OAAV,CAAkB4E,CAAlB,GAAsBrI,GAAGyD,OAAH,CAAW4E,CAAjC;EACArI,OAAG6T,MAAH,CAAUpQ,OAAV,CAAkBsB,CAAlB,GAAsB/E,GAAGyD,OAAH,CAAWsB,CAAjC;;EAEA,QAAG,CAAC/E,GAAGyD,OAAH,CAAWiH,KAAf,EACE1K,GAAGyD,OAAH,CAAWiH,KAAX,GAAmB1J,GAAGgT,YAAH,CAAgBhU,GAAGI,OAAH,CAAWiT,UAA3B,CAAnB;EACF,WAAOrT,EAAP;EACD,GAjCD;;EAmCAoT,OAAKM,SAAL,CAAe7F,IAAf,GAAsB,UAAS7H,CAAT,EAAY;EAChC,QAAIhG,KAAK,IAAT;EACAA,OAAGqM,KAAH,GAAWrG,CAAX;EACA,WAAOhG,EAAP;EACD,GAJD;;EAMAoT,OAAKM,SAAL,CAAepS,OAAf,GAAyB,YAAW;EAClC,QAAItB,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAoT,OAAKM,SAAL,CAAetG,IAAf,GAAsB,YAAW;EAC/B,QAAIpN,KAAK,IAAT;EACAA,OAAG6T,MAAH,CAAU/S,IAAV,CAAemH,IAAf,CAAoBjI,GAAGwT,IAAvB;;EAEA;;;;;;;;;;;EAWA;;;;;;;;;;;;;;;;;;;;;;;;;;;;EA4BAxT,OAAG6T,MAAH,CAAU/S,IAAV,CAAekH,SAAf,CAAyB,MAAzB,EACK5G,IADL,CACUpB,GAAGkM,KADb,EAEK9F,KAFL,GAEahB,MAFb,CAEoB,MAFpB,EAGOJ,IAHP,CAGY,OAHZ,EAGqB,KAHrB,EAIOA,IAJP,CAIY,GAJZ,EAIiB,UAAStD,CAAT,EAAY;EAAE,aAAO1B,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAAjB,IAA0B,QAA1B,IAAsCrB,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAjB,IAA0B,QAAhE,GAA0E,CAA1E,GAA8ErB,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,CAAb,CAArF;EAAqH,KAJpJ,EAKOrD,IALP,CAKY,GALZ,EAKiB,UAAStD,CAAT,EAAY;EAAE,aAAO1B,GAAGyD,OAAH,CAAWsB,CAAX,CAAarD,EAAE1B,GAAGI,OAAH,CAAW2E,CAAb,CAAb,CAAP;EAAsC,KALrE,EAMOC,IANP,CAMY,OANZ,EAMqB,UAAStD,CAAT,EAAW;EAAE,aAAO1B,GAAGyD,OAAH,CAAW4E,CAAX,CAAaiK,SAAb,GAAyBtS,GAAGyD,OAAH,CAAW4E,CAAX,CAAaiK,SAAb,EAAzB,GAAoDtS,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,CAAb,CAA3D;EAA0F,KAN5H,EAOOrD,IAPP,CAOY,QAPZ,EAOsB,UAAStD,CAAT,EAAY;EAAE,aAAO1B,GAAG6T,MAAH,CAAUrT,OAAV,GAAoBR,GAAGyD,OAAH,CAAWsB,CAAX,CAAarD,EAAE1B,GAAGI,OAAH,CAAW2E,CAAb,CAAb,CAA3B;EAA2D,KAP/F,EAQOC,IARP,CAQY,MARZ,EAQoB,UAAStD,CAAT,EAAW;EAAE,aAAO1B,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBhJ,EAAE1B,GAAGI,OAAH,CAAWsK,KAAb,CAAjB,CAAP;EAA6C,KAR9E,EASOjK,KATP,CASa,SATb,EASwB,GATxB,EAUOiF,EAVP,CAUU,WAVV,EAUuB,UAAShE,CAAT,EAAY;EAC3B1B,SAAGwT,IAAH,CAAQ7N,IAAR,CAAajE,CAAb,EAAgBV,GAAGqO,MAAH,CAAU,IAAV,EAAgB7J,IAAhB,EAAhB;EACD,KAZP,EAaOE,EAbP,CAaU,UAbV,EAasB,YAAW;EACzB1F,SAAGwT,IAAH,CAAQ5N,IAAR;EACD,KAfP,EAgBOF,EAhBP,CAgBU,OAhBV,EAgBmB,YAAW,EAhB9B;EAmBA,WAAO1F,EAAP;EACD,GA/DD;;EAiEA,SAAO,IAAIoT,IAAJ,CAASjT,MAAT,CAAP;EACD;;;;;;;;EC5MD;;;;;EAMA;;;;;;;;;;;;;;;AAeA,EAAe,SAAS8T,eAAT,CAAyBC,QAAzB,EAAmC;EAC9C,QAAIhU,QAAQ,EAAZ;;EAEA;EACAA,UAAMgU,QAAN,GAAiB;EACf9S,cAAM,IADS;EAEf+S,YAAI,IAFW;EAGfC,gBAAQ,IAHO;EAIf7L,gBAAQ,IAJO;EAKf8L,eAAO,IALQ;EAMfC,eAAM,IANS;EAOfC,eAAO,IAPQ;EAQf3H,kBAAU,IARK;EASf4H,oBAAY,IATG;EAUfC,gBAAQ,CAVO;EAWfpT,eAAO,QAXQ;EAYfqT,mBAAW,EAACrU,OAAO,GAAR,EAAaE,QAAQ,GAArB,EAZI;EAaf4J,gBAAQ,EAACG,KAAK,EAAN,EAAUD,OAAO,EAAjB,EAAqBE,QAAQ,EAA7B,EAAiCH,MAAM,EAAvC,EAbO;EAcfuK,2BAAmB,KAdJ;EAefjK,eAAO1J,iBAAA,CAAgBA,qBAAhB;EAfQ,KAAjB;EAiBA,SAAK,IAAI4T,OAAT,IAAoBV,QAApB,EAA8B;EAC5BhU,cAAMgU,QAAN,CAAeU,OAAf,IAA0BV,SAASU,OAAT,CAA1B;EACD;;EAGD,aAASC,aAAT,CAAuBnT,CAAvB,EAA0B;EACxB,YAAIA,IAAI,CAAJ,KAAU,CAAd,EAAiB;EACf,mBAAOV,WAAA,CAAU,MAAV,EAAkBU,CAAlB,CAAP;EACD,SAFD,MAEO;EACL,mBAAOV,WAAA,CAAU,MAAV,EAAkBU,CAAlB,CAAP;EACD;EACF;EACD,aAASoT,YAAT,CAAsBpT,CAAtB,EAAyB;EACvB,YAAI2B,QAAQ,EAAZ;EACE,YAAI3B,IAAI,CAAJ,IAAS,CAAb,EAAgB;EAChB2B,oBAAQrC,WAAA,CAAU,MAAV,EAAkBU,CAAlB,CAAR;EACC,SAFD,MAEO,IAAIA,IAAI,CAAJ,IAASA,IAAI,CAAjB,EAAoB;EAC3B2B,oBAAQrC,WAAA,CAAU,MAAV,EAAkBU,CAAlB,CAAR;EACC,SAFM,MAEA;EACP2B,oBAAQrC,WAAA,CAAU,MAAV,EAAkBU,CAAlB,CAAR;EACC;EACD,eAAO2B,KAAP;EACH;;EAED,aAAS0R,WAAT,CAAqBrT,CAArB,EAAwB;EACpB,YAAIH,QAAQG,EAAEqC,KAAF,CAAQ,KAAR,CAAZ;EACA,YAAIV,QAAQ,EAAZ;EACA,aAAI,IAAIwC,IAAI,CAAZ,EAAeA,IAAItE,MAAM2C,MAAzB,EAAiC2B,GAAjC,EAAqC;EACnC,gBAAItE,MAAMsE,CAAN,IAAW,CAAX,IAAgB,CAApB,EAAuB;EACrBxC,yBAASrC,WAAA,CAAU,MAAV,EAAkBO,MAAMsE,CAAN,CAAlB,CAAT;EACD,aAFD,MAEO,IAAItE,MAAMsE,CAAN,IAAW,CAAX,IAAgBtE,MAAMsE,CAAN,IAAW,CAA/B,EAAkC;EACvCxC,yBAASrC,WAAA,CAAU,MAAV,EAAkBO,MAAMsE,CAAN,CAAlB,CAAT;EACD,aAFM,MAEA;EACLxC,yBAASrC,WAAA,CAAU,MAAV,EAAkBO,MAAMsE,CAAN,CAAlB,CAAT;EACD;EACD,gBAAIA,MAAM,CAAV,EAAa;EACXxC,yBAAS,KAAT;EACD;EACF;EACD,eAAOA,KAAP;EACD;;EAEH,aAAS2R,eAAT,CAAyBtT,CAAzB,EAA4B;EAC1B,YAAI2G,IAAIf,KAAKuK,GAAL,CAASnQ,CAAT,IAAc4F,KAAKuK,GAAL,CAAS,EAAT,CAAd,GAA6B,IAArC;EACA,eAAOvK,KAAKyK,GAAL,CAAS1J,IAAIf,KAAK2N,KAAL,CAAW5M,CAAX,CAAb,IAA8B,GAA9B,GAAoCwM,cAAcnT,CAAd,CAApC,GAAuD,EAA9D;EACD;;EAEDxB,UAAMgV,UAAN,GAAmBJ,YAAnB;EACA5U,UAAMiV,UAAN,GAAmBJ,WAAnB;;EAEA7U,UAAMkB,IAAN,GAAalB,MAAMgU,QAAN,CAAe9S,IAA5B;;EAEAlB,UAAMkV,SAAN,GAAkB,EAAlB,CAzE8C;EA0E9ClV,UAAMmV,IAAN,GAAa,EAACC,SAAS,IAAV,EAAgBC,UAAU,IAA1B,EAAgCC,GAAG,IAAnC,EAAyC5S,OAAO,IAAhD,EAAsDD,OAAO,IAA7D,EAAb;EACAzC,UAAMuV,UAAN,GAAmB,IAAnB;;EAEA;;;;;EAKA,aAASC,aAAT,CAAuBC,YAAvB,EAAqC;EACjC,YAAI,OAAOA,YAAP,IAAuB,UAA3B,EAAuC;EACnC,mBAAOA,YAAP;EACH,SAFD,MAEO,IAAI1T,MAAMC,OAAN,CAAcyT,YAAd,CAAJ,EAAiC;EACpC;EACA,gBAAIC,WAAW,EAAf;EACA;;;;;;EAMA,gBAAI3T,MAAMC,OAAN,CAAchC,MAAMgU,QAAN,CAAeI,KAA7B,CAAJ,EAAwC;EACpCpU,sBAAMgU,QAAN,CAAeI,KAAf,CAAqBnF,OAArB,CAA6B,UAAS0G,GAAT,EAAc5R,KAAd,EAAoB;EAC7C2R,6BAASC,GAAT,IAAgBF,aAAa1R,KAAb,CAAhB;EACH,iBAFD;EAGH,aAJD,MAIK;EACD4I,uBAAO2F,IAAP,CAAYtS,MAAMkV,SAAlB,EAA6BlC,IAA7B,CAAkClS,cAAlC,EAAgDmO,OAAhD,CAAwD,UAAS0G,GAAT,EAAc5R,KAAd,EAAoB;EACxE2R,6BAASC,GAAT,IAAgBF,aAAa1R,KAAb,CAAhB;EACH,iBAFD;EAGH;EACD,mBAAO,UAAU6R,KAAV,EAAiB;EACpB,uBAAOF,SAASE,KAAT,CAAP;EACH,aAFD;EAGH,SArBM,MAqBA,IAAI,QAAOH,YAAP,yCAAOA,YAAP,MAAuB,QAA3B,EAAqC;EACxC;EACA,mBAAO,UAAUG,KAAV,EAAiB;EACpB,uBAAOH,aAAaG,KAAb,CAAP;EACH,aAFD;EAGH,SALM,MAKA;EACH,mBAAO9U,iBAAA,CAAgBA,qBAAhB,CAAP;EACH;EACJ;;EAED;;;;;;EAMA,aAAS+U,WAAT,CAAqBC,QAArB,EAA+BC,KAA/B,EAAsC;EAClC,YAAIC,UAAU,EAAC9L,MAAM,IAAP,EAAaC,OAAO,IAApB,EAA0B8L,QAAQ,IAAlC,EAAd;EACA,YAAI9V,QAAQH,MAAMkW,MAAN,CAAa9D,SAAb,MAA4B0D,WAAW,GAAvC,CAAZ;EACA,YAAI1T,UAAU,CAACpC,MAAMkW,MAAN,CAAa9D,SAAb,KAA2BjS,KAA5B,IAAqC,CAAnD;EACA,YAAIgW,SAASnW,MAAMkW,MAAN,CAAaH,KAAb,CAAb;EACAC,gBAAQC,MAAR,GAAiBjW,MAAMkW,MAAN,CAAa9D,SAAb,KAA2B,CAA3B,GAA+B+D,MAAhD;EACAH,gBAAQ9L,IAAR,GAAe9H,UAAU+T,MAAzB;EACAH,gBAAQ7L,KAAR,GAAgB6L,QAAQ9L,IAAR,GAAe/J,KAA/B;EACA,eAAO6V,OAAP;EACH;;EAED;;;;;;EAMA,aAASI,SAAT,CAAmBC,QAAnB,EAA6BlW,KAA7B,EAAoC;EAChC,YAAIkW,aAAa,IAAb,IAAqBlW,SAAS,CAAlC,EAAqC;EACjC,mBAAO,CAAP;EACH;EACD,eAAOiH,KAAK2N,KAAL,CAAW3N,KAAKkP,MAAL,KAAgBnW,KAA3B,IAAoCA,QAAQ,CAAnD;EACH;;EAED,aAASoW,WAAT,CAAqBC,MAArB,EAA6B;EACzB,YAAIC,SAAS,EAAb;EACA,aAAK,IAAI9Q,CAAT,IAAc6Q,MAAd,EAAsB;EAClB,gBAAIA,OAAO/G,cAAP,CAAsB9J,CAAtB,CAAJ,EAA8B;EAC1B8Q,uBAAO9Q,CAAP,IAAY6Q,OAAO7Q,CAAP,CAAZ;EACH;EACJ;EACD,eAAO8Q,MAAP;EACH;;EAED;;;;;;EAMA,aAASC,YAAT,CAAsBC,SAAtB,EAAiCC,OAAjC,EAAgG;EAAA,YAAtDC,SAAsD,uEAA1C,EAA0C;EAAA,YAAtCC,UAAsC,uEAAzBlV,SAAyB;EAAA,YAAdmV,OAAc,uEAAJ,EAAI;;EAC5F,YAAIC,gBAAgBH,SAApB;EACAG,yBAAiBF,aAAa,SAASA,WAAWG,cAAX,EAAT,GAAuC,uFAApD,GAA6I,EAA9J;EACAD,yBAAiBL,SAAjB;EACAK,yBAAiBD,UAAU,EAAV,GAAe,eAAepC,cAAciC,QAAQlP,GAAtB,EAA2B,GAA3B,CAA/C;EACAsP,yBAAiBD,UAAU,EAAV,GAAe,cAAcpC,cAAciC,QAAQM,SAAtB,CAA9C;EACAF,yBAAiBD,UAAUA,YAAY,MAAZ,GAAqB,iBAAiBpC,cAAciC,QAAQtT,IAAtB,CAAtC,GAAoE,EAA9E,GAAmF,iBAAiBqR,cAAciC,QAAQtT,IAAtB,CAArH;EACA0T,yBAAiBD,UAAUA,YAAa,QAAb,GAAwB,mBAAmBpC,cAAciC,QAAQO,MAAtB,CAA3C,GAA2E,EAArF,GAA0F,mBAAmBxC,cAAciC,QAAQO,MAAtB,CAA9H;EACAH,yBAAiBD,UAAU,EAAV,GAAe,cAAcpC,cAAciC,QAAQQ,SAAtB,CAA9C;EACAJ,yBAAiBD,UAAU,EAAV,GAAe,eAAepC,cAAciC,QAAQjP,GAAtB,CAA/C;EACA,eAAO,YAAY;EACf3H,kBAAMmV,IAAN,CAAW9Q,OAAX,CAAmBgT,UAAnB,GAAgCC,QAAhC,CAAyC,GAAzC,EAA8C/W,KAA9C,CAAoD,SAApD,EAA+D,GAA/D;EACAP,kBAAMmV,IAAN,CAAW9Q,OAAX,CAAmB+K,IAAnB,CAAwB4H,aAAxB;EACH,SAHD;EAIH;;EAOD;;EAEA;;;EAGA,KAAC,SAASO,WAAT,GAAuB;EACpB,iBAASC,WAAT,CAAqBlJ,MAArB,EAA6B;;EAEzB,gBAAIsI,UAAU;EACVlP,qBAAK,IADK;EAEV+P,iCAAiB,IAFP;EAGVC,iCAAiB,IAHP;EAIVR,2BAAW,IAJD;EAKVC,wBAAQ,IALE;EAMV7T,sBAAM,IANI;EAOVqU,qBAAK,IAPK;EAQVP,2BAAW,IARD;EASVQ,iCAAiB,IATP;EAUVC,iCAAiB,IAVP;EAWVlQ,qBAAK;EAXK,aAAd;;EAcAiP,oBAAQjP,GAAR,GAAc7G,QAAA,CAAOwN,MAAP,CAAd;EACAsI,oBAAQQ,SAAR,GAAoBtW,aAAA,CAAYwN,MAAZ,EAAoB,IAApB,CAApB;EACAsI,oBAAQO,MAAR,GAAiBrW,WAAA,CAAUwN,MAAV,CAAjB;EACAsI,oBAAQtT,IAAR,GAAexC,SAAA,CAAQwN,MAAR,CAAf;EACAsI,oBAAQM,SAAR,GAAoBpW,aAAA,CAAYwN,MAAZ,EAAoB,IAApB,CAApB;EACAsI,oBAAQlP,GAAR,GAAc5G,QAAA,CAAOwN,MAAP,CAAd;EACAsI,oBAAQe,GAAR,GAAcf,QAAQM,SAAR,GAAoBN,QAAQQ,SAA1C;;EAEA;EACA,gBAAIU,MAAMlB,QAAQQ,SAAR,GAAqB,MAAMR,QAAQe,GAA7C;EACA,gBAAII,MAAMnB,QAAQM,SAAR,GAAqB,MAAMN,QAAQe,GAA7C;EACA,iBAAK,IAAIhS,IAAI,CAAb,EAAgBA,KAAK2I,OAAOtK,MAA5B,EAAoC2B,GAApC,EAAyC;EACrC,oBAAI2I,OAAO3I,CAAP,IAAYmS,GAAhB,EAAqB;EACjB;EACH;EACD,oBAAI,CAAClB,QAAQgB,eAAT,IAA4BtJ,OAAO3I,CAAP,KAAamS,GAA7C,EAAkD;EAC9ClB,4BAAQgB,eAAR,GAA0BtJ,OAAO3I,CAAP,CAA1B;EACA;EACH;EACD,oBAAI2I,OAAO3I,CAAP,IAAYoS,GAAhB,EAAqB;EACjBnB,4BAAQc,eAAR,GAA0BpJ,OAAO3I,IAAI,CAAX,CAA1B;EACA;EACH;EACJ;;EAGDiR,oBAAQiB,eAAR,GAA0BjB,QAAQQ,SAAR,GAAqB,IAAIR,QAAQe,GAA3D;EACAf,oBAAQa,eAAR,GAA0Bb,QAAQM,SAAR,GAAqB,IAAIN,QAAQe,GAA3D;EACA,gBAAI,CAACf,QAAQgB,eAAb,EAA8B;EAC1BhB,wBAAQgB,eAAR,GAA0BhB,QAAQjP,GAAlC;EACH;EACD,gBAAI,CAACiP,QAAQc,eAAb,EAA8B;EAC1Bd,wBAAQc,eAAR,GAA0Bd,QAAQlP,GAAlC;EACH;EACD,mBAAOkP,OAAP;EACH;;EAED,YAAIoB,YAAY,IAAhB;EACA,YAAIC,YAAY,IAAhB;EACA,YAAIC,aAAa,IAAjB;EACA,YAAIC,iBAAiB,IAArB;EACA,YAAIC,WAAJ;;EAEA;EACA,aAAKA,cAAc,CAAnB,EAAsBA,cAAcpY,MAAMkB,IAAN,CAAW8C,MAA/C,EAAuDoU,aAAvD,EAAsE;EAClEJ,wBAAYhY,MAAMkB,IAAN,CAAWkX,WAAX,EAAwBpY,MAAMgU,QAAN,CAAeG,KAAvC,CAAZ;EACA8D,wBAAYjY,MAAMkB,IAAN,CAAWkX,WAAX,EAAwBpY,MAAMgU,QAAN,CAAeK,KAAvC,CAAZ;EACA6D,yBAAalY,MAAMgU,QAAN,CAAeC,EAAf,GAAoBjU,MAAMkB,IAAN,CAAWkX,WAAX,EAAwBpY,MAAMgU,QAAN,CAAeC,EAAvC,CAApB,GAAiE,IAA9E;EACAkE,6BAAiBnY,MAAMgU,QAAN,CAAeE,MAAf,GAAwBlU,MAAMkB,IAAN,CAAWkX,WAAX,EAAwBpY,MAAMgU,QAAN,CAAeE,MAAvC,CAAxB,GAAyE,IAA1F;;EAEA,gBAAIlU,MAAMkV,SAAN,CAAgBzF,cAAhB,CAA+BuI,SAA/B,CAAJ,EAA+C;EAC3C,oBAAIhY,MAAMgU,QAAN,CAAeC,EAAnB,EAAuB;EACnBjU,0BAAMkV,SAAN,CAAgB8C,SAAhB,EAA2BK,UAA3B,CAAsCjT,IAAtC,CAA2C;EACvCjC,+BAAO8U,SADgC;EAEvChE,4BAAIiE,UAFmC;EAGvChE,gCAAQiE;EAH+B,qBAA3C;EAKH,iBAND,MAMM;EACFnY,0BAAMkV,SAAN,CAAgB8C,SAAhB,EAA2B1J,MAA3B,CAAkClJ,IAAlC,CAAuC6S,SAAvC;EACH;EACJ,aAVD,MAUO;EACH,oBAAIjY,MAAMgU,QAAN,CAAeC,EAAnB,EAAuB;EACnBjU,0BAAMkV,SAAN,CAAgB8C,SAAhB,IAA6B,EAA7B;EACAhY,0BAAMkV,SAAN,CAAgB8C,SAAhB,EAA2BK,UAA3B,GAAwC,CAAC;EACrClV,+BAAO8U,SAD8B;EAErChE,4BAAIiE,UAFiC;EAGrChE,gCAAQiE;EAH6B,qBAAD,CAAxC;EAKH,iBAPD,MAOM;EACFnY,0BAAMkV,SAAN,CAAgB8C,SAAhB,IAA6B,EAA7B;EACAhY,0BAAMkV,SAAN,CAAgB8C,SAAhB,EAA2B1J,MAA3B,GAAoC,CAAC2J,SAAD,CAApC;EACH;EACJ;;EAGD;EACA;;;;;;EAMH;;EAED,aAAK,IAAIK,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/B,gBAAIlV,MAAMgU,QAAN,CAAeC,EAAnB,EAAuB;EACnBjU,sBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhK,MAAvB,GAAgC,EAAhC;EACA;EACA,qBAAK,IAAIvK,QAAQ,CAAjB,EAAoBA,QAAQ/D,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBD,UAAvB,CAAkCrU,MAA9D,EAAsED,OAAtE,EAA8E;EAC1E/D,0BAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhK,MAAvB,CAA8BlJ,IAA9B,CAAmCpF,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBD,UAAvB,CAAkCtU,KAAlC,EAAyCZ,KAA5E;EACH;;EAEDnD,sBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBD,UAAvB,CAAkCrF,IAAlC,CAAuC,UAAS7K,CAAT,EAAWtD,CAAX,EAAc;EAAE,2BAAO/D,cAAA,CAAaqH,EAAEhF,KAAf,EAAsB0B,EAAE1B,KAAxB,CAAP;EAAuC,iBAA9F;EACH;;EAED;EACAnD,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhK,MAAvB,CAA8B0E,IAA9B,CAAmClS,cAAnC;EACAd,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,GAAiC,EAAjC;EACA5W,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,GAAkCY,YAAYxX,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhK,MAAnC,CAAlC;EACH;EACJ,KArHA,EAAD;;EAuHA;;;EAGA,KAAC,SAASiK,eAAT,GAA2B;EACxB,YAAIrW,SAAS,EAAb;EACA;EACAlC,cAAMiK,MAAN,GAAejK,MAAMgU,QAAN,CAAe/J,MAA9B;EACAjK,cAAMwY,QAAN,GAAiBxY,MAAMgU,QAAN,CAAeQ,SAAf,CAAyBrU,KAA1C;EACAH,cAAMyY,SAAN,GAAkBzY,MAAMgU,QAAN,CAAeQ,SAAf,CAAyBnU,MAA3C;EACAL,cAAMG,KAAN,GAAcH,MAAMwY,QAAN,GAAiBxY,MAAMiK,MAAN,CAAaC,IAA9B,GAAqClK,MAAMiK,MAAN,CAAaE,KAAhE;EACAnK,cAAMK,MAAN,GAAeL,MAAMyY,SAAN,GAAkBzY,MAAMiK,MAAN,CAAaG,GAA/B,GAAqCpK,MAAMiK,MAAN,CAAaI,MAAjE;;EAEA,YAAIrK,MAAMgU,QAAN,CAAe0E,UAAnB,EAA+B;EAC3B1Y,kBAAM2Y,UAAN,GAAmB3Y,MAAMgU,QAAN,CAAe0E,UAAf,CAA0BhW,KAA7C;EACA1C,kBAAM4Y,UAAN,GAAmB5Y,MAAMgU,QAAN,CAAe0E,UAAf,CAA0BjW,KAA7C;EACH,SAHD,MAGO;EACHzC,kBAAM2Y,UAAN,GAAmB3Y,MAAMgU,QAAN,CAAeG,KAAlC;EACAnU,kBAAM4Y,UAAN,GAAmB5Y,MAAMgU,QAAN,CAAeK,KAAlC;EACH;;EAED,YAAIrU,MAAMgU,QAAN,CAAe7S,KAAf,KAAyB,KAA7B,EAAoC;EAChCnB,kBAAM6Y,MAAN,GAAe/X,aAAA,EAAf;EACAd,kBAAMgV,UAAN,GAAmBF,eAAnB;EACH,SAHD,MAGO;EACH9U,kBAAM6Y,MAAN,GAAe/X,gBAAA,EAAf;EACH;;EAED,YAAId,MAAMgU,QAAN,CAAeS,iBAAf,KAAqC,IAAzC,EAA+C;EAC3C,gBAAIqE,SAAS,EAAb;EACA,iBAAK,IAAIR,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/B4D,uBAAO1T,IAAP,CAAYpF,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,CAA+BgB,eAA3C;EACAkB,uBAAO1T,IAAP,CAAYpF,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,CAA+Bc,eAA3C;EACH;EACD1X,kBAAMqB,KAAN,GAAcP,WAAA,CAAUgY,MAAV,CAAd;EAEH,SARD,MAQO;EACH9Y,kBAAMqB,KAAN,GAAcP,WAAA,CAAUd,MAAMkB,IAAhB,EAAsB,UAAUM,CAAV,EAAa;EAAC,uBAAOA,EAAExB,MAAMgU,QAAN,CAAeK,KAAjB,CAAP;EAAgC,aAApE,CAAd;EACH;;EAEDrU,cAAMuV,UAAN,GAAmBC,cAAcxV,MAAMgU,QAAN,CAAehE,MAA7B,CAAnB;;EAEA;EACAhQ,cAAM6Y,MAAN,CAAaxX,KAAb,CAAmB,CAACrB,MAAMK,MAAP,EAAe,CAAf,CAAnB,EAAsC6B,MAAtC,CAA6ClC,MAAMqB,KAAnD,EAA0Dc,IAA1D,GAAiE4W,KAAjE,CAAuE,IAAvE;;EAEA,YAAI/Y,MAAMgU,QAAN,CAAeI,KAAf,KAAyB,IAA7B,EAAmC;EAC/BlS,qBAASyK,OAAO2F,IAAP,CAAYtS,MAAMkV,SAAlB,CAAT;EACH,SAFD,MAEO;EACHhT,qBAASH,MAAMC,OAAN,CAAchC,MAAMgU,QAAN,CAAeI,KAA7B,IAAsCpU,MAAMgU,QAAN,CAAeI,KAArD,GAA6DzH,OAAO2F,IAAP,CAAYtS,MAAMkV,SAAlB,EAA6BlC,IAA7B,CAAkClS,cAAlC,CAAtE;EACH;EACDd,cAAMkW,MAAN,GAAepV,cAAA,GAAeoB,MAAf,CAAsBA,MAAtB,EAA8BD,UAA9B,CAAyC,CAAC,CAAD,EAAIjC,MAAMG,KAAV,CAAzC,CAAf;;EAEA;EACAH,cAAMmV,IAAN,CAAW1S,KAAX,GAAmB3B,aAAA,GACdK,KADc,CACRnB,MAAM6Y,MADE,EAEdrK,UAFc,CAEHxO,MAAMgV,UAFH,EAGd5G,aAHc,CAGA,CAHA,EAId4K,aAJc,CAIA,CAAChZ,MAAMG,KAAP,IAAgBH,MAAMiK,MAAN,CAAaE,KAAb,GAAqBnK,MAAMiK,MAAN,CAAaC,IAAlD,CAJA,CAAnB;EAKA;EACAlK,cAAMmV,IAAN,CAAWzS,KAAX,GAAmB5B,eAAA,GACdK,KADc,CACRnB,MAAMkW,MADE;EAEf;EAFe,SAGd9H,aAHc,CAGA,CAHA,EAIdC,QAJc,CAIL,CAJK,CAAnB;EAKH,KA5DA,EAAD;;EA8DA;;;;EAIArO,UAAMmG,MAAN,GAAe,YAAY;EACvB;EACAnG,cAAMG,KAAN,GAAcgH,SAASnH,MAAMmV,IAAN,CAAWE,QAAX,CAAoB9U,KAApB,CAA0B,OAA1B,CAAT,EAA6C,EAA7C,KAAoDP,MAAMiK,MAAN,CAAaC,IAAb,GAAoBlK,MAAMiK,MAAN,CAAaE,KAArF,CAAd;EACAnK,cAAMK,MAAN,GAAe8G,SAASnH,MAAMmV,IAAN,CAAWE,QAAX,CAAoB9U,KAApB,CAA0B,QAA1B,CAAT,EAA8C,EAA9C,KAAqDP,MAAMiK,MAAN,CAAaG,GAAb,GAAmBpK,MAAMiK,MAAN,CAAaI,MAArF,CAAf;EACA;EACArK,cAAMkW,MAAN,CAAajU,UAAb,CAAwB,CAAC,CAAD,EAAIjC,MAAMG,KAAV,CAAxB;EACAH,cAAM6Y,MAAN,CAAaxX,KAAb,CAAmB,CAACrB,MAAMK,MAAP,EAAe,CAAf,CAAnB;;EAEA;EACA,YAAIL,MAAMiZ,WAAN,IAAqBjZ,MAAMiZ,WAAN,CAAkBzH,OAAlB,CAA0B/L,IAA1B,IAAkC,IAAvD,IAA+DzF,MAAMiZ,WAAN,CAAkBzH,OAAlB,CAA0B0H,UAA1B,IAAwC,IAA3G,EAAiH;EAC7GlZ,kBAAM6Y,MAAN,CAAa3W,MAAb,CAAoBlC,MAAMiZ,WAAN,CAAkBzH,OAAlB,CAA0B0H,UAA9C,EAA0D/W,IAA1D,GAAiE4W,KAAjE,CAAuE,IAAvE;EACH,SAFD,MAEO;EACH/Y,kBAAM6Y,MAAN,CAAa3W,MAAb,CAAoBlC,MAAMqB,KAA1B,EAAiCc,IAAjC,GAAwC4W,KAAxC,CAA8C,IAA9C;EACH;;EAED;EACA/Y,cAAMmV,IAAN,CAAWG,CAAX,CAAanG,MAAb,CAAoB,SAApB,EAA+BrK,IAA/B,CAAoC,WAApC,EAAiD,iBAAiB9E,MAAMK,MAAvB,GAAgC,GAAjF,EAAsF0H,IAAtF,CAA2F/H,MAAMmV,IAAN,CAAWzS,KAAtG,EACKoF,SADL,CACe,YADf,EAEKhD,IAFL,CAEU,GAFV,EAEe,CAFf,EAGKA,IAHL,CAGU,GAHV,EAGe,CAAC,CAHhB,EAIKA,IAJL,CAIU,WAJV,EAIuB,aAJvB,EAKKvE,KALL,CAKW,aALX,EAK0B,KAL1B;EAMAP,cAAMmV,IAAN,CAAWG,CAAX,CAAanG,MAAb,CAAoB,gBAApB,EAAsCrK,IAAtC,CAA2C,GAA3C,EAAgD9E,MAAMG,KAAN,GAAc,CAA9D;EACAH,cAAMmV,IAAN,CAAWG,CAAX,CAAanG,MAAb,CAAoB,SAApB,EAA+BpH,IAA/B,CAAoC/H,MAAMmV,IAAN,CAAW1S,KAAX,CAAiBuW,aAAjB,CAA+B,CAAChZ,MAAMG,KAAtC,CAApC;EACAH,cAAMmV,IAAN,CAAWG,CAAX,CAAanG,MAAb,CAAoB,gBAApB,EAAsCrK,IAAtC,CAA2C,GAA3C,EAAgD,CAAC9E,MAAMK,MAAP,GAAgB,CAAhE;EACAL,cAAMmV,IAAN,CAAWE,QAAX,CAAoBlG,MAApB,CAA2B,KAA3B,EAAkCrK,IAAlC,CAAuC,OAAvC,EAAgD9E,MAAMG,KAAN,IAAeH,MAAMiK,MAAN,CAAaC,IAAb,GAAoBlK,MAAMiK,MAAN,CAAaE,KAAhD,CAAhD,EAAwGrF,IAAxG,CAA6G,QAA7G,EAAuH9E,MAAMK,MAAN,IAAgBL,MAAMiK,MAAN,CAAaG,GAAb,GAAmBpK,MAAMiK,MAAN,CAAaI,MAAhD,CAAvH;;EAEA,eAAOrK,KAAP;EACH,KA5BD;;EA8BA;;;EAGA,KAAC,SAASmZ,YAAT,GAAwB;EACvB;EACAnZ,cAAMmV,IAAN,CAAWC,OAAX,GAAqBtU,WAAA,CAAUd,MAAMgU,QAAN,CAAetH,QAAzB,EAClBnM,KADkB,CACZ,OADY,EACHP,MAAMwY,QAAN,GAAiB,IADd,EAElBjY,KAFkB,CAEZ,QAFY,EAEFP,MAAMyY,SAAN,GAAiB,IAFf,CAArB;EAGA;EACAzY,cAAMmV,IAAN,CAAWC,OAAX,CAAmBlQ,MAAnB,CAA0B,KAA1B,EACGJ,IADH,CACQ,OADR,EACiB,eADjB,EAEGvE,KAFH,CAES,gBAFT,EAE2B,IAF3B,EAGGA,KAHH,CAGS,QAHT,EAGmBP,MAAMyY,SAAN,GAAkB,IAHrC,EAIGvT,MAJH,CAIU,KAJV,EAIiBJ,IAJjB,CAIsB,OAJtB,EAI+B,WAJ/B,EAKGI,MALH,CAKU,KALV,EAKiBJ,IALjB,CAKsB,OALtB,EAK+B,WAL/B;EAMA;EACA9E,cAAM0M,QAAN,GAAiB1M,MAAMgU,QAAN,CAAetH,QAAf,GAA0B,aAA3C;EACA1M,cAAMmV,IAAN,CAAWE,QAAX,GAAsBvU,WAAA,CAAUd,MAAM0M,QAAhB,CAAtB;EACA5L,mBAAA,CAAU8I,MAAV,EAAkBpE,EAAlB,CAAqB,YAAYxF,MAAM0M,QAAvC,EAAiD1M,MAAMmG,MAAvD;;EAEA;EACAnG,cAAMmV,IAAN,CAAWG,CAAX,GAAetV,MAAMmV,IAAN,CAAWE,QAAX,CAAoBnQ,MAApB,CAA2B,KAA3B,EACZJ,IADY,CACP,OADO,EACE,YADF,EAEZA,IAFY,CAEP,OAFO,EAEE9E,MAAMG,KAAN,IAAeH,MAAMiK,MAAN,CAAaC,IAAb,GAAoBlK,MAAMiK,MAAN,CAAaE,KAAhD,CAFF,EAGZrF,IAHY,CAGP,QAHO,EAGG9E,MAAMK,MAAN,IAAgBL,MAAMiK,MAAN,CAAaG,GAAb,GAAmBpK,MAAMiK,MAAN,CAAaI,MAAhD,CAHH,EAIZnF,MAJY,CAIL,GAJK,EAKZJ,IALY,CAKP,WALO,EAKM,eAAe9E,MAAMiK,MAAN,CAAaC,IAA5B,GAAmC,GAAnC,GAAyClK,MAAMiK,MAAN,CAAaG,GAAtD,GAA4D,GALlE,CAAf;;EAOA;EACApK,cAAMmV,IAAN,CAAWxH,IAAX,GAAkB3N,MAAMmV,IAAN,CAAWG,CAAX,CAAapQ,MAAb,CAAoB,GAApB,EAAyBJ,IAAzB,CAA8B,OAA9B,EAAuC,MAAvC,CAAlB;EACA9E,cAAMmV,IAAN,CAAWxH,IAAX,CAAgBzI,MAAhB,CAAuB,GAAvB,EACKJ,IADL,CACU,OADV,EACmB,QADnB,EAEKA,IAFL,CAEU,WAFV,EAEuB,iBAAiB9E,MAAMK,MAAvB,GAAgC,GAFvD,EAGK0H,IAHL,CAGU/H,MAAMmV,IAAN,CAAWzS,KAHrB,EAIKwC,MAJL,CAIY,MAJZ,EAKKJ,IALL,CAKU,OALV,EAKmB,OALnB,EAMKA,IANL,CAMU,GANV,EAMe9E,MAAMiK,MAAN,CAAaI,MAAb,GAAsB,EANrC,EAOKvF,IAPL,CAOU,GAPV,EAOe,CAAC9E,MAAMG,KAAP,GAAe,CAP9B,EAQK2E,IARL,CAQU,IARV,EAQgB,OARhB,EASKA,IATL,CASU,MATV,EASkB,MATlB,EAUKvE,KAVL,CAUW,aAVX,EAU0B,QAV1B,EAWK6D,IAXL,CAWUpE,MAAM2Y,UAXhB;;EAaA3Y,cAAMmV,IAAN,CAAWxH,IAAX,CAAgBzI,MAAhB,CAAuB,GAAvB,EACKJ,IADL,CACU,OADV,EACmB,QADnB,EAEKiD,IAFL,CAEU/H,MAAMmV,IAAN,CAAW1S,KAFrB,EAGKyC,MAHL,CAGY,MAHZ,EAIKJ,IAJL,CAIU,OAJV,EAImB,OAJnB,EAKKA,IALL,CAKU,WALV,EAKuB,aALvB,EAMKA,IANL,CAMU,GANV,EAMe,CAAC9E,MAAMiK,MAAN,CAAaC,IAAd,GAAqB,GANpC,EAOKpF,IAPL,CAOU,GAPV,EAOe,CAAC9E,MAAMK,MAAP,GAAgB,CAP/B,EAQKyE,IARL,CAQU,IARV,EAQgB,OARhB,EASKA,IATL,CASU,MATV,EASkB,MATlB,EAUKvE,KAVL,CAUW,aAVX,EAU0B,QAV1B,EAWK6D,IAXL,CAWUpE,MAAM4Y,UAXhB;;EAaA;EACA5Y,cAAMmV,IAAN,CAAW9Q,OAAX,GAAqBrE,MAAMmV,IAAN,CAAWC,OAAX,CAAmBlQ,MAAnB,CAA0B,KAA1B,EAAiCJ,IAAjC,CAAsC,OAAtC,EAA+C,SAA/C,EAA0DvE,KAA1D,CAAgE,SAAhE,EAA2E,MAA3E,CAArB;EACA,aAAK,IAAI+X,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/BlV,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhD,CAAvB,GAA2BtV,MAAMmV,IAAN,CAAWG,CAAX,CAAapQ,MAAb,CAAoB,GAApB,EAAyBJ,IAAzB,CAA8B,OAA9B,EAAuC,OAAvC,CAA3B;EACA;;;;;;;;EAQH;EACD9E,cAAMmG,MAAN;EACD,KAnEA,EAAD;;EAqEA;;;;;;;;;;;;;;;EAeAnG,UAAMoZ,gBAAN,GAAyB,UAAU5H,OAAV,EAAmB;EACxCxR,cAAMiZ,WAAN,GAAoB,EAApB;;EAEA,YAAII,iBAAiB;EACjB5T,kBAAM,IADW;EAEjB6T,4BAAgB,IAFC;EAGjBC,wBAAY,GAHK;EAIjBnH,uBAAW,EAJM;EAKjBjS,mBAAO,EALU;EAMjBqZ,mBAAO1Y,kBANU;EAOjBiY,mBAAO,CAPU;EAQjB/I,oBAAQhQ,MAAMuV,UARG;EASjB2D,wBAAY,IATK;EAAA,SAArB;EAWAlZ,cAAMiZ,WAAN,CAAkBzH,OAAlB,GAA4B+E,YAAY8C,cAAZ,CAA5B;EACA,aAAK,IAAII,MAAT,IAAmBjI,OAAnB,EAA4B;EACxBxR,kBAAMiZ,WAAN,CAAkBzH,OAAlB,CAA0BiI,MAA1B,IAAoCjI,QAAQiI,MAAR,CAApC;EACH;EACD,YAAIC,QAAQ1Z,MAAMiZ,WAAN,CAAkBzH,OAA9B;;EAEA;EACA,aAAK,IAAI8G,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/BlV,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBqB,MAAvB,GAAgC,EAAhC;EACA3Z,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBqB,MAAvB,CAA8BxE,IAA9B,GAAqC,EAArC;EACH;;EAED;;;;EAIAnV,cAAMiZ,WAAN,CAAkBxG,MAAlB,GAA2B,UAAUmH,aAAV,EAAyB;EAChD,gBAAIA,aAAJ,EAAmB;EACf,qBAAK,IAAIjE,GAAT,IAAgBiE,aAAhB,EAA+B;EAC3BF,0BAAM/D,GAAN,IAAaiE,cAAcjE,GAAd,CAAb;EACH;EACJ;;EAED,iBAAK,IAAI2C,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/BlV,sBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBqB,MAAvB,CAA8BxE,IAA9B,CAAmCG,CAAnC,CAAqCtN,MAArC;EACH;;EAEDhI,kBAAMiZ,WAAN,CAAkBY,aAAlB;EACA7Z,kBAAMiZ,WAAN,CAAkB9S,MAAlB;EACH,SAbD;;EAeAnG,cAAMiZ,WAAN,CAAkBa,KAAlB,GAA0B,YAAY;EAClC9Z,kBAAMiZ,WAAN,CAAkBxG,MAAlB,CAAyB4G,cAAzB;EACH,SAFD;EAGArZ,cAAMiZ,WAAN,CAAkBxT,IAAlB,GAAyB,UAAUsU,IAAV,EAAgB;EACrC,gBAAIA,SAASnY,SAAb,EAAwB;EACpBmY,qBAAKtU,IAAL,GAAY,IAAZ;EACA,oBAAIsU,KAAKD,KAAT,EAAgB;EACZ9Z,0BAAMiZ,WAAN,CAAkBa,KAAlB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAACtU,MAAM,IAAP,EAAP;EACH;EACDzF,kBAAMiZ,WAAN,CAAkBxG,MAAlB,CAAyBsH,IAAzB;EAEH,SAXD;;EAaA/Z,cAAMiZ,WAAN,CAAkBvT,IAAlB,GAAyB,UAAUqU,IAAV,EAAgB;EACrC,gBAAIA,SAASnY,SAAb,EAAwB;EACpBmY,qBAAKtU,IAAL,GAAY,KAAZ;EACA,oBAAIsU,KAAKD,KAAT,EAAgB;EACZ9Z,0BAAMiZ,WAAN,CAAkBa,KAAlB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAACtU,MAAM,KAAP,EAAP;EACH;EACDzF,kBAAMiZ,WAAN,CAAkBxG,MAAlB,CAAyBsH,IAAzB;EAEH,SAXD;;EAaA;;;EAGA/Z,cAAMiZ,WAAN,CAAkB9S,MAAlB,GAA2B,YAAY;EACnC,gBAAImS,KAAJ,EAAW0B,WAAX;;EAEA,iBAAK1B,KAAL,IAActY,MAAMkV,SAApB,EAA+B;EAC3B8E,8BAAcha,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBqB,MAArC;;EAEA;EACA,oBAAIM,UAAUja,MAAM6Y,MAAN,CAAaqB,IAAb,EAAd;;EAGA;EACAF,4BAAYG,GAAZ,GAAkBC,uBAAuBC,QAAQX,MAAMtH,SAAd,CAAvB,EAAiD6H,QAAQxW,KAAR,CAAciW,MAAMH,UAApB,CAAjD,CAAlB;EACAS,4BAAYM,OAAZ,GAAsBN,YAAYG,GAAZ,CAAgBna,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhK,MAAvC,CAAtB;;EAEA,oBAAIiM,iBAAiBva,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,CAA+BlP,GAApD;EAAA,oBACI8S,iBAAiBxa,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,CAA+BjP,GADpD;;EAGA,oBAAI+R,MAAMX,KAAN,IAAe,CAAf,IAAoBW,MAAMX,KAAN,IAAe,CAAC,CAAxC,EAA2C;EAAE;EACzC;EACA;EACAwB,qCAAiBzZ,QAAA,CAAOkZ,YAAYM,OAAZ,CAAoBG,MAApB,CAA2B,UAAUjZ,CAAV,EAAa;EAC5D,+BAAQA,EAAE2G,CAAF,GAAMnI,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,CAA+BlP,GAArC,IAA4ClG,EAAEqD,CAAF,IAAO,CAA3D;EACH,qBAFuB,CAAP,EAEb,UAAUrD,CAAV,EAAa;EACb,+BAAOA,EAAE2G,CAAT;EACH,qBAJgB,CAAjB;EAKA;EACAqS,qCAAiB1Z,QAAA,CAAOkZ,YAAYM,OAAZ,CAAoBG,MAApB,CAA2B,UAAUjZ,CAAV,EAAa;EAC5D,+BAAQA,EAAE2G,CAAF,GAAMnI,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,CAA+BjP,GAArC,IAA4CnG,EAAEqD,CAAF,IAAO,CAA3D;EACH,qBAFuB,CAAP,EAEb,UAAUrD,CAAV,EAAa;EACb,+BAAOA,EAAE2G,CAAT;EACH,qBAJgB,CAAjB;EAKA;EACA,wBAAIuR,MAAMX,KAAN,IAAe,CAAC,CAApB,EAAuB;EACnB2B,oCAAYC,YAAYN,QAAQX,MAAMtH,SAAd,CAAZ,EAAsCpS,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhK,MAA7D,CAAZ;EACA,4BAAI,CAACiM,cAAL,EAAqB;EACjB,gCAAIK,YAAYF,UAAU1a,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,CAA+BlP,GAAzC,CAAhB;EACA,gCAAImT,YAAY7a,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,CAA+BlP,GAA/C;EACA,gCAAIoT,QAAQ,EAAZ,CAHiB;EAIjB,mCAAOA,QAAQ,CAAR,IAAaF,aAAa,CAAjC,EAAoC;EAChCA,4CAAYF,UAAUG,SAAV,CAAZ;EACAA,6CAAa,CAAb;EACAC,yCAAS,CAAT;EACH;EACDP,6CAAiBM,SAAjB;EACH;EACD,4BAAI,CAACL,cAAL,EAAqB;EACjB,gCAAIO,YAAYL,UAAU1a,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,CAA+BjP,GAAzC,CAAhB;EACA,gCAAIqT,YAAYhb,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,CAA+BjP,GAA/C;EACA,gCAAImT,QAAQ,EAAZ,CAHiB;EAIjB,mCAAOA,QAAQ,CAAR,IAAaC,aAAa,CAAjC,EAAoC;EAChCA,4CAAYL,UAAUM,SAAV,CAAZ;EACAA,6CAAa,CAAb;EACAF,yCAAS,CAAT;EACH;EACDN,6CAAiBQ,SAAjB;EACH;EAEJ;EACD;EACA;EACA,wBAAI,CAACtB,MAAMR,UAAX,EAAuBQ,MAAMR,UAAN,GAAmBlZ,MAAMqB,KAAN,CAAYuE,KAAZ,CAAkB,CAAlB,CAAnB;EACvB,wBAAI4U,kBAAkBA,iBAAiBd,MAAMR,UAAN,CAAiB,CAAjB,CAAvC,EAA4D;EACxDQ,8BAAMR,UAAN,CAAiB,CAAjB,IAAsBsB,cAAtB;EACH;EACD,wBAAID,kBAAkBA,iBAAiBb,MAAMR,UAAN,CAAiB,CAAjB,CAAvC,EAA4D;EACxDQ,8BAAMR,UAAN,CAAiB,CAAjB,IAAsBqB,cAAtB;EACH;EAGJ;;EAGD,oBAAIb,MAAMJ,cAAV,EAA0B;EACtBtZ,0BAAMmG,MAAN;EACA8T,8BAAUja,MAAM6Y,MAAN,CAAaqB,IAAb,EAAV;;EAEA;EACAF,gCAAYG,GAAZ,GAAkBC,uBAAuBC,QAAQX,MAAMtH,SAAd,CAAvB,EAAiD6H,QAAQxW,KAAR,CAAciW,MAAMH,UAApB,CAAjD,CAAlB;EACAS,gCAAYM,OAAZ,GAAsBN,YAAYG,GAAZ,CAAgBna,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhK,MAAvC,CAAtB;EACH;;EAED0L,4BAAYM,OAAZ,GAAsBN,YAAYM,OAAZ,CACjBG,MADiB,CACV,UAAUjZ,CAAV,EAAa;EACjB,2BAAQ,CAACgZ,cAAD,IAAmBhZ,EAAE2G,CAAF,IAAOqS,cAAlC;EACH,iBAHiB,EAIjBC,MAJiB,CAIV,UAAUjZ,CAAV,EAAa;EACjB,2BAAQ,CAAC+Y,cAAD,IAAmB/Y,EAAE2G,CAAF,IAAOoS,cAAlC;EACH,iBANiB,CAAtB;EAOH;EACD,iBAAKjC,KAAL,IAActY,MAAMkV,SAApB,EAA+B;EAC3B8E,8BAAcha,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBqB,MAArC;;EAEA;EACA,oBAAIsB,YAAYpF,YAAY6D,MAAMvZ,KAAlB,EAAyBmY,KAAzB,CAAhB;EACA,oBAAInY,QAAQ,CAAC8a,UAAU9Q,KAAV,GAAkB8Q,UAAU/Q,IAA7B,IAAqC,CAAjD;;EAEA,oBAAIgR,UAAUpa,gBAAA,GACTO,KADS,CACH,CAAClB,KAAD,EAAQ,CAAR,CADG,EAET+B,MAFS,CAEF,CAAC,CAAD,EAAIpB,QAAA,CAAOkZ,YAAYM,OAAnB,EAA4B,UAAU9Y,CAAV,EAAa;EAAC,2BAAOA,EAAEqD,CAAT;EAAY,iBAAtD,CAAJ,CAFE,EAGTkU,KAHS,CAGH,IAHG,CAAd;;EAKA,oBAAIoC,OAAOra,SAAA,GACN0Y,KADM,CACAE,MAAMF,KADN,EAENrR,CAFM,CAEJ,UAAU3G,CAAV,EAAa;EAAC,2BAAOyY,QAAQzY,EAAE2G,CAAV,CAAP;EAAqB,iBAF/B,EAGNiT,EAHM,CAGHjb,KAHG,EAINkb,EAJM,CAIH,UAAU7Z,CAAV,EAAa;EAAC,2BAAO0Z,QAAQ1Z,EAAEqD,CAAV,CAAP;EAAqB,iBAJhC,CAAX;;EAMA,oBAAIH,OAAO5D,SAAA,GACN0Y,KADM,CACAE,MAAMF,KADN,EAENrR,CAFM,CAEJ,UAAU3G,CAAV,EAAa;EAAC,2BAAOyY,QAAQzY,EAAE2G,CAAV,CAAP;EAAqB,iBAF/B,EAGNtD,CAHM,CAGJ,UAAUrD,CAAV,EAAa;EAAC,2BAAO0Z,QAAQ1Z,EAAEqD,CAAV,CAAP;EAAoB,iBAH9B,CAAX;;EAKA,oBAAImV,YAAY7E,IAAZ,CAAiBjL,IAAjB,CAAsBiR,IAA1B,EAAgC;EAC5BnB,gCAAY7E,IAAZ,CAAiBjL,IAAjB,CAAsBiR,IAAtB,CACKG,KADL,CACWtB,YAAYM,OADvB,EAEKxV,IAFL,CAEU,GAFV,EAEeqW,IAFf;EAGAnB,gCAAY7E,IAAZ,CAAiBjL,IAAjB,CAAsBxF,IAAtB,CACK4W,KADL,CACWtB,YAAYM,OADvB,EAEKxV,IAFL,CAEU,GAFV,EAEeJ,IAFf;;EAIAsV,gCAAY7E,IAAZ,CAAiBhL,KAAjB,CAAuBgR,IAAvB,CACKG,KADL,CACWtB,YAAYM,OADvB,EAEKxV,IAFL,CAEU,GAFV,EAEeqW,IAFf;EAGAnB,gCAAY7E,IAAZ,CAAiBhL,KAAjB,CAAuBzF,IAAvB,CACK4W,KADL,CACWtB,YAAYM,OADvB,EAEKxV,IAFL,CAEU,GAFV,EAEeJ,IAFf;EAGH;;EAED;EACAsV,4BAAY7E,IAAZ,CAAiBjL,IAAjB,CAAsBoL,CAAtB,CAAwBxQ,IAAxB,CAA6B,WAA7B,EAA0C,mCAAmCmW,UAAU/Q,IAA7C,GAAoD,gBAA9F;EACA8P,4BAAY7E,IAAZ,CAAiBhL,KAAjB,CAAuBmL,CAAvB,CAAyBxQ,IAAzB,CAA8B,WAA9B,EAA2C,kCAAkCmW,UAAU9Q,KAA5C,GAAoD,GAA/F;EACH;EACJ,SApID;;EAsIA;;;EAGAnK,cAAMiZ,WAAN,CAAkBY,aAAlB,GAAkC,YAAY;EAC1C,gBAAIvB,KAAJ,EAAW0B,WAAX;;EAEA,gBAAIN,MAAM1J,MAAV,EAAkB;EACdhQ,sBAAMiZ,WAAN,CAAkBzO,KAAlB,GAA0BgL,cAAckE,MAAM1J,MAApB,CAA1B;EACH,aAFD,MAEO;EACHhQ,sBAAMiZ,WAAN,CAAkBzO,KAAlB,GAA0BxK,MAAMuV,UAAhC;EACH;;EAED,gBAAImE,MAAMjU,IAAN,IAAc,KAAlB,EAAyB;EAAC;EAAO;;EAEjC,iBAAK6S,KAAL,IAActY,MAAMkV,SAApB,EAA+B;EAC3B8E,8BAAcha,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBqB,MAArC;;EAEAK,4BAAY7E,IAAZ,CAAiBG,CAAjB,GAAqBtV,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhD,CAAvB,CAAyBpQ,MAAzB,CAAgC,GAAhC,EAAqCJ,IAArC,CAA0C,OAA1C,EAAmD,aAAnD,CAArB;EACAkV,4BAAY7E,IAAZ,CAAiBjL,IAAjB,GAAwB,EAACiR,MAAM,IAAP,EAAazW,MAAM,IAAnB,EAAyB4Q,GAAG,IAA5B,EAAxB;EACA0E,4BAAY7E,IAAZ,CAAiBhL,KAAjB,GAAyB,EAACgR,MAAM,IAAP,EAAazW,MAAM,IAAnB,EAAyB4Q,GAAG,IAA5B,EAAzB;;EAEA0E,4BAAY7E,IAAZ,CAAiBjL,IAAjB,CAAsBoL,CAAtB,GAA0B0E,YAAY7E,IAAZ,CAAiBG,CAAjB,CAAmBpQ,MAAnB,CAA0B,GAA1B,CAA1B;EACA8U,4BAAY7E,IAAZ,CAAiBhL,KAAjB,CAAuBmL,CAAvB,GAA2B0E,YAAY7E,IAAZ,CAAiBG,CAAjB,CAAmBpQ,MAAnB,CAA0B,GAA1B,CAA3B;;EAEA,oBAAIwU,MAAMJ,cAAN,KAAyB,KAA7B,EAAoC;EAChC;EACAU,gCAAY7E,IAAZ,CAAiBjL,IAAjB,CAAsBiR,IAAtB,GAA6BnB,YAAY7E,IAAZ,CAAiBjL,IAAjB,CAAsBoL,CAAtB,CAAwBpQ,MAAxB,CAA+B,MAA/B,EACxBJ,IADwB,CACnB,OADmB,EACV,MADU,EAExBvE,KAFwB,CAElB,MAFkB,EAEVP,MAAMiZ,WAAN,CAAkBzO,KAAlB,CAAwB8N,KAAxB,CAFU,CAA7B;EAGA0B,gCAAY7E,IAAZ,CAAiBhL,KAAjB,CAAuBgR,IAAvB,GAA8BnB,YAAY7E,IAAZ,CAAiBhL,KAAjB,CAAuBmL,CAAvB,CAAyBpQ,MAAzB,CAAgC,MAAhC,EACzBJ,IADyB,CACpB,OADoB,EACX,MADW,EAEzBvE,KAFyB,CAEnB,MAFmB,EAEXP,MAAMiZ,WAAN,CAAkBzO,KAAlB,CAAwB8N,KAAxB,CAFW,CAA9B;;EAIA;EACA0B,gCAAY7E,IAAZ,CAAiBjL,IAAjB,CAAsBxF,IAAtB,GAA6BsV,YAAY7E,IAAZ,CAAiBjL,IAAjB,CAAsBoL,CAAtB,CAAwBpQ,MAAxB,CAA+B,MAA/B,EACxBJ,IADwB,CACnB,OADmB,EACV,MADU,EAExBA,IAFwB,CAEnB,MAFmB,EAEX,MAFW,EAGxBvE,KAHwB,CAGlB,QAHkB,EAGRP,MAAMiZ,WAAN,CAAkBzO,KAAlB,CAAwB8N,KAAxB,CAHQ,CAA7B;EAIA0B,gCAAY7E,IAAZ,CAAiBhL,KAAjB,CAAuBzF,IAAvB,GAA8BsV,YAAY7E,IAAZ,CAAiBhL,KAAjB,CAAuBmL,CAAvB,CAAyBpQ,MAAzB,CAAgC,MAAhC,EACzBJ,IADyB,CACpB,OADoB,EACX,MADW,EAEzBA,IAFyB,CAEpB,MAFoB,EAEZ,MAFY,EAGzBvE,KAHyB,CAGnB,QAHmB,EAGTP,MAAMiZ,WAAN,CAAkBzO,KAAlB,CAAwB8N,KAAxB,CAHS,CAA9B;EAIH;EAEJ;EAEJ,SA3CD;;EA8CA,iBAAS8B,sBAAT,CAAgCmB,MAAhC,EAAwCpT,CAAxC,EAA2C;EACvC,mBAAO,UAAUqT,MAAV,EAAkB;EACrB,uBAAOrT,EAAE5G,GAAF,CAAM,UAAU4G,CAAV,EAAa;EACtB,2BAAO,EAACA,GAAEA,CAAH,EAAMtD,GAAE/D,SAAA,CAAQ0a,MAAR,EAAgB,UAAUC,CAAV,EAAa;EAAC,mCAAOF,OAAOpT,IAAIsT,CAAX,CAAP;EAAsB,yBAApD,CAAR,EAAP;EACH,iBAFM,CAAP;EAGH,aAJD;EAKH;;EAED,iBAASpB,OAAT,CAAiBlZ,KAAjB,EAAwB;EACpB,mBAAO,UAAUua,CAAV,EAAa;EAChB,uBAAOtU,KAAKyK,GAAL,CAAS6J,KAAKva,KAAd,KAAwB,CAAxB,GAA4B,OAAO,IAAIua,IAAIA,CAAf,IAAoBva,KAAhD,GAAwD,CAA/D;EACH,aAFD;EAGH;;EAED;EACA;EACA,iBAASwZ,WAAT,CAAqBY,MAArB,EAA6BI,KAA7B,EAAoC;EAChC,mBAAO,UAAUC,KAAV,EAAiB;EACpB,uBAAO9a,SAAA,CAAQ6a,KAAR,EAAe,UAAUF,CAAV,EAAa;EAAC,2BAAOF,OAAOK,QAAQH,CAAf,CAAP;EAA0B,iBAAvD,CAAP;EACH,aAFD;EAGH;;EAEDzb,cAAMiZ,WAAN,CAAkBY,aAAlB;;EAEA/Y,mBAAA,CAAU8I,MAAV,EAAkBpE,EAAlB,CAAqB,YAAYxF,MAAM0M,QAAlB,GAA6B,aAAlD,EAAiE1M,MAAMiZ,WAAN,CAAkB9S,MAAnF;EACAnG,cAAMiZ,WAAN,CAAkB9S,MAAlB;EACA,eAAOnG,KAAP;EACH,KA/RD;;EAiSA;;;;;;;;;;;;;;;;;EAiBAA,UAAM6b,aAAN,GAAsB,UAAUrK,OAAV,EAAmB;EACrCxR,cAAM8b,QAAN,GAAiB,EAAjB;;EAEA;EACA,YAAIzC,iBAAiB;EACjB5T,kBAAM,IADW;EAEjBsW,qBAAS,IAFQ;EAGjBC,0BAAc,IAHG;EAIjBC,wBAAY,IAJK;EAKjBC,sBAAU,KALO;EAMjBC,yBAAa,GANI;EAOjBC,0BAAc,IAPG;EAQjBC,sBAAU,EARO;EASjBC,uBAAW,IATM;EAUjBC,6BAAiB,KAVA;EAWjBC,0BAAc,GAXG;EAYjBxM,oBAAQhQ,MAAMuV;EAZG,SAArB;EAcAvV,cAAM8b,QAAN,CAAetK,OAAf,GAAyB+E,YAAY8C,cAAZ,CAAzB;EACA,aAAK,IAAII,MAAT,IAAmBjI,OAAnB,EAA4B;EACxBxR,kBAAM8b,QAAN,CAAetK,OAAf,CAAuBiI,MAAvB,IAAiCjI,QAAQiI,MAAR,CAAjC;EACH;EACD,YAAIgD,QAAQzc,MAAM8b,QAAN,CAAetK,OAA3B;;EAEA;EACA,aAAK,IAAI8G,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/BlV,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBoE,OAAvB,GAAiC,EAAjC;EACA1c,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBoE,OAAvB,CAA+BvH,IAA/B,GAAsC,EAAtC;EACH;;EAGD;;;EAGA,SAAC,SAASwH,eAAT,GAA2B;;EAExB;;;;;EAKA,qBAASC,YAAT,CAAsBC,MAAtB,EAA8B;EAC1B,oBAAIC,YAAY,EAAhB;EACA,oBAAIC,YAAY,EAAhB;EACA,oBAAIC,IAAJ,EAAUC,GAAV;EACA,qBAAKA,MAAM,CAAX,EAAcA,OAAOJ,OAAOvO,MAAP,CAActK,MAAnC,EAA2CiZ,KAA3C,EAAkD;EAC9CD,2BAAO,EAAC7Z,OAAO0Z,OAAOvO,MAAP,CAAc2O,GAAd,CAAR,EAAP;;EAEA,wBAAID,KAAK7Z,KAAL,GAAa0Z,OAAOjG,OAAP,CAAegB,eAAhC,EAAiD;EAC7C,4BAAIoF,KAAK7Z,KAAL,GAAa0Z,OAAOjG,OAAP,CAAeiB,eAAhC,EAAiD;EAC7CiF,sCAAU1X,IAAV,CAAe4X,IAAf;EACH,yBAFD,MAEO;EACHD,sCAAU3X,IAAV,CAAe4X,IAAf;EACH;EACJ,qBAND,MAMO,IAAIA,KAAK7Z,KAAL,GAAa0Z,OAAOjG,OAAP,CAAec,eAAhC,EAAiD;EACpD,4BAAIsF,KAAK7Z,KAAL,GAAa0Z,OAAOjG,OAAP,CAAea,eAAhC,EAAiD;EAC7CqF,sCAAU1X,IAAV,CAAe4X,IAAf;EACH,yBAFD,MAEO;EACHD,sCAAU3X,IAAV,CAAe4X,IAAf;EACH;EACJ;EACJ;EACDH,uBAAOH,OAAP,CAAevH,IAAf,CAAoB+H,QAApB,GAA+BH,SAA/B;EACAF,uBAAOH,OAAP,CAAevH,IAAf,CAAoBgI,QAApB,GAA+BL,SAA/B;EACH;;EAED,iBAAK,IAAIxE,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/B0H,6BAAa5c,MAAMkV,SAAN,CAAgBoD,KAAhB,CAAb;EACH;EACJ,SAnCA,EAAD;;EAqCA;;;;EAIAtY,cAAM8b,QAAN,CAAerJ,MAAf,GAAwB,UAAUmH,aAAV,EAAyB;EAC7C,gBAAIA,aAAJ,EAAmB;EACf,qBAAK,IAAIjE,GAAT,IAAgBiE,aAAhB,EAA+B;EAC3B6C,0BAAM9G,GAAN,IAAaiE,cAAcjE,GAAd,CAAb;EACH;EACJ;;EAED,iBAAK,IAAI2C,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/BlV,sBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBoE,OAAvB,CAA+BvH,IAA/B,CAAoCG,CAApC,CAAsCtN,MAAtC;EACH;EACDhI,kBAAM8b,QAAN,CAAesB,cAAf;EACApd,kBAAM8b,QAAN,CAAe3V,MAAf;EACH,SAZD;;EAcAnG,cAAM8b,QAAN,CAAehC,KAAf,GAAuB,YAAY;EAC/B9Z,kBAAM8b,QAAN,CAAerJ,MAAf,CAAsB4G,cAAtB;EACH,SAFD;EAGArZ,cAAM8b,QAAN,CAAerW,IAAf,GAAsB,UAAUsU,IAAV,EAAgB;EAClC,gBAAIA,SAASnY,SAAb,EAAwB;EACpBmY,qBAAKtU,IAAL,GAAY,IAAZ;EACA,oBAAIsU,KAAKD,KAAT,EAAgB;EACZ9Z,0BAAM8b,QAAN,CAAehC,KAAf;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAACtU,MAAM,IAAP,EAAP;EACH;EACDzF,kBAAM8b,QAAN,CAAerJ,MAAf,CAAsBsH,IAAtB;EAEH,SAXD;EAYA/Z,cAAM8b,QAAN,CAAepW,IAAf,GAAsB,UAAUqU,IAAV,EAAgB;EAClC,gBAAIA,SAASnY,SAAb,EAAwB;EACpBmY,qBAAKtU,IAAL,GAAY,KAAZ;EACA,oBAAIsU,KAAKD,KAAT,EAAgB;EACZ9Z,0BAAM8b,QAAN,CAAehC,KAAf;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAACtU,MAAM,KAAP,EAAP;EACH;EACDzF,kBAAM8b,QAAN,CAAerJ,MAAf,CAAsBsH,IAAtB;EACH,SAVD;;EAYA;;;EAGA/Z,cAAM8b,QAAN,CAAe3V,MAAf,GAAwB,YAAY;EAChC,gBAAImS,KAAJ,EAAW+E,QAAX;;EAEA,iBAAK/E,KAAL,IAActY,MAAMkV,SAApB,EAA+B;EAC3BmI,2BAAWrd,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBoE,OAAlC;;EAEA;EACA,oBAAIzB,YAAYpF,YAAY4G,MAAMJ,QAAlB,EAA4B/D,KAA5B,CAAhB;EACA,oBAAInY,QAAS8a,UAAU9Q,KAAV,GAAkB8Q,UAAU/Q,IAAzC;;EAEA,oBAAIoT,WAAW,EAAf,CAP2B;EAQ3B,qBAAK,IAAIxY,IAAT,IAAiB9E,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAxC,EAAiD;EAC7C0G,6BAASxY,IAAT,IAAiB,IAAjB;EACAwY,6BAASxY,IAAT,IAAiB9E,MAAM6Y,MAAN,CAAa7Y,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAAvB,CAA+B9R,IAA/B,CAAb,CAAjB;EACH;;EAED;EACA,oBAAIuY,SAASlI,IAAT,CAAcoI,GAAlB,EAAuB;EACnBF,6BAASlI,IAAT,CAAcoI,GAAd,CACKzY,IADL,CACU,GADV,EACemW,UAAU/Q,IADzB,EAEKpF,IAFL,CAEU,OAFV,EAEmB3E,KAFnB,EAGK2E,IAHL,CAGU,GAHV,EAGewY,SAASpG,SAHxB,EAIKpS,IAJL,CAIU,IAJV,EAIgB,CAJhB,EAKKA,IALL,CAKU,IALV,EAKgB,CALhB,EAMKA,IANL,CAMU,QANV,EAMoB,CAACwY,SAASpG,SAAV,GAAsBoG,SAASlG,SANnD;EAOH;;EAED;EACA,oBAAIoG,aAAa,IAAjB;EACA,oBAAIf,MAAMH,SAAV,EAAqB;EACjBkB,iCAAa3H,YAAY4G,MAAMH,SAAlB,EAA6BhE,KAA7B,CAAb;EACH,iBAFD,MAEO;EACHkF,iCAAavC,SAAb;EACH;EACD;EACA,oBAAIoC,SAASlI,IAAT,CAAcsI,YAAlB,EAAgC;EAC5BJ,6BAASlI,IAAT,CAAcsI,YAAd,CAA2BC,KAA3B,CACK5Y,IADL,CACU,IADV,EACgB0Y,WAAWtT,IAD3B,EAEKpF,IAFL,CAEU,IAFV,EAEgB0Y,WAAWrT,KAF3B,EAGKrF,IAHL,CAGU,IAHV,EAGgBwY,SAAS5F,eAHzB,EAIK5S,IAJL,CAIU,IAJV,EAIgBwY,SAAS5F,eAJzB;EAKA2F,6BAASlI,IAAT,CAAcsI,YAAd,CAA2B/Y,IAA3B,CACKI,IADL,CACU,IADV,EACgB0Y,WAAWvH,MAD3B,EAEKnR,IAFL,CAEU,IAFV,EAEgB0Y,WAAWvH,MAF3B,EAGKnR,IAHL,CAGU,IAHV,EAGgBwY,SAASpG,SAHzB,EAIKpS,IAJL,CAIU,IAJV,EAIgBwY,SAAS5F,eAJzB;;EAMA2F,6BAASlI,IAAT,CAAcwI,YAAd,CAA2BD,KAA3B,CACK5Y,IADL,CACU,IADV,EACgB0Y,WAAWtT,IAD3B,EAEKpF,IAFL,CAEU,IAFV,EAEgB0Y,WAAWrT,KAF3B,EAGKrF,IAHL,CAGU,IAHV,EAGgBwY,SAAS1F,eAHzB,EAIK9S,IAJL,CAIU,IAJV,EAIgBwY,SAAS1F,eAJzB;EAKAyF,6BAASlI,IAAT,CAAcwI,YAAd,CAA2BjZ,IAA3B,CACKI,IADL,CACU,IADV,EACgB0Y,WAAWvH,MAD3B,EAEKnR,IAFL,CAEU,IAFV,EAEgB0Y,WAAWvH,MAF3B,EAGKnR,IAHL,CAGU,IAHV,EAGgBwY,SAASlG,SAHzB,EAIKtS,IAJL,CAIU,IAJV,EAIgBwY,SAAS1F,eAJzB;EAKH;;EAED;EACA,oBAAIyF,SAASlI,IAAT,CAAcgC,MAAlB,EAA0B;EACtBkG,6BAASlI,IAAT,CAAcgC,MAAd,CAAqBzS,IAArB,CACKI,IADL,CACU,IADV,EACgB0Y,WAAWtT,IAD3B,EAEKpF,IAFL,CAEU,IAFV,EAEgB0Y,WAAWrT,KAF3B,EAGKrF,IAHL,CAGU,IAHV,EAGgBwY,SAASnG,MAHzB,EAIKrS,IAJL,CAIU,IAJV,EAIgBwY,SAASnG,MAJzB;EAKAkG,6BAASlI,IAAT,CAAcgC,MAAd,CAAqByG,MAArB,CACK9Y,IADL,CACU,IADV,EACgB0Y,WAAWvH,MAD3B,EAEKnR,IAFL,CAEU,IAFV,EAEgBwY,SAASnG,MAFzB;EAGH;;EAED;EACA,oBAAIkG,SAASlI,IAAT,CAAc7R,IAAlB,EAAwB;EACpB+Z,6BAASlI,IAAT,CAAc7R,IAAd,CAAmBoB,IAAnB,CACKI,IADL,CACU,IADV,EACgB0Y,WAAWtT,IAD3B,EAEKpF,IAFL,CAEU,IAFV,EAEgB0Y,WAAWrT,KAF3B,EAGKrF,IAHL,CAGU,IAHV,EAGgBwY,SAASha,IAHzB,EAIKwB,IAJL,CAIU,IAJV,EAIgBwY,SAASha,IAJzB;EAKA+Z,6BAASlI,IAAT,CAAc7R,IAAd,CAAmBsa,MAAnB,CACK9Y,IADL,CACU,IADV,EACgB0Y,WAAWvH,MAD3B,EAEKnR,IAFL,CAEU,IAFV,EAEgBwY,SAASha,IAFzB;EAGH;;EAED;;EAEA,oBAAIua,EAAJ;EACA,oBAAIR,SAASlI,IAAT,CAAc+H,QAAlB,EAA4B;EACxB,yBAAKW,EAAL,IAAWR,SAASlI,IAAT,CAAc+H,QAAzB,EAAmC;EAC/BG,iCAASlI,IAAT,CAAc+H,QAAd,CAAuBW,EAAvB,EAA2BC,KAA3B,CACKhZ,IADL,CACU,IADV,EACgBmW,UAAUhF,MAAV,GAAmBG,UAAUqG,MAAMF,eAAhB,EAAiCpc,KAAjC,CADnC,EAEK2E,IAFL,CAEU,IAFV,EAEgB9E,MAAM6Y,MAAN,CAAawE,SAASlI,IAAT,CAAc+H,QAAd,CAAuBW,EAAvB,EAA2B1a,KAAxC,CAFhB;EAGH;EACJ;EACD,oBAAIka,SAASlI,IAAT,CAAcgI,QAAlB,EAA4B;EACxB,yBAAKU,EAAL,IAAWR,SAASlI,IAAT,CAAcgI,QAAzB,EAAmC;EAC/BE,iCAASlI,IAAT,CAAcgI,QAAd,CAAuBU,EAAvB,EAA2BC,KAA3B,CACKhZ,IADL,CACU,IADV,EACgBmW,UAAUhF,MAAV,GAAmBG,UAAUqG,MAAMF,eAAhB,EAAiCpc,KAAjC,CADnC,EAEK2E,IAFL,CAEU,IAFV,EAEgB9E,MAAM6Y,MAAN,CAAawE,SAASlI,IAAT,CAAcgI,QAAd,CAAuBU,EAAvB,EAA2B1a,KAAxC,CAFhB;EAGH;EACJ;EACJ;EACJ,SArGD;;EAuGA;;;EAGAnD,cAAM8b,QAAN,CAAesB,cAAf,GAAgC,YAAY;EACxC,gBAAI9E,KAAJ,EAAW+E,QAAX;;EAEA,gBAAIZ,MAAMzM,MAAV,EAAkB;EACdhQ,sBAAM8b,QAAN,CAAevG,UAAf,GAA4BC,cAAciH,MAAMzM,MAApB,CAA5B;EACH,aAFD,MAEO;EACHhQ,sBAAM8b,QAAN,CAAevG,UAAf,GAA4BvV,MAAMuV,UAAlC;EACH;;EAED,gBAAIkH,MAAMhX,IAAN,IAAc,KAAlB,EAAyB;EACrB;EACH;;EAED,iBAAK6S,KAAL,IAActY,MAAMkV,SAApB,EAA+B;EAC3BmI,2BAAWrd,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBoE,OAAlC;;EAEAW,yBAASlI,IAAT,CAAcG,CAAd,GAAkBtV,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhD,CAAvB,CAAyBpQ,MAAzB,CAAgC,GAAhC,EAAqCJ,IAArC,CAA0C,OAA1C,EAAmD,UAAnD,CAAlB;;EAEA;EACA,oBAAI2X,MAAMV,OAAV,EAAmB;EACfsB,6BAASlI,IAAT,CAAcoI,GAAd,GAAoBF,SAASlI,IAAT,CAAcG,CAAd,CAAgBpQ,MAAhB,CAAuB,MAAvB,EACfJ,IADe,CACV,OADU,EACD,KADC,EAEfvE,KAFe,CAET,MAFS,EAEDP,MAAM8b,QAAN,CAAevG,UAAf,CAA0B+C,KAA1B,CAFC,EAGf/X,KAHe,CAGT,QAHS,EAGCP,MAAM8b,QAAN,CAAevG,UAAf,CAA0B+C,KAA1B,CAHD,CAApB;EAIA;EACA;EACH;;EAED;EACA,oBAAImE,MAAMR,UAAV,EAAsB;EAClBoB,6BAASlI,IAAT,CAAcgC,MAAd,GAAuB,EAACzS,MAAM,IAAP,EAAakZ,QAAQ,IAArB,EAAvB;EACAP,6BAASlI,IAAT,CAAcgC,MAAd,CAAqBzS,IAArB,GAA4B2Y,SAASlI,IAAT,CAAcG,CAAd,CAAgBpQ,MAAhB,CAAuB,MAAvB,EACvBJ,IADuB,CAClB,OADkB,EACT,QADS,CAA5B;EAEAuY,6BAASlI,IAAT,CAAcgC,MAAd,CAAqByG,MAArB,GAA8BP,SAASlI,IAAT,CAAcG,CAAd,CAAgBpQ,MAAhB,CAAuB,QAAvB,EACzBJ,IADyB,CACpB,OADoB,EACX,QADW,EAEzBA,IAFyB,CAEpB,GAFoB,EAEf2X,MAAMN,WAFS,EAGzB5b,KAHyB,CAGnB,MAHmB,EAGXP,MAAM8b,QAAN,CAAevG,UAAf,CAA0B+C,KAA1B,CAHW,EAIzB9S,EAJyB,CAItB,WAJsB,EAIT,YAAY;EACzBxF,8BAAMmV,IAAN,CAAW9Q,OAAX,CACK9D,KADL,CACW,SADX,EACsB,IADtB,EAEKA,KAFL,CAEW,MAFX,EAEoBO,UAAA,CAASid,KAAV,GAAmB,IAFtC,EAGKxd,KAHL,CAGW,KAHX,EAGmBO,UAAA,CAASkd,KAAT,GAAiB,EAAlB,GAAwB,IAH1C;EAIH,qBATyB,EASvBxY,EATuB,CASpB,UAToB,EASR,YAAY;EAC5BxF,8BAAMmV,IAAN,CAAW9Q,OAAX,CAAmB9D,KAAnB,CAAyB,SAAzB,EAAoC,MAApC;EACD,qBAXyB,EAWvBiF,EAXuB,CAWpB,WAXoB,EAWPkR,aAAa4B,KAAb,EAAoBtY,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAA3C,EAAoD,EAApD,EAAwD,EAAxD,EAA4D,QAA5D,CAXO,CAA9B;EAYH;;EAED;EACA,oBAAI6F,MAAMP,QAAV,EAAoB;EAChBmB,6BAASlI,IAAT,CAAc7R,IAAd,GAAqB,EAACoB,MAAM,IAAP,EAAakZ,QAAQ,IAArB,EAArB;EACAP,6BAASlI,IAAT,CAAc7R,IAAd,CAAmBoB,IAAnB,GAA0B2Y,SAASlI,IAAT,CAAcG,CAAd,CAAgBpQ,MAAhB,CAAuB,MAAvB,EACrBJ,IADqB,CAChB,OADgB,EACP,MADO,CAA1B;EAEAuY,6BAASlI,IAAT,CAAc7R,IAAd,CAAmBsa,MAAnB,GAA4BP,SAASlI,IAAT,CAAcG,CAAd,CAAgBpQ,MAAhB,CAAuB,QAAvB,EACvBJ,IADuB,CAClB,OADkB,EACT,MADS,EAEvBA,IAFuB,CAElB,GAFkB,EAEb2X,MAAMN,WAFO,EAGvB5b,KAHuB,CAGjB,MAHiB,EAGTP,MAAM8b,QAAN,CAAevG,UAAf,CAA0B+C,KAA1B,CAHS,EAIvB9S,EAJuB,CAIpB,WAJoB,EAIP,YAAY;EACzBxF,8BAAMmV,IAAN,CAAW9Q,OAAX,CACK9D,KADL,CACW,SADX,EACsB,IADtB,EAEKA,KAFL,CAEW,MAFX,EAEoBO,UAAA,CAASid,KAAV,GAAmB,IAFtC,EAGKxd,KAHL,CAGW,KAHX,EAGmBO,UAAA,CAASkd,KAAT,GAAiB,EAAlB,GAAwB,IAH1C;EAIH,qBATuB,EASrBxY,EATqB,CASlB,UATkB,EASN,YAAY;EAC5BxF,8BAAMmV,IAAN,CAAW9Q,OAAX,CAAmB9D,KAAnB,CAAyB,SAAzB,EAAoC,MAApC;EACD,qBAXuB,EAWrBiF,EAXqB,CAWlB,WAXkB,EAWLkR,aAAa4B,KAAb,EAAoBtY,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAA3C,EAAoD,EAApD,EAAwD,EAAxD,EAA4D,MAA5D,CAXK,CAA5B;EAYH;;EAED;EACA,oBAAI6F,MAAMT,YAAV,EAAwB;EACpBqB,6BAASlI,IAAT,CAAcsI,YAAd,GAA6B,EAACC,OAAO,IAAR,EAAchZ,MAAM,IAApB,EAA7B;EACA2Y,6BAASlI,IAAT,CAAcwI,YAAd,GAA6B,EAACD,OAAO,IAAR,EAAchZ,MAAM,IAApB,EAA7B;EACA2Y,6BAASlI,IAAT,CAAcsI,YAAd,CAA2BC,KAA3B,GAAmCL,SAASlI,IAAT,CAAcG,CAAd,CAAgBpQ,MAAhB,CAAuB,MAAvB,EAC9BJ,IAD8B,CACzB,OADyB,EAChB,eADgB,EAE9BvE,KAF8B,CAExB,QAFwB,EAEdP,MAAM8b,QAAN,CAAevG,UAAf,CAA0B+C,KAA1B,CAFc,CAAnC;EAGA+E,6BAASlI,IAAT,CAAcsI,YAAd,CAA2B/Y,IAA3B,GAAkC2Y,SAASlI,IAAT,CAAcG,CAAd,CAAgBpQ,MAAhB,CAAuB,MAAvB,EAC7BJ,IAD6B,CACxB,OADwB,EACf,eADe,EAE7BvE,KAF6B,CAEvB,QAFuB,EAEbP,MAAM8b,QAAN,CAAevG,UAAf,CAA0B+C,KAA1B,CAFa,CAAlC;;EAIA+E,6BAASlI,IAAT,CAAcwI,YAAd,CAA2BD,KAA3B,GAAmCL,SAASlI,IAAT,CAAcG,CAAd,CAAgBpQ,MAAhB,CAAuB,MAAvB,EAC9BJ,IAD8B,CACzB,OADyB,EAChB,eADgB,EAE9BvE,KAF8B,CAExB,QAFwB,EAEdP,MAAM8b,QAAN,CAAevG,UAAf,CAA0B+C,KAA1B,CAFc,CAAnC;EAGA+E,6BAASlI,IAAT,CAAcwI,YAAd,CAA2BjZ,IAA3B,GAAkC2Y,SAASlI,IAAT,CAAcG,CAAd,CAAgBpQ,MAAhB,CAAuB,MAAvB,EAC7BJ,IAD6B,CACxB,OADwB,EACf,eADe,EAE7BvE,KAF6B,CAEvB,QAFuB,EAEbP,MAAM8b,QAAN,CAAevG,UAAf,CAA0B+C,KAA1B,CAFa,CAAlC;EAGH;;EAED;EACA,oBAAImE,MAAML,YAAV,EAAwB;EACpB,wBAAI,CAACiB,SAASlI,IAAT,CAAc+H,QAAnB,EAA6BP;EAC7B,wBAAIkB,EAAJ;EACA,wBAAIR,SAASlI,IAAT,CAAc+H,QAAd,CAAuBlZ,MAA3B,EAAmC;EAC/B,4BAAIia,SAASZ,SAASlI,IAAT,CAAcG,CAAd,CAAgBpQ,MAAhB,CAAuB,GAAvB,EAA4BJ,IAA5B,CAAiC,OAAjC,EAA0C,kBAA1C,CAAb;EACA,6BAAK+Y,EAAL,IAAWR,SAASlI,IAAT,CAAc+H,QAAzB,EAAmC;EAC/BG,qCAASlI,IAAT,CAAc+H,QAAd,CAAuBW,EAAvB,EAA2BC,KAA3B,GAAmCG,OAAO/Y,MAAP,CAAc,QAAd,EAC9BJ,IAD8B,CACzB,OADyB,EAChB,SADgB,EAE9BA,IAF8B,CAEzB,GAFyB,EAEpB2X,MAAMD,YAFc,EAG9Bjc,KAH8B,CAGxB,MAHwB,EAGhBP,MAAM8b,QAAN,CAAevG,UAAf,CAA0B+C,KAA1B,CAHgB,CAAnC;EAIH;EACJ;;EAED,wBAAI+E,SAASlI,IAAT,CAAcgI,QAAd,CAAuBnZ,MAA3B,EAAmC;EAC/B,4BAAIka,SAASb,SAASlI,IAAT,CAAcG,CAAd,CAAgBpQ,MAAhB,CAAuB,GAAvB,EAA4BJ,IAA5B,CAAiC,OAAjC,EAA0C,kBAA1C,CAAb;EACA,6BAAK+Y,EAAL,IAAWR,SAASlI,IAAT,CAAcgI,QAAzB,EAAmC;EAC/BE,qCAASlI,IAAT,CAAcgI,QAAd,CAAuBU,EAAvB,EAA2BC,KAA3B,GAAmCI,OAAOhZ,MAAP,CAAc,QAAd,EAC9BJ,IAD8B,CACzB,OADyB,EAChB,SADgB,EAE9BA,IAF8B,CAEzB,GAFyB,EAEpB2X,MAAMD,YAFc,EAG9Bjc,KAH8B,CAGxB,QAHwB,EAGdP,MAAM8b,QAAN,CAAevG,UAAf,CAA0B+C,KAA1B,CAHc,CAAnC;EAIH;EACJ;EACJ;EAGJ;EACJ,SAhHD;EAiHAtY,cAAM8b,QAAN,CAAesB,cAAf;;EAEAtc,mBAAA,CAAU8I,MAAV,EAAkBpE,EAAlB,CAAqB,YAAYxF,MAAM0M,QAAlB,GAA6B,UAAlD,EAA8D1M,MAAM8b,QAAN,CAAe3V,MAA7E;EACAnG,cAAM8b,QAAN,CAAe3V,MAAf;EACA,eAAOnG,KAAP;EAEH,KAxVD;;EA0VA;;;;;;;;;;;;;EAaAA,UAAMme,gBAAN,GAAyB,UAAU3M,OAAV,EAAmB;EACxCxR,cAAMoe,UAAN,GAAmB,EAAnB;;EAEA;EACA,YAAI/E,iBAAiB;EACjB5T,kBAAM,IADW;EAEjB4Y,0BAAc,IAFG;EAGjBC,uBAAW,KAHM;EAIjBjC,sBAAU,EAJO;EAKjBkC,yBAAa,EALI;EAMjBjC,uBAAW,EANM;EAOjBkC,wBAAY,IAPK;EAQjBxO,oBAAQ;EARS,SAArB;EAUAhQ,cAAMoe,UAAN,CAAiB5M,OAAjB,GAA2B+E,YAAY8C,cAAZ,CAA3B;EACA,aAAK,IAAII,MAAT,IAAmBjI,OAAnB,EAA4B;EACxBxR,kBAAMoe,UAAN,CAAiB5M,OAAjB,CAAyBiI,MAAzB,IAAmCjI,QAAQiI,MAAR,CAAnC;EACH;EACD,YAAIgF,QAAQze,MAAMoe,UAAN,CAAiB5M,OAA7B;;EAEA;EACA,aAAK,IAAI8G,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/BlV,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBoG,QAAvB,GAAkC,EAAlC;EACA1e,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBoG,QAAvB,CAAgCvJ,IAAhC,GAAuC,EAAvC;EACH;;EAED;;;;;;EAMA,iBAASwJ,YAAT,CAAsBC,MAAtB,EAA8BC,WAA9B,EAA2C;EACvC,gBAAIC,eAAe,EAAnB;EACA,gBAAIL,MAAMD,UAAN,IAAoB,KAAxB,EAA+B;EAC3BM,+BAAe,CACX,CAACD,YAAYE,OAAb,EAAsB/e,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeQ,SAA5B,CAAtB,CADW,EAEX,CAACyH,YAAYE,OAAb,EAAsB/e,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeoI,UAA5B,CAAtB,CAFW,EAGX,CAACH,YAAYI,UAAb,EAAyBjf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeoI,UAA5B,CAAzB,CAHW,EAIX,CAACH,YAAYI,UAAb,EAAyBjf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeO,MAA5B,CAAzB,CAJW,EAKX,CAAC0H,YAAYI,UAAb,EAAyBjf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAesI,UAA5B,CAAzB,CALW,EAMX,CAACL,YAAYE,OAAb,EAAsB/e,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAesI,UAA5B,CAAtB,CANW,EAOX,CAACL,YAAYE,OAAb,EAAsB/e,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeM,SAA5B,CAAtB,CAPW,EAQX,CAAC2H,YAAYM,QAAb,EAAuBnf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeM,SAA5B,CAAvB,CARW,EASX,CAAC2H,YAAYM,QAAb,EAAuBnf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAesI,UAA5B,CAAvB,CATW,EAUX,CAACL,YAAYO,WAAb,EAA0Bpf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAesI,UAA5B,CAA1B,CAVW,EAWX,CAACL,YAAYO,WAAb,EAA0Bpf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeO,MAA5B,CAA1B,CAXW,EAYX,CAAC0H,YAAYO,WAAb,EAA0Bpf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeoI,UAA5B,CAA1B,CAZW,EAaX,CAACH,YAAYM,QAAb,EAAuBnf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeoI,UAA5B,CAAvB,CAbW,EAcX,CAACH,YAAYM,QAAb,EAAuBnf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeQ,SAA5B,CAAvB,CAdW,CAAf;EAgBH,aAjBD,MAiBO;EACH0H,+BAAe,CACX,CAACD,YAAYE,OAAb,EAAsB/e,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeQ,SAA5B,CAAtB,CADW,EAEX,CAACyH,YAAYE,OAAb,EAAsB/e,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeoI,UAA5B,CAAtB,CAFW,EAGX,CAACH,YAAYI,UAAb,EAAyBjf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeO,MAA5B,CAAzB,CAHW,EAIX,CAAC0H,YAAYE,OAAb,EAAsB/e,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAesI,UAA5B,CAAtB,CAJW,EAKX,CAACL,YAAYE,OAAb,EAAsB/e,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeM,SAA5B,CAAtB,CALW,EAMX,CAAC2H,YAAYM,QAAb,EAAuBnf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeM,SAA5B,CAAvB,CANW,EAOX,CAAC2H,YAAYM,QAAb,EAAuBnf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAesI,UAA5B,CAAvB,CAPW,EAQX,CAACL,YAAYO,WAAb,EAA0Bpf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeO,MAA5B,CAA1B,CARW,EASX,CAAC0H,YAAYM,QAAb,EAAuBnf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeoI,UAA5B,CAAvB,CATW,EAUX,CAACH,YAAYM,QAAb,EAAuBnf,MAAM6Y,MAAN,CAAa+F,OAAOhI,OAAP,CAAeQ,SAA5B,CAAvB,CAVW,CAAf;EAYH;EACD,mBAAO0H,aAAavd,GAAb,CAAiB,UAAUC,CAAV,EAAa;EACjC,uBAAO,CAACA,EAAE,CAAF,CAAD,EAAOA,EAAE,CAAF,CAAP,EAAa6D,IAAb,CAAkB,GAAlB,CAAP;EACH,aAFM,EAEJA,IAFI,CAEC,GAFD,CAAP;EAGH;;EAED;;;EAGA,SAAC,SAASga,WAAT,GAAuB;EACpB,gBAAIT,MAAJ,EAAYU,QAAZ;EACA,iBAAK,IAAIhH,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/B0J,yBAAS5e,MAAMkV,SAAN,CAAgBoD,KAAhB,CAAT;EACAgH,2BAAY,QAAQV,OAAOhI,OAAP,CAAee,GAAf,GAAqBvQ,KAAKmY,IAAL,CAAUX,OAAOtQ,MAAP,CAActK,MAAxB,CAA7B,CAAZ;EACA4a,uBAAOhI,OAAP,CAAesI,UAAf,GAA4BN,OAAOhI,OAAP,CAAeO,MAAf,GAAwBmI,QAApD;EACAV,uBAAOhI,OAAP,CAAeoI,UAAf,GAA4BJ,OAAOhI,OAAP,CAAeO,MAAf,GAAwBmI,QAApD;EACH;EACJ,SARA,EAAD;;EAUA;;;;EAIAtf,cAAMoe,UAAN,CAAiB3L,MAAjB,GAA0B,UAAUmH,aAAV,EAAyB;EAC/C,gBAAIA,aAAJ,EAAmB;EACf,qBAAK,IAAIjE,GAAT,IAAgBiE,aAAhB,EAA+B;EAC3B6E,0BAAM9I,GAAN,IAAaiE,cAAcjE,GAAd,CAAb;EACH;EACJ;;EAED,iBAAK,IAAI2C,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/BlV,sBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBoG,QAAvB,CAAgCvJ,IAAhC,CAAqCG,CAArC,CAAuCtN,MAAvC;EACH;EACDhI,kBAAMoe,UAAN,CAAiBoB,iBAAjB;EACAxf,kBAAMoe,UAAN,CAAiBjY,MAAjB;EACH,SAZD;;EAcAnG,cAAMoe,UAAN,CAAiBtE,KAAjB,GAAyB,YAAY;EACjC9Z,kBAAMoe,UAAN,CAAiB3L,MAAjB,CAAwB4G,cAAxB;EACH,SAFD;EAGArZ,cAAMoe,UAAN,CAAiB3Y,IAAjB,GAAwB,UAAUsU,IAAV,EAAgB;EACpC,gBAAIA,SAASnY,SAAb,EAAwB;EACpBmY,qBAAKtU,IAAL,GAAY,IAAZ;EACA,oBAAIsU,KAAKD,KAAT,EAAgB;EACZ9Z,0BAAMoe,UAAN,CAAiBtE,KAAjB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAACtU,MAAM,IAAP,EAAP;EACH;EACDzF,kBAAMoe,UAAN,CAAiB3L,MAAjB,CAAwBsH,IAAxB;EACH,SAVD;EAWA/Z,cAAMoe,UAAN,CAAiB1Y,IAAjB,GAAwB,UAAUqU,IAAV,EAAgB;EACpC,gBAAIA,SAASnY,SAAb,EAAwB;EACpBmY,qBAAKtU,IAAL,GAAY,KAAZ;EACA,oBAAIsU,KAAKD,KAAT,EAAgB;EACZ9Z,0BAAMoe,UAAN,CAAiBtE,KAAjB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAACtU,MAAM,KAAP,EAAP;EACH;EACDzF,kBAAMoe,UAAN,CAAiB3L,MAAjB,CAAwBsH,IAAxB;EACH,SAVD;;EAYA;;;EAGA/Z,cAAMoe,UAAN,CAAiBjY,MAAjB,GAA0B,YAAY;EAClC,gBAAImS,KAAJ,EAAWuE,MAAX;;EAEA,iBAAKvE,KAAL,IAActY,MAAMkV,SAApB,EAA+B;EAC3B2H,yBAAS7c,MAAMkV,SAAN,CAAgBoD,KAAhB,CAAT;;EAEA;EACA,oBAAImH,YAAY5J,YAAY4I,MAAMpC,QAAlB,EAA4B/D,KAA5B,CAAhB;EACA,oBAAIoH,eAAe7J,YAAY4I,MAAMF,WAAlB,EAA+BjG,KAA/B,CAAnB;;EAEA,oBAAIuG,cAAc;EACdE,6BAASU,UAAUvV,IADL;EAEdiV,8BAAUM,UAAUtV,KAFN;EAGd8L,4BAAQwJ,UAAUxJ,MAHJ;EAIdgJ,gCAAYS,aAAaxV,IAJX;EAKdkV,iCAAaM,aAAavV;EALZ,iBAAlB;;EAQA;EACA,oBAAI0S,OAAO6B,QAAP,CAAgBvJ,IAAhB,CAAqBwK,KAAzB,EAAgC;EAC5B9C,2BAAO6B,QAAP,CAAgBvJ,IAAhB,CAAqBwK,KAArB,CACK7a,IADL,CACU,QADV,EACoB6Z,aAAa9B,MAAb,EAAqBgC,WAArB,CADpB;EAEH;EACD,oBAAIhC,OAAO6B,QAAP,CAAgBvJ,IAAhB,CAAqByK,SAAzB,EAAoC;EAChC,wBAAIpC,aAAa,IAAjB;EACA,wBAAIiB,MAAMnC,SAAV,EAAqB;EACjBkB,qCAAa3H,YAAY4I,MAAMnC,SAAlB,EAA6BhE,KAA7B,CAAb;EACH,qBAFD,MAEO;EACHkF,qCAAavC,SAAb;EACH;;EAED,wBAAI4E,kBAAkB;EAClBC,+BAAO9f,MAAM6Y,MAAN,CAAagE,OAAOjG,OAAP,CAAesI,UAA5B,CADW;EAElBa,+BAAO/f,MAAM6Y,MAAN,CAAagE,OAAOjG,OAAP,CAAeoI,UAA5B;EAFW,qBAAtB;EAIAnC,2BAAO6B,QAAP,CAAgBvJ,IAAhB,CAAqByK,SAArB,CACK9a,IADL,CACU,IADV,EACgB0Y,WAAWtT,IAD3B,EAEKpF,IAFL,CAEU,IAFV,EAEgB0Y,WAAWrT,KAF3B,EAGKrF,IAHL,CAGU,IAHV,EAGgB+a,gBAAgBC,KAHhC,EAIKhb,IAJL,CAIU,IAJV,EAIgB+a,gBAAgBC,KAJhC;EAKAjD,2BAAO6B,QAAP,CAAgBvJ,IAAhB,CAAqB6K,SAArB,CACKlb,IADL,CACU,IADV,EACgB0Y,WAAWtT,IAD3B,EAEKpF,IAFL,CAEU,IAFV,EAEgB0Y,WAAWrT,KAF3B,EAGKrF,IAHL,CAGU,IAHV,EAGgB+a,gBAAgBE,KAHhC,EAIKjb,IAJL,CAIU,IAJV,EAIgB+a,gBAAgBE,KAJhC;EAKH;EACJ;EACJ,SA/CD;;EAiDA;;;EAGA/f,cAAMoe,UAAN,CAAiBoB,iBAAjB,GAAqC,YAAY;EAC7C,gBAAIlH,KAAJ,EAAWsG,MAAX;;EAEA,gBAAIH,SAASA,MAAMzO,MAAnB,EAA2B;EACvBhQ,sBAAMoe,UAAN,CAAiB7I,UAAjB,GAA8BC,cAAciJ,MAAMzO,MAApB,CAA9B;EACH,aAFD,MAEO;EACHhQ,sBAAMoe,UAAN,CAAiB7I,UAAjB,GAA8BvV,MAAMuV,UAApC;EACH;;EAED,gBAAIkJ,MAAMhZ,IAAN,IAAc,KAAlB,EAAyB;EACrB;EACH;;EAED,iBAAK6S,KAAL,IAActY,MAAMkV,SAApB,EAA+B;EAC3B0J,yBAAS5e,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBoG,QAAhC;;EAEAE,uBAAOzJ,IAAP,CAAYG,CAAZ,GAAgBtV,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhD,CAAvB,CAAyBpQ,MAAzB,CAAgC,GAAhC,EAAqCJ,IAArC,CAA0C,OAA1C,EAAmD,YAAnD,CAAhB;;EAEA;EACA,oBAAI2Z,MAAMJ,YAAV,EAAwB;EACpBO,2BAAOzJ,IAAP,CAAYwK,KAAZ,GAAoBf,OAAOzJ,IAAP,CAAYG,CAAZ,CAAcpQ,MAAd,CAAqB,SAArB,EACfJ,IADe,CACV,OADU,EACD,OADC,EAEfvE,KAFe,CAET,MAFS,EAEDP,MAAMoe,UAAN,CAAiB7I,UAAjB,CAA4B+C,KAA5B,CAFC,EAGf/X,KAHe,CAGT,QAHS,EAGCP,MAAMoe,UAAN,CAAiB7I,UAAjB,CAA4B+C,KAA5B,CAHD,CAApB;EAIA;EACA;EACH;;EAED;EACA,oBAAImG,MAAMH,SAAV,EAAqB;EACjBM,2BAAOzJ,IAAP,CAAYyK,SAAZ,GAAwBhB,OAAOzJ,IAAP,CAAYG,CAAZ,CAAcpQ,MAAd,CAAqB,MAArB,EACnBJ,IADmB,CACd,OADc,EACL,uBADK,EAEnBvE,KAFmB,CAEb,QAFa,EAEHP,MAAMoe,UAAN,CAAiB7I,UAAjB,CAA4B+C,KAA5B,CAFG,CAAxB;;EAIAsG,2BAAOzJ,IAAP,CAAY6K,SAAZ,GAAwBpB,OAAOzJ,IAAP,CAAYG,CAAZ,CAAcpQ,MAAd,CAAqB,MAArB,EACnBJ,IADmB,CACd,OADc,EACL,uBADK,EAEnBvE,KAFmB,CAEb,QAFa,EAEHP,MAAMoe,UAAN,CAAiB7I,UAAjB,CAA4B+C,KAA5B,CAFG,CAAxB;EAGH;EACJ;EACJ,SAvCD;EAwCAtY,cAAMoe,UAAN,CAAiBoB,iBAAjB;;EAEA1e,mBAAA,CAAU8I,MAAV,EAAkBpE,EAAlB,CAAqB,YAAYxF,MAAM0M,QAAlB,GAA6B,WAAlD,EAA+D1M,MAAMoe,UAAN,CAAiBjY,MAAhF;EACAnG,cAAMoe,UAAN,CAAiBjY,MAAjB;EACA,eAAOnG,KAAP;EACH,KAnOD;;EAqOA;;;;;;;;;;;;;;EAcAA,UAAMigB,eAAN,GAAwB,UAAUzO,OAAV,EAAmB;EACvCxR,cAAMkgB,SAAN,GAAkB,EAAlB;;EAGA;EACA,YAAI7G,iBAAiB;EACjB5T,kBAAM,IADW;EAEjB0a,sBAAU,KAFO;EAGjBC,sBAAU,MAHO;EAIjBC,uBAAW,CAJM;EAKjB/B,uBAAW,KALM;EAMjBgC,2BAAe,KANE;EAOjBC,uBAAW,EAPM;EAQjBvQ,oBAAQ;EARS,SAArB;EAUAhQ,cAAMkgB,SAAN,CAAgB1O,OAAhB,GAA0B+E,YAAY8C,cAAZ,CAA1B;EACA,aAAK,IAAII,MAAT,IAAmBjI,OAAnB,EAA4B;EACxBxR,kBAAMkgB,SAAN,CAAgB1O,OAAhB,CAAwBiI,MAAxB,IAAkCjI,QAAQiI,MAAR,CAAlC;EACH;EACD,YAAI+G,QAAQxgB,MAAMkgB,SAAN,CAAgB1O,OAA5B;;EAEA;EACA,aAAK,IAAI8G,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/BlV,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB4H,SAAvB,GAAmC,EAAnC;EACAlgB,kBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB4H,SAAvB,CAAiC/K,IAAjC,GAAwC,EAAxC;EACH;EACD;EACAnV,cAAMkgB,SAAN,CAAgB/K,IAAhB,GAAuB,EAAvB;;EAEA;;;;EAIAnV,cAAMkgB,SAAN,CAAgBzN,MAAhB,GAAyB,UAAUmH,aAAV,EAAyB;EAC9C,gBAAIA,aAAJ,EAAmB;EACf,qBAAK,IAAIjE,GAAT,IAAgBiE,aAAhB,EAA+B;EAC3B4G,0BAAM7K,GAAN,IAAaiE,cAAcjE,GAAd,CAAb;EACH;EACJ;;EAED3V,kBAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqBG,CAArB,CAAuBtN,MAAvB;EACA,iBAAK,IAAIsQ,KAAT,IAAkBtY,MAAMkV,SAAxB,EAAmC;EAC/BlV,sBAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB4H,SAAvB,CAAiC/K,IAAjC,CAAsCG,CAAtC,CAAwCtN,MAAxC;EACH;EACDhI,kBAAMkgB,SAAN,CAAgBO,YAAhB;EACAzgB,kBAAMkgB,SAAN,CAAgB/Z,MAAhB;EACH,SAbD;;EAeAnG,cAAMkgB,SAAN,CAAgBpG,KAAhB,GAAwB,YAAY;EAChC9Z,kBAAMkgB,SAAN,CAAgBzN,MAAhB,CAAuB4G,cAAvB;EACH,SAFD;EAGArZ,cAAMkgB,SAAN,CAAgBza,IAAhB,GAAuB,UAAUsU,IAAV,EAAgB;EACnC,gBAAIA,SAASnY,SAAb,EAAwB;EACpBmY,qBAAKtU,IAAL,GAAY,IAAZ;EACA,oBAAIsU,KAAKD,KAAT,EAAgB;EACZ9Z,0BAAMkgB,SAAN,CAAgBpG,KAAhB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAACtU,MAAM,IAAP,EAAP;EACH;EACDzF,kBAAMkgB,SAAN,CAAgBzN,MAAhB,CAAuBsH,IAAvB;EACH,SAVD;EAWA/Z,cAAMkgB,SAAN,CAAgBxa,IAAhB,GAAuB,UAAUqU,IAAV,EAAgB;EACnC,gBAAIA,SAASnY,SAAb,EAAwB;EACpBmY,qBAAKtU,IAAL,GAAY,KAAZ;EACA,oBAAIsU,KAAKD,KAAT,EAAgB;EACZ9Z,0BAAMkgB,SAAN,CAAgBpG,KAAhB;EACH;EACJ,aALD,MAKO;EACHC,uBAAO,EAACtU,MAAM,KAAP,EAAP;EACH;EACDzF,kBAAMkgB,SAAN,CAAgBzN,MAAhB,CAAuBsH,IAAvB;EACH,SAVD;;EAYA;;;EAGA/Z,cAAMkgB,SAAN,CAAgB/Z,MAAhB,GAAyB,YAAY;EACjC,gBAAImS,KAAJ,EAAWuE,MAAX,EAAmB6D,KAAnB;;EAEA;EACA,gBAAI1gB,MAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqBG,CAAzB,EAA4B;EACxB,oBAAIqL,WAAW3gB,MAAMkW,MAAN,CAAa9D,SAAb,KAA2B,CAA1C,CADwB;EAExB,qBAAK,IAAIwO,OAAT,IAAoB5gB,MAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqB0L,KAAzC,EAAgD;EAC5C7gB,0BAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqB0L,KAArB,CAA2BD,OAA3B,EAAoClc,IAApC,CACKyD,CADL,CACO,UAAU3G,CAAV,EAAa;EACZ,+BAAOxB,MAAMkW,MAAN,CAAa1U,EAAE2G,CAAf,IAAoBwY,QAA3B;EACH,qBAHL;EAIA3gB,0BAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqB0L,KAArB,CAA2BD,OAA3B,EAAoCtL,CAApC,CACKgG,KADL,CACWtb,MAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqB0L,KAArB,CAA2BD,OAA3B,EAAoCtS,MAD/C,EAEKxJ,IAFL,CAEU,GAFV,EAEe9E,MAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqB0L,KAArB,CAA2BD,OAA3B,EAAoClc,IAFnD;EAGH;EACJ;;EAGD,iBAAK4T,KAAL,IAActY,MAAMkV,SAApB,EAA+B;EAC3B2H,yBAAS7c,MAAMkV,SAAN,CAAgBoD,KAAhB,CAAT;EACAoI,wBAAQ7D,OAAOqD,SAAf;;EAEA,oBAAIQ,MAAMvL,IAAN,CAAWrR,MAAf,EAAuB;EACnB,wBAAI0c,MAAMJ,QAAN,IAAkB,UAAtB,EAAkC;EAC9B,4BAAIU,cAAcjL,YAAY,GAAZ,EAAiByC,KAAjB,CAAlB;EACA,4BAAIyI,WAAW/gB,MAAM6Y,MAAN,CAAaqB,IAAb,GACV7Y,KADU,CACJ,CAAC+F,KAAK2N,KAAL,CAAW/U,MAAM6Y,MAAN,CAAaxX,KAAb,GAAqB,CAArB,IAA0Bmf,MAAMH,SAA3C,CAAD,EAAwD,CAAxD,CADI,EAEVW,WAFU,CAEElgB,qBAFF,EAGVoB,MAHU,CAGHlC,MAAM6Y,MAAN,CAAa3W,MAAb,EAHG,CAAf;EAIA,4BAAI+e,WAAW7Z,KAAK2N,KAAL,CAAW/U,MAAMkW,MAAN,CAAa9D,SAAb,KAA2BoO,MAAMH,SAA5C,CAAf;EACA,4BAAIa,SAAS,EAAb;EACA,4BAAIC,WAAW,IAAf;EACA;EACA,6BAAK,IAAItD,KAAK,CAAd,EAAiBA,KAAKhB,OAAOvO,MAAP,CAActK,MAApC,EAA4C6Z,IAA5C,EAAkD;EAC9CsD,uCAAWJ,SAASlE,OAAOvO,MAAP,CAAcuP,EAAd,CAAT,CAAX;EACA,gCAAIqD,OAAOzR,cAAP,CAAsB0R,QAAtB,MAAoC,IAAxC,EAA8C;EAC1CD,uCAAOC,QAAP,IAAmB,EAAnB;EACH;EACDD,mCAAOC,QAAP,EAAiB/b,IAAjB,CAAsBsb,MAAMvL,IAAN,CAAWrR,MAAX,CAAkBsd,GAAlB,CAAsBvD,EAAtB,EACjB/Y,IADiB,CACZ,IADY,EACNgc,YAAY7K,MADN,EAEjBnR,IAFiB,CAEZ,IAFY,EAENic,SAASlE,OAAOvO,MAAP,CAAcuP,EAAd,CAAT,IAA8B2C,MAAMH,SAF9B,CAAtB;EAGH;EACD;EACA,4BAAIgB,WAAWja,KAAKO,GAAL,CAASmZ,YAAY3W,KAAZ,GAAoBqW,MAAMH,SAAnC,CAAf;EACA,6BAAK,IAAIiB,GAAT,IAAgBJ,MAAhB,EAAwB;EACpB,gCAAIK,UAAUT,YAAY5W,IAAZ,GAAoB9C,KAAKM,GAAL,CAAS,CAACuZ,WAAWC,OAAOI,GAAP,EAAYtd,MAAxB,IAAkC,CAA3C,EAA8C,CAA9C,IAAmDwc,MAAMH,SAA3F;EACA,gCAAImB,MAAM,CAAV;EACA,iCAAK3D,EAAL,IAAWqD,OAAOI,GAAP,CAAX,EAAwB;EACpBJ,uCAAOI,GAAP,EAAYzD,EAAZ,EAAgB/Y,IAAhB,CAAqB,IAArB,EAA2BsC,KAAKO,GAAL,CAAS4Z,UAAUC,MAAMhB,MAAMH,SAA/B,EAA0CgB,QAA1C,IAAsDb,MAAMH,SAAN,GAAkB,CAAnG;EACAmB;EACH;EACJ;EACJ,qBA7BD,MA6BO;EAAE;EACL,4BAAIC,aAAa,IAAjB;EAAA,4BACIC,eAAe,CADnB;EAAA,4BAEIvhB,QAAQ,CAFZ;EAGA,4BAAIqgB,MAAMJ,QAAN,IAAkB,SAAlB,IAA+B,OAAOI,MAAMJ,QAAb,IAAyB,QAA5D,EAAsE;EAClE;EACAsB,2CAAe,OAAOlB,MAAMJ,QAAb,IAAyB,QAAzB,GAAoCI,MAAMJ,QAA1C,GAAqD,EAApE;EACH;;EAEDqB,qCAAa5L,YAAY6L,YAAZ,EAA0BpJ,KAA1B,CAAb;EACAnY,gCAAQshB,WAAWtX,KAAX,GAAmBsX,WAAWvX,IAAtC;;EAEA,6BAAK,IAAI2T,KAAK,CAAd,EAAiBA,KAAKhB,OAAOvO,MAAP,CAActK,MAApC,EAA4C6Z,IAA5C,EAAkD;EAC9C6C,kCAAMvL,IAAN,CAAWrR,MAAX,CAAkBsd,GAAlB,CAAsBvD,EAAtB,EACK/Y,IADL,CACU,IADV,EACgB2c,WAAWxL,MAAX,GAAoBG,UAAU,IAAV,EAAgBjW,KAAhB,CADpC,EAEK2E,IAFL,CAEU,IAFV,EAEgB9E,MAAM6Y,MAAN,CAAagE,OAAOvO,MAAP,CAAcuP,EAAd,CAAb,CAFhB;EAGH;EACJ;EACJ;;EAGD,oBAAI6C,MAAMvL,IAAN,CAAWwM,IAAf,EAAqB;EACjB,wBAAIC,aAAa/L,YAAY2K,MAAMD,SAAlB,EAA6BjI,KAA7B,CAAjB;EACA,yBAAK,IAAIuF,KAAK,CAAd,EAAiBA,KAAKhB,OAAOvO,MAAP,CAActK,MAApC,EAA4C6Z,IAA5C,EAAkD;EAC9C6C,8BAAMvL,IAAN,CAAWwM,IAAX,CAAgBd,KAAhB,CAAsBhD,EAAtB,EACK/Y,IADL,CACU,IADV,EACgB8c,WAAW1X,IAD3B,EAEKpF,IAFL,CAEU,IAFV,EAEgB8c,WAAWzX,KAF3B,EAGKrF,IAHL,CAGU,IAHV,EAGgB9E,MAAM6Y,MAAN,CAAagE,OAAOvO,MAAP,CAAcuP,EAAd,CAAb,CAHhB,EAIK/Y,IAJL,CAIU,IAJV,EAIgB9E,MAAM6Y,MAAN,CAAagE,OAAOvO,MAAP,CAAcuP,EAAd,CAAb,CAJhB;EAKH;EACJ;EACJ;EACJ,SApFD;;EAsFA;;;EAGA7d,cAAMkgB,SAAN,CAAgBO,YAAhB,GAA+B,YAAY;EACvC,gBAAInI,KAAJ,EAAWoI,KAAX;;EAEA,gBAAIF,SAASA,MAAMxQ,MAAnB,EAA2B;EACvBhQ,sBAAMkgB,SAAN,CAAgB3K,UAAhB,GAA6BC,cAAcgL,MAAMxQ,MAApB,CAA7B;EACH,aAFD,MAEO;EACHhQ,sBAAMkgB,SAAN,CAAgB3K,UAAhB,GAA6BvV,MAAMuV,UAAnC;EACH;;EAED,gBAAIiL,MAAM/a,IAAN,IAAc,KAAlB,EAAyB;EACrB;EACH;;EAED;EACAzF,kBAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqBG,CAArB,GAAyBtV,MAAMmV,IAAN,CAAWG,CAAX,CAAapQ,MAAb,CAAoB,GAApB,EAAyBJ,IAAzB,CAA8B,OAA9B,EAAuC,eAAvC,CAAzB;EACA,gBAAI0b,MAAMlC,SAAN,IAAmBkC,MAAMlC,SAAN,CAAgBta,MAAhB,GAAyB,CAAhD,EAAmD;EAC/ChE,sBAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqB0L,KAArB,GAA6B,EAA7B;EACA,oBAAID,OAAJ;EACA,qBAAK,IAAIlc,IAAT,IAAiB8b,MAAMlC,SAAvB,EAAkC;EAC9BsC,8BAAUJ,MAAMlC,SAAN,CAAgB5Z,IAAhB,CAAV;EACA1E,0BAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqB0L,KAArB,CAA2BD,OAA3B,IAAsC,EAAtC;EACA5gB,0BAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqB0L,KAArB,CAA2BD,OAA3B,EAAoCtS,MAApC,GAA6C,EAA7C;EACA,yBAAK,IAAIuO,MAAT,IAAmB7c,MAAMkV,SAAzB,EAAoC;EAChClV,8BAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqB0L,KAArB,CAA2BD,OAA3B,EAAoCtS,MAApC,CAA2ClJ,IAA3C,CAAgD;EAC5C+C,+BAAG0U,MADyC;EAE5ChY,+BAAG7E,MAAMkV,SAAN,CAAgB2H,MAAhB,EAAwBjG,OAAxB,CAAgCgK,OAAhC;EAFyC,yBAAhD;EAIH;EACD5gB,0BAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqB0L,KAArB,CAA2BD,OAA3B,EAAoClc,IAApC,GAA2C5D,SAAA,GACtC0Y,KADsC,CAChC1Y,kBADgC,EAEtC+D,CAFsC,CAEpC,UAAUrD,CAAV,EAAa;EACZ,+BAAOxB,MAAM6Y,MAAN,CAAarX,EAAEqD,CAAf,CAAP;EACH,qBAJsC,CAA3C;EAKA7E,0BAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqB0L,KAArB,CAA2BD,OAA3B,EAAoCtL,CAApC,GAAwCtV,MAAMkgB,SAAN,CAAgB/K,IAAhB,CAAqBG,CAArB,CAAuBpQ,MAAvB,CAA8B,MAA9B,EACnCJ,IADmC,CAC9B,OAD8B,EACrB,UAAU8b,OADW,EAEnC9b,IAFmC,CAE9B,aAF8B,EAEf8b,OAFe,EAGnCrgB,KAHmC,CAG7B,MAH6B,EAGrB,MAHqB,EAInCA,KAJmC,CAI7B,QAJ6B,EAInBP,MAAMuV,UAAN,CAAiBqL,OAAjB,CAJmB,CAAxC;EAKH;EAEJ;;EAGD,iBAAKtI,KAAL,IAActY,MAAMkV,SAApB,EAA+B;EAC3BwL,wBAAQ1gB,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB4H,SAA/B;EACAQ,sBAAMvL,IAAN,CAAWG,CAAX,GAAetV,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhD,CAAvB,CAAyBpQ,MAAzB,CAAgC,GAAhC,EAAqCJ,IAArC,CAA0C,OAA1C,EAAmD,WAAnD,CAAf;EACA;EACA,oBAAI0b,MAAML,QAAV,EAAoB;EAChBO,0BAAMvL,IAAN,CAAWrR,MAAX,GAAoB,EAACwR,GAAG,IAAJ,EAAU8L,KAAK,EAAf,EAApB;EACAV,0BAAMvL,IAAN,CAAWrR,MAAX,CAAkBwR,CAAlB,GAAsBoL,MAAMvL,IAAN,CAAWG,CAAX,CAAapQ,MAAb,CAAoB,GAApB,EAAyBJ,IAAzB,CAA8B,OAA9B,EAAuC,aAAvC,CAAtB;;EAFgB;EAIZ,4BAAI+c,MAAM7hB,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhK,MAAvB,CAA8BuP,EAA9B,CAAV;EACA,4BAAIiE,UAAU9hB,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBD,UAAvB,CAAkCwF,EAAlC,CAAd;EACA6C,8BAAMvL,IAAN,CAAWrR,MAAX,CAAkBsd,GAAlB,CAAsBhc,IAAtB,CAA2Bsb,MAAMvL,IAAN,CAAWrR,MAAX,CAAkBwR,CAAlB,CAAoBpQ,MAApB,CAA2B,QAA3B,EACtBJ,IADsB,CACjB,OADiB,EACR,OADQ;EAEvB;EAFuB,yBAGtBA,IAHsB,CAGjB,OAHiB,EAGR,YAAW;EAAE,gCAAImP,KAAKjU,MAAMgU,QAAN,CAAeC,EAAf,GAAoBjU,MAAMgU,QAAN,CAAeC,EAAnC,GAAwC,KAAjD;EAC5B,mCAAOA,KAAK,YAAY6N,QAAQ7N,EAAzB,GAA8B,EAArC;EAAyC,yBAJlB,EAKtBnP,IALsB,CAKjB,GALiB,EAKZ0b,MAAMH,SAAN,GAAkB,CALN;EAAA,yBAMtB9f,KANsB,CAMhB,MANgB,EAMRP,MAAMkgB,SAAN,CAAgB3K,UAAhB,CAA2B+C,KAA3B,CANQ,EAOtB/X,KAPsB,CAOhB,cAPgB,EAOA,GAPA,EAQtBA,KARsB,CAQhB,QARgB,EAQNP,MAAMkgB,SAAN,CAAgB3K,UAAhB,CAA2B+C,KAA3B,CARM,EAStB/X,KATsB,CAShB,cATgB,EASA,KATA,EAUtBiF,EAVsB,CAUnB,WAVmB,EAUN,YAAI;EACjBxF,kCAAMmV,IAAN,CAAW9Q,OAAX,CACK9D,KADL,CACW,SADX,EACsB,IADtB,EAEKA,KAFL,CAEW,MAFX,EAEoBO,UAAA,CAASid,KAAV,GAAmB,IAFtC,EAGKxd,KAHL,CAGW,KAHX,EAGmBO,UAAA,CAASkd,KAAT,GAAiB,EAAlB,GAAwB,IAH1C;EAIH,yBAfsB,EAepBxY,EAfoB,CAejB,UAfiB,EAeL,YAAY;EAC1BxF,kCAAMmV,IAAN,CAAW9Q,OAAX,CAAmB9D,KAAnB,CAAyB,SAAzB,EAAoC,MAApC;EACH,yBAjBsB,EAiBpBiF,EAjBoB,CAiBjB,WAjBiB,EAiBJkR,aAAa4B,KAAb,EAAoBtY,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuB1B,OAA3C,EAAoDkL,QAAQ5N,MAA5D,EAAoE2N,GAApE,CAjBI,EAkBtBrc,EAlBsB,CAkBnB,OAlBmB,EAkBV,YAAU;EACnB,gCAAIxF,MAAMgU,QAAN,CAAe3L,MAAf,CAAsB0Z,cAA1B,EAA0C;EACtC/hB,sCAAMgU,QAAN,CAAe3L,MAAf,CAAsB0Z,cAAtB,CAAqCha,IAArC,CAA0C,IAA1C,EAAgD+Z,OAAhD;EACH;EACJ,yBAtBsB,CAA3B;EANY;;EAGhB,yBAAK,IAAIjE,KAAK,CAAd,EAAiBA,KAAK7d,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhK,MAAvB,CAA8BtK,MAApD,EAA4D6Z,IAA5D,EAAkE;EAAA;EA0BjE;EACJ;;EAGD;EACA,oBAAI2C,MAAMF,aAAV,EAAyB;EACrBI,0BAAMvL,IAAN,CAAWwM,IAAX,GAAkB,EAACrM,GAAG,IAAJ,EAAUuL,OAAO,EAAjB,EAAlB;EACAH,0BAAMvL,IAAN,CAAWwM,IAAX,CAAgBrM,CAAhB,GAAoBoL,MAAMvL,IAAN,CAAWG,CAAX,CAAapQ,MAAb,CAAoB,GAApB,EAAyBJ,IAAzB,CAA8B,OAA9B,EAAuC,WAAvC,CAApB;EACA,yBAAK,IAAI+Y,KAAK,CAAd,EAAiBA,KAAK7d,MAAMkV,SAAN,CAAgBoD,KAAhB,EAAuBhK,MAAvB,CAA8BtK,MAApD,EAA4D6Z,IAA5D,EAAkE;EAC9D6C,8BAAMvL,IAAN,CAAWwM,IAAX,CAAgBd,KAAhB,CAAsBzb,IAAtB,CAA2Bsb,MAAMvL,IAAN,CAAWwM,IAAX,CAAgBrM,CAAhB,CAAkBpQ,MAAlB,CAAyB,MAAzB,EACtBJ,IADsB,CACjB,OADiB,EACR,WADQ,EAEtBvE,KAFsB,CAEhB,cAFgB,EAEA,GAFA,EAGtBA,KAHsB,CAGhB,QAHgB,EAGNP,MAAMkgB,SAAN,CAAgB3K,UAAhB,CAA2B+C,KAA3B,CAHM,CAA3B;EAIH;EACJ;EACJ;EAEJ,SA7FD;EA8FAtY,cAAMkgB,SAAN,CAAgBO,YAAhB;;EAEA3f,mBAAA,CAAU8I,MAAV,EAAkBpE,EAAlB,CAAqB,YAAYxF,MAAM0M,QAAlB,GAA6B,WAAlD,EAA+D1M,MAAMkgB,SAAN,CAAgB/Z,MAA/E;EACAnG,cAAMkgB,SAAN,CAAgB/Z,MAAhB;EACA,eAAOnG,KAAP;EACH,KAzQD;;EA2QA,WAAOA,KAAP;EACH;;ECvpDD;;;AAGA,EAAe,iBAASC,MAAT,EAAiBoM,MAAjB,EAAyB;EACtC,MAAI2V,SAASrV,OAAOsV,MAAP,CAAc5V,MAAd,CAAb;;EAEA2V,SAAOlY,IAAP,GAAc,UAAS7J,MAAT,EAAiB;EAC7B,QAAIH,KAAK,IAAT;EACAA,OAAGI,OAAH,GAAaD,SAASA,MAAT,GAAkB,EAA/B;EACAH,OAAGkM,KAAH,GAAW,EAAX;EACAlM,OAAGyD,OAAH,GAAa,EAAb;EACAzD,OAAGqM,KAAH,GAAW,EAAX;;EAEArM,OAAGwT,IAAH,GAAUxT,GAAGe,KAAH,CAASC,EAAT,CACPC,GADO,GAEP+D,IAFO,CAEF,OAFE,EAEO,QAFP,EAGPsK,IAHO,CAINtP,GAAGI,OAAH,CAAWa,GAAX,GACIjB,GAAGI,OAAH,CAAWa,GADf,GAEI,UAASS,CAAT,EAAY;EACV,UAAI4N,OAAO,EAAX;EACA;EACAA,cAAQ5N,EAAEqD,CAAF,GACJ,YACC9B,OAAOC,KAAP,CAAa,CAACxB,EAAEqD,CAAhB,IACGrD,EAAEqD,CADL,GAEG/E,GAAGe,KAAH,CAASyB,MAAT,CAAgBxC,GAAGI,OAAH,CAAWuC,KAA3B,EAAkCjB,EAAEqD,CAApC,CAHJ,IAIA,cALI,GAMJ,EANJ;EAOA;;EAEA,aAAOuK,IAAP;EACD,KAnBC,CAAV;EAqBD,GA5BD;;EA8BA;EACA;EACA4S,SAAOngB,IAAP,GAAc,UAASA,IAAT,EAAe;EAC3B,QAAI/B,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW2B,IAAX,GAAkBA,IAAlB;EACA,WAAO/B,EAAP;EACD,GAJD;;EAMAkiB,SAAO7Z,CAAP,GAAW,UAASqZ,GAAT,EAAc;EACvB,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWiI,CAAX,GAAeqZ,GAAf;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMAkiB,SAAOnd,CAAP,GAAW,UAAS2c,GAAT,EAAc;EACvB,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW2E,CAAX,GAAe2c,GAAf;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMAkiB,SAAOE,MAAP,GAAgB,UAASC,GAAT,EAAc;EAC5B,QAAIriB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWgiB,MAAX,GAAoBC,GAApB;EACA,WAAOriB,EAAP;EACD,GAJD;;EAMAkiB,SAAOI,IAAP,GAAc,UAASZ,GAAT,EAAc;EAC1B,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWkiB,IAAX,GAAkBZ,GAAlB;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMAkiB,SAAO/N,EAAP,GAAY,UAASuN,GAAT,EAAc;EACxB,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW+T,EAAX,GAAgBuN,GAAhB;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMAkiB,SAAOhS,MAAP,GAAgB,UAASA,MAAT,EAAiB;EAC/B,QAAIlQ,KAAK,IAAT;EACA,QAAIiC,MAAMC,OAAN,CAAcgO,MAAd,CAAJ,EAA2B;EACzB;EACAlQ,SAAGI,OAAH,CAAW8P,MAAX,GAAoBA,MAApB;EACD,KAHD,MAGO;EACL;EACAlQ,SAAGyD,OAAH,CAAWiH,KAAX,GAAmBwF,MAAnB;EACD;EACD,WAAOlQ,EAAP;EACD,GAVD;;EAYAkiB,SAAOjhB,GAAP,GAAa,UAASA,GAAT,EAAc;EACzB,QAAIjB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACAjB,OAAGwT,IAAH,CAAQlE,IAAR,CAAatP,GAAGI,OAAH,CAAWa,GAAxB;EACA,WAAOjB,EAAP;EACD,GALD;;EAOA;EACA;EACAkiB,SAAO9gB,IAAP,GAAc,UAASA,IAAT,EAAe;EAC3B,QAAIpB,KAAK,IAAT;;EAEAA,OAAGkM,KAAH,GAAW,EAAX;EACA9K,SAAK+N,OAAL,CAAa,UAASzN,CAAT,EAAY;EACvBA,QAAE2G,CAAF,GAAM3G,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,CAAN;EACA3G,QAAEqD,CAAF,GAAM,CAACrD,EAAE1B,GAAGI,OAAH,CAAW2E,CAAb,CAAP;EACArD,QAAEgJ,KAAF,GAAU1K,GAAGI,OAAH,CAAWkiB,IAAX,GAAkB5gB,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAAlB,GAAuC,KAAjD;EACA,aAAO5gB,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,CAAP;EACA,aAAO3G,EAAE1B,GAAGI,OAAH,CAAW2E,CAAb,CAAP;EACA,UAAI/E,GAAGI,OAAH,CAAWkiB,IAAf,EAAqB,OAAO5gB,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,CAAP;;EAErBrI,SAAGkM,KAAH,CAAS5G,IAAT,CAAc5D,CAAd;EACD,KATD;;EAWA,WAAO1B,EAAP;EACD,GAhBD;;EAkBAkiB,SAAO5U,MAAP,GAAgB,YAAW;EACzB,QAAItN,KAAK,IAAT;;EAEA,WAAOA,EAAP;EACD,GAJD;;EAMAkiB,SAAO9U,IAAP,GAAc,YAAW;EACvB,QAAIpN,KAAK,IAAT;EACA;EACA;;EAEAA,OAAGE,KAAH,CAASS,OAAT,GAAmBuH,MAAnB;;EAEA,QAAIqa,SAAStO,gBAAgB;EAC3B/T,aAAOF,GAAGE,KADiB;EAE3BkB,YAAMpB,GAAGkM,KAFkB;EAG3BiI,UAAInU,GAAGI,OAAH,CAAW+T,EAHY;EAI3BC,cAAQpU,GAAGI,OAAH,CAAWgU,MAJQ;EAK3B7L,cAAQvI,GAAGI,OAAH,CAAWmI,MALQ;EAM3B8L,aAAO,GANoB;EAO3BC,aACEkO,QAAOxiB,GAAGI,OAAH,CAAWgiB,MAAlB,MAA6B,QAA7B,IAAyCpiB,GAAGI,OAAH,CAAWgiB,MAAX,CAAkB/Z,CAA3D,GACIrI,GAAGI,OAAH,CAAWgiB,MAAX,CAAkB/Z,CADtB,GAEI,IAVqB;EAW3BkM,aAAO,GAXoB;EAY3BqE,kBAAY;EACVhW,eAAO5C,GAAGI,OAAH,CAAWwY,UAAX,CAAsBhW,KADnB;EAEVD,eAAO3C,GAAGI,OAAH,CAAWwY,UAAX,CAAsBjW;EAFnB,OAZe;EAgB3BiK,gBAAU,SAhBiB;EAiB3BsD,cAAQ,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,CAjBmB;EAkB3BwE,iBAAW;EACTnU,gBAAQP,GAAGI,OAAH,CAAW8J,IAAX,CAAgB3J,MADf;EAETF,eAAOL,GAAGI,OAAH,CAAW8J,IAAX,CAAgB7J;EAFd,OAlBgB;EAsB3B8J,cAAQ;EACNG,aAAKtK,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBG,GADtB;EAEND,eAAOrK,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBE,KAFxB;EAGNE,gBAAQvK,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBI,MAHzB;EAINH,cAAMpK,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBC;EAJvB,OAtBmB;EA4B3BuK,yBAAmB;EA5BQ,KAAhB,CAAb;;EA+BA,QAAI3U,GAAGE,KAAH,CAASC,MAAT,CAAgB6Q,MAApB,EAA4B;EAC1BhQ,iBAAA,CAAU,kBAAV,EACGP,KADH,CACS,kBADT,EAC6BT,GAAGE,KAAH,CAASO,KAAT,CAAe8D,OAAf,CAAuBkG,eADpD,EAEGhK,KAFH,CAES,aAFT,EAEwB,CAFxB,EAGGA,KAHH,CAGS,aAHT,EAGwBT,GAAGE,KAAH,CAASO,KAAT,CAAe8D,OAAf,CAAuBD,IAAvB,CAA4BwG,UAHpD,EAIGrK,KAJH,CAIS,WAJT,EAIsBT,GAAGE,KAAH,CAASO,KAAT,CAAe8D,OAAf,CAAuBD,IAAvB,CAA4BuG,QAJlD,EAKGpK,KALH,CAKS,OALT,EAKkBT,GAAGE,KAAH,CAASO,KAAT,CAAe8D,OAAf,CAAuBD,IAAvB,CAA4BsG,SAL9C,EAMGnK,KANH,CAMS,aANT,EAMwBT,GAAGE,KAAH,CAASO,KAAT,CAAe8D,OAAf,CAAuBD,IAAvB,CAA4BiH,UANpD,EAOG9K,KAPH,CAOS,kBAPT,EAO6BT,GAAGE,KAAH,CAASO,KAAT,CAAe8D,OAAf,CAAuBkG,eAPpD,EAQGhK,KARH,CAQS,SART,EAQoBT,GAAGE,KAAH,CAASO,KAAT,CAAe8D,OAAf,CAAuBD,IAAvB,CAA4BhC,OARhD,EASG7B,KATH,CAUI,QAVJ,EAWIT,GAAGE,KAAH,CAASO,KAAT,CAAe8D,OAAf,CAAuBiH,MAAvB,CAA8BnL,KAA9B,GACE,SADF,GAEEL,GAAGE,KAAH,CAASO,KAAT,CAAe8D,OAAf,CAAuBiH,MAAvB,CAA8Bd,KAbpC,EAeGjK,KAfH,CAeS,eAfT,EAe0BT,GAAGE,KAAH,CAASO,KAAT,CAAe8D,OAAf,CAAuBiH,MAAvB,CAA8BC,MAfxD;EAgBD;;EAED8W,WAAOxG,aAAP;EACAwG,WAAOpC,eAAP;EACAoC,WAAOlE,gBAAP,CAAwB,EAAEE,cAAc,KAAhB,EAAxB;EACAgE,WAAOjJ,gBAAP,CAAwB,EAAEE,gBAAgB,KAAlB,EAAxB;;EAEA+I,WAAOvG,QAAP,CAAgBrW,IAAhB,CAAqB;EACnBqU,aAAO,IADY;EAEnBkC,oBAAc,KAFK;EAGnBI,oBAAc,KAHK;EAInBF,gBAAU,IAJS;EAKnBD,kBAAY,IALO;EAMnBF,eAAS;EANU,KAArB;EAQAsG,WAAOnC,SAAP,CAAiBzN,MAAjB,CAAwB,EAAE0N,UAAU,IAAZ,EAAxB;EACAkC,WAAOpJ,WAAP,CAAmBxT,IAAnB,CAAwB,EAAEqU,OAAO,IAAT,EAAef,OAAO,CAAtB,EAAyB5Y,OAAO,GAAhC,EAAxB;EACA;EACA;;;;;EAKA;EACA;;;;;EAKA;EACA;;;;;EAKA;EACA,QAAIL,GAAGI,OAAH,CAAW2B,IAAX,KAAoB,QAAxB,EAAkC;EAChCwgB,aAAOpJ,WAAP,CAAmBxT,IAAnB,CAAwB,EAAEqU,OAAO,IAAT,EAAef,OAAO,CAAtB,EAAyB5Y,OAAO,EAAhC,EAAxB;EACAkiB,aAAOvG,QAAP,CAAgBrW,IAAhB,CAAqB;EACnBqU,eAAO,IADY;EAEnBkC,sBAAc,KAFK;EAGnBI,sBAAc,KAHK;EAInBC,kBAAU,EAJS;EAKnBC,mBAAW,EALQ;EAMnBtM,gBAAQ,CAAC,MAAD;EANW,OAArB;EAQAqS,aAAOjE,UAAP,CAAkB1Y,IAAlB;EACA2c,aAAOnC,SAAP,CAAiBzN,MAAjB,CAAwB,EAAE0N,UAAU,KAAZ,EAAmBG,eAAe,KAAlC,EAAxB;EACD;;EAED;EACA;;;;;EAKA;EACA;;;;;EAKA;EACA,QAAIxgB,GAAGI,OAAH,CAAW2B,IAAX,KAAoB,SAAxB,EAAmC;EACjCwgB,aAAOpJ,WAAP,CAAmBvT,IAAnB;EACA2c,aAAOnC,SAAP,CAAiBza,IAAjB,CAAsB;EACpB0a,kBAAU,IADU;EAEpBC,kBAAU,EAFU;EAGpBE,uBAAe,KAHK;EAIpBtQ,gBAAQ;EAJY,OAAtB;EAMAqS,aAAOjE,UAAP,CAAkB1Y,IAAlB;EACA;EACD;;EAED;EACA;;;;;;EAMA,WAAO5F,EAAP;EACD,GA1ID;;EA4IAkiB,SAAO7S,MAAP,GAAgB,UAAS8E,EAAT,EAAa;AAC3B,EACA,WAAOnT,WAAA,CAAU,qBAAqBmT,EAA/B,CAAP;EACD,GAHD;;EAKA+N,SAAOla,SAAP,GAAmB,UAASmM,EAAT,EAAa;AAC9B,EACA,WAAOnT,cAAA,CAAa,aAAamT,EAA1B,CAAP;EACD,GAHD;;EAKA+N,SAAOlY,IAAP,CAAY7J,MAAZ;EACA,SAAO+hB,MAAP;EACD;;ECnRD;;;;AAIA,EAAe,kBAAS/hB,MAAT,EAAiB;;EAE9B,WAASsiB,OAAT,CAAiBtiB,MAAjB,EAAwB;EACtB,QAAIH,KAAK,IAAT;EACAA,OAAGI,OAAH,GAAaD,SAASA,MAAT,GAAkB,EAA/B;EACAH,OAAGkM,KAAH,GAAW,EAAX;EACAlM,OAAGyD,OAAH,GAAY,EAAZ;EACAzD,OAAGqM,KAAH,GAAW,EAAX;EACArM,OAAG0iB,SAAH,GAAepb,KAAK2N,KAAL,CAAWjV,GAAGI,OAAH,CAAW8J,IAAX,CAAgB7J,KAAhB,GAAwB,EAAnC,CAAf;EACAL,OAAG2iB,mBAAH,GAAyB3iB,GAAG0iB,SAA5B;;EAEA1iB,OAAGI,OAAH,CAAWmT,OAAX,GAAyBvS,GAAGwB,MAAH,CAAU,MAAV,CAAzB;;EAEAxC,OAAGwT,IAAH,GAAUxS,GAAGC,GAAH,GAAS+D,IAAT,CAAc,OAAd,EAAuB,QAAvB,CAAV;EACD;;EAED;EACA;EACAyd,UAAQ/O,SAAR,CAAkBrL,CAAlB,GAAsB,UAASua,OAAT,EAAiB;EACrC,QAAI5iB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWiI,CAAX,GAAeua,OAAf;EACA,WAAO5iB,EAAP;EACD,GAJD;;EAMAyiB,UAAQ/O,SAAR,CAAkB3O,CAAlB,GAAsB,UAAS6d,OAAT,EAAiB;EACrC,QAAI5iB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW2E,CAAX,GAAe6d,OAAf;EACA,WAAO5iB,EAAP;EACD,GAJD;;EAMAyiB,UAAQ/O,SAAR,CAAkBxD,MAAlB,GAA2B,UAASA,MAAT,EAAgB;EACzC,QAAIlQ,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW8P,MAAX,GAAoBA,MAApB;EACA,WAAOlQ,EAAP;EACD,GAJD;;EAMAyiB,UAAQ/O,SAAR,CAAkBzS,GAAlB,GAAwB,UAASA,GAAT,EAAa;EACnC,QAAIjB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACAjB,OAAGwT,IAAH,CAAQlE,IAAR,CAAatP,GAAGI,OAAH,CAAWa,GAAxB;EACA,WAAOjB,EAAP;EACD,GALD;;EAOAyiB,UAAQ/O,SAAR,CAAkBvF,OAAlB,GAA4B,UAASlI,CAAT,EAAW;EACrC,QAAIjG,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW+N,OAAX,GAAqBA,OAArB;EACA,WAAOnO,EAAP;EACD,GAJD;;EAMAyiB,UAAQ/O,SAAR,CAAkBE,GAAlB,GAAwB,YAAU;EAChC,QAAI5T,KAAK,IAAT;EACA,WAAOA,GAAG6T,MAAV;EACD,GAHD;;EAKA;EACA;EACA4O,UAAQ/O,SAAR,CAAkBxT,KAAlB,GAA0B,UAASA,KAAT,EAAe;EACvC,QAAIF,KAAK,IAAT;EACAA,OAAG6T,MAAH,GAAY3T,KAAZ;EACA,WAAOF,EAAP;EACD,GAJD;;EAMAyiB,UAAQ/O,SAAR,CAAkBtS,IAAlB,GAAyB,UAASA,IAAT,EAAc;EACrC,QAAIpB,KAAK,IAAT;EACAA,OAAGkM,KAAH,GAAW9K,KAAKK,GAAL,CAAS,UAASC,CAAT,EAAW;EAC7B,UAAImhB,IAAI;EACN9d,WAAGrD,EAAEohB,UADC;EAENza,WAAG3G,EAAEqhB,WAFC;EAGN1f,eAAO,CAAC3B,EAAEshB,GAHJ;EAINC,oBAAa,CAACvhB,EAAEwhB;EAJV,OAAR;EAMA,aAAOL,CAAP;EACD,KARU,CAAX;EASA,WAAO7iB,EAAP;EACD,GAZD;;EAcAyiB,UAAQ/O,SAAR,CAAkBpG,MAAlB,GAA2B,UAASyG,CAAT,EAAW;EACpC,QAAI/T,KAAK,IAAT;EACAA,OAAGyD,OAAH,GAAasQ,CAAb;EACA,WAAO/T,EAAP;EACD,GAJD;;EAMAyiB,UAAQ/O,SAAR,CAAkB7F,IAAlB,GAAyB,UAAS7H,CAAT,EAAW;EAClC,QAAIhG,KAAK,IAAT;EACAA,OAAGqM,KAAH,GAAWrG,CAAX;EACA,WAAOhG,EAAP;EACD,GAJD;;EAMAyiB,UAAQ/O,SAAR,CAAkBpS,OAAlB,GAA4B,YAAU;EACpC,QAAItB,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAyiB,UAAQ/O,SAAR,CAAkBtG,IAAlB,GAAyB,YAAU;EACjC,QAAIpN,KAAK,IAAT;;EAEA;EACAA,OAAG6T,MAAH,CAAU/S,IAAV,CAAemH,IAAf,CAAoBjI,GAAGwT,IAAvB;;EAEA,QAAGxT,GAAGI,OAAH,CAAWwC,KAAd,EAAoB;EAClB5C,SAAGI,OAAH,CAAWwC,KAAX,CAAiBmC,CAAjB,GAAsB/E,GAAGI,OAAH,CAAW2E,CAAX,CAAab,MAAb,GAAsBlE,GAAG0iB,SAAzB,GAAmC,EAAzD;EACD,KAFD,MAEK;EACH1iB,SAAGI,OAAH,CAAWwC,KAAX,GAAmB,EAAE,KAAM5C,GAAGI,OAAH,CAAW2E,CAAX,CAAab,MAAb,GAAsBlE,GAAG0iB,SAAjC,EAAnB;EACD;;EAED1iB,OAAGmjB,UAAH,GAAgBnjB,GAAG6T,MAAH,CAAU/S,IAAV,CAAekH,SAAf,CAAyB,WAAzB,EACT5G,IADS,CACJpB,GAAGI,OAAH,CAAW2E,CADP,EAETqB,KAFS,GAEDhB,MAFC,CAEM,MAFN,EAGPd,IAHO,CAGF,UAAU5C,CAAV,EAAa;EAAE,aAAOA,CAAP;EAAW,KAHxB,EAIPsD,IAJO,CAIF,GAJE,EAIG,CAJH,EAKPA,IALO,CAKF,GALE,EAKG,UAAUtD,CAAV,EAAamE,CAAb,EAAgB;EAAE,aAAOA,IAAI7F,GAAG0iB,SAAd;EAA0B,KAL/C,EAMPjiB,KANO,CAMD,aANC,EAMc,KANd,EAOPuE,IAPO,CAOF,WAPE,EAOW,kBAAkBhF,GAAG0iB,SAAH,GAAe,GAAjC,GAAuC,GAPlD,EAQP1d,IARO,CAQF,OARE,EAQO,oBARP,CAAhB;EASQ;;EAERhF,OAAGojB,WAAH,GAAiBpjB,GAAG6T,MAAH,CAAU/S,IAAV,CAAekH,SAAf,CAAyB,YAAzB,EACZ5G,IADY,CACPpB,GAAGI,OAAH,CAAWiI,CADJ,EAEZjC,KAFY,GAEJhB,MAFI,CAEG,MAFH,EAGVd,IAHU,CAGL,UAAS5C,CAAT,EAAY;EAAE,aAAOA,CAAP;EAAW,KAHpB,EAIVsD,IAJU,CAIL,GAJK,EAIA,UAAStD,CAAT,EAAYmE,CAAZ,EAAe;EAAE,aAAOA,IAAI7F,GAAG0iB,SAAd;EAA0B,KAJ3C,EAKV1d,IALU,CAKL,GALK,EAKAhF,GAAGI,OAAH,CAAWwC,KAAX,CAAiBmC,CALjB,EAMVtE,KANU,CAMJ,aANI,EAMW,QANX,EAOVuE,IAPU,CAOL,WAPK,EAOQ,eAAehF,GAAG0iB,SAAH,GAAe,CAA9B,GAAkC,OAP1C,EAQV1d,IARU,CAQL,OARK,EAQI,qBARJ,CAAjB;EASM;;;EAGN,QAAIqO,aAAarS,GAAGqiB,aAAH,GACZjhB,MADY,CACL,CAAC,CAAD,EAAIpB,GAAG4G,GAAH,CAAO5H,GAAGkM,KAAV,EAAiB,UAAUxK,CAAV,EAAa;EAAE,aAAOA,EAAE2B,KAAT;EAAiB,KAAjD,CAAJ,CADK,EAEZ9B,KAFY,CAENvB,GAAGI,OAAH,CAAW8P,MAFL,CAAjB;;EAIA,QAAIoT,QAAQtjB,GAAG6T,MAAH,CAAU/S,IAAV,CAAekH,SAAf,CAAyB,OAAzB,EACP5G,IADO,CACFpB,GAAGkM,KADD,EACQ,UAASxK,CAAT,EAAY;EAC1B,aAAOA,EAAEqD,CAAF,GAAI,GAAJ,GAAQrD,EAAE2G,CAAjB;EACD,KAHO,CAAZ;;EAKAib,UAAMld,KAAN,GAAchB,MAAd,CAAqB,MAArB,EACKJ,IADL,CACU,GADV,EACe,UAAStD,CAAT,EAAY;EAAE,aAAQ1B,GAAGI,OAAH,CAAWiI,CAAX,CAAajE,OAAb,CAAqB1C,EAAE2G,CAAvB,CAAD,GAA+BrI,GAAG0iB,SAAzC;EAAqD,KADlF,EAEK1d,IAFL,CAEU,GAFV,EAEe,UAAStD,CAAT,EAAY;EAAE,aAAQ1B,GAAGI,OAAH,CAAW2E,CAAX,CAAaX,OAAb,CAAqB1C,EAAEqD,CAAvB,CAAD,GAA8B/E,GAAG0iB,SAAxC;EAAoD,KAFjF,EAGK1d,IAHL,CAGU,IAHV,EAGgB,CAHhB,EAIKA,IAJL,CAIU,IAJV,EAIgB,CAJhB,EAKKA,IALL,CAKU,OALV,EAKmB,eALnB,EAMKA,IANL,CAMU,IANV,EAMgB,UAAStD,CAAT,EAAW;EAAE,aAAO,MAAMA,EAAE2G,CAAR,GAAY,GAAZ,GAAkB3G,EAAEqD,CAA3B;EAA8B,KAN3D,EAOKC,IAPL,CAOU,OAPV,EAOmBhF,GAAG0iB,SAPtB,EAQK1d,IARL,CAQU,QARV,EAQoBhF,GAAG0iB,SARvB,EASKhd,EATL,CASQ,WATR,EASqB,UAAShE,CAAT,EAAWmE,CAAX,EAAa;EAC5B;;;EAGA7F,SAAGwT,IAAH,CAAQ7N,IAAR,CAAajE,CAAb,EAAgBV,GAAGqO,MAAH,CAAU,IAAV,EAAgB7J,IAAhB,EAAhB;EACD,KAdL,EAeKE,EAfL,CAeQ,UAfR,EAeoB,UAAShE,CAAT,EAAWmE,CAAX,EAAa;EAC3B;;;EAGA7F,SAAGwT,IAAH,CAAQ5N,IAAR,CAAalE,CAAb,EAAgBV,GAAGqO,MAAH,CAAU,IAAV,EAAgB7J,IAAhB,EAAhB;EACD,KApBL,EAqBKE,EArBL,CAqBQ,OArBR,EAqBiB,UAAShE,CAAT,EAAWmE,CAAX,EAAa;EACxB,UAAG7F,GAAGI,OAAH,CAAWgB,IAAX,CAAgBmiB,OAAnB,EAA2B;EACzBvjB,WAAGI,OAAH,CAAWgB,IAAX,CAAgBmiB,OAAhB,CAAwBtb,IAAxB,CAA6B,IAA7B,EAAmCvG,CAAnC,EAAsCmE,CAAtC;EACD;EACF,KAzBL,EA0BKpF,KA1BL,CA0BW,MA1BX,EA0BmBT,GAAGI,OAAH,CAAW8P,MAAX,CAAkB,CAAlB,CA1BnB,EA2BGqH,UA3BH,GA4BKC,QA5BL,CA4Bc,IA5Bd,EA6BKgM,IA7BL,CA6BUxiB,GAAGyiB,UA7Bb,EA8BKhjB,KA9BL,CA8BW,MA9BX,EA8BmB,UAASiB,CAAT,EAAY;EAAE,aAAO2R,WAAW3R,EAAE2B,KAAb,CAAP;EAA6B,KA9B9D;;EAiCF;;;;;;;;;;;;;;;;;EAqBE,WAAOrD,EAAP;EACD,GAnGD;;EAqGA,SAAO,IAAIyiB,OAAJ,CAAYtiB,MAAZ,CAAP;EACD;;ECtMD;;;;AAIA,EAAe,kBAAUA,MAAV,EAAkBoM,MAAlB,EAA0B;;EAEvC,MAAImX,UAAU7W,OAAOsV,MAAP,CAAc5V,MAAd,CAAd;;EAEAmX,UAAQ1Z,IAAR,GAAe,UAAU7J,MAAV,EAAkB;EAC/B,QAAMH,KAAK,IAAX;EACAA,OAAGI,OAAH,GAAaD,SAASA,MAAT,GAAkB,EAA/B;EACAH,OAAGyD,OAAH,GAAa,EAAb;EACAzD,OAAGqM,KAAH,GAAW,EAAX;EACArM,OAAGkM,KAAH,GAAW,EAAX;;EAEAlM,OAAGyD,OAAH,CAAWiH,KAAX,GAAmB1J,kBAAA,GAAmBO,KAAnB,CAAyB,CAAC,SAAD,EAAY,SAAZ,EAAuB,SAAvB,EAAkC,SAAlC,EAA6C,SAA7C,CAAzB,CAAnB;EAED,GATD;;EAWAmiB,UAAQvP,EAAR,GAAa,UAAUuN,GAAV,EAAe;EAC1B,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW+T,EAAX,GAAgBuN,GAAhB;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMA0jB,UAAQpB,IAAR,GAAe,UAAUZ,GAAV,EAAe;EAC5B,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWkiB,IAAX,GAAkBZ,GAAlB;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMA0jB,UAAQpY,OAAR,GAAkB,UAAUjI,KAAV,EAAiB;EACjC,QAAIrD,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWkL,OAAX,GAAqBjI,KAArB;EACA,WAAOrD,EAAP;EACD,GAJD;;EAMA0jB,UAAQxT,MAAR,GAAiB,UAAUA,MAAV,EAAkB;EACjC,QAAIlQ,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW8P,MAAX,GAAoBA,MAApB;EACA,QAAIA,UAAUjO,MAAMC,OAAN,CAAcgO,MAAd,CAAd,EAAqC;EACnClQ,SAAGyD,OAAH,CAAWiH,KAAX,CAAiBnJ,KAAjB,CAAuB2O,MAAvB;EACD,KAFD,MAEO,IAAI,OAAOA,MAAP,KAAkB,UAAtB,EAAkC;EACvClQ,SAAGyD,OAAH,CAAWiH,KAAX,GAAmBwF,MAAnB;EACD;EACD,WAAOlQ,EAAP;EACD,GATD;;EAWA0jB,UAAQC,WAAR,GAAsB,UAAUxb,WAAV,EAAuB;EAC3C,QAAInI,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW+H,WAAX,GAAyBA,WAAzB;EACA,WAAOnI,EAAP;EACD,GAJD;;EAMA;EACA;EACA0jB,UAAQtiB,IAAR,GAAe,UAAUA,IAAV,EAAgB;EAC7B,QAAIpB,KAAK,IAAT;EACAA,OAAG4jB,SAAH,GAAexiB,KAAK,CAAL,IAAUA,KAAK,CAAL,CAAV,GAAoB,KAAnC,CAF6B;EAG7BA,WAAOA,KAAK,CAAL,CAAP,CAH6B;;EAK7B,QAAIpB,GAAGI,OAAH,CAAWgB,IAAX,CAAgBuZ,MAApB,EAA4B;EAC1BvZ,aAAOA,KAAKuZ,MAAL,CAAY3a,GAAGI,OAAH,CAAWgB,IAAX,CAAgBuZ,MAA5B,CAAP;EACD;;EAED3a,OAAGkM,KAAH,GAAW9K,IAAX;EACA;EACApB,OAAG6jB,OAAH,GAAa7iB,WAAA,CAAUI,IAAV,EAAgB,UAASM,CAAT,EAAY;EAAE,aAAO,CAACA,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAAR;EAA6B,KAA3D,CAAb;;EAEAtiB,OAAGyD,OAAH,CAAWiH,KAAX,CAAiBtI,MAAjB,CAAwBpC,GAAG6jB,OAA3B;;EAEA,QAAIC,UAAU9jB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwB6U,OAAtC;;EAEA9jB,OAAG+jB,MAAH,GAAY,EAAZ;EACA,QAAI9hB,MAAMC,OAAN,CAAc4hB,OAAd,CAAJ,EAA4B;EAC1B,WAAK,IAAI3G,MAAM,CAAf,EAAkBA,MAAM2G,QAAQ5f,MAAhC,EAAwCiZ,KAAxC,EAA+C;EAC7C,YAAMzK,MAAMoR,QAAQ3G,GAAR,CAAZ;EACAnd,WAAG4jB,SAAH,CAAaE,OAAb,CAAqBpR,GAArB,EAA0BsR,UAA1B,CAAqC7U,OAArC,CAA6C,UAAU8U,IAAV,EAAgB;EAC3DA,eAAK9P,EAAL,GAAUnU,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBiV,MAAxB,CAA+BD,IAA/B,CAAV;EACA,cAAIE,QAAQnkB,GAAGkM,KAAH,CAASyO,MAAT,CAAgB;EAAA,mBAAKvM,EAAEpO,GAAGI,OAAH,CAAW+T,EAAb,KAAoB8P,KAAK9P,EAA9B;EAAA,WAAhB,EAAkD,CAAlD,CAAZ;EACA,cAAIgQ,KAAJ,EAAW;EACTF,iBAAKG,UAAL,CAAgBpkB,GAAGI,OAAH,CAAWkiB,IAA3B,IAAmC6B,MAAMnkB,GAAGI,OAAH,CAAWkiB,IAAjB,CAAnC;EACD;EACDtiB,aAAG+jB,MAAH,CAAUze,IAAV,CAAe2e,IAAf;EACD,SAPD;EAQD;EACF,KAZD,MAYO,IAAIH,OAAJ,EAAa;EAClB9jB,SAAG4jB,SAAH,CAAaE,OAAb,CAAqBA,OAArB,EAA8BE,UAA9B,CAAyC7U,OAAzC,CAAiD,UAAU8U,IAAV,EAAgB;EAC/DA,aAAK9P,EAAL,GAAUnU,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBiV,MAAxB,CAA+BD,IAA/B,CAAV;EACA,YAAIE,QAAQnkB,GAAGkM,KAAH,CAASyO,MAAT,CAAgB;EAAA,iBAAKvM,EAAEpO,GAAGI,OAAH,CAAW+T,EAAb,KAAoB8P,KAAK9P,EAA9B;EAAA,SAAhB,EAAkD,CAAlD,CAAZ;EACA,YAAIgQ,KAAJ,EAAW;EACTF,eAAKG,UAAL,CAAgBpkB,GAAGI,OAAH,CAAWkiB,IAA3B,IAAmC6B,MAAMnkB,GAAGI,OAAH,CAAWkiB,IAAjB,CAAnC;EACD;EACDtiB,WAAG+jB,MAAH,CAAUze,IAAV,CAAe2e,IAAf;EACD,OAPD;EAQD;;EAED;EACA;EACA,WAAOjkB,EAAP;EACD,GA5CD;;EA8CA0jB,UAAQpW,MAAR,GAAiB,YAAY;EAC3B,QAAItN,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKA0jB,UAAQW,eAAR,GAA0B,YAAY;EACpC,QAAIrkB,KAAK,IAAT;;EAEA,QAAIuB,QAAQvB,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBnJ,KAAjB,GAAyB2C,MAArC;EACA,QAAIogB,OAAO,CAACtkB,GAAG6jB,OAAH,CAAW,CAAX,IAAgB7jB,GAAG6jB,OAAH,CAAW,CAAX,CAAjB,KAAmCtiB,QAAQ,CAA3C,CAAX;EACA,QAAIa,SAASpC,GAAGI,OAAH,CAAW8P,MAAxB;;EAEA,QAAIqU,mBAAmBvjB,cAAA,GAAemB,UAAf,CAA0B,CAACnC,GAAGI,OAAH,CAAW8J,IAAX,CAAgB3J,MAAhB,GAAyB,GAA1B,EAA+B,CAA/B,CAA1B,EAA6D6B,MAA7D,CAAoEA,MAApE,CAAvB;EACA;EACA;EACA,QAAIgJ,SAASpK,WAAA,CAAU,MAAMhB,GAAGI,OAAH,CAAWuM,MAA3B,EACVvH,MADU,CACH,KADG,EAERJ,IAFQ,CAEH,OAFG,EAEM,GAFN,EAGRA,IAHQ,CAGH,QAHG,EAGOhF,GAAGI,OAAH,CAAW8J,IAAX,CAAgB3J,MAHvB,EAIRE,KAJQ,CAIF,SAJE,EAIS,GAJT,EAKRA,KALQ,CAKF,UALE,EAKU,UALV,EAMRA,KANQ,CAMF,KANE,EAMK,KANL,EAORA,KAPQ,CAOF,OAPE,EAOO,KAPP,EAQV2E,MARU,CAQH,GARG,EASVJ,IATU,CASL,OATK,EASI,kBATJ,EAUVA,IAVU,CAUL,WAVK,EAUQ,kBAVR,CAAb;;EAYA;EACAoG,WAAOhG,MAAP,CAAc,MAAd,EACGJ,IADH,CACQ,GADR,EACa,CAAC,EADd,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAAC,EAFd,EAGGA,IAHH,CAGQ,OAHR,EAGiB,GAHjB,EAIGA,IAJH,CAIQ,QAJR,EAIkBhF,GAAGI,OAAH,CAAW8J,IAAX,CAAgB3J,MAAhB,GAAyB,EAJ3C,EAKGyE,IALH,CAKQ,IALR,EAKc,EALd,EAMGA,IANH,CAMQ,IANR,EAMc,EANd,EAOGA,IAPH,CAOQ,OAPR,EAOiB,mBAPjB,EAQGA,IARH,CAQQ,MARR,EAQgB,uBARhB;;EAUE;EACFoG,WAAOhG,MAAP,CAAc,MAAd,EACGJ,IADH,CACQ,GADR,EACa,CADb,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAAC,EAFd,EAGGA,IAHH,CAGQ,OAHR,EAGiB,cAHjB,EAIGA,IAJH,CAIQ,aAJR,EAIuB,QAJvB,EAKGV,IALH,CAKQtE,GAAGI,OAAH,CAAW+H,WALnB;;EAOA,QAAIqc,YAAYpZ,OAAOpD,SAAP,CAAiB,WAAjB,EACb5G,IADa,CACRpB,GAAGI,OAAH,CAAW8P,MADH,EAEb9J,KAFa,GAGbhB,MAHa,CAGN,GAHM,EAIbJ,IAJa,CAIR,OAJQ,EAIC,UAJD,EAKbA,IALa,CAKR,WALQ,EAKK,UAAStD,CAAT,EAAY;EAC7B,aAAO,oBAAoB6iB,iBAAiB7iB,CAAjB,CAApB,GACJ,GADH;EAED,KARa,CAAhB;;EAUA;EACA8iB,cAAUpf,MAAV,CAAiB,MAAjB,EACGJ,IADH,CACQ,GADR,EACa,CAAC,EADd,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,OAHR,EAGiB,EAHjB,EAIGA,IAJH,CAIQ,QAJR,EAIkBuf,iBAAiBjS,SAAjB,EAJlB,EAKGtN,IALH,CAKQ,MALR,EAKgB,UAAUtD,CAAV,EAAa;EACzB,aAAOA,CAAP;EACD,KAPH;;EAUA;EACA8iB,cAAUpf,MAAV,CAAiB,MAAjB,EACGJ,IADH,CACQ,GADR,EACa,EADb,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,OAHR,EAGiB,WAHjB,EAIGA,IAJH,CAIQ,aAJR,EAIuB,MAJvB,EAKGV,IALH,CAKQ,UAAS5C,CAAT,EAAW;EACf,UAAIkG,MAAO5H,GAAGyD,OAAH,CAAWiH,KAAX,CAAiB+Z,YAAjB,CAA8B/iB,CAA9B,EAAiC,CAAjC,CAAX;EACA,UAAI1B,GAAGI,OAAH,CAAW+H,WAAX,KAA2B,YAA3B,IAA2CP,MAAM,GAArD,EAA0D;EACxDA,cAAM,GAAN;EACD;EACD,UAAI5H,GAAGI,OAAH,CAAWqB,GAAX,CAAeijB,YAAnB,EAAiC;EAC/B,eAAO1kB,GAAGI,OAAH,CAAWqB,GAAX,CAAeijB,YAAf,CAA4B9c,GAA5B,CAAP;EACD,OAFD,MAEO;EACL,eAAO5H,GAAGe,KAAH,CAASyB,MAAT,CAAgBoF,GAAhB,CAAP;EACD;EACF,KAfH;;EAiBA;EACA4c,cAAUpf,MAAV,CAAiB,MAAjB,EACGJ,IADH,CACQ,GADR,EACa,EADb,EAEGA,IAFH,CAEQ,GAFR,EAEahF,GAAGI,OAAH,CAAW8J,IAAX,CAAgB3J,MAAhB,GAAyB,CAAzB,GAA6B,EAF1C,EAGGyE,IAHH,CAGQ,OAHR,EAGiB,cAHjB,EAIGA,IAJH,CAIQ,aAJR,EAIuB,MAJvB,EAKGV,IALH,CAKQ,UAAS5C,CAAT,EAAYmE,CAAZ,EAAc;EAClB,UAAIA,MAAM,CAAV,EAAa;EACX,YAAIgC,MAAO7H,GAAGyD,OAAH,CAAWiH,KAAX,CAAiB+Z,YAAjB,CAA8B/iB,CAA9B,EAAiC,CAAjC,CAAX;EACA,YAAI1B,GAAGI,OAAH,CAAWqB,GAAX,CAAeijB,YAAnB,EAAiC;EAC/B,iBAAO1kB,GAAGI,OAAH,CAAWqB,GAAX,CAAeijB,YAAf,CAA4B7c,GAA5B,CAAP;EACD,SAFD,MAEO;EACL,iBAAO7H,GAAGe,KAAH,CAASyB,MAAT,CAAgBqF,GAAhB,CAAP;EACD;EACF,OAPD,MAOO;EACL,eAAO,EAAP;EACD;EACF,KAhBH;EAiBD,GAlGD;;EAoGA6b,UAAQtW,IAAR,GAAe,YAAY;EACzB,QAAIpN,KAAK,IAAT;;EAEA,QAAI2kB,cAAc3kB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBC,GAA1C;EACA,QAAI4U,UAAU9jB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwB6U,OAAtC,CAJyB;EAKzB,QAAIc,OAAO5kB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwB4V,SAAnC,CALyB;EAMzB,QAAIxjB,QAAQrB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwB5N,KAApC,CANyB;EAOzB,QAAI6iB,SAASlkB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBiV,MAArC;EACA,QAAI/P,KAAKnU,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBkF,EAAjC;;EAEA2Q,MAAEC,QAAF,GAAaD,EAAEE,OAAF,CAAUC,MAAV,CAAiB;EAC5BC,eAAS,iBAAUC,QAAV,EAAoB;EAC3B,YAAIC,OAAJ,EAAavP,GAAb;EACA,YAAIsP,SAASpjB,IAAT,KAAkB,UAAtB,EAAkC;EAChC,cAAI+hB,OAAJ,EAAa;EACX,gBAAI7hB,MAAMC,OAAN,CAAc4hB,OAAd,CAAJ,EAA4B;EAC1B,mBAAK,IAAI3G,MAAM,CAAf,EAAkBA,MAAM2G,QAAQ5f,MAAhC,EAAwCiZ,KAAxC,EAA+C;EAC7C,oBAAMzK,MAAMoR,QAAQ3G,GAAR,CAAZ;EACAiI,0BAAUnW,SAASoW,OAAT,CAAiBF,QAAjB,EAA2BA,SAASrB,OAAT,CAAiBpR,GAAjB,CAA3B,CAAV;EACAoS,kBAAEE,OAAF,CAAUtR,SAAV,CAAoBwR,OAApB,CAA4Bjd,IAA5B,CAAiC,IAAjC,EAAuCmd,OAAvC;EACD;EACF,aAND,MAMO;EACLA,wBAAUnW,SAASoW,OAAT,CAAiBF,QAAjB,EAA2BA,SAASrB,OAAT,CAAiBA,OAAjB,CAA3B,CAAV;EACAgB,gBAAEE,OAAF,CAAUtR,SAAV,CAAoBwR,OAApB,CAA4Bjd,IAA5B,CAAiC,IAAjC,EAAuCmd,OAAvC;EACD;EACF,WAXD,MAWO;EACL,iBAAKvP,GAAL,IAAYsP,SAASrB,OAArB,EAA8B;EAC5BsB,wBAAUnW,SAASoW,OAAT,CAAiBF,QAAjB,EAA2BA,SAASrB,OAAT,CAAiBjO,GAAjB,CAA3B,CAAV;EACAiP,gBAAEE,OAAF,CAAUtR,SAAV,CAAoBwR,OAApB,CAA4Bjd,IAA5B,CAAiC,IAAjC,EAAuCmd,OAAvC;EACD;EACF;EACF,SAlBD,MAkBO;EACLN,YAAEE,OAAF,CAAUtR,SAAV,CAAoBwR,OAApB,CAA4Bjd,IAA5B,CAAiC,IAAjC,EAAuCkd,QAAvC;EACD;EACF;EAxB2B,KAAjB,CAAb;;EA2BA,QAAIG,SAAS;EACXC,WAAK,UADM;EAEXC,WAAK,CAAC;EAFK,KAAb;EAIA,QAAIxlB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBwW,MAAxB,IAAkCzlB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBwW,MAAxB,CAA+BvhB,MAA/B,KAA0C,CAAhF,EAAmF;EACjFohB,aAAOC,GAAP,GAAavlB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBwW,MAAxB,CAA+B,CAA/B,CAAb;EACAH,aAAOE,GAAP,GAAaxlB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBwW,MAAxB,CAA+B,CAA/B,CAAb;EACD;;EAED,QAAIC,SAAS,IAAIZ,EAAEa,YAAN,CAAmB,IAAIb,EAAEQ,MAAN,CAAaA,OAAOC,GAAP,GAAa,CAA1B,EAA6BD,OAAOE,GAAP,GAAa,CAA1C,CAAnB,EAAiE,IAAIV,EAAEQ,MAAN,CAAaA,OAAOC,GAAP,GAAa,CAA1B,EAA6BD,OAAOE,GAAP,GAAa,CAA1C,CAAjE,CAAb;;EAEAxlB,OAAG4lB,IAAH,GAAU,IAAId,EAAEe,GAAN,CAAU7lB,GAAGI,OAAH,CAAWuM,MAArB,EAA6B;EACnC8Y,cAAQC,OAAOI,SAAP,EAD2B;EAEnCC,YAAM/lB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwB8W,IAAxB,IAAgC,CAFH;EAGnCC,eAAShmB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwB+W,OAAxB,IAAmC,EAHT;EAInCC,eAASjmB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBgX,OAAxB,IAAmC,CAJT;EAKnCC,iBAAWR,MALwB;EAMnCS,0BAAoB;EANe,KAA7B,CAAV;;EASA,QAAIC,WAAWtB,EAAEuB,SAAF,CAAY,oDAAZ,EAAkE;EAC7EC,mBAAa;EADgE,KAAlE,CAAf;EAGA,QAAIC,YAAY,IAAIzB,EAAEC,QAAN,EAAhB;;EAEAqB,aAASI,KAAT,CAAexmB,GAAG4lB,IAAlB;EACAa,gBAAYzmB,GAAG4jB,SAAf;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA,aAAS6C,WAAT,CAAqBC,QAArB,EAA+B;EAC7BH,gBAAUrB,OAAV,CAAkBwB,QAAlB;EACAH,gBAAUC,KAAV,CAAgBxmB,GAAG4lB,IAAnB;EACAW,gBAAUI,SAAV,CAAoBC,WAApB;EACD;;EAED,QAAI3lB,MAAMjB,GAAGe,KAAH,CAASC,EAAT,CAAYC,GAAZ,GACPqO,IADO,CACFtP,GAAGI,OAAH,CAAWa,GAAX,GAAiBjB,GAAGI,OAAH,CAAWa,GAAX,CAAeuL,IAAf,CAAoB,IAApB,CAAjB,GAA6C,UAAS9K,CAAT,EAAY;EAC7D,UAAI4N,OAAO,wDAAwD5N,EAAE2jB,OAAF,CAAUjB,UAAV,CAAqByC,OAArB,IAAgCnlB,EAAE2jB,OAAF,CAAUjB,UAAV,CAAqB0C,OAA7G,IAAwH,oBAAxH,GACT9mB,GAAGe,KAAH,CAASyB,MAAT,GAAkBd,EAAE2jB,OAAF,CAAUjB,UAAV,CAAqBpkB,GAAGI,OAAH,CAAWkiB,IAAhC,CAAlB,CADS,GACkD,eAD7D;EAEA,aAAOhT,IAAP;EACD,KALO,CAAV;EAMAtO,eAAA,CAAU,MAAMhB,GAAGI,OAAH,CAAWuM,MAA3B,EAAmC0C,MAAnC,CAA0C,2BAA1C,EAAuEpH,IAAvE,CAA4EhH,GAA5E;;EAEA;;;;EAIA,aAAS2lB,WAAT,CAAqB5Z,KAArB,EAA4B;EAC1B,UAAI3J,QAAQ2J,MAAMqY,OAAN,CAAcjB,UAAd,CAAyBpkB,GAAGI,OAAH,CAAWkiB,IAApC,CAAZ;EACA,UAAI,CAACjf,KAAL,EAAY;EACV;EACA;EACArC,mBAAA,CAAUgM,MAAM+Z,KAAhB,EAAuB7e,MAAvB;EACD,OAJD,MAIO;EACL,YAAI8e,YAAYhnB,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBrH,KAAjB,CAAhB;;EAEA2J,cAAMia,QAAN,CAAe;EACbD,qBAAWA,SADE;EAEbE,uBAAalnB,GAAGI,OAAH,CAAWkL,OAAX,IAAsB,GAFtB;EAGbZ,iBAAO,MAHM;EAIbyc,kBAAQ,CAJK;EAKb7b,mBAAS;EALI,SAAf;;EAQAtL,WAAGonB,SAAH,CAAapa,KAAb;;EAEAA,cAAMtH,EAAN,CAAS;EACP2hB,qBAAW,qBAAW;EACpBC,uBAAWta,KAAX;EACD,WAHM;EAIPua,oBAAU,oBAAW;EACnBC,uBAAWxa,KAAX;EACD;EANM,SAAT;EAQD;EACF;;EAED,aAASsa,UAAT,CAAoBta,KAApB,EAA2B;EACzB/L,UAAI0E,IAAJ,CAASqH,KAAT,EAAgBhM,WAAA,CAAUgM,MAAM+Z,KAAhB,EAAuBvhB,IAAvB,EAAhB;EACD;;EAED,aAASgiB,UAAT,CAAoBxa,KAApB,EAA2B;EACzB/L,UAAI2E,IAAJ,CAASoH,KAAT;EACD;;EAED;;;EAGA,QAAI,OAAOhN,GAAGI,OAAH,CAAWgL,MAAlB,KAA6B,UAAjC,EAA6C;EAC3CpL,SAAGI,OAAH,CAAWgL,MAAX,CAAkBnD,IAAlB,CAAuB,IAAvB,EAA6BjI,GAAG+jB,MAAhC;EACD;;EAEDL,YAAQW,eAAR;;EAEA,WAAOrkB,EAAP;EACD,GA5ID;;EA8IA;;;EAGA0jB,UAAQ0D,SAAR,GAAoB,UAASpa,KAAT,EAAgB;EAClC,QAAMhN,KAAK,IAAX;EACA,QAAMynB,QAAQza,MAAMqY,OAAN,CAAcjB,UAA5B;EACA,QAAMsD,OAAO1mB,WAAA,CAAUgM,MAAM+Z,KAAhB,EAAuBvhB,IAAvB,EAAb;EACA,QAAMmiB,OAAOD,KAAKE,OAAL,EAAb;EACA,QAAI/mB,MAAMG,WAAA,CAAU,MAAMhB,GAAGI,OAAH,CAAWuM,MAA3B,EACP0C,MADO,CACA,2BADA,CAAV;;EAGA,QAAIoY,MAAMznB,GAAGI,OAAH,CAAWkiB,IAAjB,MAA2BxgB,SAA/B,EAA0C;EACxCjB,UAAIuE,MAAJ,CAAW,MAAX,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,GAFR,EAEa2iB,KAAKtf,CAAL,GAAUsf,KAAKtnB,KAAL,GAAa,CAFpC,EAGG2E,IAHH,CAGQ,GAHR,EAGa2iB,KAAK5iB,CAAL,GAAU/D,QAAA,CAAO,CAAC2mB,KAAKpnB,MAAL,GAAc,CAAf,EAAkB,EAAlB,CAAP,CAHvB,EAIGyE,IAJH,CAIQ,aAJR,EAIuB,QAJvB,EAKGV,IALH,CAKQ,CAACmjB,MAAMZ,OAAN,IAAiBY,MAAMX,OAAxB,IAAmC,IAAnC,GAA0C9mB,GAAGe,KAAH,CAASyB,MAAT,CAAgBilB,MAAMznB,GAAGI,OAAH,CAAWkiB,IAAjB,CAAhB,CALlD;EAMD;EACD,WAAOtiB,EAAP;EACD,GAjBD;;EAoBA0jB,UAAQ1Z,IAAR,CAAa7J,MAAb;;EAEA,SAAOujB,OAAP;EACD;;ECxXD;;;;AAIA,EAAe,cAASvjB,MAAT,EAAiB;;EAE9B,WAAS0lB,GAAT,CAAa1lB,MAAb,EAAqB;EACnB,QAAIH,KAAK,IAAT;EACAA,OAAGI,OAAH,GAAaD,SAASA,MAAT,GAAkB,EAA/B;EACAH,OAAGkM,KAAH,GAAW,EAAX;EACAlM,OAAGyD,OAAH,GAAa,EAAb;EACAzD,OAAGqM,KAAH,GAAW,EAAX;EACArM,OAAGwT,IAAH,GAAUxS,GAAGC,GAAH,GAAS+D,IAAT,CAAc,OAAd,EAAuB,QAAvB,CAAV;;EAEAhF,OAAG6nB,uBAAH,GAA8B7mB,GAAGwB,MAAH,CAAU,MAAV,CAA9B;EACAxC,OAAG8nB,qBAAH,GAA8B9mB,GAAGwB,MAAH,CAAU,MAAV,CAA9B;EACAxC,OAAG+nB,sBAAH,GAA8B/mB,GAAGwB,MAAH,CAAU,MAAV,CAA9B;EACAxC,OAAGgoB,wBAAH,GAA8BhnB,GAAGwB,MAAH,CAAU,MAAV,CAA9B;;EAEAxC,OAAGuT,OAAH,GAAa,EAAb;EACAvT,OAAGuT,OAAH,CAAW0U,KAAX,GAAmBjoB,GAAG6nB,uBAAtB;EACA7nB,OAAGuT,OAAH,CAAW0P,UAAX,GAAwB,UAASvhB,CAAT,EAAW;EAAC,aAAOV,GAAGwB,MAAH,CAAU,MAAV,EAAkBd,CAAlB,IAAuB,GAA9B;EAAmC,KAAvE;EACA1B,OAAGuT,OAAH,CAAWZ,MAAX,GAAqB3R,GAAGwB,MAAH,CAAU,MAAV,CAArB;EAED;;EAED;EACA;;EAEAqjB,MAAInS,SAAJ,CAAcS,EAAd,GAAmB,UAASuN,GAAT,EAAc;EAC/B,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW+T,EAAX,GAAgBuN,GAAhB;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMA6lB,MAAInS,SAAJ,CAAchJ,KAAd,GAAsB,UAASgX,GAAT,EAAc;EAClC,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWsK,KAAX,GAAmBgX,GAAnB;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMA6lB,MAAInS,SAAJ,CAAczS,GAAd,GAAoB,UAASA,GAAT,EAAa;EAC/B,QAAIjB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACAjB,OAAGwT,IAAH,CAAQlE,IAAR,CAAatP,GAAGI,OAAH,CAAWa,GAAxB;EACA,WAAOjB,EAAP;EACD,GALD;;EAOA6lB,MAAInS,SAAJ,CAAc6P,OAAd,GAAwB,UAASA,OAAT,EAAiB;EACvC,QAAIvjB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWmjB,OAAX,GAAqBA,OAArB;EACA,WAAOvjB,EAAP;EACD,GAJD;;EAMA6lB,MAAInS,SAAJ,CAAcE,GAAd,GAAoB,YAAW;EAC7B,QAAI5T,KAAK,IAAT;EACA,WAAOA,GAAG6T,MAAV;EACD,GAHD;;EAKA;EACA;EACAgS,MAAInS,SAAJ,CAAcxT,KAAd,GAAsB,UAASA,KAAT,EAAgB;EACpC,QAAIF,KAAK,IAAT;EACAA,OAAG6T,MAAH,GAAY3T,KAAZ;EACA,WAAOF,EAAP;EACD,GAJD;;EAOA6lB,MAAInS,SAAJ,CAActS,IAAd,GAAqB,UAASA,IAAT,EAAe;EAClC,QAAIpB,KAAK,IAAT;;EAEA,QAAGA,GAAGI,OAAH,CAAWgB,IAAX,CAAgBuZ,MAAnB,EAA0B;EACxBvZ,aAAOA,KAAKuZ,MAAL,CAAY3a,GAAGI,OAAH,CAAWgB,IAAX,CAAgBuZ,MAA5B,CAAP;EACD;;EAED3a,OAAGkM,KAAH,GAAW9K,IAAX;EACApB,OAAGkoB,UAAH,GAAgBloB,GAAGmoB,YAAH,CAAgB/mB,IAAhB,CAAhB;EACApB,OAAG6jB,OAAH,GAAa7iB,GAAGonB,MAAH,CAAUhnB,IAAV,EAAgB,UAASM,CAAT,EAAY;EAAE,aAAO,CAACA,EAAE1B,GAAGI,OAAH,CAAWsK,KAAb,CAAR;EAA8B,KAA5D,CAAb;;EAEA1K,OAAGI,OAAH,CAAWqB,GAAX,CAAeoG,GAAf,GAAqB7H,GAAG6jB,OAAH,CAAW,CAAX,CAArB;EACA7jB,OAAGI,OAAH,CAAWqB,GAAX,CAAemG,GAAf,GAAqB5H,GAAG6jB,OAAH,CAAW,CAAX,CAArB;;EAEA,WAAO7jB,EAAP;EACD,GAfD;;EAiBA6lB,MAAInS,SAAJ,CAAcpG,MAAd,GAAuB,UAASyG,CAAT,EAAY;EACjC,QAAI/T,KAAK,IAAT;EACAA,OAAGyD,OAAH,GAAasQ,CAAb;EACA,WAAO/T,EAAP;EACD,GAJD;;EAMA6lB,MAAInS,SAAJ,CAAc7F,IAAd,GAAqB,UAAS7H,CAAT,EAAY;EAC/B,QAAIhG,KAAK,IAAT;EACAA,OAAGqM,KAAH,GAAWrG,CAAX;EACA,WAAOhG,EAAP;EACD,GAJD;;EAMA6lB,MAAInS,SAAJ,CAAcpS,OAAd,GAAwB,YAAW;EACjC,QAAItB,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKA6lB,MAAInS,SAAJ,CAActG,IAAd,GAAsB,YAAU;EAC9B,QAAIpN,KAAK,IAAT;;EAEA;EACA,QAAI2kB,cAAc3kB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBC,GAA1C;EACA,QAAI4U,UAAU9jB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwB6U,OAAtC,CAL8B;EAM9B,QAAIc,OAAO5kB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwB4V,SAAnC,CAN8B;EAO9B,QAAIxjB,QAAQrB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwB5N,KAApC;;EAEA;;;;;EAKA,QAAI6iB,SAASlkB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBiV,MAArC;EACA;;;;EAIA,QAAI/P,KAAKnU,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwBkF,EAAjC;;EAEA;EACAnU,OAAG6T,MAAH,CAAU/S,IAAV,CAAemH,IAAf,CAAoBjI,GAAGwT,IAAvB;;EAEAxT,OAAGqoB,WAAH,GAAiBrnB,GAAGsnB,WAAH;EACb;EADa,KAEZjnB,KAFY,CAENA,KAFM,EAGZwjB,SAHY,CAGFD,IAHE,CAAjB;;EAKA5kB,OAAG0nB,IAAH,GAAU1mB,GAAGunB,OAAH,GACLC,UADK,CACMxoB,GAAGqoB,WADT,CAAV;;EAGAroB,OAAGyoB,SAAH,GAAezoB,GAAG6T,MAAH,CAAU/S,IAAV,CAAesE,MAAf,CAAsB,GAAtB,EACVJ,IADU,CACL,IADK,EACC,mBADD,EAEVvE,KAFU,CAEJ,SAFI,EAEO,MAFP,EAGVuE,IAHU,CAGL,WAHK,EAGQ,YAAW;EAC1B,aAAO,eAAgBhF,GAAGI,OAAH,CAAW8J,IAAX,CAAgBwe,UAAhC,GAA8C,cAA9C,GAA+D1oB,GAAGI,OAAH,CAAW8J,IAAX,CAAgB7I,KAA/E,GAAuF,GAA9F;EACH,KALU,CAAf;;EAOAL,OAAG6N,IAAH,CAAQ8V,WAAR,EAAqB,UAASlX,KAAT,EAAgBkb,CAAhB,EAAmB;EACtC,UAAIC,WAAW3Z,SAASoW,OAAT,CAAiBsD,CAAjB,EAAoBA,EAAE7E,OAAF,CAAUA,OAAV,CAApB,EAAwC8E,QAAvD;EACA;EACA,UAAI,OAAO5oB,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwB0L,MAA/B,IAAyC,WAA7C,EAA0D;EACxD,YAAIA,SAAS3a,GAAGI,OAAH,CAAWqB,GAAX,CAAewN,QAAf,CAAwB0L,MAArC;EACA/I,gBAAQC,GAAR,CAAY8I,MAAZ;EACA9N,eAAO2F,IAAP,CAAYmI,MAAZ,EAAoBlZ,GAApB,CAAwB,UAASoU,GAAT,EAAc;EACpC+S,qBAAWA,SAASjO,MAAT,CAAgB;EAAA,mBAAW0K,QAAQjB,UAAR,CAAmBvO,GAAnB,MAA4B8E,OAAO9E,GAAP,CAAvC;EAAA,WAAhB,CAAX;EACD,SAFD;EAGD;EACD7V,SAAGyoB,SAAH,CAAazgB,SAAb,CAAuB,MAAvB,EACK5G,IADL,CACUwnB,QADV,EACoB1E,MADpB,EAEK9d,KAFL,GAEahB,MAFb,CAEoB,MAFpB,EAGKJ,IAHL,CAGU,GAHV,EAGehE,GAAGunB,OAAH,GAAaC,UAAb,CAAwBxoB,GAAGqoB,WAA3B,CAHf,EAIKrjB,IAJL,CAIU,IAJV,EAIgBmP,EAJhB,EAKKnP,IALL,CAKU,cALV,EAK0B8e,OAL1B,EAMK9e,IANL,CAMU,MANV,EAMkB,SANlB,EAOKA,IAPL,CAOU,QAPV,EAOoB,SAPpB,EAQKvE,KARL,CAQW,cARX,EAQ2B,KAR3B,EASKiF,EATL,CASQ,WATR,EASqB,UAAShE,CAAT,EAAYmE,CAAZ,EAAe;EAC9B,YAAI7F,GAAGI,OAAH,CAAWgB,IAAX,CAAgBynB,WAApB,EAAiC;EAAE;EACjC7oB,aAAGI,OAAH,CAAWgB,IAAX,CAAgBynB,WAAhB,CAA4B5gB,IAA5B,CAAiC,IAAjC,EAAuCvG,CAAvC,EAA0CmE,CAA1C;EACD;;EAED,YAAG7F,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBsE,aAA5B,EAA0C;EAAE;EAC1C9nB,aAAGqO,MAAH,CAAU,IAAV,EAAgBrK,IAAhB,CAAqB,MAArB,EAA6B,UAAStD,CAAT,EAAY;EACrC,mBAAO1B,GAAG+oB,iBAAH,CAAqBrnB,EAAE1B,GAAGI,OAAH,CAAWsK,KAAb,CAArB,EAAyC,SAAzC,CAAP;EACH,WAFD;EAGD;;EAED1K,WAAGwT,IAAH,CAAQ7N,IAAR,CAAajE,CAAb,EAAgBV,GAAGqO,MAAH,CAAU,IAAV,EAAgB7J,IAAhB,EAAhB,EAX8B;EAY/B,OArBL,EAsBKE,EAtBL,CAsBQ,UAtBR,EAsBoB,UAAShE,CAAT,EAAYmE,CAAZ,EAAe;EAC3B,YAAI7F,GAAGI,OAAH,CAAWgB,IAAX,CAAgB4nB,UAApB,EAAgC;EAAE;EAC9BhpB,aAAGI,OAAH,CAAWgB,IAAX,CAAgB4nB,UAAhB,CAA2B/gB,IAA3B,CAAgC,IAAhC,EAAsCvG,CAAtC,EAAyCmE,CAAzC;EACH;;EAED,YAAG7F,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBsE,aAA5B,EAA0C;EAAE;EAC1C9nB,aAAGqO,MAAH,CAAU,IAAV,EAAgBrK,IAAhB,CAAqB,MAArB,EAA6B,UAAStD,CAAT,EAAY;EACrC,mBAAO1B,GAAG+oB,iBAAH,CAAqBrnB,EAAE1B,GAAGI,OAAH,CAAWsK,KAAb,CAArB,EAAyC,SAAzC,CAAP;EACH,WAFD;EAGD;EACD;EACA1K,WAAGwT,IAAH,CAAQ5N,IAAR,CAAalE,CAAb,EAAgBV,GAAGqO,MAAH,CAAU,IAAV,EAAgB7J,IAAhB,EAAhB;EAEH,OAnCL,EAoCKE,EApCL,CAoCQ,OApCR,EAoCiB,UAAShE,CAAT,EAAYmE,CAAZ,EAAe;EACxB,YAAI7F,GAAGI,OAAH,CAAWgB,IAAX,CAAgBmiB,OAApB,EAA6B;EACzBvjB,aAAGI,OAAH,CAAWgB,IAAX,CAAgBmiB,OAAhB,CAAwBtb,IAAxB,CAA6B,IAA7B,EAAmCvG,CAAnC,EAAsCmE,CAAtC;EACH;EACJ,OAxCL;;EA0CA7F,SAAGipB,gBAAH,GAAsBjpB,GAAGyoB,SAAH,CAAazgB,SAAb,CAAuB,MAAvB,EAA+B5G,IAA/B,EAAtB;;EAEApB,SAAGyoB,SAAH,CAAazgB,SAAb,CAAuB,MAAvB,EAA+BhD,IAA/B,CAAoC,QAApC,EAA8C,MAA9C,EAAsDA,IAAtD,CAA2D,cAA3D,EAA2E,GAA3E;EACAhF,SAAGyoB,SAAH,CAAazgB,SAAb,CAAuB,MAAvB,EAA+BhD,IAA/B,CAAoC,MAApC,EAA4C,KAA5C;EACAhF,SAAGyoB,SAAH,CAAazgB,SAAb,CAAuB,MAAvB,EAA+BhD,IAA/B,CAAoC,YAApC,EAAkD,IAAlD;EACAhF,SAAGyoB,SAAH,CAAazgB,SAAb,CAAuB,MAAvB,EACK5G,IADL,CACUpB,GAAGkM,KADb,EACoB,UAASxK,CAAT,EAAY;EAC1B;EACA,eAAOA,EAAEyS,EAAF,GAAOzS,EAAEyS,EAAT,GAAczS,EAAE1B,GAAGI,OAAH,CAAW+T,EAAb,CAArB;EACD,OAJL,EAKKnP,IALL,CAKU,MALV,EAKkB,UAAStD,CAAT,EAAY;EACtB,eAAO1B,GAAG+oB,iBAAH,CAAqBrnB,EAAE1B,GAAGI,OAAH,CAAWsK,KAAb,CAArB,EAAyC,SAAzC,CAAP;EACH,OAPL,EAQK1F,IARL,CAQU,YARV,EAQwB,UAAStD,CAAT,EAAY;EAC5B,eAAO,CAACA,EAAE1B,GAAGI,OAAH,CAAWsK,KAAb,CAAR;EACH,OAVL;;EAYA;EACA1K,SAAGyoB,SAAH,CAAazgB,SAAb,CAAuB,MAAvB,EAA+B5G,IAA/B,CAAoCpB,GAAGipB,gBAAvC,EAAyD,UAASvnB,CAAT,EAAY;EACjE,eAAOA,EAAEyS,EAAT;EACH,OAFD;EAGD,KAzED;EA2ED,GAlHD;;EAoHA0R,MAAInS,SAAJ,CAAcyU,YAAd,GAA6B,UAAS/mB,IAAT,EAAc;EACzC,QAAIpB,KAAK,IAAT;EACA,QAAIwO,SAAS,EAAb;EACA,QAAI0a,WAAW,EAAf;;EAEA,QAAGlpB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,IAA6BxkB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyB2E,mBAAtD,IACInpB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyB2E,mBAAzB,CAA6CjlB,MAA7C,GAAsD,CAD7D,EAC+D;EAC7D,aAAOlE,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyB2E,mBAAhC;EACD;;EAED/nB,SAAK+N,OAAL,CAAa,UAASzN,CAAT,EAAW;EACtB8M,aAAOlJ,IAAP,CAAY,CAAC5D,EAAE1B,GAAGI,OAAH,CAAWsK,KAAb,CAAb;EACD,KAFD;;EAIA8D,WAAO0E,IAAP,CAAYlS,GAAGooB,SAAf;;EAEA;EACA,QAAGppB,GAAGI,OAAH,IAAcJ,GAAGI,OAAH,CAAWqB,GAAzB,IAAgCzB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAA/C,IAA4DxkB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBrW,OAAxF,EAAgG;;EAE9F,UAAGnO,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyB6E,WAAzB,KAAyC,IAA5C,EAAiD;EAC/C,YAAIC,MAAMvpB,EAAEwpB,SAAF,CAAY/a,MAAZ,EAAoB,UAASJ,CAAT,EAAY;EAAE,iBAAOA,KAAK,CAAZ;EAAe,SAAjD,CAAV;EACA;;EAEA8a,iBAAS5jB,IAAT,CAAckJ,OAAO,CAAP,CAAd;EACA0a,iBAAS5jB,IAAT,CAAc,CAAd;;EAEA,aAAI,IAAIO,IAAI,CAAZ,EAAeA,KAAK7F,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBrW,OAAzB,GAAmC,CAAvD,EAA0DtI,GAA1D,EAA+D;EAC7DqjB,mBAAS5jB,IAAT,CAAetE,GAAGkoB,QAAH,CAAYI,GAAZ,EAAkBzjB,IAAG,CAAH,IAAM7F,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBrW,OAAzB,GAAmC,CAAzC,CAAlB,CAAf;EACD;EAEF,OAXD,MAWK;EACH+a,iBAAS5jB,IAAT,CAAetE,GAAGkoB,QAAH,CAAY1a,MAAZ,EAAoB,CAApB,CAAf;EACA,aAAI,IAAI3I,IAAI,CAAZ,EAAeA,KAAK7F,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBrW,OAA7C,EAAsDtI,GAAtD,EAA2D;EACzDqjB,mBAAS5jB,IAAT,CAAetE,GAAGkoB,QAAH,CAAY1a,MAAZ,EAAqB3I,IAAG,CAAH,GAAK7F,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBrW,OAAnD,CAAf;EACD;EACF;EAEF,KApBD,MAoBK;EACH+a,iBAAW,CAAEloB,GAAGkoB,QAAH,CAAY1a,MAAZ,EAAoB,CAApB,CAAF,EAA0BxN,GAAGkoB,QAAH,CAAY1a,MAAZ,EAAoB,GAApB,CAA1B,EAAoDxN,GAAGkoB,QAAH,CAAY1a,MAAZ,EAAoB,GAApB,CAApD,EAA8ExN,GAAGkoB,QAAH,CAAY1a,MAAZ,EAAoB,GAApB,CAA9E,EAAwGxN,GAAGkoB,QAAH,CAAY1a,MAAZ,EAAoB,GAApB,CAAxG,EAAkIxN,GAAGkoB,QAAH,CAAY1a,MAAZ,EAAmB,CAAnB,CAAlI,CAAX;EACD;;EAED;EACA,QAAIxO,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,IAA4BxkB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBrW,OAArD,IACGnO,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBrW,OAAzB,KAAqC,CAD5C,EAC8C;;EAE5C,UAAI+a,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAAhB,IAA+BA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAA/C,IAA8DA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAA9E,IAA6FA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAAjH,EAA6H;EAC3HA,mBAAW,CAAEloB,GAAGkoB,QAAH,CAAY1a,MAAZ,EAAoB,CAApB,CAAF,EAA0BxN,GAAGkoB,QAAH,CAAY1a,MAAZ,EAAoB,GAApB,CAA1B,CAAX;EACD;EACF;;EAED,WAAO0a,QAAP;EACD,GAnDD;;EAqDArD,MAAInS,SAAJ,CAAcqV,iBAAd,GAAkC,UAASrnB,CAAT,EAAWK,IAAX,EAAgB;EAChD,QAAI/B,KAAK,IAAT;EACA,QAAIioB,QAAQ/iB,WAAWxD,CAAX,CAAZ;;EAEA;EACA,QAAG1B,GAAGI,OAAH,IAAcJ,GAAGI,OAAH,CAAWqB,GAAzB,IAAgCzB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAA/C,IAA4DxkB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBtU,MAAxF,EAA+F;EAC7F,UAAGlQ,GAAGkoB,UAAH,CAAchkB,MAAd,GAAuB,CAA1B,EAA4B;;EAE1B,YAAGlE,GAAGI,OAAH,IAAcJ,GAAGI,OAAH,CAAWqB,GAAzB,IAAgCzB,GAAGI,OAAH,CAAWqB,GAAX,CAAeoG,GAAf,KAAuB/F,SAAvD,IAAoE9B,GAAGI,OAAH,CAAWqB,GAAX,CAAemG,GAAf,KAAuB9F,SAA9F,EAAwG;EACtG,cAAGmmB,QAAQjoB,GAAGI,OAAH,CAAWqB,GAAX,CAAeoG,GAAvB,IAA8BogB,QAAQjoB,GAAGI,OAAH,CAAWqB,GAAX,CAAemG,GAAxD,EAA4D;EAC1DgK,oBAAQC,GAAR,CAAY,iBAAZ,EAA+BoW,KAA/B,EAAsCjoB,GAAGI,OAAH,CAAWqB,GAAX,CAAeoG,GAArD,EAA0D7H,GAAGI,OAAH,CAAWqB,GAAX,CAAemG,GAAzE;EACA,mBAAO5H,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBgF,eAAhC;EACD;EACF,SALD,MAKK;EACH,cAAGvB,QAAQjoB,GAAG6jB,OAAH,CAAW,CAAX,CAAR,IAAyBoE,QAAQjoB,GAAG6jB,OAAH,CAAW,CAAX,CAApC,EAAkD;EAChDjS,oBAAQC,GAAR,CAAY,iBAAZ,EAA+BoW,KAA/B,EAAsCjoB,GAAGI,OAAH,CAAWqB,GAAX,CAAeoG,GAArD,EAA0D7H,GAAGI,OAAH,CAAWqB,GAAX,CAAemG,GAAzE;EACA,mBAAO5H,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBgF,eAAhC;EACD;EACF;;EAED,YAAGznB,QAAQ,SAAX,EAAqB;EACnB,cAAGkmB,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAZ,EAA6B;EAC3B,mBAAOloB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBtU,MAAzB,CAAgC,CAAhC,CAAP,CAD2B;EAE5B,WAFD,MAEM,IAAG+X,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOloB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBtU,MAAzB,CAAgC,CAAhC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAG+X,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOloB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBtU,MAAzB,CAAgC,CAAhC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAG+X,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOloB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBtU,MAAzB,CAAgC,CAAhC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAG+X,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOloB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBtU,MAAzB,CAAgC,CAAhC,CAAP,CADiC;EAElC;EACF;;EAED,YAAGnO,QAAQ,SAAR,IAAqB/B,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBsE,aAAjD,EAA+D;EAC7D,cAAGb,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAZ,EAA6B;EAC3B,mBAAOloB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBsE,aAAzB,CAAuC,CAAvC,CAAP,CAD2B;EAE5B,WAFD,MAEM,IAAGb,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOloB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBsE,aAAzB,CAAuC,CAAvC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAGb,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOloB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBsE,aAAzB,CAAuC,CAAvC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAGb,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOloB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBsE,aAAzB,CAAuC,CAAvC,CAAP,CADiC;EAElC,WAFK,MAEA,IAAGb,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAZ,EAA6B;EACjC,mBAAOloB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBsE,aAAzB,CAAuC,CAAvC,CAAP,CADiC;EAElC;EACF;EAEF;EACF;;EAED,QAAG9oB,GAAGkoB,UAAH,CAAchkB,MAAd,IAAwB,CAA3B,EAA6B;EAC3B;;;;;EAKA,UAAG+jB,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAZ,EAA6B;EAC3B,eAAOloB,GAAGI,OAAH,CAAWqB,GAAX,CAAe+iB,SAAf,CAAyBtU,MAAzB,CAAgC,CAAhC,CAAP,CAD2B;EAE5B;EACF;EAEF,GA9DD;;EAkED,SAAO,IAAI2V,GAAJ,CAAQ1lB,MAAR,CAAP;EACA;;EClVD;;;;AAIA,EAAe,gBAASA,MAAT,EAAiB;EAC9B,WAASspB,KAAT,CAAetpB,MAAf,EAAuB;EACrB,QAAIH,KAAK,IAAT;EAAA,QAAekK,IAAf;;EAEAlK,OAAG0pB,cAAH,GAAoB,IAAIpiB,KAAKqiB,EAA7B;;EAEA;EACA3pB,OAAG4pB,iBAAH,GAAuB5pB,GAAG0pB,cAAH,GAAoB,CAAC,CAA5C;;EAEA1pB,OAAGI,OAAH,GAAaD,SAASA,MAAT,GAAkB,EAA/B;EACAH,OAAGkM,KAAH,GAAW,EAAX;EACAlM,OAAGyD,OAAH,GAAa,EAAb;EACAzD,OAAGqM,KAAH,GAAW,EAAX;EACArM,OAAG6pB,SAAH,GAAe,EAAf;EACA7pB,OAAG8pB,OAAH,GAAa,IAAb;EACA9pB,OAAG6jB,OAAH,GAAa,CAAC,CAAD,EAAI,CAAJ,CAAb;EACA7jB,OAAG+pB,SAAH,GAAe,EAAf;EACA/pB,OAAGgqB,SAAH,GAAe,EAAf;EACAhqB,OAAGiqB,MAAH,GAAY,CAAZ;EACAjqB,OAAGkqB,MAAH,GAAY,IAAZ;EACAlqB,OAAGmqB,iBAAH,GAAuB,EAAvB;;EAEA;EACA,QAAG,CAACnqB,GAAGI,OAAH,CAAWuD,KAAf,EAAsB;EACpB3D,SAAGI,OAAH,CAAWuD,KAAX,GAAmB,EAAnB;EACD;;EAED,QAAG,CAAC3D,GAAGI,OAAH,CAAWgqB,kBAAf,EAAmC;EACjCpqB,SAAGI,OAAH,CAAWgqB,kBAAX,GAAgC,GAAhC;EACD;;EAED,QAAG,CAACpqB,GAAGI,OAAH,CAAWiqB,eAAf,EAAgC;EAC9BrqB,SAAGI,OAAH,CAAWiqB,eAAX,GAA6B,EAA7B;EACD;;EAED,QAAG,CAACrqB,GAAGI,OAAH,CAAWgL,MAAf,EAAuB;EACrBpL,SAAGI,OAAH,CAAWgL,MAAX,GAAoB;EAClBkf,gBAAQ;EADU,OAApB;EAGD;;EAED,QAAG,CAACtqB,GAAGI,OAAH,CAAWgL,MAAX,CAAkBmf,EAAtB,EAA0B;EACxBvqB,SAAGI,OAAH,CAAWgL,MAAX,CAAkBmf,EAAlB,GAAuB;EACrBliB,WAAG,EADkB;EAErBtD,WAAG;EAFkB,OAAvB;EAID;;EAED,QAAG,eAAe,OAAO/E,GAAGI,OAAH,CAAWoqB,aAApC,EAAmD;EACjDxqB,SAAGI,OAAH,CAAWoqB,aAAX,GAA2B,IAA3B;EACD;;EAED;EACAtgB,WAAOlK,GAAGI,OAAH,CAAW8J,IAAlB;;EAEAlK,OAAGyqB,OAAH,GAAa;EACXpiB,SAAI6B,KAAK7J,KAAL,GAAa,CAAd,GAAmB6J,KAAKC,MAAL,CAAYC,IADvB;EAEXrF,SAAImF,KAAK3J,MAAL,GAAc,CAAf,GAAoB2J,KAAKC,MAAL,CAAYG;EAFxB,KAAb;;EAKAtK,OAAG0qB,OAAH,GAAapjB,KAAKO,GAAL,CACX,CAACqC,KAAK7J,KAAL,GAAa6J,KAAKC,MAAL,CAAYC,IAAzB,GAAgCF,KAAKC,MAAL,CAAYE,KAA7C,IAAsD,CAD3C,EAEX,CAACH,KAAK3J,MAAL,GAAc2J,KAAKC,MAAL,CAAYG,GAA1B,GAAgCJ,KAAKC,MAAL,CAAYI,MAA7C,IAAuD,CAF5C,CAAb;EAID;;EAED;;EAEAkf,QAAM/V,SAAN,CAAgBiX,YAAhB,GAA+B,UAAShpB,MAAT,EAAiB;EAC9C,QAAI3B,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWuqB,YAAX,GAA0BhpB,MAA1B;EACA,WAAO3B,EAAP;EACD,GAJD;;EAMAypB,QAAM/V,SAAN,CAAgBkX,QAAhB,GAA2B,UAASjpB,MAAT,EAAiB;EAC1C,QAAI3B,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWwqB,QAAX,GAAsBjpB,MAAtB;EACA,WAAO3B,EAAP;EACD,GAJD;;EAMAypB,QAAM/V,SAAN,CAAgBmX,UAAhB,GAA6B,UAASlpB,MAAT,EAAiB;EAC5C,QAAI3B,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWyqB,UAAX,GAAwBlpB,MAAxB;EACA,WAAO3B,EAAP;EACD,GAJD;;EAMAypB,QAAM/V,SAAN,CAAgB/P,KAAhB,GAAwB,UAASA,KAAT,EAAgB;EACtC,QAAI3D,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWuD,KAAX,GAAmBA,KAAnB;EACA,WAAO3D,EAAP;EACD,GAJD;;EAMAypB,QAAM/V,SAAN,CAAgBxD,MAAhB,GAAyB,UAASA,MAAT,EAAiB;EACxC,QAAIlQ,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW8P,MAAX,GAAoBA,MAApB;EACA,WAAOlQ,EAAP;EACD,GAJD;;EAMAypB,QAAM/V,SAAN,CAAgBE,GAAhB,GAAsB,YAAW;EAC/B,QAAI5T,KAAK,IAAT;EACA,WAAOA,GAAG6T,MAAV;EACD,GAHD;;EAKA;;EAEA4V,QAAM/V,SAAN,CAAgBoX,SAAhB,GAA4B,YAAW;EACrC,QAAI9qB,KAAK,IAAT;EAAA,QACEa,MAAMb,GAAG6T,MAAH,CAAU/S,IADlB;EAAA,QAEEiqB,MAAM/qB,GAAGI,OAAH,CAAWgqB,kBAFnB;EAAA,QAGEY,GAHF;;EAKAA,UAAMnqB,IAAIwO,MAAJ,CAAW,SAAX,CAAN;;EAEA,QAAG2b,IAAIC,KAAJ,EAAH,EAAgB;EACdD,YAAMnqB,IAAIuE,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB,OAArB,EAA8B,OAA9B,CAAN;EACD;;EAEDgmB,UAAMA,IAAIhjB,SAAJ,CAAc,aAAd,EACH5G,IADG;EAEF;EACA;EACA;EACA;EACApB,OAAGiqB,MAAH,CAAUxoB,GAAV,CAAc,UAACsgB,GAAD,EAAM5E,GAAN;EAAA,aAAc,CAACA,GAAD,EAAM4E,GAAN,CAAd;EAAA,KAAd,EAAwCrd,OAAxC,EANE,EAOF;EAAA,aAAKhD,EAAE,CAAF,CAAL;EAAA,KAPE,CAAN;;EASAspB,QACGzT,UADH,GAEGC,QAFH,CAEYuT,GAFZ,EAGG/lB,IAHH,CAGQ,GAHR,EAGa,UAAStD,CAAT,EAAY;EAAE,aAAO1B,GAAGkqB,MAAH,CAAUxoB,EAAE,CAAF,CAAV,CAAP;EAAyB,KAHpD;;EAKAspB,QAAI5kB,KAAJ,GACGhB,MADH,CACU,QADV,EAEGoK,OAFH,CAEW,MAFX,EAEmB,IAFnB,EAGGxK,IAHH,CAGQ,IAHR,EAGchF,GAAGyqB,OAAH,CAAWpiB,CAHzB,EAIGrD,IAJH,CAIQ,IAJR,EAIchF,GAAGyqB,OAAH,CAAW1lB,CAJzB,EAKGtE,KALH,CAKS,MALT,EAKiBT,GAAGkrB,gBAAH,CAAoB,MAApB,CALjB,EAMGzqB,KANH,CAMS,QANT,EAMmBT,GAAGkrB,gBAAH,CAAoB,MAApB,CANnB,EAOGlmB,IAPH,CAOQ,GAPR,EAOa,UAAStD,CAAT,EAAY;EAAE,aAAO1B,GAAGkqB,MAAH,CAAUxoB,EAAE,CAAF,CAAV,CAAP;EAAyB,KAPpD,EAQGsD,IARH,CAQQ,SARR,EAQmB,CARnB,EASGuS,UATH,GAUGC,QAVH,CAUYuT,GAVZ,EAWG/lB,IAXH,CAWQ,SAXR,EAWmB,CAXnB;;EAaAgmB,QAAI1kB,IAAJ,GACGiR,UADH,GAEGC,QAFH,CAEYuT,GAFZ,EAGG/lB,IAHH,CAGQ,SAHR,EAGmB,CAHnB,EAIGkD,MAJH;EAKD,GA5CD;;EA8CAuhB,QAAM/V,SAAN,CAAgByX,eAAhB,GAAkC,YAAW;EAC3C,QAAInrB,KAAK,IAAT;EAAA,QACEa,MAAMb,GAAG6T,MAAH,CAAU/S,IADlB;EAAA,QAEEqJ,SAAS,CAFX;EAAA,QAGE4gB,MAAM/qB,GAAGI,OAAH,CAAWgqB,kBAHnB;EAAA,QAIEY,GAJF;;EAMAA,UAAMnqB,IAAIwO,MAAJ,CAAW,gBAAX,CAAN;;EAEA,QAAG2b,IAAIC,KAAJ,EAAH,EAAgB;EACdD,YAAMnqB,IAAIuE,MAAJ,CAAW,GAAX,EAAgBJ,IAAhB,CAAqB,OAArB,EAA8B,cAA9B,CAAN;EACD;;EAEDgmB,UAAMA,IAAIhjB,SAAJ,CAAc,iBAAd,EACH5G,IADG,CACEpB,GAAGiqB,MADL,CAAN;;EAGAe,QACGzT,UADH,GAEGC,QAFH,CAEYuT,GAFZ,EAGGzmB,IAHH,CAGQ,UAAS5C,CAAT,EAAY;EAAE,aAAOA,CAAP;EAAW,KAHjC,EAIGsD,IAJH,CAIQ,GAJR,EAIa,UAAStD,CAAT,EAAY;EAAE,aAAO1B,GAAGyqB,OAAH,CAAW1lB,CAAX,GAAeoF,MAAf,GAAwBnK,GAAGkqB,MAAH,CAAUxoB,CAAV,CAA/B;EAA8C,KAJzE;;EAMAspB,QAAI5kB,KAAJ,GACGhB,MADH,CACU,MADV,EAEGd,IAFH,CAEQ,UAAS5C,CAAT,EAAY;EAAE,aAAOA,CAAP;EAAW,KAFjC,EAGGsD,IAHH,CAGQ,OAHR,EAGiB,YAHjB,EAIGA,IAJH,CAIQ,GAJR,EAIahF,GAAGyqB,OAAH,CAAWpiB,CAAX,GAAe8B,MAJ5B,EAKGnF,IALH,CAKQ,GALR,EAKa,UAAStD,CAAT,EAAY;EAAE,aAAO1B,GAAGyqB,OAAH,CAAW1lB,CAAX,GAAeoF,MAAf,GAAwBnK,GAAGkqB,MAAH,CAAUxoB,CAAV,CAA/B;EAA8C,KALzE,EAMGsD,IANH,CAMQ,MANR,EAMgBhF,GAAGkrB,gBAAH,CAAoB,MAApB,CANhB,EAOGzqB,KAPH,CAOS,aAPT,EAOwBT,GAAGkrB,gBAAH,CAAoB,YAApB,CAPxB,EAQGlmB,IARH,CAQQ,SARR,EAQmB,CARnB,EASGuS,UATH,GAUGC,QAVH,CAUYuT,GAVZ,EAWG/lB,IAXH,CAWQ,SAXR,EAWmB,CAXnB;;EAaAgmB,QAAI1kB,IAAJ,GACGiR,UADH,GAEGC,QAFH,CAEYuT,GAFZ,EAGG/lB,IAHH,CAGQ,SAHR,EAGmB,CAHnB,EAIGkD,MAJH;EAKD,GAxCD;;EA0CAuhB,QAAM/V,SAAN,CAAgB0X,WAAhB,GAA8B,UAAShqB,IAAT,EAAe;EAC3C,QAAIiqB,MAAJ;EAAA,QACErrB,KAAK,IADP;EAAA,QAEE6N,OAAO7N,GAAGI,OAAH,CAAWwqB,QAFpB;EAAA,QAGEU,cAHF;;EAKAD,aAASjqB,KAAKmqB,MAAL,CACP,UAASC,IAAT,EAAeC,IAAf,EAAqB;EACnB,aAAOD,KAAKpnB,OAAL,CAAaqnB,KAAK5d,IAAL,CAAb,IAA2B,CAAC,CAA5B,GACH2d,IADG,GAEHA,KAAKE,MAAL,CAAYD,KAAK5d,IAAL,CAAZ,CAFJ;EAGD,KALM,EAKJ,EALI,CAAT;;EAOAyd,qBAAkBtrB,GAAG0pB,cAAH,GAAoB2B,OAAOnnB,MAA7C;;EAEAmnB,aAASA,OAAO5pB,GAAP,CACP,UAASgqB,IAAT,EAAetO,GAAf,EAAoB;EAClB,aAAO;EACLra,cAAM2oB,IADD;EAELE,cAAOxO,MAAMmO,cAAP,GAAyBtrB,GAAG4pB;EAF7B,OAAP;EAID,KANM,CAAT;;EAQA,WAAO;EACLgC,YAAMP,MADD;EAELQ,YAAMR,OAAOE,MAAP,CAAc,UAASO,MAAT,EAAiBC,EAAjB,EAAqB;EACvCD,eAAOC,GAAGjpB,IAAV,IAAkBipB,EAAlB;EACA,eAAOD,MAAP;EACD,OAHK,EAGH,EAHG;EAFD,KAAP;EAOD,GA9BD;;EAgCArC,QAAM/V,SAAN,CAAgBsY,aAAhB,GAAgC,UAAS5qB,IAAT,EAAe;EAC7C,QAAIpB,KAAK,IAAT;EAAA,QACEkQ,SAASlQ,GAAGI,OAAH,CAAW8P,MADtB;EAEA,WAAO9O,KAAKmqB,MAAL,CAAY,UAASU,IAAT,EAAezK,GAAf,EAAoB;EACrC,UAAI0K,QAAQ1K,IAAIxhB,GAAGI,OAAH,CAAWuqB,YAAf,CAAZ;EAAA,UACEwB,OAAOF,KAAKhoB,KAAL,CAAWG,OAAX,CAAmB8nB,KAAnB,CADT;;EAGA,UAAGC,QAAQ,CAAC,CAAZ,EAAe;EACbA,eAAOF,KAAKhoB,KAAL,CAAWqB,IAAX,CAAgB4mB,KAAhB,IAAyB,CAAhC;EACAD,aAAKJ,IAAL,CAAUK,KAAV,IAAmBhc,OAAOic,IAAP,CAAnB;EACAF,aAAKL,IAAL,CAAUtmB,IAAV,CAAe,EAAC8mB,SAASF,KAAV,EAAiBxhB,OAAOwF,OAAOic,IAAP,CAAxB,EAAf;EACD;EACD,aAAOF,IAAP;EACD,KAVM,EAUJ,EAAChoB,OAAO,EAAR,EAAY4nB,MAAM,EAAlB,EAAsBD,MAAM,EAA5B,EAVI,CAAP;EAWD,GAdD;;EAgBAnC,QAAM/V,SAAN,CAAgB5F,QAAhB,GAA2B,YAAW;EACpC,QAAI9N,KAAK,IAAT;EAAA,QACEa,MAAMb,GAAG6T,MAAH,CAAU/S,IADlB;EAAA,QAEE0W,WAAWxX,GAAGI,OAAH,CAAWgqB,kBAFxB;EAAA,QAGEiC,SAHF;;EAKAA,gBAAYxrB,IAAImH,SAAJ,CAAc,WAAd,EACT5G,IADS,CACJpB,GAAG6pB,SAAH,CAAa+B,IADT,EACe,UAASlqB,CAAT,EAAY;EAAE,aAAOA,EAAEoB,IAAT;EAAgB,KAD7C,CAAZ;;EAGAupB,cAAUjmB,KAAV,GACGhB,MADH,CACU,MADV,EAEGoK,OAFH,CAEW,MAFX,EAEmB,IAFnB,EAGGxK,IAHH,CAGQ,IAHR,EAGchF,GAAGyqB,OAAH,CAAWpiB,CAHzB,EAIGrD,IAJH,CAIQ,IAJR,EAIchF,GAAGyqB,OAAH,CAAW1lB,CAJzB,EAKGtE,KALH,CAKS,QALT,EAKmBT,GAAGkrB,gBAAH,CAAoB,MAApB,CALnB,EAMGlmB,IANH,CAMQ,IANR,EAMchF,GAAGyqB,OAAH,CAAWpiB,CANzB,EAOGrD,IAPH,CAOQ,IAPR,EAOchF,GAAGyqB,OAAH,CAAW1lB,CAPzB,EAQGwS,UARH,GASGC,QATH,CASYA,QATZ,EAUGxS,IAVH,CAUQ,IAVR,EAUc,UAAStD,CAAT,EAAY;EACtB,aAAO1B,GAAGssB,GAAH,CAAO5qB,EAAEiqB,IAAT,EAAe3rB,GAAG0qB,OAAH,GAAa,CAA5B,CAAP;EACD,KAZH,EAaG1lB,IAbH,CAaQ,IAbR,EAac,UAAStD,CAAT,EAAY;EACtB,aAAO1B,GAAGusB,GAAH,CAAO7qB,EAAEiqB,IAAT,EAAe3rB,GAAG0qB,OAAH,GAAa,CAA5B,CAAP;EACD,KAfH;;EAiBA2B,cACG9U,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGxS,IAHH,CAGQ,IAHR,EAGc,UAAStD,CAAT,EAAY;EACtB,aAAO1B,GAAGssB,GAAH,CAAO5qB,EAAEiqB,IAAT,EAAe3rB,GAAG0qB,OAAH,GAAa,CAA5B,CAAP;EACD,KALH,EAMG1lB,IANH,CAMQ,IANR,EAMc,UAAStD,CAAT,EAAY;EACtB,aAAO1B,GAAGusB,GAAH,CAAO7qB,EAAEiqB,IAAT,EAAe3rB,GAAG0qB,OAAH,GAAa,CAA5B,CAAP;EACD,KARH;;EAUA2B,cAAU/lB,IAAV,GACGiR,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGxS,IAHH,CAGQ,IAHR,EAGchF,GAAGyqB,OAAH,CAAWpiB,CAHzB,EAIGrD,IAJH,CAIQ,IAJR,EAIchF,GAAGyqB,OAAH,CAAW1lB,CAJzB,EAKGmD,MALH;EAMD,GA1CD;;EA4CAuhB,QAAM/V,SAAN,CAAgB8Y,cAAhB,GAAiC,YAAW;EAC1C,QAAIxsB,KAAK,IAAT;EAAA,QACEa,MAAMb,GAAG6T,MAAH,CAAU/S,IADlB;EAAA,QAEE0W,WAAWxX,GAAGI,OAAH,CAAWgqB,kBAFxB;EAAA,QAGEqC,aAAazsB,GAAG0qB,OAAH,GAAa1qB,GAAGI,OAAH,CAAWiqB,eAHvC;EAAA,QAIEre,MAJF;;EAMAA,aAASnL,IAAImH,SAAJ,CAAc,iBAAd,EACN5G,IADM,CACDpB,GAAG6pB,SAAH,CAAa+B,IADZ,EACkB,UAASlqB,CAAT,EAAY;EAAE,aAAOA,EAAEoB,IAAT;EAAgB,KADhD,CAAT;;EAGAkJ,WACGuL,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGxS,IAHH,CAGQ,GAHR,EAGa,UAACtD,CAAD;EAAA,aAAO1B,GAAGssB,GAAH,CAAO5qB,EAAEiqB,IAAT,EAAec,UAAf,CAAP;EAAA,KAHb,EAIGznB,IAJH,CAIQ,GAJR,EAIa,UAACtD,CAAD;EAAA,aAAO1B,GAAGusB,GAAH,CAAO7qB,EAAEiqB,IAAT,EAAec,UAAf,CAAP;EAAA,KAJb;;EAMAzgB,WAAO5F,KAAP,GACGhB,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,YAFjB,EAGGA,IAHH,CAGQ,aAHR,EAGuB,QAHvB,EAIGA,IAJH,CAIQ,MAJR,EAIgBhF,GAAGkrB,gBAAH,CAAoB,MAApB,CAJhB,EAKGzqB,KALH,CAKS,aALT,EAKwBT,GAAGkrB,gBAAH,CAAoB,YAApB,CALxB,EAMG5mB,IANH,CAMQ,UAAS5C,CAAT,EAAY;EAAE,aAAOA,EAAEoB,IAAT;EAAgB,KANtC,EAOGkC,IAPH,CAOQ,GAPR,EAOa,UAACtD,CAAD;EAAA,aAAO1B,GAAGssB,GAAH,CAAO5qB,EAAEiqB,IAAT,EAAec,UAAf,CAAP;EAAA,KAPb,EAQGznB,IARH,CAQQ,GARR,EAQa,UAACtD,CAAD;EAAA,aAAO1B,GAAGusB,GAAH,CAAO7qB,EAAEiqB,IAAT,EAAec,UAAf,CAAP;EAAA,KARb,EASGznB,IATH,CASQ,SATR,EASmB,CATnB,EAUGuS,UAVH,GAWGC,QAXH,CAWYA,QAXZ,EAYGxS,IAZH,CAYQ,SAZR,EAYmB,CAZnB;;EAcAgH,WAAO1F,IAAP,GACGiR,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGxS,IAHH,CAGQ,SAHR,EAGmB,CAHnB,EAIGkD,MAJH;EAKD,GAnCD;;EAqCAuhB,QAAM/V,SAAN,CAAgBgZ,YAAhB,GAA+B,YAAW;EACxC,QAAI1sB,KAAK,IAAT;EAAA,QACEoB,OAAOpB,GAAG+pB,SADZ;EAAA,QAEElpB,MAAMb,GAAG6T,MAAH,CAAU/S,IAFlB;EAAA,QAGE0W,WAAWxX,GAAGI,OAAH,CAAWgqB,kBAHxB;EAAA,QAIEuC,WAJF;EAAA,QAKEC,EALF;EAAA,QAKMC,MALN;EAAA,QAKcC,OALd;;EAOA;EACAH,kBAAcvrB,KAAKmqB,MAAL,CAAY,UAASwB,MAAT,EAAiBvL,GAAjB,EAAsB;EAC9C,UAAIwL,WAAWD,OAAOva,IAAP,CAAYpO,OAAZ,CAAoBod,IAAI4K,OAAxB,CAAf;EACA,UAAGY,YAAY,CAAC,CAAhB,EAAmB;EACjBA,mBAAWD,OAAOva,IAAP,CAAYlN,IAAZ,CAAiBkc,IAAI4K,OAArB,IAAgC,CAA3C;EACAW,eAAOE,QAAP,CAAgB3nB,IAAhB,CAAqB;EACnB8mB,mBAAS5K,IAAI4K,OADM;EAEnB1hB,iBAAO8W,IAAI9W,KAFQ;EAGnB1G,kBAAQ,EAHW;EAInBwK,kBAAQ;EAJW,SAArB;EAMD;EACDue,aAAOE,QAAP,CAAgBD,QAAhB,EAA0Bxe,MAA1B,CAAiClJ,IAAjC,CAAsCkc,GAAtC;EACAuL,aAAOE,QAAP,CAAgBD,QAAhB,EAA0BhpB,MAA1B,CAAiCsB,IAAjC,CAAsCkc,IAAI0L,EAAJ,CAAO3nB,IAAP,CAAY,GAAZ,CAAtC;EACA,aAAOwnB,MAAP;EACD,KAda,EAcX,EAACva,MAAM,EAAP,EAAWya,UAAS,EAApB,EAdW,EAccA,QAd5B;;EAgBAL,SAAK/rB,IAAImH,SAAJ,CAAc,qBAAd,EACF5G,IADE,CACGurB,WADH,EACgB,UAASjrB,CAAT,EAAY;EAAE,aAAOA,EAAE0qB,OAAF,GAAY,YAAnB;EAAkC,KADhE,CAAL;;EAGAU,cAAUF,GAAGxmB,KAAH,GACPhB,MADO,CACA,GADA,EAEPJ,IAFO,CAEF,OAFE,EAEO,mBAFP,CAAV;;EAIA6nB,aAASD,GAAGtmB,IAAH,EAAT;EACAumB,WAAOtV,UAAP,GAAoBC,QAApB,CAA6BA,QAA7B,EAAuCtP,MAAvC;;EAEAlI,OAAGmtB,oBAAH,CAAwBP,EAAxB,EAA4BE,OAA5B,EAAqCD,MAArC;EACA7sB,OAAGotB,oBAAH,CAAwBR,EAAxB,EAA4BE,OAA5B,EAAqCD,MAArC;EACD,GArCD;;EAuCApD,QAAM/V,SAAN,CAAgB0Z,oBAAhB,GAAuC,UAAS/mB,MAAT,EAAiBD,KAAjB,EAAwBE,IAAxB,EAA8B;EACnE,QAAItG,KAAK,IAAT;EAAA,QACEwX,WAAWxX,GAAGI,OAAH,CAAWgqB,kBADxB;EAAA,QAEExd,WAAW,eAFb;EAAA,QAGEygB,QAHF;;EAKA,aAASC,YAAT,CAAsBjB,SAAtB,EAAiC;EAC/BA,gBACGjnB,MADH,CACU,QADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,QAFjB,EAGGA,IAHH,CAGQ,IAHR,EAGchF,GAAGyqB,OAAH,CAAWpiB,CAHzB,EAIGrD,IAJH,CAIQ,IAJR,EAIchF,GAAGyqB,OAAH,CAAW1lB,CAJzB,EAKGC,IALH,CAKQ,GALR,EAKa,CALb,EAMGA,IANH,CAMQ,MANR,EAMgB;EAAA,eAAKtD,EAAEgJ,KAAP;EAAA,OANhB,EAOGzC,IAPH,CAOQslB,YAPR,EAQG7nB,EARH,CAQM,WARN,EAQmB,aAAK;EACpB,YAAI2C,IAAI3G,EAAEwrB,EAAF,CAAK,CAAL,IAAU,EAAlB;EAAA,YACEnoB,IAAIrD,EAAEwrB,EAAF,CAAK,CAAL,IAAU,EADhB;EAEAltB,WAAGwtB,YAAH,CAAgBnlB,CAAhB,EAAmBtD,CAAnB,EAAsBrD,EAAE0qB,OAAxB,EAAiC1qB,EAAE2B,KAAnC;EACD,OAZH,EAaGqC,EAbH,CAaM,UAbN,EAakB,YAAM;EACpB1F,WAAGytB,YAAH;EACD,OAfH;EAgBD;;EAED,aAASC,YAAT,CAAsBrB,SAAtB,EAAiC;EAC/BA,gBACG9U,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGxS,IAHH,CAGQ,IAHR,EAGchF,GAAGyqB,OAAH,CAAWpiB,CAHzB,EAIGrD,IAJH,CAIQ,IAJR,EAIchF,GAAGyqB,OAAH,CAAW1lB,CAJzB,EAKGmD,MALH;EAMD;;EAED,aAASqlB,YAAT,CAAsBlB,SAAtB,EAAiC;EAC/BA,gBACG9U,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGxS,IAHH,CAGQ,IAHR,EAGc,UAAStD,CAAT,EAAY;EAAE,eAAOA,EAAEwrB,EAAF,CAAK,CAAL,CAAP;EAAiB,OAH7C,EAIGloB,IAJH,CAIQ,IAJR,EAIc,UAAStD,CAAT,EAAY;EAAE,eAAOA,EAAEwrB,EAAF,CAAK,CAAL,CAAP;EAAiB,OAJ7C;EAKD;;EAED,aAASS,QAAT,CAAkBjsB,CAAlB,EAAqB;EAAE,aAAOA,EAAE8M,MAAT;EAAkB;;EAEzC,aAASof,OAAT,CAAiBlsB,CAAjB,EAAoB;EAAE,aAAOA,EAAE0qB,OAAF,GAAY,GAAZ,GAAkB1qB,EAAEoB,IAA3B;EAAkC;;EAExDuqB,eAAWhnB,OAAO2B,SAAP,CAAiB4E,QAAjB,EACRxL,IADQ,CACHusB,QADG,EACOC,OADP,CAAX;;EAGAP,aACGplB,IADH,CACQslB,YADR;;EAGAF,aAASjnB,KAAT,GACG6B,IADH,CACQqlB,YADR;;EAGAD,aAAS/mB,IAAT,GACG2B,IADH,CACQylB,YADR;;EAGAtnB,UAAM4B,SAAN,CAAgB4E,QAAhB,EACGxL,IADH,CACQusB,QADR,EACkBC,OADlB,EAEGxnB,KAFH,GAGG6B,IAHH,CAGQqlB,YAHR;;EAKAhnB,SAAK0B,SAAL,CAAe4E,QAAf,EACG3E,IADH,CACQylB,YADR;EAED,GAjED;;EAmEA;;;;;;;;EAQAjE,QAAM/V,SAAN,CAAgB8Z,YAAhB,GAA+B,UAASnlB,CAAT,EAAYtD,CAAZ,EAAe8oB,IAAf,EAAqBC,IAArB,EAA2B;EACxD,QAAIC,EAAJ;EAAA,QAAQC,KAAR;EAAA,QAAeC,EAAf;EAAA,QAAmBtG,IAAnB;EAAA,QACErlB,UAAU,CADZ;EAAA,QAEEtC,KAAK,IAFP;EAAA,QAGEa,MAAMb,GAAG6T,MAAH,CAAU/S,IAHlB;;EAKAitB,SAAKltB,IAAIuE,MAAJ,CAAW,GAAX,EACFJ,IADE,CACG,OADH,EACY,SADZ,EAEFA,IAFE,CAEG,SAFH,EAEc,CAFd,CAAL;;EAIAipB,SAAKF,GAAG3oB,MAAH,CAAU,MAAV,EAAkBJ,IAAlB,CAAuB,OAAvB,EAAgC,oBAAhC,CAAL;;EAEAgpB,YAAQD,GACL3oB,MADK,CACE,MADF,EAELJ,IAFK,CAEA,GAFA,EAEKD,CAFL,EAGLC,IAHK,CAGA,GAHA,EAGKqD,CAHL,EAIL5H,KAJK,CAIC,MAJD,EAIST,GAAGkrB,gBAAH,CAAoB,OAApB,CAJT,EAKLzqB,KALK,CAKC,aALD,EAKgBT,GAAGkrB,gBAAH,CAAoB,YAApB,CALhB,CAAR;;EAOA8C,UAAM5oB,MAAN,CAAa,OAAb,EACGd,IADH,CACQwpB,IADR;;EAGAE,UAAM5oB,MAAN,CAAa,OAAb,EACGJ,IADH,CACQ,IADR,EACc,QADd,EAEGA,IAFH,CAEQ,GAFR,EAEaqD,CAFb,EAGG/D,IAHH,CAGQupB,IAHR;;EAKAlG,WAAOoG,GAAGvoB,IAAH,GAAUoiB,OAAV,EAAP;;EAEAqG,OAAGjpB,IAAH,CAAQ,GAAR,EAAa2iB,KAAKtf,CAAL,GAAS/F,OAAtB,EACG0C,IADH,CACQ,GADR,EACa2iB,KAAK5iB,CAAL,GAASzC,OADtB,EAEG0C,IAFH,CAEQ,OAFR,EAEiB2iB,KAAKtnB,KAAL,GAAciC,UAAU,CAFzC,EAGG0C,IAHH,CAGQ,QAHR,EAGkB2iB,KAAKpnB,MAAL,IAAe+B,UAAU,CAAzB,CAHlB,EAIG7B,KAJH,CAIS,MAJT,EAIiBT,GAAGkrB,gBAAH,CAAoB,MAApB,CAJjB;;EAMA6C,OAAGxW,UAAH,GACGC,QADH,CACY,GADZ,EAEGxS,IAFH,CAEQ,SAFR,EAEmB,EAFnB;;EAIA,WAAO+oB,EAAP;EACD,GAxCD;;EA0CA;;;;EAIAtE,QAAM/V,SAAN,CAAgB+Z,YAAhB,GAA+B,YAAW;EACxC,SAAK5Z,MAAL,CAAY/S,IAAZ,CAAiBkH,SAAjB,CAA2B,WAA3B,EACGuP,UADH,GAEGC,QAFH,CAEY,GAFZ,EAGGxS,IAHH,CAGQ,SAHR,EAGmB,CAHnB,EAIGkD,MAJH;EAKD,GAND;;EAQAuhB,QAAM/V,SAAN,CAAgByZ,oBAAhB,GAAuC,UAAS9mB,MAAT,EAAiBD,KAAjB,EAAwBE,IAAxB,EAA8B;EACnE,QAAItG,KAAK,IAAT;EAAA,QACEwX,WAAWxX,GAAGI,OAAH,CAAWgqB,kBADxB;EAAA,QAEExd,WAAW,kBAFb;EAAA,QAGEygB,QAHF;;EAKA;EACA;EACA,aAASa,YAAT,CAAsB9sB,IAAtB,EAA4B;EAC1B,UAAIqkB,SAAS,CAACzlB,GAAGyqB,OAAH,CAAWpiB,CAAZ,EAAerI,GAAGyqB,OAAH,CAAW1lB,CAA1B,EAA6BQ,IAA7B,CAAkC,GAAlC,CAAb;EACA,aAAOnE,KAAK4C,MAAL,CAAYvC,GAAZ,CAAgB,YAAW;EAChC;EACA,eAAOgkB,MAAP;EACD,OAHM,EAGJlgB,IAHI,CAGC,GAHD,CAAP;EAID;;EAED,aAAS+nB,YAAT,CAAsBjB,SAAtB,EAAiC;EAC/BA,gBACGjnB,MADH,CACU,SADV,EAEGJ,IAFH,CAEQ,OAFR,EAEiB,UAFjB,EAGGA,IAHH,CAGQ,QAHR,EAGkBkpB,YAHlB,EAIGztB,KAJH,CAIS,QAJT,EAImB,UAASiB,CAAT,EAAY;EAAE,eAAOA,EAAEgJ,KAAT;EAAiB,OAJlD,EAKGjK,KALH,CAKS,MALT,EAKiB,UAASiB,CAAT,EAAY;EAAE,eAAOA,EAAEgJ,KAAT;EAAiB,OALhD,EAMGjK,KANH,CAMS,cANT,EAMyB,GANzB,EAOGA,KAPH,CAOS,cAPT,EAOyBT,GAAGkrB,gBAAH,CAAoB,KAApB,CAPzB,EAQGjjB,IARH,CAQQslB,YARR;EASD;;EAED,aAASG,YAAT,CAAsBrB,SAAtB,EAAiC;EAC/BA,gBACG9U,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGxS,IAHH,CAGQ,QAHR,EAGkBkpB,YAHlB,EAIGhmB,MAJH;EAKD;;EAED,aAASqlB,YAAT,CAAsBlB,SAAtB,EAAiC;EAC/BA,gBACG9U,UADH,GAEGC,QAFH,CAEYA,QAFZ,EAGGxS,IAHH,CAGQ,QAHR,EAGkB,UAAStD,CAAT,EAAY;EAAE,eAAOA,EAAEsC,MAAF,CAASuB,IAAT,CAAc,GAAd,CAAP;EAA4B,OAH5D;EAID;;EAED,aAASooB,QAAT,CAAkBjsB,CAAlB,EAAqB;EAAE,aAAO,CAACA,CAAD,CAAP;EAAa;;EAEpC,aAASksB,OAAT,CAAiBlsB,CAAjB,EAAoB;EAAE,aAAOA,EAAE0qB,OAAT;EAAmB;;EAEzCiB,eAAWhnB,OAAO2B,SAAP,CAAiB4E,QAAjB,EACRxL,IADQ,CACHusB,QADG,EACOC,OADP,CAAX;;EAGAP,aACGplB,IADH,CACQslB,YADR;;EAGAF,aAASjnB,KAAT,GACG6B,IADH,CACQqlB,YADR;;EAGAD,aAAS/mB,IAAT,GACG2B,IADH,CACQylB,YADR;;EAGAtnB,UAAM4B,SAAN,CAAgB4E,QAAhB,EACGxL,IADH,CACQusB,QADR,EACkBC,OADlB,EAEGxnB,KAFH,GAGG6B,IAHH,CAGQqlB,YAHR;;EAKAhnB,SAAK0B,SAAL,CAAe4E,QAAf,EACG3E,IADH,CACQylB,YADR;EAGD,GAnED;;EAqEAjE,QAAM/V,SAAN,CAAgB7D,UAAhB,GAA6B,YAAW;EACtC,QAAI7P,KAAK,IAAT;EAAA,QACEisB,OAAOjsB,GAAGgqB,SAAH,CAAa4B,IADtB;EAAA,QAEE/qB,MAAMb,GAAG6T,MAAH,CAAU/S,IAFlB;EAAA,QAGEypB,KAAKvqB,GAAGI,OAAH,CAAWgL,MAAX,CAAkBmf,EAHzB;EAAA,QAIE4D,OAAO,EAJT;EAAA,QAKEhkB,SAAS,CALX;EAAA,QAMEiB,MANF;EAAA,QAMUgjB,SANV;;EAQAhjB,aAASvK,IAAImH,SAAJ,CAAc,eAAd,EACN5G,IADM,CACD6qB,IADC,EACK,UAASvqB,CAAT,EAAY;EAAE,aAAOA,EAAE0qB,OAAT;EAAmB,KADtC,EAENpnB,IAFM,CAED,SAFC,EAEU,aAAK;EACpB,aAAOhF,GAAGmqB,iBAAH,CAAqB/lB,OAArB,CAA6B1C,EAAE0qB,OAA/B,IAA0C,CAAC,CAA3C,GAA+C,EAA/C,GAAoD,CAA3D;EACD,KAJM,CAAT;;EAMAgC,gBAAYhjB,OAAOhF,KAAP,GACThB,MADS,CACF,GADE,EAETM,EAFS,CAEN,OAFM,EAEG,UAAChE,CAAD,EAAO;EAClB1B,SAAGmqB,iBAAH,GAAuBnqB,GAAGquB,WAAH,CACrBruB,GAAGmqB,iBADkB,EACC,CAACzoB,EAAE0qB,OAAH,CADD,CAAvB;EAEApsB,SAAGoN,IAAH;EACD,KANS,EAOTpI,IAPS,CAOJ,OAPI,EAOK,aAPL,CAAZ;;EASAopB,cACGhpB,MADH,CACU,MADV,EAEGd,IAFH,CAEQ;EAAA,aAAK5C,EAAE0qB,OAAP;EAAA,KAFR,EAGGpnB,IAHH,CAGQ,GAHR,EAGaulB,GAAGliB,CAAH,GAAO8lB,IAAP,GAAchkB,MAH3B,EAIGnF,IAJH,CAIQ,GAJR,EAIa,UAACtD,CAAD,EAAImE,CAAJ;EAAA,aAAW,CAACsoB,OAAOhkB,MAAR,IAAkBtE,CAAnB,GAAwB0kB,GAAGxlB,CAA3B,GAA+BopB,IAAzC;EAAA,KAJb,EAKG1tB,KALH,CAKS,aALT,EAKwBT,GAAGkrB,gBAAH,CAAoB,YAApB,CALxB;;EAOAkD,cACGhpB,MADH,CACU,MADV,EAEGJ,IAFH,CAEQ,MAFR,EAEgB;EAAA,aAAKtD,EAAEgJ,KAAP;EAAA,KAFhB,EAGG1F,IAHH,CAGQ,OAHR,EAGiBmpB,IAHjB,EAIGnpB,IAJH,CAIQ,QAJR,EAIkBmpB,IAJlB,EAKGnpB,IALH,CAKQ,GALR,EAKaulB,GAAGliB,CALhB,EAMGrD,IANH,CAMQ,GANR,EAMa,UAACtD,CAAD,EAAImE,CAAJ;EAAA,aAAW,CAACsoB,OAAOhkB,MAAR,IAAkBtE,CAAnB,GAAwB0kB,GAAGxlB,CAArC;EAAA,KANb;EAOD,GAtCD;;EAwCA;;;;;EAKA0kB,QAAM/V,SAAN,CAAgBwX,gBAAhB,GAAmC,UAAS7nB,KAAT,EAAgB;EACjD,WAAO,KAAKjD,OAAL,CAAaoqB,aAAb,GAA6BnnB,KAA7B,GAAqC,IAA5C;EACD,GAFD;;EAIA;;;;;;EAMAomB,QAAM/V,SAAN,CAAgB2a,WAAhB,GAA8B,UAACC,IAAD,EAAOC,KAAP,EAAiB;EAC7C,QAAIC,WAAWD,MAAM5T,MAAN,CAAa;EAAA,aAAM2T,KAAKlqB,OAAL,CAAaqqB,EAAb,KAAoB,CAAC,CAA3B;EAAA,KAAb,CAAf;EACA,WAAOH,KAAK3T,MAAL,CAAY;EAAA,aAAM4T,MAAMnqB,OAAN,CAAcqqB,EAAd,KAAqB,CAAC,CAA5B;EAAA,KAAZ,EAA2C/C,MAA3C,CAAkD8C,QAAlD,CAAP;EACD,GAHD;;EAKA/E,QAAM/V,SAAN,CAAgB4Y,GAAhB,GAAsB,UAASX,IAAT,EAAetoB,KAAf,EAAsB;EAC1C,QAAIrD,KAAK,IAAT;EACA,WAAOA,GAAGyqB,OAAH,CAAWpiB,CAAX,GAAgBhF,QAAQiE,KAAKonB,GAAL,CAAS/C,IAAT,CAA/B;EACD,GAHD;;EAKAlC,QAAM/V,SAAN,CAAgB6Y,GAAhB,GAAsB,UAASZ,IAAT,EAAetoB,KAAf,EAAsB;EAC1C,QAAIrD,KAAK,IAAT;EACA,WAAOA,GAAGyqB,OAAH,CAAW1lB,CAAX,GAAgB1B,QAAQiE,KAAKqnB,GAAL,CAAShD,IAAT,CAA/B;EACD,GAHD;;EAKAlC,QAAM/V,SAAN,CAAgBZ,MAAhB,GAAyB,UAAS1R,IAAT,EAAe;EACtC,QAAIpB,KAAK,IAAT;EACA,WAAOoB,KAAKmqB,MAAL,CAAY,UAASzY,MAAT,EAAiB0O,GAAjB,EAAsB;EACvC,UAAIO,MAAM1a,SAASma,IAAIxhB,GAAGI,OAAH,CAAWyqB,UAAf,CAAT,CAAV;EACA,UAAG/X,OAAO5O,MAAP,IAAiB,CAApB,EAAuB;EACrB,eAAO,CAAC6d,GAAD,EAAMA,GAAN,CAAP;EACD;EACD,aAAO,CACLA,MAAMjP,OAAO,CAAP,CAAN,GAAkBiP,GAAlB,GAAwBjP,OAAO,CAAP,CADnB,EAELiP,MAAMjP,OAAO,CAAP,CAAN,GAAkBiP,GAAlB,GAAwBjP,OAAO,CAAP,CAFnB,CAAP;EAID,KATM,EASJ,EATI,CAAP;EAUD,GAZD;;EAcA;EACA2W,QAAM/V,SAAN,CAAgBkb,oBAAhB,GAAuC,UAASxtB,IAAT,EAAe;EACpD,QAAIpB,KAAK,IAAT;EAAA,QACEqB,QAAQrB,GAAGkqB,MADb;EAAA,QAEE2E,UAAU7uB,GAAGI,OAAH,CAAWwqB,QAFvB;EAAA,QAGEkE,SAAS9uB,GAAGI,OAAH,CAAWyqB,UAHtB;EAAA,QAIEkE,WAAW/uB,GAAGI,OAAH,CAAWuqB,YAJxB;EAAA,QAKEqE,WAAWhvB,GAAG6pB,SAAH,CAAagC,IAL1B;;EAOA,WAAOzqB,KAAKK,GAAL,CAAS,UAAS+f,GAAT,EAAc;EAC5B,UAAI1e,OAAO0e,IAAIqN,OAAJ,CAAX;EAAA,UACElD,OAAOqD,SAASlsB,IAAT,EAAe6oB,IADxB;EAAA,UAEES,UAAU5K,IAAIuN,QAAJ,CAFZ;EAAA,UAGEhN,MAAMP,IAAIsN,MAAJ,CAHR;EAAA,UAIEG,QAAQ5tB,MAAM0gB,GAAN,CAJV;EAKA,aAAO;EACLmL,YAAI,CACFltB,GAAGssB,GAAH,CAAOX,IAAP,EAAasD,KAAb,CADE,EAEFjvB,GAAGusB,GAAH,CAAOZ,IAAP,EAAasD,KAAb,CAFE,CADC;EAKL5rB,eAAO0e,GALF;EAMLqK,iBAASA,OANJ;EAOLtpB,cAAMA,IAPD;EAQL4H,eAAO1K,GAAGgqB,SAAH,CAAa6B,IAAb,CAAkBO,OAAlB,CARF;EASL8C,iBAAS1N;EATJ,OAAP;EAWD,KAjBM,CAAP;EAkBD,GA1BD;;EA4BAiI,QAAM/V,SAAN,CAAgBiH,MAAhB,GAAyB,UAASwU,GAAT,EAAc;EACrC,QAAInvB,KAAK,IAAT;EACAA,OAAG8pB,OAAH,GAAaqF,GAAb;EACA,WAAOnvB,EAAP;EACD,GAJD;;EAMA;;EAEAypB,QAAM/V,SAAN,CAAgBxT,KAAhB,GAAwB,UAASA,KAAT,EAAgB;EACtC,QAAIF,KAAK,IAAT;EACAA,OAAG6T,MAAH,GAAY3T,KAAZ;EACA,WAAOF,EAAP;EACD,GAJD;;EAMAypB,QAAM/V,SAAN,CAAgBtS,IAAhB,GAAuB,UAASA,IAAT,EAAe;EACpC,QAAIpB,KAAK,IAAT;EACAA,OAAGkM,KAAH,GAAW9K,IAAX;EACA,WAAOpB,EAAP;EACD,GAJD;;EAMAypB,QAAM/V,SAAN,CAAgBpG,MAAhB,GAAyB,UAASA,MAAT,EAAiB;EACxC,QAAItN,KAAK,IAAT;EACAA,OAAGyD,OAAH,GAAa6J,MAAb;EACA;EACAtN,OAAGkqB,MAAH,GAAYlqB,GAAGyD,OAAH,CAAW4E,CAAvB;EACArI,OAAGkqB,MAAH,CAAU3oB,KAAV,CAAgB,CAAC,CAAD,EAAIvB,GAAG0qB,OAAP,CAAhB;EACA,WAAO1qB,EAAP;EACD,GAPD;;EASAypB,QAAM/V,SAAN,CAAgB7F,IAAhB,GAAuB,UAASA,IAAT,EAAe;EACpC,QAAI7N,KAAK,IAAT;EACA;EACA,WAAOA,EAAP;EACD,GAJD;;EAMAypB,QAAM/V,SAAN,CAAgBpS,OAAhB,GAA0B,YAAW;EACnC,QAAItB,KAAK,IAAT;EACAA,OAAGovB,YAAH,CAAgBpvB,GAAGkM,KAAnB;EACA,WAAOlM,EAAP;EACD,GAJD;;EAMAypB,QAAM/V,SAAN,CAAgB0b,YAAhB,GAA+B,UAAShuB,IAAT,EAAe;EAC5C,QAAIpB,KAAK,IAAT;EACAA,OAAG6jB,OAAH,GAAa7jB,GAAG8S,MAAH,CAAU1R,IAAV,CAAb;EACApB,OAAGkqB,MAAH,CAAU9nB,MAAV,CAAiB,CAAC,CAAD,EAAIpC,GAAG6jB,OAAH,CAAW,CAAX,CAAJ,CAAjB;EACA7jB,OAAGiqB,MAAH,GAAYjqB,GAAGkqB,MAAH,CAAUvmB,KAAV,CAAgB3D,GAAGI,OAAH,CAAWuD,KAA3B,CAAZ;EACA;EACA;EACA,QAAG3D,GAAGiqB,MAAH,CAAU/lB,MAAV,GAAmB,CAAnB,IAAwBlE,GAAGiqB,MAAH,CAAU,CAAV,MAAiB,CAA5C,EAA+C;EAC7CjqB,SAAGiqB,MAAH,GAAYjqB,GAAGiqB,MAAH,CAAUnkB,KAAV,CAAgB,CAAhB,CAAZ;EACD;EACF,GAVD;;EAYA2jB,QAAM/V,SAAN,CAAgBtG,IAAhB,GAAuB,YAAW;EAChC,QAAIpN,KAAK,IAAT;EAAA,QACEoB,OAAOpB,GAAGkM,KADZ;;EAGA;EACA;EACA;EACAlM,OAAGgqB,SAAH,GAAehqB,GAAGgsB,aAAH,CAAiB5qB,IAAjB,CAAf;;EAEA;EACA,QAAG,OAAOpB,GAAG8pB,OAAV,KAAsB,UAAzB,EAAqC;EACnC1oB,aAAOA,KAAKuZ,MAAL,CAAY3a,GAAG8pB,OAAf,CAAP;EACD;;EAED;EACA,QAAG9pB,GAAGmqB,iBAAH,CAAqBjmB,MAArB,GAA8B,CAAjC,EAAoC;EAClC9C,aAAOA,KAAKuZ,MAAL,CAAY,cAAM;EACvB,eAAO3a,GAAGmqB,iBAAH,CAAqB/lB,OAArB,CACLqqB,GAAGzuB,GAAGI,OAAH,CAAWuqB,YAAd,CADK,KAC2B,CAAC,CADnC;EAED,OAHM,CAAP;EAID;;EAED3qB,OAAGovB,YAAH,CAAgBhuB,IAAhB;EACApB,OAAG6pB,SAAH,GAAe7pB,GAAGorB,WAAH,CAAehqB,IAAf,CAAf;EACApB,OAAG+pB,SAAH,GAAe/pB,GAAG4uB,oBAAH,CAAwBxtB,IAAxB,CAAf;;EAEApB,OAAG8qB,SAAH;EACA9qB,OAAG8N,QAAH;EACA9N,OAAGwsB,cAAH;EACAxsB,OAAGmrB,eAAH;EACAnrB,OAAG0sB,YAAH;EACA1sB,OAAG6P,UAAH;EACD,GAhCD;;EAkCA,SAAO,IAAI4Z,KAAJ,CAAUtpB,MAAV,CAAP;EAED;;EC7vBD;;;;AAIA,EAAe,kBAASA,MAAT,EAAiB;;EAE9B,WAASkvB,OAAT,CAAiBlvB,MAAjB,EAAyB;EACvB,QAAIH,KAAK,IAAT;EACAA,OAAGI,OAAH,GAAaD,SAASA,MAAT,GAAkB,EAA/B;EACAH,OAAGkM,KAAH,GAAW,EAAX;EACAlM,OAAGyD,OAAH,GAAa,EAAb;EACAzD,OAAGqM,KAAH,GAAW,EAAX;EACArM,OAAGwT,IAAH,GAAUxS,GAAGC,GAAH,GAAS+D,IAAT,CAAc,OAAd,EAAuB,QAAvB,CAAV;EACD;;EAED;EACA;EACAqqB,UAAQ3b,SAAR,CAAkBrL,CAAlB,GAAsB,UAASqZ,GAAT,EAAc;EAClC,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWiI,CAAX,GAAeqZ,GAAf;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMAqvB,UAAQ3b,SAAR,CAAkB3O,CAAlB,GAAsB,UAAS2c,GAAT,EAAc;EAClC,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW2E,CAAX,GAAe2c,GAAf;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMAqvB,UAAQ3b,SAAR,CAAkBjI,MAAlB,GAA2B,UAASA,MAAT,EAAiB;EAC1C,QAAIzL,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWqL,MAAX,GAAoBA,MAApB;EACA,WAAOzL,EAAP;EACD,GAJD;;EAMAqvB,UAAQ3b,SAAR,CAAkB4b,WAAlB,GAAgC,UAASA,WAAT,EAAsB;EACpD,QAAItvB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWkvB,WAAX,GAAyBA,WAAzB;EACA,WAAOtvB,EAAP;EACD,GAJD;;EAMAqvB,UAAQ3b,SAAR,CAAkB0Q,UAAlB,GAA+B,UAASA,UAAT,EAAoB;EACjD,QAAIpkB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWgkB,UAAX,GAAwBA,UAAxB;EACA,WAAOpkB,EAAP;EACD,GAJD;;EAMAqvB,UAAQ3b,SAAR,CAAkBhJ,KAAlB,GAA0B,UAASgX,GAAT,EAAc;EACtC,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWsK,KAAX,GAAmBgX,GAAnB;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMAqvB,UAAQ3b,SAAR,CAAkBpI,OAAlB,GAA4B,UAASA,OAAT,EAAkB;EAC5C,QAAItL,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWkL,OAAX,GAAqBA,OAArB;EACA,WAAOtL,EAAP;EACD,GAJD;;EAMAqvB,UAAQ3b,SAAR,CAAkBzS,GAAlB,GAAwB,UAASA,GAAT,EAAa;EACnC,QAAIjB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACAjB,OAAGwT,IAAH,CAAQlE,IAAR,CAAatP,GAAGI,OAAH,CAAWa,GAAxB;EACA,WAAOjB,EAAP;EACD,GALD;;EAOAqvB,UAAQ3b,SAAR,CAAkBE,GAAlB,GAAwB,YAAW;EACjC,QAAI5T,KAAK,IAAT;EACA,WAAOA,GAAG6T,MAAV;EACD,GAHD;;EAKA;EACA;EACAwb,UAAQ3b,SAAR,CAAkBxT,KAAlB,GAA0B,UAASA,KAAT,EAAgB;EACxC,QAAIF,KAAK,IAAT;EACAA,OAAG6T,MAAH,GAAY3T,KAAZ;EACA,WAAOF,EAAP;EACD,GAJD;;EAMAqvB,UAAQ3b,SAAR,CAAkBtS,IAAlB,GAAyB,UAASA,IAAT,EAAe;EACtC,QAAIpB,KAAK,IAAT;EACAA,OAAGkM,KAAH,GAAW,EAAX;EACA9K,SAAK+N,OAAL,CAAa,UAASzN,CAAT,EAAYmE,CAAZ,EAAe;EAC1B,UAAIgd,IAAI,EAAR;EACAA,QAAErH,KAAF,GAAU9Z,CAAV;EACAmhB,QAAExa,CAAF,GAAMrI,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAAjB,IAA0B,QAA1B,GAAqC,CAACK,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,CAAtC,GAAwD3G,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,CAA9D;EACAwa,QAAE9d,CAAF,GAAM/E,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAjB,IAA0B,QAA1B,GAAoC,CAACK,EAAE1B,GAAGI,OAAH,CAAW2E,CAAb,CAArC,GAAuDrD,EAAE1B,GAAGI,OAAH,CAAW2E,CAAb,CAA7D;EACA8d,QAAEnY,KAAF,GAAU1K,GAAGI,OAAH,CAAWsK,KAAX,CAAiB5E,KAAjB,CAAuB,CAAvB,EAAyB,CAAzB,MAAgC,GAAhC,GAAsCpE,EAAE1B,GAAGI,OAAH,CAAWsK,KAAb,CAAtC,GAA4D1K,GAAGI,OAAH,CAAWsK,KAAjF;EACAmY,QAAEpX,MAAF,GAAWzL,GAAGI,OAAH,CAAWqL,MAAX,KAAsB3J,SAAtB,GAAkCoB,MAAMlD,GAAGI,OAAH,CAAWqL,MAAjB,IAA2B,CAAC/J,EAAE1B,GAAGI,OAAH,CAAWqL,MAAb,CAA5B,GAAmDzL,GAAGI,OAAH,CAAWqL,MAAhG,GAAyG,CAApH;;EAEA,UAAGzL,GAAGI,OAAH,CAAWgkB,UAAX,KAA0BtiB,SAA1B,IAAuCG,MAAMC,OAAN,CAAclC,GAAGI,OAAH,CAAWgkB,UAAzB,CAAvC,IAA+EpkB,GAAGI,OAAH,CAAWgkB,UAAX,CAAsBlgB,MAAtB,GAA+B,CAAjH,EAAmH;EACjHlE,WAAGI,OAAH,CAAWgkB,UAAX,CAAsBjV,OAAtB,CAA8B,UAASogB,CAAT,EAAW;EACvC1M,YAAE0M,CAAF,IAAO7tB,EAAE6tB,CAAF,CAAP;EACD,SAFD;EAGD;EACDvvB,SAAGkM,KAAH,CAAS5G,IAAT,CAAcud,CAAd;EACD,KAdD;EAeA,WAAO7iB,EAAP;EACD,GAnBD;;EAqBAqvB,UAAQ3b,SAAR,CAAkBpG,MAAlB,GAA2B,UAASyG,CAAT,EAAY;EACrC,QAAI/T,KAAK,IAAT;EACAA,OAAGyD,OAAH,GAAasQ,CAAb;EACA,WAAO/T,EAAP;EACD,GAJD;;EAMAqvB,UAAQ3b,SAAR,CAAkB7F,IAAlB,GAAyB,UAAS7H,CAAT,EAAY;EACnC,QAAIhG,KAAK,IAAT;EACAA,OAAGqM,KAAH,GAAWrG,CAAX;EACA,WAAOhG,EAAP;EACD,GAJD;;EAMAqvB,UAAQ3b,SAAR,CAAkBpS,OAAlB,GAA4B,YAAW;EACrC,QAAItB,KAAK,IAAT;EACA,QAAIwvB,UAAUxuB,GAAGonB,MAAH,CAAUpoB,GAAGkM,KAAb,EAAoB,UAASxK,CAAT,EAAY;EAC1C,aAAOA,EAAE2G,CAAT;EACD,KAFW,CAAd;EAAA,QAGEonB,UAAUzuB,GAAGonB,MAAH,CAAUpoB,GAAGkM,KAAb,EAAoB,UAASxK,CAAT,EAAY;EACxC,aAAOA,EAAEqD,CAAT;EACD,KAFS,CAHZ;EAAA,QAME2qB,eAAe1uB,GAAGonB,MAAH,CAAUpoB,GAAGkM,KAAb,EAAoB,UAASxK,CAAT,EAAY;EAC7C,aAAOA,EAAE+J,MAAT;EACD,KAFc,CANjB;;EAUA,QAAIkkB,QAAQ,CAAC,CAAD,EAAI,CAAJ,CAAZ;;EAEA,QAAI3vB,GAAGI,OAAH,CAAWwvB,OAAf,EAAwB;EACtB,UAAIJ,QAAQ,CAAR,IAAaC,QAAQ,CAAR,CAAjB,EAA6B;EAC3BE,cAAM,CAAN,IAAWH,QAAQ,CAAR,CAAX;EACD,OAFD,MAEO;EACLG,cAAM,CAAN,IAAWF,QAAQ,CAAR,CAAX;EACD;;EAED,UAAID,QAAQ,CAAR,IAAaC,QAAQ,CAAR,CAAjB,EAA6B;EAC3B;EACAE,cAAM,CAAN,IAAWH,QAAQ,CAAR,CAAX;EACD,OAHD,MAGO;EACLG,cAAM,CAAN,IAAWF,QAAQ,CAAR,CAAX;EACD;;EAEDzvB,SAAGyD,OAAH,CAAW4E,CAAX,CAAajG,MAAb,CAAoButB,KAApB,EAA2BttB,IAA3B;EACArC,SAAGyD,OAAH,CAAWsB,CAAX,CAAa3C,MAAb,CAAoButB,KAApB,EAA2BttB,IAA3B;EACArC,SAAGyD,OAAH,CAAWgI,MAAX,GAAoBzK,GAAG6uB,WAAH,GACCtuB,KADD,CACOvB,GAAGI,OAAH,CAAWkvB,WAAX,IAA0BxtB,SAA1B,GAAsC9B,GAAGI,OAAH,CAAWkvB,WAAjD,GAA+D,CAAC,CAAD,EAAI,EAAJ,CADtE,EAECltB,MAFD,CAEQstB,YAFR,EAEsBrtB,IAFtB,EAApB;EAID,KApBD,MAoBO;EACLrC,SAAGyD,OAAH,CAAW4E,CAAX,CAAajG,MAAb,CAAoBotB,OAApB,EADK;EAELxvB,SAAGyD,OAAH,CAAWsB,CAAX,CAAa3C,MAAb,CAAoBqtB,OAApB,EAFK;EAGL,UAAGzvB,GAAGyD,OAAH,CAAW4E,CAAX,CAAahG,IAAhB,EAAsB;EACpBrC,WAAGyD,OAAH,CAAW4E,CAAX,CAAahG,IAAb;EACD;EACD,UAAGrC,GAAGyD,OAAH,CAAWsB,CAAX,CAAa1C,IAAhB,EAAsB;EACpBrC,WAAGyD,OAAH,CAAWsB,CAAX,CAAa1C,IAAb;EACD;EACDrC,SAAGyD,OAAH,CAAWgI,MAAX,GAAoBzK,GAAG6uB,WAAH,GACCtuB,KADD,CACOvB,GAAGI,OAAH,CAAWkvB,WAAX,IAA0BxtB,SAA1B,GAAsC9B,GAAGI,OAAH,CAAWkvB,WAAjD,GAA+D,CAAC,CAAD,EAAI,EAAJ,CADtE,EAECltB,MAFD,CAEQstB,YAFR,EAEsBrtB,IAFtB,EAApB;EAGA,UAAGrC,GAAGI,OAAH,CAAWwC,KAAX,IAAoB5C,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAAjB,KAA2B,QAAlD,EAA4D;EAC1DrB,WAAGyD,OAAH,CAAW4E,CAAX,CAAajG,MAAb,CAAoBpC,GAAGkM,KAAH,CAASzK,GAAT,CAAa,UAASohB,CAAT,EAAW;EAAE,iBAAOA,EAAExa,CAAT;EAAa,SAAvC,CAApB;EACD;EACD,UAAGrI,GAAGI,OAAH,CAAWuC,KAAX,IAAoB3C,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAjB,KAA2B,QAAlD,EAA4D;EAC1DrB,WAAGyD,OAAH,CAAWsB,CAAX,CAAa3C,MAAb,CAAoBpC,GAAGkM,KAAH,CAASzK,GAAT,CAAa,UAASohB,CAAT,EAAW;EAAE,iBAAOA,EAAE9d,CAAT;EAAW,SAArC,CAApB;EACD;EACF;;EAED,QAAG/E,GAAGI,OAAH,CAAWwC,KAAX,CAAiBktB,WAAjB,IAAgC7tB,MAAMC,OAAN,CAAclC,GAAGI,OAAH,CAAWwC,KAAX,CAAiBktB,WAA/B,CAAnC,EAAgF;EAC9E9vB,SAAGyD,OAAH,CAAW4E,CAAX,CAAajG,MAAb,CAAoBpC,GAAGI,OAAH,CAAWwC,KAAX,CAAiBktB,WAArC;EAED;EACD,QAAG9vB,GAAGI,OAAH,CAAWuC,KAAX,CAAiBmtB,WAAjB,IAAgC7tB,MAAMC,OAAN,CAAclC,GAAGI,OAAH,CAAWuC,KAAX,CAAiBmtB,WAA/B,CAAnC,EAAgF;EAC9E9vB,SAAGyD,OAAH,CAAWsB,CAAX,CAAa3C,MAAb,CAAoBpC,GAAGI,OAAH,CAAWuC,KAAX,CAAiBmtB,WAArC;EACD;EACD,WAAO9vB,EAAP;EACD,GA9DD;;EAgEAqvB,UAAQ3b,SAAR,CAAkBtG,IAAlB,GAAyB,YAAW;EAClC,QAAIpN,KAAK,IAAT;;EAEA;EACAA,OAAG6T,MAAH,CAAU/S,IAAV,CAAemH,IAAf,CAAoBjI,GAAGwT,IAAvB;;EAEA,QAAIuc,UAAU/vB,GAAG6T,MAAH,CAAU/S,IAAV,CAAekH,SAAf,CAAyB,MAAzB,EACX5G,IADW,CACNpB,GAAGkM,KADG;EAEZ;EAFY,KAGX9F,KAHW,GAGHhB,MAHG,CAGI,QAHJ,EAIXJ,IAJW,CAIN,OAJM,EAIG,KAJH,EAKXA,IALW,CAKN,OALM,EAKE,UAAStD,CAAT,EAAWmE,CAAX,EAAa;EACzB,aAAOnE,EAAE0iB,UAAF,KAAiBtiB,SAAjB,IAA+BJ,EAAE0iB,UAAF,CAAajQ,EAAb,KAAoBrS,SAAnD,GAA+D,aAAWJ,EAAE0iB,UAAF,CAAajQ,EAAvF,GAA4F,aAAWtO,CAA9G;EACD,KAPW,EAQXb,IARW,CAQN,GARM,EAQD,UAAStD,CAAT,EAAW;EACpB,aAAO1B,GAAGyD,OAAH,CAAWgI,MAAX,CAAkB/J,EAAE+J,MAApB,CAAP;EACD,KAVW,EAWXzG,IAXW,CAWN,IAXM,EAWA,UAAStD,CAAT,EAAY;EACtB,UAAG1B,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAAjB,IAA0B,SAA1B,IAAuCrB,GAAGI,OAAH,CAAWwC,KAAX,CAAiBvB,KAAjB,IAA0B,MAApE,EACE,OAAOrB,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE2G,CAAf,IAAqBf,KAAKkP,MAAL,MAAiBxW,GAAGyD,OAAH,CAAW4E,CAAX,CAAaiK,SAAb,KAA4B5Q,EAAEwI,IAAF,GAAS,CAAtD,CAA5B,CADF,KAGE,OAAOlK,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE2G,CAAf,CAAP;EACH,KAhBW,EAiBXrD,IAjBW,CAiBN,IAjBM,EAiBA,UAAStD,CAAT,EAAY;EACtB,UAAG1B,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAjB,IAA0B,SAA1B,IAAuCrB,GAAGI,OAAH,CAAWuC,KAAX,CAAiBtB,KAAjB,IAA0B,MAApE,EACE,OAAOrB,GAAGyD,OAAH,CAAWsB,CAAX,CAAarD,EAAEqD,CAAf,IAAqBuC,KAAKkP,MAAL,MAAiBxW,GAAGyD,OAAH,CAAWsB,CAAX,CAAauN,SAAb,KAA4B5Q,EAAEwI,IAAF,GAAS,CAAtD,CAA5B,CADF,KAGE,OAAOlK,GAAGyD,OAAH,CAAWsB,CAAX,CAAarD,EAAEqD,CAAf,CAAP;EACH,KAtBW,EAuBXtE,KAvBW,CAuBL,MAvBK,EAuBG,UAASiB,CAAT,EAAY;EACzB,aAAOA,EAAEgJ,KAAF,CAAQ5E,KAAR,CAAc,CAAd,EAAgB,CAAhB,MAAuB,GAAvB,GAA8B9F,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBhJ,EAAEgJ,KAAnB,CAA9B,GAA0DhJ,EAAEgJ,KAAnE;EACD,KAzBW,EA0BXjK,KA1BW,CA0BL,SA1BK,EA0BMT,GAAGI,OAAH,CAAWkL,OAAX,KAAuBxJ,SAAvB,GAAmC9B,GAAGI,OAAH,CAAWkL,OAA9C,GAAyD,CA1B/D,EA2BX5F,EA3BW,CA2BR,WA3BQ,EA2BK,UAAShE,CAAT,EAAYmE,CAAZ,EAAe;EAC9B,UAAI7F,GAAGI,OAAH,CAAWinB,SAAf,EAA0B;EACxBrnB,WAAGI,OAAH,CAAWinB,SAAX,CAAqBpf,IAArB,CAA0BjI,EAA1B,EAA8B0B,CAA9B,EAAiCmE,CAAjC;EACD;EACD7F,SAAGwT,IAAH,CAAQ7N,IAAR,CAAajE,CAAb,EAAgBV,GAAGqO,MAAH,CAAU,IAAV,EAAgB7J,IAAhB,EAAhB;EACD,KAhCW,EAiCXE,EAjCW,CAiCR,UAjCQ,EAiCI,UAAShE,CAAT,EAAYmE,CAAZ,EAAe;EAC7B,UAAI7F,GAAGI,OAAH,CAAWmnB,QAAf,EAAyB;EACvBvnB,WAAGI,OAAH,CAAWmnB,QAAX,CAAoBtf,IAApB,CAAyB,IAAzB,EAA+BvG,CAA/B,EAAkCmE,CAAlC;EACD;EACD7F,SAAGwT,IAAH,CAAQ5N,IAAR,CAAalE,CAAb,EAAgBV,GAAGqO,MAAH,CAAU,IAAV,EAAgB7J,IAAhB,EAAhB;EACD,KAtCW,EAuCXE,EAvCW,CAuCR,OAvCQ,EAuCC,UAAShE,CAAT,EAAYmE,CAAZ,EAAe;EAC1B,UAAI7F,GAAGI,OAAH,CAAWmjB,OAAf,EAAwB;EACtBvjB,WAAGI,OAAH,CAAWmjB,OAAX,CAAmBtb,IAAnB,CAAwB,IAAxB,EAA8BvG,CAA9B,EAAiCmE,CAAjC;EACD;EACF,KA3CW,CAAd;;EA6CA,WAAO7F,EAAP;EACD,GApDD;;EAsDAqvB,UAAQ3b,SAAR,CAAkBrE,MAAlB,GAA2B,UAAS8E,EAAT,EAAY;EACrC,QAAInU,KAAK,IAAT;EACA,WAAOA,GAAG6T,MAAH,CAAU/S,IAAV,CAAeuO,MAAf,CAAsB,oBAAkB8E,EAAxC,CAAP;EACD,GAHD;;EAKAkb,UAAQ3b,SAAR,CAAkB1L,SAAlB,GAA8B,UAASmM,EAAT,EAAY;EACxC,QAAInU,KAAK,IAAT;EACA,WAAOA,GAAG6T,MAAH,CAAU/S,IAAV,CAAekH,SAAf,CAAyB,QAAzB,CAAP;EACD,GAHD;;EAKA,SAAO,IAAIqnB,OAAJ,CAAYlvB,MAAZ,CAAP;EACD;;EC9OD;;;AAGA,EAAe,oBAAUA,MAAV,EAAkBoM,MAAlB,EAA0B;;EAEvC;EACA,MAAIyjB,YAAYnjB,OAAOsV,MAAP,CAAc5V,MAAd,CAAhB;;EAEAyjB,YAAUhmB,IAAV,GAAiB,UAAU7J,MAAV,EAAkB;EACjC,QAAIH,KAAK,IAAT;;EAEAA,OAAGI,OAAH,GAAaD,SAASA,MAAT,GAAkB,EAA/B;EACAH,OAAGI,OAAH,CAAW6vB,WAAX,GAAyB,YAAzB;EACAjwB,OAAGkM,KAAH,GAAW,EAAX;EACAlM,OAAGyD,OAAH,GAAa,EAAb;EACAzD,OAAGwT,IAAH,GAAUxT,GAAGe,KAAH,CAASC,EAAT,CAAYC,GAAZ,GACP+D,IADO,CAEN,OAFM,EAGN,aACGhF,GAAGI,OAAH,CAAWmE,OAAX,IAAsBvE,GAAGI,OAAH,CAAWmE,OAAX,CAAmBiL,OAAzC,GACGxP,GAAGI,OAAH,CAAWmE,OAAX,CAAmBiL,OADtB,GAEG,EAHN,CAHM,EAQPiE,SARO,CAQG,GARH,EASPnE,IATO,CASFtP,GAAGI,OAAH,CAAWa,GAAX,IAAkB,UAAUS,CAAV,EAAa;EACnC,UAAI4N,OAAO,OAAX;EACAA,cAAQ,WAAW5N,EAAE1B,GAAGI,OAAH,CAAW8vB,QAAb,CAAX,GAAoC,SAA5C;EACA5gB,cAAQ,gBAAgBtP,GAAGe,KAAH,CAASyB,MAAT,GAAkBd,EAAE1B,GAAGI,OAAH,CAAWiD,KAAb,CAAlB,CAAhB,GAAyD,SAAjE;EACAiM,cAAQ,QAAR;EACA,aAAOA,IAAP;EACD,KAfO,CAAV;EAiBD,GAxBD;;EA2BA;EACA;EACA0gB,YAAU7b,EAAV,GAAe,UAAUR,UAAV,EAAsB;EACnC,QAAI3T,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW+T,EAAX,GAAgBR,UAAhB;EACA,WAAO3T,EAAP;EACD,GAJD;;EAMAgwB,YAAUE,QAAV,GAAqB,UAAUvc,UAAV,EAAsB;EACzC,QAAI3T,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW8vB,QAAX,GAAsBvc,UAAtB;EACA,WAAO3T,EAAP;EACD,GAJD;;EAMAgwB,YAAU3sB,KAAV,GAAkB,UAAUsQ,UAAV,EAAsB;EACtC,QAAI3T,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWiD,KAAX,GAAmBsQ,UAAnB;EACA,WAAO3T,EAAP;EACD,GAJD;;EAMAgwB,YAAUC,WAAV,GAAwB,UAAUA,WAAV,EAAuB;EAC7C,QAAIjwB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW6vB,WAAX,GAAyBA,WAAzB;EACA,WAAOjwB,EAAP;EACD,GAJD;;EAMA;;;;EAIAgwB,YAAUpuB,OAAV,GAAoB,UAAU+R,UAAV,EAAsB;EACxC,QAAI3T,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWwB,OAAX,GAAqB+R,UAArB;EACA,WAAO3T,EAAP;EACD,GAJD;;EAMA;;;;EAIAgwB,YAAU1N,IAAV,GAAiB,UAAU3O,UAAV,EAAsB;EACrC,QAAI3T,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWkiB,IAAX,GAAkB3O,UAAlB;EACA,WAAO3T,EAAP;EACD,GAJD;;EAMA;;;;EAIAgwB,YAAU9f,MAAV,GAAmB,UAAUA,MAAV,EAAkB;EACnC,QAAIlQ,KAAK,IAAT;EACA,QAAIiC,MAAMC,OAAN,CAAcgO,MAAd,CAAJ,EAA2B;EACzB;EACAlQ,SAAGI,OAAH,CAAW8P,MAAX,GAAoBA,MAApB;EACD,KAHD,MAGO;EACL;EACAlQ,SAAGyD,OAAH,CAAWiH,KAAX,GAAmBwF,MAAnB;EACD;EACD,WAAOlQ,EAAP;EACD,GAVD;;EAYAgwB,YAAU5N,MAAV,GAAmB,UAAUzI,MAAV,EAAkB;EACnC;EACA;EACA,QAAI3Z,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWgiB,MAAX,GAAoBzI,MAApB;EACA,WAAO3Z,EAAP;EACD,GAND;;EAQAgwB,YAAUxtB,MAAV,GAAmB,UAAUA,MAAV,EAAkB;EACnC,QAAIxC,KAAK,IAAT;EACA,QAAI,OAAOwC,MAAP,IAAiB,UAAjB,IAA+BA,kBAAkBsR,QAArD,EACE9T,GAAGe,KAAH,CAASyB,MAAT,GAAkBA,MAAlB,CADF,KAGExC,GAAGe,KAAH,CAASyB,MAAT,GAAkBxB,WAAA,CAAUwB,MAAV,CAAlB;EACF,WAAOxC,EAAP;EACD,GAPD;;EASAgwB,YAAU/uB,GAAV,GAAgB,UAAUA,GAAV,EAAe;EAC7B,QAAIjB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACA,WAAOjB,EAAP;EACD,GAJD;;EAMAgwB,YAAU5kB,MAAV,GAAmB,UAAUA,MAAV,EAAkB;EACnC,QAAIpL,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWgL,MAAX,GAAoBA,MAApB;EACA,WAAOpL,EAAP;EACD,GAJD;;EAOA;EACA;EACAgwB,YAAU5uB,IAAV,GAAiB,UAAUA,IAAV,EAAgB;EAC/B,QAAIpB,KAAK,IAAT;;EAEA,QAAIA,GAAGI,OAAH,CAAWua,MAAf,EAAuB;EACrB;EACAvZ,aAAOA,KAAKuZ,MAAL,CAAY3a,GAAGI,OAAH,CAAWua,MAAvB,CAAP;EACD;EACD;EACA,QAAI3a,GAAGI,OAAH,CAAWgiB,MAAf,EAAuB;EACrB,UAAIpiB,GAAGI,OAAH,CAAWgiB,MAAX,CAAkB8N,QAAtB,EAAgC;EAC9B9uB,eAAOA,KAAK8R,IAAL,CAAU,UAAUlN,CAAV,EAAaC,CAAb,EAAgB;EAC/B,iBAAOjG,GAAGI,OAAH,CAAWgiB,MAAX,CAAkB8N,QAAlB,KAA+B,MAA/B,GAAwClwB,GAAGe,KAAH,CAASmF,cAAT,CAAwBF,EAAEhG,GAAGI,OAAH,CAAW8vB,QAAb,CAAxB,EAAgDjqB,EAAEjG,GAAGI,OAAH,CAAW8vB,QAAb,CAAhD,CAAxC,GAAkHlwB,GAAGe,KAAH,CAASgF,aAAT,CAAuBC,EAAEhG,GAAGI,OAAH,CAAW8vB,QAAb,CAAvB,EAA+CjqB,EAAEjG,GAAGI,OAAH,CAAW8vB,QAAb,CAA/C,CAAzH;EACD,SAFM,CAAP;EAGD;EACD,UAAIlwB,GAAGI,OAAH,CAAWgiB,MAAX,CAAkB/e,KAAtB,EAA6B;EAC3BjC,eAAOA,KAAK8R,IAAL,CAAU,UAAUlN,CAAV,EAAaC,CAAb,EAAgB;EAC/B,iBAAOjG,GAAGI,OAAH,CAAWgiB,MAAX,CAAkB/e,KAAlB,KAA4B,MAA5B,GAAqCrD,GAAGe,KAAH,CAASmF,cAAT,CAAwBF,EAAEhG,GAAGI,OAAH,CAAWiD,KAAb,CAAxB,EAA6C4C,EAAEjG,GAAGI,OAAH,CAAWiD,KAAb,CAA7C,CAArC,GAAyGrD,GAAGe,KAAH,CAASgF,aAAT,CAAuBC,EAAEhG,GAAGI,OAAH,CAAWiD,KAAb,CAAvB,EAA4C4C,EAAEjG,GAAGI,OAAH,CAAWiD,KAAb,CAA5C,CAAhH;EACD,SAFM,CAAP;EAGD;EACF,KAXD,MAWO;EACLjC,aAAOA,KAAK8R,IAAL,CAAU,UAAUlN,CAAV,EAAaC,CAAb,EAAgB;EAC/B,eAAOjG,GAAGe,KAAH,CAASgF,aAAT,CAAuBC,EAAEhG,GAAGI,OAAH,CAAW8vB,QAAb,CAAvB,EAA+CjqB,EAAEjG,GAAGI,OAAH,CAAW8vB,QAAb,CAA/C,CAAP;EACD,OAFM,CAAP;EAGD;;EAED,QAAIjI,QAAQ,CAAZ;EACAjoB,OAAGkM,KAAH,GAAW9K,KAAKK,GAAL,CAAS,UAASC,CAAT,EAAY;EAC9BA,QAAEyuB,EAAF,GAAOlI,KAAP;EACAvmB,QAAE0uB,EAAF,GAAOnI,QAAQvmB,EAAE1B,GAAGI,OAAH,CAAWiD,KAAb,CAAf;EACA4kB,eAAS,CAACvmB,EAAE1B,GAAGI,OAAH,CAAWiD,KAAb,CAAV;EACA,UAAIrD,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,SAA1B,KAAwC1N,MAAMC,OAAN,CAAclC,GAAGI,OAAH,CAAWwB,OAAzB,CAAxC,IAA6E5B,GAAGI,OAAH,CAAWwB,OAAX,CAAmBsC,MAAnB,GAA4B,CAA7G,EAAgH;EAC9GxC,UAAE2uB,WAAF,GAAgBrvB,UAAA,GAAWwR,IAAX,CAAgBxS,GAAGI,OAAH,CAAWwB,OAA3B,EAAoC,CAACF,CAAD,CAApC,CAAhB;EACAA,UAAE4uB,aAAF,GAAkBtvB,QAAA,CAAOU,EAAE2uB,WAAT,EAAsB,UAASE,KAAT,EAAgB;EACtD,iBAAOA,MAAM,CAAN,EAAS,CAAT,IAAcA,MAAM,CAAN,EAAS,CAAT,CAArB;EACD,SAFiB,CAAlB;EAGD;EACD,aAAO7uB,CAAP;EACD,KAXU,CAAX;;EAaA,QAAI1B,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,WAA1B,CAAJ,EAA4C;EAC1C3P,SAAGkoB,UAAH,GAAgBloB,GAAGmoB,YAAH,CAAgB/mB,IAAhB,CAAhB;EACApB,SAAG6jB,OAAH,GAAa7iB,WAAA,CAAUI,IAAV,EAAgB,UAAUM,CAAV,EAAa;EACxC,eAAO,CAACA,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAAR;EACD,OAFY,CAAb;EAGD;;EAED,WAAOtiB,EAAP;EACD,GA/CD;;EAiDAgwB,YAAU1iB,MAAV,GAAmB,YAAY;EAC7B,QAAItN,KAAK,IAAT;EACA,QAAIG,MAAJ;EACA;EACA;;;;;;;EAOA;EACA,QAAIH,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,UAA1B,KAAyC3P,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,OAA1B,CAA7C,EAAiF;EAC/ExP,eAAS;EACPwB,gBAAQ,IADD;EAEPI,cAAM,QAFC;EAGPR,eAAO,CAAC,CAAD,EAAIvB,GAAGE,KAAH,CAASG,KAAb,CAHA;EAIP2B,iBAAS;EAJF,OAAT;EAMAhC,SAAGyD,OAAH,CAAW4E,CAAX,GAAerI,GAAGe,KAAH,CAASI,aAAT,CAAuBnB,GAAGkM,KAA1B,EAAiC/L,MAAjC,CAAf;;EAEAA,eAAS;EACPwB,gBAAQ3B,GAAGI,OAAH,CAAWiD,KADZ;EAEPtB,cAAM,QAFC;EAGPR,eAAO,CAACvB,GAAGE,KAAH,CAASK,MAAV,EAAkB,CAAlB,CAHA;EAIPyB,iBAAS;EAJF,OAAT;EAMAhC,SAAGyD,OAAH,CAAWsB,CAAX,GAAe/E,GAAGe,KAAH,CAASI,aAAT,CAAuBnB,GAAGkM,KAA1B,EAAiC/L,MAAjC,CAAf;EACD;;EAGD;EACA,QAAIH,GAAGI,OAAH,CAAW6vB,WAAX,KAA2B,YAA3B,IAA2CjwB,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,SAA1B,CAA/C,EAAqF;EACnF;EACAxP,eAAS;EACPwB,gBAAQ,IADD;EAEPI,cAAM,QAFC;EAGPR,eAAO,CAAC,CAAD,EAAIvB,GAAGE,KAAH,CAASG,KAAb,CAHA;EAIP2B,iBAAS;EAJF,OAAT;EAMAhC,SAAGyD,OAAH,CAAW4E,CAAX,GAAerI,GAAGe,KAAH,CAASI,aAAT,CAAuBnB,GAAGkM,KAA1B,EAAiC/L,MAAjC,CAAf;;EAEA;EACAA,eAAS;EACPwB,gBAAQ,EADD;EAEPI,cAAM,QAFC;EAGPR,eAAO,CAACvB,GAAGE,KAAH,CAASK,MAAV,EAAkB,CAAlB,CAHA;EAIPyB,iBAAS;EAJF,OAAT;EAMAhC,SAAGyD,OAAH,CAAWsB,CAAX,GAAe/D,gBAAA,GAAiBO,KAAjB,CAAuBpB,OAAOoB,KAA9B,EAAqCa,MAArC,CAA4C,CAAC,CAAD,EAAI,CAAJ,CAA5C,CAAf;EACD;;EAED;EACA,QAAIpC,GAAGI,OAAH,CAAW6vB,WAAX,KAA2B,UAA3B,IAAyCjwB,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,SAA1B,CAA7C,EAAmF;EACjF;EACAxP,eAAS;EACPwB,gBAAQ,EADD;EAEP6uB,cAAM,QAFC;EAGPjvB,eAAO,CAACvB,GAAGE,KAAH,CAASK,MAAV,EAAkB,CAAlB,CAHA;EAIPyB,iBAAS;EAJF,OAAT;EAMAhC,SAAGyD,OAAH,CAAW4E,CAAX,GAAerH,gBAAA,GAAiBO,KAAjB,CAAuBpB,OAAOoB,KAA9B,EAAqCa,MAArC,CAA4C,CAAC,CAAD,EAAI,CAAJ,CAA5C,CAAf;;EAEA;EACAjC,eAAS;EACPwB,gBAAQ3B,GAAGI,OAAH,CAAWiD,KADZ;EAEPtB,cAAM,QAFC;EAGPR,eAAO,CAAC,CAAD,EAAIvB,GAAGE,KAAH,CAASG,KAAb,CAHA;EAIP2B,iBAAS;EAJF,OAAT;EAMAhC,SAAGyD,OAAH,CAAWsB,CAAX,GAAe/E,GAAGe,KAAH,CAASI,aAAT,CAAuBnB,GAAGkM,KAA1B,EAAiC/L,MAAjC,CAAf;EAED;EACD;EACA;;EAEA,QAAIH,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,QAA1B,CAAJ,EACE3P,GAAGyD,OAAH,CAAWiH,KAAX,GAAmB1J,iBAAA,CAAgBhB,GAAGI,OAAH,CAAW8P,MAA3B,CAAnB,CADF,KAGElQ,GAAGyD,OAAH,CAAWiH,KAAX,GAAmB1J,iBAAA,CAAgBA,qBAAhB,CAAnB;;EAEF,WAAOhB,EAAP;EACD,GAlFD;;EAoFAgwB,YAAUS,UAAV,GAAuB,YAAW;EAChC,QAAIzwB,KAAK,IAAT;EACA,QAAI0wB,SAAS1wB,GAAGE,KAAH,CAASW,GAAT,GAAemH,SAAf,CAAyB,WAAzB,CAAb;EACA0oB,WAAOlsB,IAAP,CAAY,UAASmsB,GAAT,EAAc;EACxB,UAAI5E,KAAK,IAAT;EACA4E,UAAIN,WAAJ,CAAgBlhB,OAAhB,CAAwB,UAASyhB,EAAT,EAAa;EACnC,YAAIC,QAAQ7wB,GAAGyD,OAAH,CAAW4E,CAAX,CAAauoB,GAAG,CAAH,EAAMxvB,IAAN,CAAWpB,GAAGI,OAAH,CAAWiD,KAAtB,CAAb,CAAZ;EACA,YAAIytB,QAAQ9wB,GAAGyD,OAAH,CAAWsB,CAAX,CAAc6rB,GAAG,CAAH,EAAM,CAAN,IAAWA,GAAG,CAAH,EAAMxvB,IAAN,CAAWkvB,aAApC,IAAsDtwB,GAAGyD,OAAH,CAAWsB,CAAX,CAAa6rB,GAAG,CAAH,EAAM,CAAN,IAAWA,GAAG,CAAH,EAAMxvB,IAAN,CAAWkvB,aAAnC,CAAlE;EACA,YAAIQ,QAAQ,EAAR,IAAcD,QAAQ,GAA1B,EAA+B;EAC7B7vB,qBAAA,CAAU+qB,EAAV,EAAc3mB,MAAd,CAAqB,MAArB,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,aAFR,EAEuB,QAFvB,EAGGA,IAHH,CAGQ,WAHR,EAGqB,YAAW;EAC5B,mBAAO,gBAAgBhF,GAAGyD,OAAH,CAAW4E,CAAX,CAAauoB,GAAG,CAAH,EAAMxvB,IAAN,CAAW+uB,EAAxB,IAA8BU,QAAM,CAApD,IAAyD,GAAzD,IAAgED,GAAG,CAAH,EAAM,CAAN,IAAW5wB,GAAGyD,OAAH,CAAWsB,CAAX,CAAa6rB,GAAG,CAAH,EAAM,CAAN,IAAWA,GAAG,CAAH,EAAMxvB,IAAN,CAAWkvB,aAAnC,IAAoD,EAA/D,GAAoEtwB,GAAGyD,OAAH,CAAWsB,CAAX,CAAa,CAAb,IAAkB,EAAtJ,IAA4J,GAAnK;EACD,WALH,EAMGT,IANH,CAMQ,YAAW;EACf,mBAAO,QAAQtE,GAAGe,KAAH,CAASyB,MAAT,CAAgBxC,GAAGI,OAAH,CAAWwC,KAA3B,EAAkCguB,GAAG,CAAH,EAAMxvB,IAAN,CAAWpB,GAAGI,OAAH,CAAWiD,KAAtB,CAAlC,CAAR,GAA0E,OAA1E,GAAoFrD,GAAGe,KAAH,CAASyB,MAAT,CAAgBxC,GAAGI,OAAH,CAAWuC,KAA3B,EAAkCiuB,GAAG,CAAH,EAAMxvB,IAAN,CAAWwvB,GAAG/a,GAAd,CAAlC,CAA3F;EACD,WARH;EASD;EACF,OAdD;EAeD,KAjBD;EAkBD,GArBD;;EAuBAma,YAAU5iB,IAAV,GAAiB,YAAW;EAC1B,QAAIpN,KAAK,IAAT;EACA,QAAIA,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,SAA1B,CAAJ,EAA0C;EACxC,UAAI3P,GAAGI,OAAH,CAAW6vB,WAAX,KAA2B,YAA/B,EAA6CjwB,GAAG+wB,iBAAH;EAC7C,UAAI/wB,GAAGI,OAAH,CAAW6vB,WAAX,KAA2B,UAA/B,EAA2CjwB,GAAGgxB,iBAAH;EAC3C,aAAOhxB,EAAP;EACD;;EAEDA,OAAGE,KAAH,CAASW,GAAT,GAAeoH,IAAf,CAAoBjI,GAAGwT,IAAvB;;EAEA,QAAMtC,UAAUlR,GAAGe,KAAH,CAASC,EAAT,CAAYC,GAAZ,GACb+D,IADa,CACR,OADQ,EACC,WADD,EAEbsK,IAFa,CAER,aAAK;EACT,aAAO5N,EAAE1B,GAAGI,OAAH,CAAW8vB,QAAb,CAAP;EACD,KAJa,CAAhB;EAKAlwB,OAAGE,KAAH,CAASW,GAAT,GAAeoH,IAAf,CAAoBiJ,OAApB;;EAEA,QAAIlR,GAAGI,OAAH,CAAW6vB,WAAX,KAA2B,YAA/B,EAA6C;;EAE3C;;;EAGA,UAAIgB,OAAO,EAAX;EACAjxB,SAAGkxB,QAAH,GAAclxB,GAAGE,KAAH,CAASW,GAAT,GAAeuE,MAAf,CAAsB,GAAtB,EACXJ,IADW,CACN,OADM,EACG,QADH,EAEXA,IAFW,CAEN,WAFM,EAEO,kBAAkBhF,GAAGE,KAAH,CAASK,MAAT,GAAkB,EAApC,IAA0C,GAFjD,EAGXyH,SAHW,CAGD,OAHC,EAIX5G,IAJW,CAINpB,GAAGkM,KAJG,EAKX9F,KALW,GAMXhB,MANW,CAMJ,GANI,EAOXJ,IAPW,CAON,OAPM,EAOG,MAPH,EAQXA,IARW,CAQN,WARM,EAQO,aAAK;EACtB,YAAMqD,IAAIrI,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAEyuB,EAAf,IAAsBnwB,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE0uB,EAAF,GAAO1uB,EAAEyuB,EAAtB,IAA4B,CAA5D;EACAc,aAAK3rB,IAAL,CAAU+C,CAAV;EACA,eAAO,eAAeA,CAAf,GAAmB,MAA1B;EACD,OAZW,EAaXjD,MAbW,CAaJ,MAbI,EAcXJ,IAdW,CAcN,aAdM,EAcS,QAdT,EAeXV,IAfW,CAeN,UAAS5C,CAAT,EAAY;EAChB,eAAOA,EAAE1B,GAAGI,OAAH,CAAW8vB,QAAb,CAAP;EACD,OAjBW,CAAd;;EAmBA,UAAIiB,gBAAgBnwB,QAAA,CAAOhB,GAAGkM,KAAV,EAAiB,UAAUxK,CAAV,EAAa;EAChD,eAAO,CAAC1B,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE0uB,EAAf,IAAqBpwB,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAEyuB,EAAf,CAAtB,IAA4C,GAAnD;EACD,OAFmB,CAApB;EAGA,UAAMiB,oBAAoBpwB,QAAA,CAAOhB,GAAGkxB,QAAH,CAAY9e,KAAZ,EAAP,EAA4B,UAAU5M,IAAV,EAAgB;EACpE,eAAOA,KAAKC,qBAAL,EAAP;EACD,OAFyB,CAA1B;AAGA;EAEAzF,SAAGkxB,QAAH,CAAY1sB,IAAZ,CAAiB,UAAU9C,CAAV,EAAauC,KAAb,EAAoB8nB,EAApB,EAAwB;EAAA;;EACvC;EACA;EACA,YAAIqF,oBAAqBD,gBAAgB,CAAzC,EAA6C;EAC3CnwB,qBAAA,CAAU,IAAV,EAAgBiH,IAAhB,CAAqBjI,GAAGe,KAAH,CAASsD,IAA9B,EAAoC8sB,aAApC,EAAmDjgB,OAAnD;EACD,SAFD,MAEO;EACLlQ,qBAAA,CAAU,IAAV,EACGgE,IADH,CACQ,aADR,EACuB,KADvB,EAEGA,IAFH,CAEQ,IAFR,EAEc,CAFd,EAGGA,IAHH,CAGQ,WAHR,EAGqB,4BAHrB;EAIA,cAAIqsB,mBAAmBrxB,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBI,MAAvB,GAAgC,GAAvD;EACA,cAAI,KAAK9E,qBAAL,KAA+B4rB,gBAAnC,EAAqD;EAAA;EACnDrwB,yBAAA,CAAU,KAAV,EACG0E,EADH,CACM,WADN,EACmBwL,QAAQvL,IAD3B,EAEGD,EAFH,CAEM,UAFN,EAEkBwL,QAAQtL,IAF1B;EAGA,kBAAIC,IAAI,CAAR;EACA,qBAAO,MAAKJ,qBAAL,KAA+B4rB,gBAAtC,EAAwD;EACtDrwB,2BAAA,CAAU,KAAV,EAAgBsD,IAAhB,CAAqB,UAAU5C,CAAV,EAAa;EAChC,yBAAO,CAACA,EAAE1B,GAAGI,OAAH,CAAW8vB,QAAb,IAAyB,EAA1B,EAA8BpqB,KAA9B,CAAoC,CAApC,EAAuC,CAACD,CAAxC,IAA6C,KAApD;EACD,iBAFD,EAEGb,IAFH,CAEQ,OAFR,EAEiBtD,CAFjB;EAGA,kBAAEmE,CAAF;EACD;EAVkD;EAWpD;EACF;;EAED,YAAIyrB,WAAWxnB,OAAOynB,gBAAP,CAAwB,IAAxB,EAA8B,IAA9B,EAAoCC,gBAApC,CAAqD,WAArD,CAAf;EACA,YAAIC,UAAUxuB,OAAOquB,SAAS5tB,OAAT,CAAiB,KAAjB,EAAuB,EAAvB,CAAP,CAAd;;EAEA,YAAIO,UAAU,CAAV,IAAeA,UAAUjE,GAAGkM,KAAH,CAAShI,MAAT,GAAkB,CAA/C,EAAkD;EAChD,cAAIwtB,WAAWT,KAAKhtB,KAAL,IAAcgtB,KAAKhtB,QAAQ,CAAb,CAA7B;EACA,cAAI0tB,WAAWV,KAAKhtB,QAAQ,CAAb,IAAkBgtB,KAAKhtB,KAAL,CAAjC;;EAEA,cAAI2tB,eAAelwB,EAAE2B,KAAF,GAAUrD,GAAGkM,KAAH,CAASjI,QAAQ,CAAjB,EAAoBZ,KAAjD;EACA,cAAIwuB,eAAenwB,EAAE2B,KAAF,GAAUrD,GAAGkM,KAAH,CAASjI,QAAQ,CAAjB,EAAoBZ,KAAjD;;EAEA,cAAIquB,WAAWD,UAAU,CAArB,IAA0BE,WAAWF,UAAU,CAAnD,EAAsD;EACpD,gBAAIG,gBAAgBC,YAApB,EAAkC;EAChC7wB,yBAAA,CAAU,IAAV,EAAgBkH,MAAhB;AACA4pB,EACD;EACF;EACF;EACF,OA1CD;;EA6CA9xB,SAAGE,KAAH,CAASW,GAAT,GAAemH,SAAf,CAAyB,MAAzB,EACG5G,IADH,CACQpB,GAAGkM,KADX,EAEG9F,KAFH,GAEWhB,MAFX,CAEkB,MAFlB,EAGGJ,IAHH,CAGQ,OAHR,EAGiB,KAHjB,EAIGA,IAJH,CAIQ,IAJR,EAIc,UAACtD,CAAD,EAAImE,CAAJ,EAAU;EACpB,YAAIsO,KAAK,eAAetO,CAAxB;EACA,YAAI7F,GAAGI,OAAH,CAAW+T,EAAf,EAAmB;EACjBA,eAAK,eAAezS,EAAE1B,GAAGI,OAAH,CAAW+T,EAAb,CAApB;EACD;EACD,eAAOA,EAAP;EACD,OAVH,EAWGnP,IAXH,CAWQ,GAXR,EAWa,UAACtD,CAAD;EAAA,eAAO1B,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAEyuB,EAAf,CAAP;EAAA,OAXb,EAYGnrB,IAZH,CAYQ,GAZR,EAYa,CAZb,EAaGA,IAbH,CAaQ,OAbR,EAaiB;EAAA,eAAKhF,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE1B,GAAGI,OAAH,CAAWiD,KAAb,CAAb,CAAL;EAAA,OAbjB,EAcG2B,IAdH,CAcQ,QAdR,EAckBhF,GAAGE,KAAH,CAASK,MAAT,GAAkBP,GAAGE,KAAH,CAASK,MAA3B,GAAoC,GAdtD,EAeGyE,IAfH,CAeQ,MAfR,EAegB,UAACtD,CAAD,EAAO;EACnB,eAAO1B,GAAGyD,OAAH,CAAWiH,KAAX,KAAqB,KAArB,GAA6B1K,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBhJ,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAAjB,CAA7B,GAAoEtiB,GAAG+oB,iBAAH,CAAqBrnB,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAArB,EAAyC,SAAzC,CAA3E;EACD,OAjBH,EAkBGtd,IAlBH,CAkBQ,QAlBR,EAkBkB,OAlBlB,EAmBGA,IAnBH,CAmBQ,cAnBR,EAmBwB,CAnBxB,EAoBGvE,KApBH,CAoBS,SApBT,EAoBoB,GApBpB,EAqBGiF,EArBH,CAqBM,WArBN,EAqBmB,UAAShE,CAAT,EAAYmE,CAAZ,EAAe;EAC9B,YAAI7F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,WAA1B,KAA0C3P,GAAGI,OAAH,CAAWokB,SAAX,CAAqB7U,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpG3O,qBAAA,CAAU,IAAV,EAAgBgE,IAAhB,CAAqB,MAArB,EAA6B,UAAUtD,CAAV,EAAa;EACxC,mBAAO1B,GAAG+oB,iBAAH,CAAqBrnB,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,WAFD;EAGD;EACDtiB,WAAGwT,IAAH,CAAQ7N,IAAR,CAAajE,CAAb,EAAgBV,WAAA,CAAU,IAAV,EAAgBwE,IAAhB,EAAhB;;EAEA,YAAIxF,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,aAA1B,CAAJ,EAA8C;EAAE;EAC9C3P,aAAGI,OAAH,CAAWyoB,WAAX,CAAuB5gB,IAAvB,CAA4B,IAA5B,EAAkCvG,CAAlC,EAAqCmE,CAArC;EACD;EAEF,OAjCH,EAkCGH,EAlCH,CAkCM,UAlCN,EAkCkB,UAAUhE,CAAV,EAAamE,CAAb,EAAgB;EAC9B,YAAI7F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,WAA1B,KAA0C3P,GAAGI,OAAH,CAAWokB,SAAX,CAAqB7U,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpG3O,qBAAA,CAAU,IAAV,EAAgBgE,IAAhB,CAAqB,MAArB,EAA6B,UAAUtD,CAAV,EAAa;EACxC,mBAAO1B,GAAG+oB,iBAAH,CAAqBrnB,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,WAFD;EAGD;EACDtiB,WAAGwT,IAAH,CAAQ5N,IAAR;;EAEA,YAAI5F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,YAA1B,CAAJ,EAA6C;EAAE;EAC7C3P,aAAGI,OAAH,CAAW4oB,UAAX,CAAsB/gB,IAAtB,CAA2B,IAA3B,EAAiCvG,CAAjC,EAAoCmE,CAApC;EACD;EACF,OA7CH,EA8CGH,EA9CH,CA8CM,OA9CN,EA8Ce,UAAUhE,CAAV,EAAamE,CAAb,EAAgB;EAC3B,YAAI7F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,OAA1B,CAAJ,EAAwC;EACtC3P,aAAGI,OAAH,CAAWmjB,OAAX,CAAmBtb,IAAnB,CAAwB,IAAxB,EAA8BvG,CAA9B,EAAiCmE,CAAjC;EACD;EACF,OAlDH;EAmDD;EACD,WAAO7F,EAAP;EACD,GApJD;;EAuJA;EACA;;;EAGAgwB,YAAUe,iBAAV,GAA8B,YAAY;EACxC,QAAI/wB,KAAK,IAAT;EACAA,OAAGwT,IAAH,CAAQlE,IAAR,CAAatP,GAAGI,OAAH,CAAWa,GAAX,IAAkB,UAAUS,CAAV,EAAa;EAC1C,UAAIqwB,MAAM,EAAV;EACAA,aAAO,WAAWrwB,EAAEmU,GAAb,GAAmB,SAA1B;EACA,UAAInU,EAAEmU,GAAF,KAAUnU,EAAE,CAAF,EAAKN,IAAL,CAAUpB,GAAGI,OAAH,CAAW8vB,QAArB,CAAd,EAA8C;EAC5C6B,eAAO,kBAAkB/xB,GAAGe,KAAH,CAASyB,MAAT,CAAgBxC,GAAGI,OAAH,CAAWuC,KAA3B,EAAkCjB,EAAE,CAAF,EAAKN,IAAL,CAAUM,EAAEmU,GAAZ,CAAlC,CAAlB,GAAwE,SAA/E;EACAkc,eAAO,eAAerwB,EAAE,CAAF,EAAKN,IAAL,CAAUpB,GAAGI,OAAH,CAAW8vB,QAArB,CAAf,GAAgD,SAAvD;EACA6B,eAAO,kBAAkB/xB,GAAGe,KAAH,CAASyB,MAAT,CAAgBxC,GAAGI,OAAH,CAAWwC,KAA3B,EAAkClB,EAAE,CAAF,EAAKN,IAAL,CAAUpB,GAAGI,OAAH,CAAWiD,KAArB,CAAlC,CAAlB,GAAmF,SAA1F;EACD,OAJD,MAIO;EACL0uB,eAAO,eAAe/xB,GAAGe,KAAH,CAASyB,MAAT,GAAkBd,EAAE,CAAF,EAAKN,IAAL,CAAUM,EAAEmU,GAAZ,CAAlB,CAAf,GAAqD,SAA5D;EACD;EACD,aAAOkc,GAAP;EACD,KAXD;EAYA/xB,OAAGE,KAAH,CAASW,GAAT,GAAeoH,IAAf,CAAoBjI,GAAGwT,IAAvB;;EAEA,QAAMtC,UAAUlR,GAAGe,KAAH,CAASC,EAAT,CAAYC,GAAZ,GACb+D,IADa,CACR,OADQ,EACC,WADD,EAEbsK,IAFa,CAER,aAAK;EACT,aAAO5N,EAAE1B,GAAGI,OAAH,CAAW8vB,QAAb,CAAP;EACD,KAJa,CAAhB;EAKAlwB,OAAGE,KAAH,CAASW,GAAT,GAAeoH,IAAf,CAAoBiJ,OAApB;;EAEA;;;EAGAlR,OAAGkxB,QAAH,GAAclxB,GAAGE,KAAH,CAASW,GAAT,GAAeuE,MAAf,CAAsB,GAAtB,EACXJ,IADW,CACN,OADM,EACG,QADH,EAEXA,IAFW,CAEN,WAFM,EAEO,kBAAkBhF,GAAGE,KAAH,CAASK,MAAT,GAAkB,EAApC,IAA0C,GAFjD,EAGXyH,SAHW,CAGD,GAHC,EAIX5G,IAJW,CAINpB,GAAGkM,KAJG,EAKX9F,KALW,GAMXhB,MANW,CAMJ,GANI,EAOXJ,IAPW,CAON,OAPM,EAOG,MAPH,EAQXA,IARW,CAQN,WARM,EAQO,aAAK;EACtB,UAAMqD,IAAIrI,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAEyuB,EAAf,IAAsBnwB,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE0uB,EAAF,GAAO1uB,EAAEyuB,EAAtB,IAA4B,CAA5D;EACA,aAAO,eAAe9nB,CAAf,GAAmB,MAA1B;EACD,KAXW,EAYXjD,MAZW,CAYJ,MAZI,EAaXJ,IAbW,CAaN,aAbM,EAaS,QAbT,EAcXV,IAdW,CAcN;EAAA,aAAK5C,EAAE1B,GAAGI,OAAH,CAAW8vB,QAAb,CAAL;EAAA,KAdM,CAAd;;EAgBA,QAAIiB,gBAAgBnwB,QAAA,CAAOhB,GAAGkM,KAAV,EAAiB,UAASxK,CAAT,EAAY;EAC/C,aAAO,CAAC1B,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE0uB,EAAf,IAAqBpwB,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAEyuB,EAAf,CAAtB,IAA4C,GAAnD;EACD,KAFmB,CAApB;EAGA,QAAMiB,oBAAoBpwB,QAAA,CAAOhB,GAAGkxB,QAAH,CAAY9e,KAAZ,EAAP,EAA4B,UAAU5M,IAAV,EAAgB;EACpE,aAAOA,KAAKC,qBAAL,EAAP;EACD,KAFyB,CAA1B;;EAIAzF,OAAGkxB,QAAH,CAAY1sB,IAAZ,CAAiB,UAAU9C,CAAV,EAAa;EAAA;;EAC5B;EACA;EACA,UAAI0vB,oBAAqBD,gBAAgB,CAAzC,EAA6C;EAC3CnwB,mBAAA,CAAU,IAAV,EAAgBiH,IAAhB,CAAqBjI,GAAGe,KAAH,CAASsD,IAA9B,EAAoC8sB,aAApC,EAAmDjgB,OAAnD;EACD,OAFD,MAEO;EACLlQ,mBAAA,CAAU,IAAV,EACGgE,IADH,CACQ,aADR,EACuB,KADvB,EAEGA,IAFH,CAEQ,IAFR,EAEc,CAFd,EAGGA,IAHH,CAGQ,WAHR,EAGqB,4BAHrB;EAIA,YAAIqsB,mBAAmBrxB,GAAGI,OAAH,CAAW8J,IAAX,CAAgBC,MAAhB,CAAuBI,MAAvB,GAAgC,GAAvD;EACA,YAAI,KAAK9E,qBAAL,KAA+B4rB,gBAAnC,EAAqD;EAAA;EACnDrwB,uBAAA,CAAU,MAAV,EACG0E,EADH,CACM,WADN,EACmBwL,QAAQvL,IAD3B,EAEGD,EAFH,CAEM,UAFN,EAEkBwL,QAAQtL,IAF1B;EAGA,gBAAIC,IAAI,CAAR;EACA,mBAAO,OAAKJ,qBAAL,KAA+B4rB,gBAAtC,EAAwD;EACtDrwB,yBAAA,CAAU,MAAV,EAAgBsD,IAAhB,CAAqB,UAAU5C,CAAV,EAAa;EAChC,uBAAO,CAACA,EAAE1B,GAAGI,OAAH,CAAW8vB,QAAb,IAAyB,EAA1B,EAA8BpqB,KAA9B,CAAoC,CAApC,EAAuC,CAACD,CAAxC,IAA6C,KAApD;EACD,eAFD,EAEGb,IAFH,CAEQ,OAFR,EAEiBtD,CAFjB;EAGA,gBAAEmE,CAAF;EACD;EAVkD;EAWpD;EACF;EACF,KAxBD;;EA0BA,QAAI6qB,SAAS1wB,GAAGE,KAAH,CAASW,GAAT,GAAeuE,MAAf,CAAsB,GAAtB,EACV4C,SADU,CACA,GADA,EAEV5G,IAFU,CAELpB,GAAGkM,KAFE,EAGV9F,KAHU,GAGFhB,MAHE,CAGK,GAHL,EAIVJ,IAJU,CAIL,OAJK,EAII,UAJJ,CAAb;;EAMA0rB,WAAO1oB,SAAP,CAAiB,MAAjB,EACG5G,IADH,CACQ,UAAUM,CAAV,EAAa;EACjB,aAAOA,EAAE2uB,WAAT;EACD,KAHH,EAIGjqB,KAJH,GAIWhB,MAJX,CAIkB,MAJlB,EAKGJ,IALH,CAKQ,GALR,EAKa,UAAUtD,CAAV,EAAa;EACtB,aAAOA,EAAE,CAAF,EAAK,CAAL,IAAU1B,GAAGyD,OAAH,CAAWsB,CAAX,CAAarD,EAAE,CAAF,EAAK,CAAL,IAAUA,EAAE,CAAF,EAAKN,IAAL,CAAUkvB,aAAjC,CAAV,GAA4DtwB,GAAGyD,OAAH,CAAWsB,CAAX,CAAa,CAAb,CAAnE;EACD,KAPH,EAQGC,IARH,CAQQ,GARR,EAQa,UAAUtD,CAAV,EAAa;EACtB,aAAO1B,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE,CAAF,EAAKN,IAAL,CAAU+uB,EAAvB,CAAP;EACD,KAVH,EAWGnrB,IAXH,CAWQ,OAXR,EAWiB,UAAUtD,CAAV,EAAa;EAC1B,aAAO1B,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE,CAAF,EAAKN,IAAL,CAAUpB,GAAGI,OAAH,CAAWiD,KAArB,CAAb,CAAP;EACD,KAbH,EAcG2B,IAdH,CAcQ,QAdR,EAckB,UAAUtD,CAAV,EAAa;EAC3B,UAAIswB,IAAIhyB,GAAGyD,OAAH,CAAWsB,CAAX,CAAcrD,EAAE,CAAF,EAAK,CAAL,IAAUA,EAAE,CAAF,EAAKN,IAAL,CAAUkvB,aAAlC,IAAoDtwB,GAAGyD,OAAH,CAAWsB,CAAX,CAAarD,EAAE,CAAF,EAAK,CAAL,IAAUA,EAAE,CAAF,EAAKN,IAAL,CAAUkvB,aAAjC,CAA5D;EACA,aAAO0B,CAAP;EACD,KAjBH,EAkBGhtB,IAlBH,CAkBQ,QAlBR,EAkBkB,OAlBlB,EAmBGA,IAnBH,CAmBQ,cAnBR,EAmBwB,CAnBxB,EAoBGA,IApBH,CAoBQ,MApBR,EAoBgB,UAAUtD,CAAV,EAAa;EACzB,aAAO1B,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBhJ,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAAjB,CAAP;EACD,KAtBH,EAuBG5c,EAvBH,CAuBM,WAvBN,EAuBmB,UAAUhE,CAAV,EAAamE,CAAb,EAAgB;EAC/B,UAAI7F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,WAA1B,KAA0C3P,GAAGI,OAAH,CAAWokB,SAAX,CAAqB7U,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpG3O,mBAAA,CAAU,IAAV,EAAgBgE,IAAhB,CAAqB,MAArB,EAA6B,UAAUtD,CAAV,EAAa;EACxC,iBAAO1B,GAAG+oB,iBAAH,CAAqBrnB,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDtiB,SAAGwT,IAAH,CAAQ7N,IAAR,CAAajE,CAAb,EAAgBV,WAAA,CAAU,IAAV,EAAgBwE,IAAhB,EAAhB;;EAEA,UAAIxF,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,aAA1B,CAAJ,EAA8C;EAC5C;EACA3P,WAAGI,OAAH,CAAWyoB,WAAX,CAAuB5gB,IAAvB,CAA4B,IAA5B,EAAkCvG,CAAlC,EAAqCmE,CAArC;EACD;EAEF,KApCH,EAqCGH,EArCH,CAqCM,UArCN,EAqCkB,UAAUhE,CAAV,EAAamE,CAAb,EAAgB;EAC9B,UAAI7F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,WAA1B,KAA0C3P,GAAGI,OAAH,CAAWokB,SAAX,CAAqB7U,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpG3O,mBAAA,CAAU,IAAV,EAAgBgE,IAAhB,CAAqB,MAArB,EAA6B,UAAUtD,CAAV,EAAa;EACxC,iBAAO1B,GAAG+oB,iBAAH,CAAqBrnB,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDtiB,SAAGwT,IAAH,CAAQ5N,IAAR;;EAEA,UAAI5F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,YAA1B,CAAJ,EAA6C;EAAE;EAC7C3P,WAAGI,OAAH,CAAW4oB,UAAX,CAAsB/gB,IAAtB,CAA2B,IAA3B,EAAiCvG,CAAjC,EAAoCmE,CAApC;EACD;EACF,KAhDH,EAiDGH,EAjDH,CAiDM,OAjDN,EAiDe,UAAUhE,CAAV,EAAamE,CAAb,EAAgB;EAC3B,UAAI7F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,OAA1B,CAAJ,EAAwC;EACtC3P,WAAGI,OAAH,CAAWmjB,OAAX,CAAmBtb,IAAnB,CAAwB,IAAxB,EAA8BvG,CAA9B,EAAiCmE,CAAjC;EACD;EACF,KArDH;;EAuDAmqB,cAAUS,UAAV;EACD,GAzID;;EA2IAT,YAAUgB,iBAAV,GAA8B,YAAY;EACxC,QAAIhxB,KAAK,IAAT;;EAEAA,OAAGwT,IAAH,CAAQlE,IAAR,CAAatP,GAAGI,OAAH,CAAWa,GAAX,IAAkB,UAAUS,CAAV,EAAa;EAC1C,UAAI4N,OAAO,gBAAgB5N,EAAE1B,GAAGI,OAAH,CAAW8vB,QAAb,CAAhB,GAAyC,YAApD;EACA,WAAK,IAAIzd,CAAT,IAAc/Q,EAAEN,IAAhB,EAAsB;EACpB,YAAKM,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAR,IAAiBA,EAAEN,IAAF,CAAOqR,CAAP,CAArB,EAAgC;EAC9BnD,kBAAQ,WAAWmD,CAAX,GAAe,SAAvB;EACD;EACF;EACDnD,cAAQ,SAAStP,GAAGe,KAAH,CAASyB,MAAT,GAAkBd,EAAE,CAAF,IAAOA,EAAE,CAAF,CAAzB,CAAjB;EACA,aAAO4N,IAAP;EACD,KATD;;EAWAtP,OAAGE,KAAH,CAASW,GAAT,GAAeoH,IAAf,CAAoBjI,GAAGwT,IAAvB;;EAEAxT,OAAGE,KAAH,CAASW,GAAT,GAAeuE,MAAf,CAAsB,GAAtB,EACG4C,SADH,CACa,GADb,EAEG5G,IAFH,CAEQpB,GAAGkM,KAFX,EAGG9F,KAHH,GAGWhB,MAHX,CAGkB,GAHlB,EAIGJ,IAJH,CAIQ,OAJR,EAIiB,UAJjB,EAKGA,IALH,CAKQ,MALR,EAKgB,UAAUtD,CAAV,EAAa;EACzB,aAAO1B,GAAGyD,OAAH,CAAWiH,KAAX,CAAiBhJ,EAAEmU,GAAnB,CAAP;EACD,KAPH,EAQG7N,SARH,CAQa,MARb,EASG5G,IATH,CASQ,UAAUM,CAAV,EAAa;EACjB,aAAOA,CAAP;EACD,KAXH,EAYG0E,KAZH,GAYWhB,MAZX,CAYkB,MAZlB,EAaGJ,IAbH,CAaQ,GAbR,EAaa,UAAUtD,CAAV,EAAa;EACtB,aAAO1B,GAAGyD,OAAH,CAAWsB,CAAX,CAAarD,EAAEN,IAAF,CAAOpB,GAAGI,OAAH,CAAWiD,KAAlB,CAAb,CAAP;EACD,KAfH,EAgBG2B,IAhBH,CAgBQ,GAhBR,EAgBa,UAAUtD,CAAV,EAAa;EACtB,aAAO1B,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE,CAAF,CAAb,CAAP;EACD,KAlBH,EAmBGsD,IAnBH,CAmBQ,QAnBR,EAmBkBhF,GAAGyD,OAAH,CAAWsB,CAAX,CAAauN,SAAb,EAnBlB,EAoBGtN,IApBH,CAoBQ,OApBR,EAoBiB,UAAUtD,CAAV,EAAa;EAC1B,aAAO1B,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE,CAAF,CAAb,IAAqB1B,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE,CAAF,CAAb,CAA5B;EACD,KAtBH,EAuBGgE,EAvBH,CAuBM,WAvBN,EAuBmB,UAAUhE,CAAV,EAAamE,CAAb,EAAgB;EAC/B,UAAI7F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,WAA1B,KAA0C3P,GAAGI,OAAH,CAAWokB,SAAX,CAAqB7U,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpG3O,mBAAA,CAAU,IAAV,EAAgBgE,IAAhB,CAAqB,MAArB,EAA6B,UAAUtD,CAAV,EAAa;EACxC,iBAAO1B,GAAG+oB,iBAAH,CAAqBrnB,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDtiB,SAAGwT,IAAH,CAAQ7N,IAAR,CAAajE,CAAb,EAAgBV,WAAA,CAAU,IAAV,EAAgBwE,IAAhB,EAAhB;;EAEA,UAAIxF,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,aAA1B,CAAJ,EAA8C;EAC5C;EACA3P,WAAGI,OAAH,CAAWyoB,WAAX,CAAuB5gB,IAAvB,CAA4B,IAA5B,EAAkCvG,CAAlC,EAAqCmE,CAArC;EACD;EAEF,KApCH,EAqCGH,EArCH,CAqCM,UArCN,EAqCkB,UAAUhE,CAAV,EAAamE,CAAb,EAAgB;EAC9B,UAAI7F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,WAA1B,KAA0C3P,GAAGI,OAAH,CAAWokB,SAAX,CAAqB7U,cAArB,CAAoC,eAApC,CAA9C,EAAoG;EAAE;EACpG3O,mBAAA,CAAU,IAAV,EAAgBgE,IAAhB,CAAqB,MAArB,EAA6B,UAAUtD,CAAV,EAAa;EACxC,iBAAO1B,GAAG+oB,iBAAH,CAAqBrnB,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAArB,EAAyC,SAAzC,CAAP;EACD,SAFD;EAGD;EACDtiB,SAAGwT,IAAH,CAAQ5N,IAAR;;EAEA,UAAI5F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,YAA1B,CAAJ,EAA6C;EAAE;EAC7C3P,WAAGI,OAAH,CAAW4oB,UAAX,CAAsB/gB,IAAtB,CAA2B,IAA3B,EAAiCvG,CAAjC,EAAoCmE,CAApC;EACD;EACF,KAhDH,EAiDGH,EAjDH,CAiDM,OAjDN,EAiDe,UAAUhE,CAAV,EAAamE,CAAb,EAAgB;EAC3B,UAAI7F,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,OAA1B,CAAJ,EAAwC;EACtC3P,WAAGI,OAAH,CAAWmjB,OAAX,CAAmBtb,IAAnB,CAAwB,IAAxB,EAA8BvG,CAA9B,EAAiCmE,CAAjC;EACD;EACF,KArDH;EAuDD,GAvED;;EAyEAmqB,YAAU7H,YAAV,GAAyB,UAAU/mB,IAAV,EAAgB;EACvC,QAAIpB,KAAK,IAAT;EACA,QAAIwO,SAAS,EAAb;EACA,QAAI0a,WAAW,EAAf;;EAEA,QAAIlpB,GAAGI,OAAH,CAAWokB,SAAX,IAAwBxkB,GAAGI,OAAH,CAAWokB,SAAX,CAAqB2E,mBAA7C,IACFnpB,GAAGI,OAAH,CAAWokB,SAAX,CAAqB2E,mBAArB,CAAyCjlB,MAAzC,GAAkD,CADpD,EACuD;EACrD,aAAOlE,GAAGI,OAAH,CAAWokB,SAAX,CAAqB2E,mBAA5B;EACD;;EAED/nB,SAAK+N,OAAL,CAAa,UAAUzN,CAAV,EAAa;EACxB8M,aAAOlJ,IAAP,CAAY,CAAC5D,EAAE1B,GAAGI,OAAH,CAAWkiB,IAAb,CAAb;EACD,KAFD;;EAIA9T,WAAO0E,IAAP,CAAYlT,GAAGe,KAAH,CAASgF,aAArB;;EAEA;EACA,QAAI/F,GAAGI,OAAH,IAAcJ,GAAGI,OAAH,CAAWokB,SAAzB,IAAsCxkB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBrW,OAA/D,EAAwE;;EAEtE,UAAInO,GAAGI,OAAH,CAAWokB,SAAX,CAAqB6E,WAArB,KAAqC,IAAzC,EAA+C;EAC7C,YAAIC,MAAMvpB,aAAA,CAAYyO,MAAZ,EAAoB,UAAUJ,CAAV,EAAa;EACzC,iBAAOA,KAAK,CAAZ;EACD,SAFS,CAAV;EAGA;;EAEA8a,iBAAS5jB,IAAT,CAAckJ,OAAO,CAAP,CAAd;EACA0a,iBAAS5jB,IAAT,CAAc,CAAd;;EAEA,aAAK,IAAIO,IAAI,CAAb,EAAgBA,KAAK7F,GAAGI,OAAH,CAAWokB,SAAX,CAAqBrW,OAArB,GAA+B,CAApD,EAAuDtI,GAAvD,EAA4D;EAC1DqjB,mBAAS5jB,IAAT,CAActE,aAAA,CAAYsoB,GAAZ,EAAiBzjB,IAAI,CAAJ,IAAS7F,GAAGI,OAAH,CAAWokB,SAAX,CAAqBrW,OAArB,GAA+B,CAAxC,CAAjB,CAAd;EACD;EAEF,OAbD,MAaO;EACL+a,iBAAS5jB,IAAT,CAActE,aAAA,CAAYwN,MAAZ,EAAoB,CAApB,CAAd;EACA,aAAK,IAAIyjB,IAAI,CAAb,EAAgBA,KAAKjyB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBrW,OAA1C,EAAmD8jB,GAAnD,EAAwD;EACtD/I,mBAAS5jB,IAAT,CAActE,aAAA,CAAYwN,MAAZ,EAAoByjB,IAAI,CAAJ,GAAQjyB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBrW,OAAjD,CAAd;EACD;EACF;EAEF,KAtBD,MAsBO;EACL+a,iBAAW,CAACloB,aAAA,CAAYwN,MAAZ,EAAoB,CAApB,CAAD,EAAyBxN,aAAA,CAAYwN,MAAZ,EAAoB,GAApB,CAAzB,EAAmDxN,aAAA,CAAYwN,MAAZ,EAAoB,GAApB,CAAnD,EAA6ExN,aAAA,CAAYwN,MAAZ,EAAoB,GAApB,CAA7E,EAAuGxN,aAAA,CAAYwN,MAAZ,EAAoB,GAApB,CAAvG,EAAiIxN,aAAA,CAAYwN,MAAZ,EAAoB,CAApB,CAAjI,CAAX;EACD;;EAED;EACA,QAAIxO,GAAGI,OAAH,CAAWokB,SAAX,IAAwBxkB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBrW,OAA7C,IAAwDnO,GAAGI,OAAH,CAAWokB,SAAX,CAAqBrW,OAArB,KAAiC,CAA7F,EAAgG;;EAE9F,UAAI+a,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAAhB,IAA+BA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAA/C,IAA8DA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAA9E,IAA6FA,SAAS,CAAT,MAAgBA,SAAS,CAAT,CAAjH,EAA8H;EAC5HA,mBAAW,CAACloB,aAAA,CAAYwN,MAAZ,EAAoB,CAApB,CAAD,EAAyBxN,aAAA,CAAYwN,MAAZ,EAAoB,GAApB,CAAzB,CAAX;EACD;EACF;;EAED,WAAO0a,QAAP;EACD,GApDD;;EAsDA8G,YAAUjH,iBAAV,GAA8B,UAAUrnB,CAAV,EAAaK,IAAb,EAAmB;EAC/C,QAAI/B,KAAK,IAAT;EACA,QAAIioB,QAAQ/iB,WAAWxD,CAAX,CAAZ;;EAEA;EACA,QAAI1B,GAAGI,OAAH,IAAcJ,GAAGI,OAAH,CAAW8xB,IAAX,CAAgB1N,SAA9B,IAA2CxkB,GAAGI,OAAH,CAAW8xB,IAAX,CAAgB1N,SAAhB,CAA0BtU,MAAzE,EAAiF;EAC/E,UAAIlQ,GAAGkoB,UAAH,CAAchkB,MAAd,GAAuB,CAA3B,EAA8B;;EAE5B,YAAIlE,GAAGI,OAAH,IAAcJ,GAAGI,OAAH,CAAW8xB,IAAX,CAAgBrqB,GAAhB,KAAwB/F,SAAtC,IAAmD9B,GAAGI,OAAH,CAAW8xB,IAAX,CAAgBtqB,GAAhB,KAAwB9F,SAA/E,EAA0F;EACxF,cAAImmB,QAAQjoB,GAAGI,OAAH,CAAW8xB,IAAX,CAAgBrqB,GAAxB,IAA+BogB,QAAQjoB,GAAGI,OAAH,CAAW8xB,IAAX,CAAgBtqB,GAA3D,EAAgE;EAC9D,mBAAO5H,GAAGI,OAAH,CAAW8xB,IAAX,CAAgB1N,SAAhB,CAA0BgF,eAAjC;EACD;EACF,SAJD,MAIO;EACL,cAAIvB,QAAQjoB,GAAG6jB,OAAH,CAAW,CAAX,CAAR,IAAyBoE,QAAQjoB,GAAG6jB,OAAH,CAAW,CAAX,CAArC,EAAoD;EAClD,mBAAO7jB,GAAGI,OAAH,CAAW8xB,IAAX,CAAgB1N,SAAhB,CAA0BgF,eAAjC;EACD;EACF;;EAED,YAAIznB,QAAQ,SAAZ,EAAuB;EACrB,cAAIkmB,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAb,EAA+B;EAC7B,mBAAOloB,GAAGI,OAAH,CAAW8xB,IAAX,CAAgB1N,SAAhB,CAA0BtU,MAA1B,CAAiC,CAAjC,CAAP,CAD6B;EAE9B,WAFD,MAEO,IAAI+X,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOloB,GAAGI,OAAH,CAAW8xB,IAAX,CAAgB1N,SAAhB,CAA0BtU,MAA1B,CAAiC,CAAjC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAI+X,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOloB,GAAGI,OAAH,CAAW8xB,IAAX,CAAgB1N,SAAhB,CAA0BtU,MAA1B,CAAiC,CAAjC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAI+X,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOloB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBtU,MAArB,CAA4B,CAA5B,CAAP,CADoC;EAErC,WAFM,MAEA,IAAI+X,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOloB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBtU,MAArB,CAA4B,CAA5B,CAAP,CADoC;EAErC;EACF;;EAED,YAAInO,QAAQ,SAAR,IAAqB/B,GAAGI,OAAH,CAAWuP,cAAX,CAA0B,WAA1B,CAArB,IAA+D3P,GAAGI,OAAH,CAAWokB,SAAX,CAAqB7U,cAArB,CAAoC,eAApC,CAAnE,EAAyH;EACvH,cAAIsY,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAb,EAA+B;EAC7B,mBAAOloB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBsE,aAArB,CAAmC,CAAnC,CAAP,CAD6B;EAE9B,WAFD,MAEO,IAAIb,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOloB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBsE,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIb,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOloB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBsE,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIb,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOloB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBsE,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC,WAFM,MAEA,IAAIb,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAb,EAA+B;EACpC,mBAAOloB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBsE,aAArB,CAAmC,CAAnC,CAAP,CADoC;EAErC;EACF;EAEF;EACF;;EAED,QAAI9oB,GAAGkoB,UAAH,CAAchkB,MAAd,IAAwB,CAA5B,EAA+B;EAC7B;;;;;EAKA,UAAI+jB,SAASjoB,GAAGkoB,UAAH,CAAc,CAAd,CAAb,EAA+B;EAC7B,eAAOloB,GAAGI,OAAH,CAAWokB,SAAX,CAAqBtU,MAArB,CAA4B,CAA5B,CAAP,CAD6B;EAE9B;EACF;EAEF,GA5DD;;EA8DA8f,YAAUhmB,IAAV,CAAe7J,MAAf;EACA,SAAO6vB,SAAP;EACD;;ECrwBD;;;;AAIA,EAAe,mBAAS7vB,MAAT,EAAiB;;EAE9B,MAAIgyB,YAAYnxB,GAAGoxB,SAAH,CAAa,UAAb,CAAhB;;EAEA,WAASC,QAAT,CAAkBlyB,MAAlB,EAAyB;EACvB,QAAIH,KAAK,IAAT;EACAA,OAAGI,OAAH,GAAaD,SAASA,MAAT,GAAkB,EAA/B;EACAH,OAAGkM,KAAH,GAAW,EAAX;EACAlM,OAAGyD,OAAH,GAAY,EAAZ;EACAzD,OAAGqM,KAAH,GAAW,EAAX;;EAEArM,OAAGsyB,KAAH,GAAWtxB,GAAG4D,IAAH,GACR8U,KADQ,CACF1Y,GAAGuxB,UADD,EAERlqB,CAFQ,CAEN,UAAS3G,CAAT,EAAY;EAAE,aAAO1B,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE2G,CAAf,CAAP;EAA2B,KAFnC,EAGRtD,CAHQ,CAGN,UAASrD,CAAT,EAAY;EAAE,aAAO1B,GAAGyD,OAAH,CAAWsB,CAAX,CAAarD,EAAEqD,CAAf,CAAP;EAA2B,KAHnC,CAAX;;EAMA/E,OAAGwyB,KAAH,GAAWxxB,GAAGqa,IAAH,GACR3B,KADQ,CACF1Y,GAAGuxB,UADD,EAERlqB,CAFQ,CAEN,UAAS3G,CAAT,EAAY;EACb,UAAIA,EAAE+wB,aAAF,IAAmB/wB,EAAE+wB,aAAF,KAAoB,IAA3C,EAAgD;EAC9C,eAAO/wB,EAAE2G,CAAT;EACD,OAFD,MAEK;EACH,eAAOrI,GAAGyD,OAAH,CAAW4E,CAAX,CAAa3G,EAAE2G,CAAf,CAAP;EACD;EACF,KARQ,EASRkT,EATQ,CASL,UAAS7Z,CAAT,EAAY;EACd,UAAIA,EAAE+wB,aAAF,IAAmB/wB,EAAE+wB,aAAF,KAAoB,IAA3C,EAAgD;EAC9C,eAAO/wB,EAAEqD,CAAT;EACD,OAFD,MAEK;EACH,eAAO/E,GAAGyD,OAAH,CAAWsB,CAAX,CAAarD,EAAEqD,CAAf,CAAP;EACD;EAEF,KAhBQ,CAAX;EAkBD;;EAED;EACA;EACAstB,WAAS3e,SAAT,CAAmBrL,CAAnB,GAAuB,UAASqZ,GAAT,EAAa;EAClC,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWiI,CAAX,GAAeqZ,GAAf;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMAqyB,WAAS3e,SAAT,CAAmB3O,CAAnB,GAAuB,UAAS2c,GAAT,EAAa;EAClC,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAW2E,CAAX,GAAe2c,GAAf;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMAqyB,WAAS3e,SAAT,CAAmBgf,MAAnB,GAA4B,UAASC,GAAT,EAAa;EACvC,QAAI3yB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWsyB,MAAX,GAAoBC,GAApB;EACA,WAAO3yB,EAAP;EACD,GAJD;;EAMAqyB,WAAS3e,SAAT,CAAmBhJ,KAAnB,GAA2B,UAASgX,GAAT,EAAa;EACtC,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWsK,KAAX,GAAmBgX,GAAnB;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMAqyB,WAAS3e,SAAT,CAAmBE,GAAnB,GAAyB,YAAU;EACjC,QAAI5T,KAAK,IAAT;EACA,WAAOA,GAAG6T,MAAV;EACD,GAHD;;EAKA;EACA;EACAwe,WAAS3e,SAAT,CAAmBxT,KAAnB,GAA2B,UAASA,KAAT,EAAe;EACxC,QAAIF,KAAK,IAAT;EACAA,OAAG6T,MAAH,GAAY3T,KAAZ;EACA,WAAOF,EAAP;EACD,GAJD;;EAOAqyB,WAAS3e,SAAT,CAAmBtS,IAAnB,GAA0B,UAASA,IAAT,EAAc;EACtC,QAAIpB,KAAK,IAAT;;EAEAA,OAAGkM,KAAH,GAAW9K,KAAKK,GAAL,CAAS,UAASC,CAAT,EAAW;EAC7BA,QAAE2G,CAAF,GAAM8pB,UAAUzwB,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,CAAV,CAAN;EACA3G,QAAEgJ,KAAF,GAAUhJ,EAAE1B,GAAGI,OAAH,CAAWsK,KAAb,CAAV;EACA,aAAOhJ,EAAE1B,GAAGI,OAAH,CAAWiI,CAAb,CAAP;EACA,aAAO3G,CAAP;EACD,KALU,CAAX;;EAOA1B,OAAG4yB,MAAH,GAAY5yB,GAAGI,OAAH,CAAW2E,CAAX,GAAe/E,GAAGI,OAAH,CAAW2E,CAA1B,GAA8B/E,GAAGI,OAAH,CAAWsyB,MAArD;;EAEA1yB,OAAG4yB,MAAH,GAAY5yB,GAAG4yB,MAAH,CAAUnxB,GAAV,CAAc,UAAS6G,IAAT,EAAe;EACvC,aAAO;EACLA,cAAMA,IADD;EAELkG,gBAAQpN,KAAKK,GAAL,CAAS,UAASC,CAAT,EAAY;EAC3B,iBAAO,EAAC2G,GAAG3G,EAAE2G,CAAN,EAAStD,GAAG,CAACrD,EAAE4G,IAAF,CAAb,EAAP;EACD,SAFO;EAFH,OAAP;EAMD,KAPW,CAAZ;;EASA,WAAOtI,EAAP;EACD,GAtBD;;EAwBAqyB,WAAS3e,SAAT,CAAmBpG,MAAnB,GAA4B,UAASyG,CAAT,EAAW;EACrC,QAAI/T,KAAK,IAAT;EACAA,OAAGyD,OAAH,GAAasQ,CAAb;EACA,WAAO/T,EAAP;EACD,GAJD;;EAMAqyB,WAAS3e,SAAT,CAAmB7F,IAAnB,GAA0B,UAAS7H,CAAT,EAAW;EACnC,QAAIhG,KAAK,IAAT;EACAA,OAAGqM,KAAH,GAAWrG,CAAX;EACA,WAAOhG,EAAP;EACD,GAJD;;EAMAqyB,WAAS3e,SAAT,CAAmBpS,OAAnB,GAA6B,YAAU;EACrC,QAAItB,KAAK,IAAT;EACAA,OAAG6yB,QAAH,GAAc7xB,GAAGonB,MAAH,CAAUpoB,GAAGkM,KAAb,EAAoB,UAASxK,CAAT,EAAY;EAAE,aAAOA,EAAE2G,CAAT;EAAa,KAA/C,CAAd;;EAEArI,OAAG8yB,QAAH,GAAc,CACZ9xB,GAAG6G,GAAH,CAAO7H,GAAG4yB,MAAV,EAAkB,UAASljB,CAAT,EAAY;EAAE,aAAO1O,GAAG6G,GAAH,CAAO6H,EAAElB,MAAT,EAAiB,UAASmN,CAAT,EAAY;EAAE,eAAOA,EAAE5W,CAAT;EAAa,OAA5C,CAAP;EAAuD,KAAvF,CADY,EAEZ/D,GAAG4G,GAAH,CAAO5H,GAAG4yB,MAAV,EAAkB,UAASljB,CAAT,EAAY;EAAE,aAAO1O,GAAG4G,GAAH,CAAO8H,EAAElB,MAAT,EAAiB,UAASmN,CAAT,EAAY;EAAE,eAAOA,EAAE5W,CAAT;EAAa,OAA5C,CAAP;EAAuD,KAAvF,CAFY,CAAd;;EAKA/E,OAAGyD,OAAH,CAAW4E,CAAX,CAAajG,MAAb,CAAoBpC,GAAG6yB,QAAvB;EACA7yB,OAAGyD,OAAH,CAAWsB,CAAX,CAAa3C,MAAb,CAAoBpC,GAAG8yB,QAAvB;;EAEAlhB,YAAQC,GAAR,CAAY7R,GAAGyD,OAAH,CAAW4E,CAAX,CAAajG,MAAb,EAAZ,EAAmCpC,GAAG6T,MAAH,CAAUpQ,OAAV,CAAkB4E,CAAlB,CAAoBjG,MAApB,EAAnC;;EAEApC,OAAG6T,MAAH,CAAUpQ,OAAV,GAAoBzD,GAAGyD,OAAvB;;EAEA,WAAOzD,EAAP;EACD,GAjBD;;EAmBAqyB,WAAS3e,SAAT,CAAmBtG,IAAnB,GAA0B,YAAU;EAClC,QAAIpN,KAAK,IAAT;;EAEA,QAAI+gB,QAAQ/gB,GAAG6T,MAAH,CAAU/S,IAAV,CAAekH,SAAf,CAAyB,QAAzB,EACT5G,IADS,CACJpB,GAAG4yB,MADC,EAEXxsB,KAFW,GAEHhB,MAFG,CAEI,GAFJ,EAGTJ,IAHS,CAGJ,OAHI,EAGK,OAHL,CAAZ;;EAKA,QAAI0iB,OAAO1nB,GAAG6T,MAAH,CAAU/S,IAAV,CAAekH,SAAf,CAAyB,QAAzB,EAAmC5C,MAAnC,CAA0C,MAA1C,EACRJ,IADQ,CACH,OADG,EACM,MADN,EAERA,IAFQ,CAEH,GAFG,EAEE,UAAStD,CAAT,EAAY;EACrB,aAAO1B,GAAGsyB,KAAH,CAAS5wB,EAAE8M,MAAX,CAAP;EACD,KAJQ,EAKR/N,KALQ,CAKF,QALE,EAKQ,UAASiB,CAAT,EAAW;EAC1B,UAAIA,EAAE4G,IAAF,IAAU,QAAd,EAAuB;EACrB,eAAO,kBAAP;EACD,OAFD,MAEM;EACJ,eAAO,MAAP;EACD;EACF,KAXQ,CAAX;;EAcA,QAAIqgB,IAAIoK,SAAShS,KAAT,GAAiBiS,OAAjB,EAAR;;EAEAhzB,OAAG6T,MAAH,CAAU/S,IAAV,CAAemH,IAAf,CAAoB0gB,CAApB;;EAGA3oB,OAAGwyB,KAAH,CAASlX,EAAT,CAAYtb,GAAGyD,OAAH,CAAWsB,CAAX,CAAa/E,GAAG8yB,QAAH,CAAY,CAAZ,CAAb,CAAZ;;EAEA,QAAIG,QAAQjzB,GAAG6T,MAAH,CAAU/S,IAAV,CAAekH,SAAf,CAAyB,QAAzB,EACT5G,IADS,CACJpB,GAAG4yB,MADC,EAEXxsB,KAFW,GAEHhB,MAFG,CAEI,GAFJ,EAGTJ,IAHS,CAGJ,OAHI,EAGK,OAHL,CAAZ;;EAKA,QAAIkuB,WAAYlzB,GAAG6T,MAAH,CAAU/S,IAAV,CAAekH,SAAf,CAAyB,QAAzB,EAAmC5C,MAAnC,CAA0C,MAA1C,EACbJ,IADa,CACR,OADQ,EACC,MADD,EAEbA,IAFa,CAER,GAFQ,EAEH,UAAStD,CAAT,EAAY;EACrB,aAAO1B,GAAGwyB,KAAH,CAAS9wB,EAAE8M,MAAX,CAAP;EACD,KAJa,EAKbxJ,IALa,CAKR,MALQ,EAKA2jB,EAAEzZ,GAAF,EALA,CAAhB;;EAOA,WAAOlP,EAAP;EACD,GA1CD;;EA4CA,SAAO,IAAIqyB,QAAJ,CAAalyB,MAAb,CAAP;EACD;;ECrLD;;;;AAIA,EAAe,kBAASA,MAAT,EAAiB;EAC9B,WAASgzB,OAAT,CAAiBhzB,MAAjB,EAAyB;EACvB,QAAIH,KAAK,IAAT;EACAA,OAAGI,OAAH,GAAaD,SAASA,MAAT,GAAkB,EAA/B;EACAH,OAAGI,OAAH,CAAWgzB,QAAX,GAAsB,CAAtB;EACApzB,OAAGI,OAAH,CAAWizB,WAAX,GAAyBryB,GAAGgT,YAAH,CAAgBhT,GAAGsS,iBAAnB,CAAzB;EACAtT,OAAGI,OAAH,CAAWmT,OAAX,GAAqBvS,GAAGwB,MAAH,CAAU,MAAV,CAArB;EACAxC,OAAGI,OAAH,CAAWkzB,OAAX,GAAqB,IAArB;EACAtzB,OAAGI,OAAH,CAAWa,GAAX,GAAiB,UAASS,CAAT,EAAY;EAC3B,aAAOA,EAAEN,IAAF,CAAOkH,IAAP,GAAc,IAAd,GAAqBtI,GAAGI,OAAH,CAAWmT,OAAX,CAAmB7R,EAAE2B,KAArB,CAA5B;EACD,KAFD;EAGArD,OAAGkM,KAAH,GAAW,EAAX;EACAlM,OAAGyD,OAAH,GAAa,EAAb;EACAzD,OAAGqM,KAAH,GAAW,EAAX;EACArM,OAAGwT,IAAH,GAAUxS,GAAGC,GAAH,GACP+D,IADO,CACF,OADE,EACO,oBADP,EAEPyO,SAFO,CAEG,GAFH,EAGPnE,IAHO,CAGFtP,GAAGI,OAAH,CAAWa,GAHT,CAAV;EAID;;EAED;EACA;EACAkyB,UAAQzf,SAAR,CAAkBE,GAAlB,GAAwB,YAAW;EACjC,QAAI5T,KAAK,IAAT;EACA,WAAOA,GAAG6T,MAAV;EACD,GAHD;;EAKAsf,UAAQzf,SAAR,CAAkBxJ,IAAlB,GAAyB,UAASwX,GAAT,EAAc;EACrC,QAAI1hB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWmzB,KAAX,GAAmB7R,GAAnB;EACA,WAAO1hB,EAAP;EACD,GAJD;;EAMAmzB,UAAQzf,SAAR,CAAkBL,UAAlB,GAA+B,UAASmgB,aAAT,EAAwB;EACrD,QAAIxzB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWizB,WAAX,GAAyBryB,GAAGgT,YAAH,CAAgBwf,aAAhB,CAAzB;EACA,WAAOxzB,EAAP;EACD,GAJD;;EAMAmzB,UAAQzf,SAAR,CAAkBpR,OAAlB,GAA4B,UAASA,OAAT,EAAkB;EAC5C,QAAItC,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWgzB,QAAX,GAAsB9wB,OAAtB;EACA,WAAOtC,EAAP;EACD,GAJD;;EAMAmzB,UAAQzf,SAAR,CAAkB+f,MAAlB,GAA2B,UAASjhB,IAAT,EAAe;EACxC,QAAIxS,KAAK,IAAT;EACA,QAAIiC,MAAMC,OAAN,CAAcsQ,IAAd,CAAJ,EAAyB;EACvB,UAAIA,KAAKtO,MAAL,IAAe,CAAnB,EACE,MAAM,gCAAN;EACFlE,SAAGI,OAAH,CAAWszB,KAAX,GAAmBlhB,IAAnB;EACD,KAJD,MAIO,IAAI,OAAOA,IAAP,KAAgB,QAAhB,IAA4BA,gBAAgBmhB,MAAhD,EAAwD;EAC7D3zB,SAAGI,OAAH,CAAWszB,KAAX,GAAmB,CAAClhB,IAAD,CAAnB;EACD,KAFM,MAEA;EACL,UAAIA,QAAQ1Q,SAAR,IAAqB0Q,QAAQ,IAAjC,EACE,MAAM,0DAAN;EACFxS,SAAGI,OAAH,CAAWszB,KAAX,GAAmB,CAAClhB,KAAK1O,QAAL,EAAD,CAAnB;EACA8N,cAAQgiB,OAAR,CAAgB,0FAAhB;EACD;EACD5zB,OAAGI,OAAH,CAAWyzB,UAAX,GAAwB7zB,GAAGI,OAAH,CAAWszB,KAAX,CAAiB1zB,GAAGI,OAAH,CAAWszB,KAAX,CAAiBxvB,MAAjB,GAA0B,CAA3C,CAAxB,CAdwC;EAexC,WAAOlE,EAAP;EACD,GAhBD;;EAkBAmzB,UAAQzf,SAAR,CAAkBlR,MAAlB,GAA2B,UAASA,MAAT,EAAiB;EAC1C,QAAIxC,KAAK,IAAT;EACA,QAAI,OAAOwC,MAAP,IAAiB,UAAjB,IAA+BA,kBAAkBsR,QAArD,EACE9T,GAAGI,OAAH,CAAWmT,OAAX,GAAqB/Q,MAArB,CADF,KAGExC,GAAGI,OAAH,CAAWmT,OAAX,GAAqBvS,GAAGwB,MAAH,CAAUA,MAAV,CAArB;EACF,WAAOxC,EAAP;EACD,GAPD;;EASAmzB,UAAQzf,SAAR,CAAkB1H,MAAlB,GAA2B,UAAS8nB,IAAT,EAAe;EACxC,QAAI9zB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWkzB,OAAX,GAAqBS,QAAQD,IAAR,CAArB;EACA,WAAO9zB,EAAP;EACD,GAJD;;EAMAmzB,UAAQzf,SAAR,CAAkBzS,GAAlB,GAAwB,UAASA,GAAT,EAAc;EACpC,QAAIjB,KAAK,IAAT;EACAA,OAAGI,OAAH,CAAWa,GAAX,GAAiBA,GAAjB;EACAjB,OAAGwT,IAAH,CAAQlE,IAAR,CAAatP,GAAGI,OAAH,CAAWa,GAAxB;EACA,WAAOjB,EAAP;EACD,GALD;;EAOA;EACA;EACAmzB,UAAQzf,SAAR,CAAkBxT,KAAlB,GAA0B,UAASA,KAAT,EAAgB;EACxC,QAAIF,KAAK,IAAT;EACAA,OAAG6T,MAAH,GAAY3T,KAAZ;EACA,WAAOF,EAAP;EACD,GAJD;;EAMAmzB,UAAQzf,SAAR,CAAkBpG,MAAlB,GAA2B,YAAW;EACpC,QAAItN,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAmzB,UAAQzf,SAAR,CAAkB7F,IAAlB,GAAyB,YAAW;EAClC,QAAI7N,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAmzB,UAAQzf,SAAR,CAAkBpS,OAAlB,GAA4B,YAAW;EACrC,QAAItB,KAAK,IAAT;EACA,WAAOA,EAAP;EACD,GAHD;;EAKAmzB,UAAQzf,SAAR,CAAkBsgB,gBAAlB,GAAqC,UAASxY,KAAT,EAAgB;EACnD,QAAIxb,KAAK,IAAT;EACA,QAAI,CAAC,OAAOwb,MAAMlT,IAAb,KAAsB,QAAtB,IAAkCkT,MAAMlT,IAAN,YAAsBqrB,MAAzD,KAAoE1xB,MAAMC,OAAN,CAAcsZ,MAAMyY,QAApB,CAAxE,EAAuG;EACrG,UAAIC,MAAM,IAAV;EACA1Y,YAAMyY,QAAN,CAAe9kB,OAAf,CAAuB,UAASglB,KAAT,EAAgB;EACrCD,cAAMA,OAAOl0B,GAAGg0B,gBAAH,CAAoBG,KAApB,CAAb;EACD,OAFD;EAGA,aAAOD,GAAP;EACD,KAND,MAMO,IAAI,CAAC,OAAO1Y,MAAMlT,IAAb,KAAsB,QAAtB,IAAkCkT,MAAMlT,IAAN,YAAsBqrB,MAAzD,KAAoE1wB,OAAOuY,MAAMxb,GAAGI,OAAH,CAAWmzB,KAAjB,CAAP,KAAmC/X,MAAMxb,GAAGI,OAAH,CAAWmzB,KAAjB,CAA3G,EAAoI;EACzI,aAAO,IAAP;EACD,KAFM,MAEA;EACL,aAAO,KAAP;EACD;EACF,GAbD;;EAeAJ,UAAQzf,SAAR,CAAkB0gB,gBAAlB,GAAqC,UAAShzB,IAAT,EAAe;EAClD,QAAIpB,KAAK,IAAT;EACA,QAAIoB,KAAKyU,GAAT,EAAc;EACZzU,WAAKkH,IAAL,GAAYlH,KAAKyU,GAAjB;EACA,aAAOzU,KAAKyU,GAAZ;EACD,KAHD,MAGO;EACL,UAAI,CAAC5T,MAAMC,OAAN,CAAcd,KAAKoN,MAAnB,CAAL,EAAiC;EAC/BpN,aAAKkH,IAAL,GAAYlH,KAAKpB,GAAGI,OAAH,CAAWyzB,UAAhB,CAAZ;EACD;EACF;EACD,QAAI5xB,MAAMC,OAAN,CAAcd,KAAKoN,MAAnB,CAAJ,EAAgC;EAC9B,UAAIylB,WAAW,EAAf;EACA7yB,WAAKoN,MAAL,CAAYW,OAAZ,CAAoB,UAASwM,CAAT,EAAY;EAC9BsY,iBAAS3uB,IAAT,CAActF,GAAGo0B,gBAAH,CAAoBzY,CAApB,CAAd;EACD,OAFD;EAGAva,WAAK6yB,QAAL,GAAgBA,QAAhB;EACA,aAAO7yB,KAAKoN,MAAZ;EACD;EACD,QAAI,CAACpN,KAAKpB,GAAGI,OAAH,CAAWmzB,KAAhB,CAAD,IAA2BnyB,KAAKiC,KAApC,EAA2C;EACzCjC,WAAKpB,GAAGI,OAAH,CAAWmzB,KAAhB,IAAyBnyB,KAAKiC,KAA9B;EACD;EACD,WAAOjC,IAAP;EACD,GAtBD;;EAwBA,WAASizB,OAAT,CAAiBC,IAAjB,EAAuBze,GAAvB,EAA4BjD,QAA5B,EAAsC;EACpCA,aAAS,IAAT,EAAe0hB,KAAKze,GAAL,CAAS,UAASnU,CAAT,EAAY;EAClC,aAAOA,EAAEmU,GAAF,CAAP;EACD,KAFc,CAAf;EAGD;;EAEDsd,UAAQzf,SAAR,CAAkBtS,IAAlB,GAAyB,UAASA,IAAT,EAAe;EACtC,QAAIpB,KAAK,IAAT;EACA;EACA,QAAIoB,IAAJ,EAAU;EACR,UAAIa,MAAMC,OAAN,CAAcd,IAAd,KAAuBA,KAAK8C,MAAL,GAAc,CAAzC,EAA4C;EAC1C,YAAI,CAAClE,GAAGg0B,gBAAH,CAAoB5yB,KAAK,CAAL,CAApB,CAAL,EAAmC;EACjCA,eAAK+N,OAAL,CAAa,UAASzN,CAAT,EAAY;EACvBA,cAAE1B,GAAGI,OAAH,CAAWmzB,KAAb,IAAsB,CAAC7xB,EAAE1B,GAAGI,OAAH,CAAWmzB,KAAb,CAAvB;EACD,WAFD;EAGA,cAAI;EACF,gBAAI,CAACvzB,GAAGI,OAAH,CAAWszB,KAAhB,EACE,MAAM,sCAAN;EACF,gBAAIa,SAASvzB,GAAGszB,IAAH,EAAb;EACA,gBAAIE,QAAQxzB,GAAGwzB,KAAH,EAAZ;EACA,iBAAK,IAAI3uB,IAAI,CAAb,EAAgBA,IAAI7F,GAAGI,OAAH,CAAWszB,KAAX,CAAiBxvB,MAArC,EAA6C2B,GAA7C;EACE2uB,oBAAM5lB,KAAN,CAAYylB,OAAZ,EAAqBE,MAArB,EAA6Bv0B,GAAGI,OAAH,CAAWszB,KAAX,CAAiB7tB,CAAjB,CAA7B;EADF,aAEA2uB,MAAMhnB,QAAN,CAAe,UAASC,KAAT,EAAgB8mB,MAAhB,EAAwB;EACrC,kBAAIE,aAAaF,OAAO,CAAP,EAAUG,MAAV,CAAiB,UAASC,MAAT,EAAiB;EACjD,uBAAO3zB,GAAG4zB,GAAH,CAAOD,MAAP,EAAe,UAASjzB,CAAT,EAAY;EAChC,yBAAOA,EAAE1B,GAAGI,OAAH,CAAWmzB,KAAb,CAAP;EACD,iBAFM,CAAP;EAGD,eAJgB,EAIdsB,OAJc,CAINzzB,IAJM,CAAjB;EAKA,kBAAIkoB,MAAM,EAAV;EACAA,kBAAIzT,GAAJ,GAAU,MAAV;EACAyT,kBAAI9a,MAAJ,GAAazO,EAAE+0B,SAAF,CAAYL,UAAZ,CAAb,CARqC;EASrCrzB,qBAAOpB,GAAGo0B,gBAAH,CAAoB9K,GAApB,CAAP;EACAtpB,iBAAGkM,KAAH,GAAW9K,IAAX;EACD,aAXD;EAaD,WApBD,CAoBE,OAAOwI,GAAP,EAAY;EACZgI,oBAAQnE,KAAR,CAAc7D,GAAd;EACD;EACF;EACF,OA7BD,MA6BO;EACL,YAAI,CAAC5J,GAAGg0B,gBAAH,CAAoB5yB,IAApB,CAAL,EAAgC;EAC9B,cAAI;EACF,gBAAI,CAACA,KAAKyU,GAAV,EACE,MAAM,0BAAN;EACF,gBAAIzU,KAAKpB,GAAGI,OAAH,CAAWmzB,KAAhB,MAA2BtwB,OAAO7B,KAAKpB,GAAGI,OAAH,CAAWmzB,KAAhB,CAAP,CAA/B,EACE,MAAM,kDAAN;EACFnyB,mBAAOpB,GAAGo0B,gBAAH,CAAoBhzB,IAApB,CAAP;EACApB,eAAGkM,KAAH,GAAW9K,IAAX;EACD,WAPD,CAOE,OAAOwI,GAAP,EAAY;EACZgI,oBAAQnE,KAAR,CAAc7D,GAAd;EACD;EACF;EACF;EACF;EACD,WAAO5J,EAAP;EACD,GAjDD;;EAmDAmzB,UAAQzf,SAAR,CAAkBtG,IAAlB,GAAyB,YAAW;EAClC,QAAIpN,KAAK,IAAT;EACAA,OAAG6T,MAAH,CAAU/S,IAAV,CAAemH,IAAf,CAAoBjI,GAAGwT,IAAvB;;EAEA,QAAIuhB,UAAU/zB,GAAG+zB,OAAH,GACXC,IADW,CACNh0B,GAAGi0B,iBADG,EAEX/qB,IAFW,CAEN,CAAClK,GAAG6T,MAAH,CAAUvT,MAAX,EAAmBN,GAAG6T,MAAH,CAAUrT,OAA7B,CAFM,EAGX00B,KAHW,CAGL,IAHK,EAIXC,YAJW,CAIEn1B,GAAGI,OAAH,CAAWgzB,QAJb,CAAd;;EAMA,QAAIgC,OAAOp0B,GAAGq0B,SAAH,CAAar1B,GAAGkM,KAAhB,EACRopB,UADQ,CACG,UAAS5zB,CAAT,EAAY;EACtBA,QAAEN,IAAF,CAAO+S,EAAP,GAAY,CAACzS,EAAE6zB,MAAF,GAAW7zB,EAAE6zB,MAAF,CAASn0B,IAAT,CAAc+S,EAAd,GAAmB,GAA9B,GAAoC,EAArC,IAA2CzS,EAAEN,IAAF,CAAOkH,IAA9D;EACD,KAHQ,EAIRssB,GAJQ,CAIJ,UAASlzB,CAAT,EAAY;EACf,aAAOA,EAAE1B,GAAGI,OAAH,CAAWmzB,KAAb,CAAP;EACD,KANQ,EAORrgB,IAPQ,CAOH,UAASlN,CAAT,EAAYC,CAAZ,EAAe;EACnB,aAAOA,EAAE1F,MAAF,GAAWyF,EAAEzF,MAAb,IAAuB0F,EAAE5C,KAAF,GAAU2C,EAAE3C,KAA1C;EACD,KATQ,CAAX;;EAWA0xB,YAAQK,IAAR;;EAEA,QAAII,OAAOx1B,GAAG6T,MAAH,CAAU/S,IAAV,CAAekH,SAAf,CAAyB,GAAzB,EACR5G,IADQ,CACHg0B,KAAKT,MAAL,EADG,EAERvuB,KAFQ,GAEAhB,MAFA,CAEO,GAFP,EAGRJ,IAHQ,CAGH,WAHG,EAGU,UAAStD,CAAT,EAAY;EAC7B,aAAO,eAAeA,EAAEyuB,EAAjB,GAAsB,GAAtB,GAA4BzuB,EAAE4Z,EAA9B,GAAmC,GAA1C;EACD,KALQ,CAAX;;EAOA,QAAIma,OAAOD,KAAKpwB,MAAL,CAAY,MAAZ,EACRJ,IADQ,CACH,IADG,EACG,UAAStD,CAAT,EAAY;EACtB,aAAOA,EAAEN,IAAF,CAAO+S,EAAd;EACD,KAHQ,EAIRnP,IAJQ,CAIH,OAJG,EAIM,UAAStD,CAAT,EAAY;EACzB,aAAOA,EAAE0uB,EAAF,GAAO1uB,EAAEyuB,EAAhB;EACD,KANQ,EAORnrB,IAPQ,CAOH,QAPG,EAOO,UAAStD,CAAT,EAAY;EAC1B,aAAOA,EAAE6Z,EAAF,GAAO7Z,EAAE4Z,EAAhB;EACD,KATQ,EAURtW,IAVQ,CAUH,MAVG,EAUK,UAAStD,CAAT,EAAY;EACxB,aAAO1B,GAAGI,OAAH,CAAWizB,WAAX,CAAuB3xB,EAAEN,IAAF,CAAO+S,EAA9B,CAAP;EACD,KAZQ,CAAX;;EAcAqhB,SAAKpwB,MAAL,CAAY,UAAZ,EACGJ,IADH,CACQ,IADR,EACc,UAAStD,CAAT,EAAY;EACtB,aAAO,UAAUA,EAAEN,IAAF,CAAO+S,EAAxB;EACD,KAHH,EAIG/O,MAJH,CAIU,KAJV,EAKGJ,IALH,CAKQ,YALR,EAKsB,UAAStD,CAAT,EAAY;EAC9B,aAAO,MAAMA,EAAEN,IAAF,CAAO+S,EAApB;EACD,KAPH;;EASA,QAAInU,GAAGI,OAAH,CAAWkzB,OAAf,EAAwB;EACtB,UAAIhvB,OAAOkxB,KAAKpwB,MAAL,CAAY,MAAZ,EACRJ,IADQ,CACH,WADG,EACU,UAAStD,CAAT,EAAY;EAC7B,eAAO,eAAeA,EAAEN,IAAF,CAAO+S,EAAtB,GAA2B,GAAlC;EACD,OAHQ,CAAX;EAIA7P,WAAKc,MAAL,CAAY,OAAZ,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,GAHR,EAGa,EAHb,EAIGV,IAJH,CAIQ,UAAS5C,CAAT,EAAY;EAChB,YAAIA,EAAE2B,KAAF,GAAU,CAAd,EAAiB;EACf,cAAIsvB,MAAMjxB,EAAEN,IAAF,CAAO+S,EAAP,CAAUzQ,OAAV,CAAkB,OAAlB,EAA2B,EAA3B,EAA+BK,KAA/B,CAAqC,GAArC,CAAV;EACA,iBAAO4uB,IAAIzuB,MAAJ,GAAa,CAAb,GAAiByuB,IAAI7sB,KAAJ,CAAU6sB,IAAIzuB,MAAJ,GAAa,CAAvB,EAA0ByuB,IAAIzuB,MAA9B,EAAsCqB,IAAtC,CAA2C,KAA3C,CAAjB,GAAqEotB,IAAIA,IAAIzuB,MAAJ,GAAa,CAAjB,EAAoBJ,QAApB,EAA5E;EACD,SAHD,MAIE,OAAO,EAAP;EACH,OAVH;EAWAQ,WAAKc,MAAL,CAAY,OAAZ,EACGJ,IADH,CACQ,OADR,EACiB,YADjB,EAEGA,IAFH,CAEQ,GAFR,EAEa,CAFb,EAGGA,IAHH,CAGQ,GAHR,EAGa,EAHb,EAIGV,IAJH,CAIQ,UAAS5C,CAAT,EAAY;EAChB,eAAOA,EAAE2B,KAAF,GAAU,CAAV,GAAcrD,GAAGI,OAAH,CAAWmT,OAAX,CAAmB7R,EAAE2B,KAArB,CAAd,GAA4C,EAAnD;EACD,OANH;EAOD;;EAEDoyB,SAAK/vB,EAAL,CAAQ,WAAR,EAAqB,UAAShE,CAAT,EAAY;EAC7B;;;EAGA1B,SAAGwT,IAAH,CAAQ7N,IAAR,CAAajE,CAAb,EAAgBV,GAAGqO,MAAH,CAAU,IAAV,EAAgB7J,IAAhB,EAAhB;EACD,KALH,EAMGE,EANH,CAMM,UANN,EAMkB,UAAShE,CAAT,EAAY;EAC1B;;;EAGA1B,SAAGwT,IAAH,CAAQ5N,IAAR,CAAalE,CAAb,EAAgBV,GAAGqO,MAAH,CAAU,IAAV,EAAgB7J,IAAhB,EAAhB;EACD,KAXH;;EAaA,WAAOxF,EAAP;EACD,GA5FD;EA6FA,SAAO,IAAImzB,OAAJ,CAAYhzB,MAAZ,CAAP;EACD;;EC9SD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}