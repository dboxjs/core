{"version":3,"file":"dbox.js","sources":["../lib/helper.js","../lib/chart.js","../node_modules/@dboxjs/bars/bars.js","../node_modules/@dboxjs/distro/distrochart.js","../node_modules/@dboxjs/distro/distro.js","../node_modules/@dboxjs/heatmap/heatmap.js","../node_modules/@dboxjs/leaflet/leaflet.js","../node_modules/@dboxjs/map/map.js","../node_modules/@dboxjs/radar/radar.js","../node_modules/@dboxjs/scatter/scatter.js","../node_modules/@dboxjs/spineplot/spineplot.js","../node_modules/@dboxjs/timeline/timeline.js","../node_modules/@dboxjs/treemap/treemap.js","../index.js"],"sourcesContent":["import * as d3 from 'd3';\nvar d3Tip = require('d3-tip');\nimport * as _ from 'lodash';\n\nexport default function () {\n  var vm = this; // Hard binded to chart\n\n  var Helper = {\n    chart: {\n      config: vm._config,\n      width: vm._width,\n      height: vm._height,\n      style: vm._addStyle,\n      fullSvg: function () {\n        return vm._fullSvg;\n      },\n      svg: function () {\n        return vm._svg;\n      }\n    },\n    utils: {\n      d3: {}\n    }\n  };\n  Helper.utils.d3.tip = typeof d3Tip === 'function' ? d3Tip : d3Tip.default;\n\n  /**\n   * Generate scale based on data and config\n   * @param {*} data\n   * @param {*} config\n   * @returns\n   */\n  Helper.utils.generateScale = function (data, config) {\n    var scale = {};\n    var domains;\n    if (!config.range) {\n      throw 'Range is not defined';\n    }\n    // Used in bars.js when we want to create a groupBy or stackBy bar chart\n    if (config.groupBy && config.groupBy === 'parent') {\n      // Axis of type band\n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    } else if (config.stackBy && config.stackBy === 'parent') {\n      domains = data[0].map(function (d) {\n        return d.data[config.column];\n      });\n    } else if (config.groupBy === 'children') {\n      // GroupBy Columns\n      domains = config.column;\n    } else if (config.groupBy === 'data') {\n      // Considering the highest value on all the columns for each groupBy column\n      domains = [\n        0,\n        d3.max(data, function (d) {\n          return d3.max(config.column, function (column) {\n            return d[column];\n          });\n        })\n      ];\n    } else if (config.stackBy === 'data') {\n      // Using a d3.stack()\n      domains = [\n        0,\n        d3.max(data, function (serie) {\n          return d3.max(serie, function (d) {\n            return d[1];\n          });\n        })\n      ];\n    } else if (config.groupBy === undefined && config.type === 'band') {\n      // In case the axis is of type band and there is no groupby\n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    } else if (config.type === 'linear') {\n      // Axis of type numeric\n      if (config.minZero) {\n        domains = [\n          0,\n          d3.max(data, function (d) {\n            return +d[config.column];\n          })\n        ];\n      } else {\n        domains = d3.extent(data, function (d) {\n          return +d[config.column];\n        });\n      }\n    } else {\n      // Axis of type band\n      domains = data.map(function (d) {\n        return d[config.column];\n      });\n    }\n\n    if (config.domains && Array.isArray(config.domains)) {\n      domains = config.domains;\n    }\n\n    if (config.type) {\n      switch (config.type) {\n        case 'linear':\n          scale = d3\n            .scaleLinear()\n            .rangeRound(config.range)\n            .domain(domains)\n            .nice();\n          break;\n\n        case 'time':\n          scale = d3.scaleTime().range(config.range);\n          // .domain(domains);\n          break;\n\n        case 'ordinal':\n          scale = d3\n            .scaleBand()\n            .rangeRound(config.range)\n            .padding(0.1)\n            .domain(domains);\n          break;\n\n        case 'band':\n          scale = d3\n            .scaleBand()\n            .rangeRound(config.range)\n            .domain(domains)\n            .padding(0.1);\n          break;\n\n        case 'quantile':\n          scale = d3\n            .scaleBand()\n            .rangeRound(config.range)\n            .padding(0.1)\n            .domain(\n              data.map(function (d) {\n                return d[config.column];\n              })\n            );\n          if (!config.bins) {\n            config.bins = 10;\n          }\n          scale = d3.scaleQuantile().range(d3.range(config.bins));\n          break;\n\n        default:\n          scale = d3\n            .scaleLinear()\n            .rangeRound(config.range)\n            .domain(domains)\n            .nice();\n          break;\n      }\n    } else {\n      scale = d3\n        .scaleLinear()\n        .rangeRound(config.range)\n        .domain(domains)\n        .nice();\n    }\n\n    return scale;\n  };\n\n  /**\n   * Format numbers\n   * @param {Object} config - configurate current formatter\n   * @param {number} config.decimals - Quantity of decimals to use\n   * @param {string} config.axis - Current scale selected from axis ['xAxis', 'yAxis']\n   * @param {string} config.formatPreffix - Preffix to use in formatting. Eg. '$'\n   * @param {string} config.formatSuffix - Suffix to use in formatting. Eg. '%'\n   * @param {boolean} [smallNumber] - Display number in small format\n   * @returns Function configured to parse a number [d]\n   */\n  Helper.utils.format = function (config, smallNumber) {\n    if (!config) {\n      // Default config\n      var linearAxis =\n        vm._config.yAxis && vm._config.yAxis.scale === 'linear' ?\n        'yAxis' :\n        vm._config.xAxis && vm._config.xAxis.scale === 'linear' ?\n        'xAxis' :\n        '';\n      config = {\n        decimals: vm._config.decimals,\n        axis: linearAxis,\n        formatPreffix: vm._config.formatPreffix,\n        formatSuffix: vm._config.formatSuffix\n      };\n    }\n    return function (d) {\n      if (Number.isNaN(Number(d))) {\n        // d is not a number, return original value\n        return d;\n      }\n      var fullNumber = smallNumber ? false : true;\n      var floatingPoints = 1; // Default\n      if (config.decimals !== undefined && Number.isInteger(config.decimals)) {\n        floatingPoints = Number(config.decimals);\n      }\n      var value = '';\n      if (config.formatPreffix) {\n        value += config.formatPreffix;\n      }\n      var suffix = '';\n\n      if (smallNumber) {\n        var currentAxis = config.axis;\n        var mean = currentAxis ?\n          d3.mean(vm._scales[currentAxis.replace('Axis', '')].ticks()) :\n          d;\n\n        if (mean >= 1000000000000) {\n          if (currentAxis) {\n            vm._config[currentAxis].scaleText = 'Billones';\n          } else {\n            suffix = ' billones';\n          }\n          d = d / 1000000000000;\n        } else if (mean >= 1000000000) {\n          // Thousands of millions\n          if (currentAxis) {\n            vm._config[currentAxis].scaleText = 'Miles de millones';\n          } else {\n            suffix = ' mil millones';\n          }\n          d = d / 1000000000;\n        } else if (mean >= 1000000) {\n          // Millions\n          if (currentAxis) {\n            vm._config[currentAxis].scaleText = 'Millones';\n          } else {\n            suffix = ' millones';\n          }\n          d = d / 1000000;\n        } else if (mean >= 10000) {\n          // Thousands\n          if (currentAxis) {\n            vm._config[currentAxis].scaleText = 'Miles';\n          } else {\n            suffix = ' mil';\n          }\n          d = d / 1000;\n        }\n      }\n\n      if (Number.isInteger(d)) {\n        value += d3.format(',.0f')(d);\n      } else if (d > 1) {\n        value += d3.format(',.' + floatingPoints + 'f')(d);\n      } else {\n        var floats = d.toString().split('.')[1];\n        var points = 1;\n        if (floats) {\n          for (let index = 0; index < floats.length; index++) {\n            const number = Number(floats[index]);\n            if (number === 0) {\n              points += 1;\n            } else {\n              break;\n            }\n          }\n          value += d3.format(',.' + points + 'f')(d);\n        }\n      }\n      value += suffix;\n\n      if (config.formatSuffix && value.indexOf(config.formatSuffix) < 0) {\n        value += config.formatSuffix;\n      }\n      return value;\n    };\n  };\n\n  // wrap function used in x axis labels\n  Helper.utils.wrap = function (text, width, tooltip) {\n    text.each(function () {\n      var text = d3.select(this),\n        words = text\n        .text()\n        .split(/\\s+/)\n        .reverse(),\n        word,\n        line = [],\n        lineNumber = 0,\n        lineHeight = 1.1, // ems\n        y = text.attr('y'),\n        dy = parseFloat(text.attr('dy')) || 0,\n        tspan = text\n        .text(null)\n        .append('tspan')\n        .attr('x', 0)\n        .attr('y', y)\n        .attr('dy', dy + 'em');\n\n      while ((word = words.pop())) {\n        line.push(word);\n        tspan.text(line.join(' '));\n        if (tspan.node().getComputedTextLength() > width) {\n          line.pop();\n          tspan.text(line.join(' '));\n          line = [word];\n          tspan = text\n            .append('tspan')\n            .attr('x', 0)\n            .attr('y', y)\n            .attr('dy', ++lineNumber * lineHeight + dy + 'em')\n            .text(word);\n\n          if (lineNumber > 0) {\n            if (\n              words.length > 0 &&\n              tspan.node().getComputedTextLength() > width\n            ) {\n              if (tooltip) {\n                text.on('mouseover', tooltip.show).on('mouseout', tooltip.hide);\n              }\n              let i = 1;\n              while (tspan.node().getComputedTextLength() > width) {\n                tspan.text(function () {\n                  return tspan.text().slice(0, -i) + '...';\n                });\n                ++i;\n              }\n            }\n            words = [];\n          } else {\n            let i = 1;\n            while (tspan.node().getComputedTextLength() > width) {\n              tspan.text(function () {\n                return tspan.text().slice(0, -i) + '...';\n              });\n              ++i;\n            }\n          }\n        }\n      }\n    });\n  };\n\n  Helper.utils.sortAscending = function (a, b) {\n    if (!Number.isNaN(+a) && !Number.isNaN(+b)) {\n      // If both values are numbers use numeric value\n      return Number(a) - Number(b);\n    } else if (!Number.isNaN(+a) && Number.isNaN(+b)) {\n      return -1;\n    } else if (Number.isNaN(+a) && !Number.isNaN(+b)) {\n      return 1;\n    } else if (a <= b) {\n      return -1;\n    } else {\n      return 1;\n    }\n  };\n\n  Helper.utils.sortDescending = function (a, b) {\n    if (!Number.isNaN(+b) && !Number.isNaN(+a)) {\n      // If both values are numbers use numeric value\n      return Number(b) - Number(a);\n    } else if (!Number.isNaN(+b) && Number.isNaN(+a)) {\n      return -1;\n    } else if (Number.isNaN(+b) && !Number.isNaN(+a)) {\n      return 1;\n    } else if (b <= a) {\n      return -1;\n    } else {\n      return 1;\n    }\n  };\n\n  Helper.utils.VirtualScroller = function () {\n    var enter = null,\n      update = null,\n      exit = null,\n      data = [],\n      dataid = null,\n      svg = null,\n      viewport = null,\n      totalRows = 0,\n      position = 0,\n      rowHeight = 30,\n      totalHeight = 0,\n      viewportHeight = 0,\n      visibleRows = 0,\n      delta = 0,\n      lineNumber = 0,\n      lineHeight = 0.7, //ems\n      scrollTop = 0;\n\n    function virtualscroller(container) {\n      function render(resize) {\n        if (resize) {\n          /*\n           * Tested values:\n           * 240 -> 9 rows\n           * 170 -> 13 rows\n           */\n          viewportHeight = parseInt(viewport.style('height')) - 170;\n          visibleRows = Math.ceil(viewportHeight / rowHeight);\n        }\n        var lastPosition = position;\n        if (position < data.length && position >= 0 && scrollTop < 0) {\n          position += 1;\n        } else if (position <= data.length && position > 0 && scrollTop > 0) {\n          position -= 1;\n        }\n        delta = position - lastPosition;\n        scrollRenderFrame(position);\n      }\n\n      function scrollRenderFrame(scrollPosition) {\n        var position0 = Math.max(\n            0,\n            Math.min(scrollPosition, totalRows - visibleRows + 1)\n          ),\n          position1 = position0 + visibleRows;\n        container.each(function () {\n          var rowSelection = container\n            .selectAll('.legend-checkbox')\n            .data(\n              data.slice(position0, Math.min(position1, totalRows)),\n              dataid\n            );\n          rowSelection\n            .exit()\n            .call(exit)\n            .remove();\n          rowSelection\n            .enter()\n            .append('g')\n            .attr('class', 'legend-checkbox legend')\n            .attr('random', function (d) {\n              return d;\n            })\n            .call(enter)\n            .attr('transform', function (d, i) {\n              return (\n                'translate(0,' +\n                (vm._config.legendTitle && lineNumber > 1 ?\n                  lineNumber * lineHeight + i :\n                  1 + i) *\n                21 +\n                ')'\n              );\n            })\n            .on('click', function (d) {\n              // Run the custom function\n              var i = data.findIndex(x => x.name === d.name);\n              if (typeof vm._config.events.onClickLegend === 'function') {\n                vm._config.events.onClickLegend.call(this, d, i);\n              }\n              d3.event.stopPropagation();\n            });\n\n          rowSelection.order();\n          var rowUpdateSelection = container.selectAll('.legend-checkbox');\n\n          rowUpdateSelection.call(update);\n\n          rowUpdateSelection.each(function (d, i) {\n            d3.select(this)\n              .attr('font-weight', 'bold')\n              .attr('transform', function (d) {\n                return (\n                  'translate(0,' +\n                  (vm._config.legendTitle && lineNumber > 1 ?\n                    lineNumber * lineHeight + i :\n                    1 + i) *\n                  21 +\n                  ')'\n                );\n              });\n          });\n        });\n      }\n\n      virtualscroller.render = render;\n      let isFirefox = typeof InstallTrigger !== 'undefined';\n      let support =\n        'onwheel' in d3.select('.legendBox') ?\n        'wheel' // Modern browsers support \"wheel\"\n        :\n        document.onmousewheel !== undefined ?\n        'mousewheel' // Webkit and IE support at least \"mousewheel\"\n        :\n        'wheel'; // let's assume that remaining browsers are older Firefox\n      d3.select('.legendBox').on(support, function () {\n        // isFirefox ? 'wheel' : 'mousewheel.zoom'\n        //Chrome & IE: mousewheel.zoom | Firefox: DOMMouseScroll (not supported yet).\n        var evt = d3.event;\n        evt.preventDefault();\n        scrollTop = isFirefox ? evt.deltaY : evt.wheelDelta;\n        render(true);\n      });\n      render(true);\n      drawScrollLegend(visibleRows);\n    }\n\n    function drawScrollLegend(visibleRows) {\n      var scrollLegend = d3\n        .select('.legendBox')\n        .append('g')\n        .attr('class', 'scroll-legend')\n        .append('text')\n        .attr('transform', `translate(0,${visibleRows * 25})`);\n\n      scrollLegend\n        .append('tspan')\n        .attr('class', 'material-icons expand-more')\n        .text('mouse');\n\n      scrollLegend\n        .append('tspan')\n        .attr('x', 30)\n        .attr('y', -12)\n        .text('Despl√°zate con el');\n\n      scrollLegend\n        .append('tspan')\n        .attr('x', 60)\n        .attr('y', -1)\n        .text('cursor');\n\n      if (totalRows < visibleRows) {\n        d3.selectAll('.scroll-legend').style('display', 'none');\n      } else {\n        d3.selectAll('.scroll-legend').style('display', 'flex');\n      }\n    }\n\n    virtualscroller.render = function (resize) {};\n\n    virtualscroller.data = function (_, __) {\n      if (!arguments.length) return data;\n      data = _;\n      dataid = __;\n      return virtualscroller;\n    };\n\n    virtualscroller.dataid = function (_) {\n      if (!arguments.length) return dataid;\n      dataid = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.enter = function (_) {\n      if (!arguments.length) return enter;\n      enter = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.update = function (_) {\n      if (!arguments.length) return update;\n      update = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.exit = function (_) {\n      if (!arguments.length) return exit;\n      exit = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.totalRows = function (_) {\n      if (!arguments.length) return totalRows;\n      totalRows = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.rowHeight = function (_) {\n      if (!arguments.length) return rowHeight;\n      rowHeight = +_;\n      return virtualscroller;\n    };\n\n    virtualscroller.totalHeight = function (_) {\n      if (!arguments.length) return totalHeight;\n      totalHeight = +_;\n      return virtualscroller;\n    };\n\n    virtualscroller.position = function (_) {\n      if (!arguments.length) return position;\n      position = +_;\n      if (viewport) {\n        viewport.node().scrollTop = position;\n      }\n      return virtualscroller;\n    };\n\n    virtualscroller.svg = function (_) {\n      if (!arguments.length) return svg;\n      svg = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.viewport = function (_) {\n      if (!arguments.length) return viewport;\n      viewport = _;\n      return virtualscroller;\n    };\n\n    virtualscroller.delta = function () {\n      return delta;\n    };\n\n    virtualscroller.legendTitle = function (_) {\n      return legendTitle;\n    };\n\n    virtualscroller.lineNumber = function (_) {\n      if (!arguments.length) return lineNumber;\n      lineNumber = _;\n      return virtualscroller;\n    };\n\n    const rebind = function (target, source) {\n      var i = 1,\n        n = arguments.length,\n        method;\n      while (++i < n)\n        target[(method = arguments[i])] = d3_rebind(\n          target,\n          source,\n          source[method]\n        );\n      return target;\n    };\n\n    // Method is assumed to be a standard D3 getter-setter:\n    // If passed with no arguments, gets the value.\n    // If passed with arguments, sets the value and returns the target.\n    function d3_rebind(target, source, method) {\n      return function () {\n        var value = method.apply(source, arguments);\n        return value === source ? target : value;\n      };\n    }\n\n    return virtualscroller;\n  };\n\n  return Helper;\n}\n","import Helper from './helper.js';\n\nimport * as d3 from 'd3';\nimport * as _ from 'lodash';\n\n/**\n * Dbox Chart core\n */\n\n/**\n * Creates a chart type object\n * @constructor\n * @param {Object} config - Object with params to set chart size, xAxis and yAxis properties\n */\n\nexport default function Chart(config) {\n  var Chart = {};\n  // Internet Explorer 6-11\n  var isIE;\n  try {\n    isIE = /*@cc_on!@*/ false || (document && !!document.documentMode);\n  } catch (err) {\n    isIE = false;\n  }\n  // Edge 20+\n  var isEdge;\n  try {\n    isEdge = !isIE && window && !!window.StyleMedia;\n  } catch (err) {\n    isEdge = false;\n  }\n\n  /**\n   * Initialize chart object configuration\n   * @param {Object} config - Object with params to configure the chart (developer's configure)\n   */\n  Chart.init = function (config) {\n    var vm = this;\n\n    /**\n     * Set default size and default margins\n     * for chart container (SVG)\n     */\n    var defaultConfig = {\n      size: {\n        width: 800,\n        height: 600,\n        margin: {\n          left: 0,\n          right: 0,\n          top: 0,\n          bottom: 0,\n        },\n      },\n    };\n\n    var defaultStyle = {\n      chart: {\n        backgroundColor: {\n          color: 'transparent',\n          // linearGradient : { x1: 0, y1: 0, x2: 1, y2: 1 },\n          // stops: [ [0, '#FCFCFC'], [1, '#F3F2F2'] ]\n        },\n      },\n      title: {\n        textColor: '#E6B537',\n        fontSize: '30px',\n        fontWeight: 600,\n        textAlign: 'center',\n        hr: {\n          enabled: true,\n          borderWidth: '1px',\n          borderColor: '#fff',\n        },\n      },\n      legend: {\n        position: 'bottom',\n        figure: 'circle',\n        text: {\n          textColor: '#fff',\n          fontSize: '12px',\n          fontWeight: 600,\n        },\n      },\n      tooltip: {\n        backgroundColor: '#757575',\n        opacity: 0.9,\n        text: {\n          textColor: '#fff',\n          fontSize: '12px',\n          fontWeight: 600,\n          textAlign: 'center',\n          fontFamily: 'sans-serif',\n          padding: '0.8em',\n        },\n        border: {\n          color: '#5A5C5D',\n          radius: '5px',\n          width: '1px',\n        },\n      },\n      yAxis: {\n        enabled: true,\n        axis: {\n          strokeWidth: 3,\n          strokeColor: '#5F6C6C',\n          strokeOpacity: 0,\n          paddingTick: 0,\n        },\n        ticks: {\n          strokeWidth: 3,\n          strokeColor: '#929D9E',\n          grid: 'dashed',\n          gridDashed: '3, 5',\n          opacity: 0.6,\n        },\n        labels: {\n          fontSize: 12,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'end',\n        },\n        title: {\n          fontSize: 17,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'middle',\n          // rotation\n          // text align or position\n        },\n      },\n      xAxis: {\n        enabled: true,\n        axis: {\n          strokeWidth: 3,\n          strokeColor: '#5F6C6C',\n          strokeOpacity: 1, //???\n          paddingTick: 5,\n        },\n        ticks: {\n          strokeWidth: 1,\n          strokeColor: '#5F6C6C',\n          // ticksize\n        },\n        labels: {\n          fontSize: 12,\n          fontWeight: 400,\n          textColor: '#fff',\n          textAnchor: 'middle',\n        },\n        title: {\n          fontSize: 17,\n          fontWeight: 600,\n          textColor: '#fff',\n          textAnchor: 'middle',\n          // text align\n        },\n      },\n    };\n\n    /**\n     * Clone recursively the config object if it has content.\n     * Keep default configuration in other case.\n     */\n    vm._config = config ? _.cloneDeep(config) : defaultConfig;\n\n    if (vm._config.xAxis) {\n      vm._config.xAxis.axis = 'xAxis';\n      /**\n       * @deprecated Allow to use general config if axis-based is not especified\n       */\n      if (\n        vm._config.xAxis.decimals === undefined &&\n        vm._config.decimals !== undefined\n      ) {\n        vm._config.xAxis.decimals = vm._config.decimals;\n      }\n      if (\n        vm._config.xAxis.formatPreffix === undefined &&\n        vm._config.formatPreffix !== undefined\n      ) {\n        vm._config.xAxis.formatPreffix = vm._config.formatPreffix;\n      }\n      if (\n        vm._config.xAxis.formatSuffix === undefined &&\n        vm._config.formatSuffix !== undefined\n      ) {\n        vm._config.xAxis.formatSuffix = vm._config.formatSuffix;\n      }\n    }\n    if (vm._config.yAxis) {\n      vm._config.yAxis.axis = 'yAxis';\n      /**\n       * @deprecated Allow to use general config if axis-based is not especified\n       */\n      if (\n        vm._config.yAxis.decimals === undefined &&\n        vm._config.decimals !== undefined\n      ) {\n        vm._config.yAxis.decimals = vm._config.decimals;\n      }\n      if (\n        vm._config.yAxis.formatPreffix === undefined &&\n        vm._config.formatPreffix !== undefined\n      ) {\n        vm._config.yAxis.formatPreffix = vm._config.formatPreffix;\n      }\n      if (\n        vm._config.yAxis.formatSuffix === undefined &&\n        vm._config.formatSuffix !== undefined\n      ) {\n        vm._config.yAxis.formatSuffix = vm._config.formatSuffix;\n      }\n    }\n    // Initialize data array\n    vm._data = [];\n\n    // Define margin sizes and styles\n    vm._margin = vm._config.size.margin;\n    vm._addStyle = vm._config.addStyle ? vm._config.addStyle : defaultStyle;\n\n    // Define width and height\n    vm._width = vm._config.size.width - vm._margin.left - vm._margin.right;\n    vm._height = vm._config.size.height - vm._margin.top - vm._margin.bottom;\n    vm._svg = '';\n    vm._scales = {};\n    vm._axes = {};\n\n    // Public\n    vm.layers = [];\n\n    // Helper data/functions for layers to use\n    vm.helper = Helper.bind(vm)();\n  };\n\n  //------------------------\n  // User\n  /**\n   * User can set config object using this method\n   * @param {Object} config - Objec with params to configure the chart (user's configure)\n   */\n  Chart.config = function (config) {\n    var vm = this;\n    vm._config = _.cloneDeep(config);\n    return vm;\n  };\n\n  /**\n   * User can set size of the chart using this method\n   * @param {object} sizeObj - Size object\n   * @param {number} [sizeObj.height] - Height of the chart\n   * @param {number} [sizeObj.width] - Width of the chart\n   * @param {object} [sizeObj.margin] - Margins of the chart\n   * @param {number} [sizeObj.margin.top] - Margin top of the chart\n   * @param {number} [sizeObj.margin.right] - Margin right of the chart\n   * @param {number} [sizeObj.margin.bottom] - Margin bottom of the chart\n   * @param {number} [sizeObj.margin.left] - Margin left of the chart\n   */\n  Chart.size = function (sizeObj) {\n    var vm = this;\n    if (sizeObj) {\n      if (sizeObj.margin) {\n        if (!Number.isNaN(+sizeObj.margin.left)) {\n          vm._config.size.margin.left = sizeObj.margin.left;\n          vm._margin.left = sizeObj.margin.left;\n        }\n        if (!Number.isNaN(+sizeObj.margin.right)) {\n          vm._config.size.margin.right = sizeObj.margin.right;\n          vm._margin.right = sizeObj.margin.right;\n        }\n        if (!Number.isNaN(+sizeObj.margin.top)) {\n          vm._config.size.margin.top = sizeObj.margin.top;\n          vm._margin.top = sizeObj.margin.top;\n        }\n        if (!Number.isNaN(+sizeObj.margin.bottom)) {\n          vm._config.size.margin.bottom = sizeObj.margin.bottom;\n          vm._margin.bottom = sizeObj.margin.bottom;\n        }\n      }\n      if (!Number.isNaN(+sizeObj.width)) {\n        vm._config.size.width = sizeObj.width;\n        vm._width = sizeObj.width;\n      }\n      if (!Number.isNaN(+sizeObj.height)) {\n        vm._config.size.height = sizeObj.height;\n        vm._height = sizeObj.height;\n      }\n    }\n    return vm;\n  };\n\n  /**\n   * User can set a personalized style object\n   * @param {object} stylesObj\n   */\n  Chart.addStyle = function (stylesObj) {\n    var vm = this;\n    if (stylesObj) {\n      vm._addStyle = stylesObj;\n    }\n    return vm;\n  };\n\n  /**\n   * Set if background grid is enabled and should be drawn\n   * @param {boolean} enabled - Grid status\n   */\n  Chart.grid = function (enabled) {\n    var vm = this;\n    vm._config.grid = enabled ? true : false;\n    return vm;\n  };\n\n  /**\n   * Set selector of HTML node to embed the whole chart\n   * @param {string} selector - HTML node selector\n   */\n  Chart.bindTo = function (selector) {\n    var vm = this;\n    vm._config.bindTo = selector;\n    return vm;\n  };\n\n  /**\n   * Set data to be used in chart\n   * @param {Object[]} data - Data structure to be used\n   */\n  Chart.data = function (data) {\n    var vm = this;\n    if (vm._config.data !== undefined) {\n      vm._config.data = Object.assign({}, vm._config.data, data);\n    } else {\n      vm._config.data = data;\n    }\n    return vm;\n  };\n\n  /**\n   * Set configuration for legend\n   * @param {Object} legend - Legend configuration\n   */\n  Chart.legend = function (legend) {\n    var vm = this;\n    vm._config.legend = legend;\n    return vm;\n  };\n\n  Chart.legendType = function (legendType) {\n    var vm = this;\n    vm._config.legendType = legendType;\n    return vm;\n  };\n\n  Chart.legendTitle = function (legendTitle) {\n    var vm = this;\n    vm._config.legendTitle = legendTitle;\n    return vm;\n  };\n\n  Chart.layer = function (_layer, _config) {\n    var vm = this;\n    var layer;\n    var config = _config ? _config : vm._config;\n    if (_layer === undefined && _layer === null) {\n      /** @todo Throw Error */\n    } else {\n      layer = _layer(config, vm.helper);\n      vm.layers.push(layer);\n      return layer;\n    }\n  };\n\n  Chart.getLayer = function (layerIndex) {\n    var vm = this;\n    return vm.layers[layerIndex];\n  };\n\n  Chart.draw = function () {\n    var vm = this,\n      q;\n    vm._scales = vm.scales();\n    // vm._axes   = vm.axes(); // CALL THE AXES AFTER DATA LOADING IN ORDER TO UPDATE THE DOMAINS OF THE SCALES\n\n    q = vm.loadData();\n\n    q.awaitAll(function (error, results) {\n      if (error) throw error;\n\n      if (Array.isArray(results) && results.length === 1) {\n        vm._data = results[0];\n      } else {\n        vm._data = results;\n      }\n\n      vm.initLayers();\n      vm.drawSVG();\n\n      /** @todo ONE MAIN AXES THEN ADD THE POSSIBILITY FOR THE LAYER TO OVERRIDE */\n      vm._axes = vm.axes();\n      vm.drawAxes();\n\n      // Draw layers after axes\n      vm.drawLayers();\n\n      // Trigger load chart event\n      if (vm._config.events && vm._config.events.load) {\n        vm.dispatch.on('load.chart', vm._config.events.load(vm));\n      }\n    });\n    return vm;\n  };\n\n  Chart.addStyle = function (theme) {\n    var vm = this;\n    vm._addStyle = theme;\n    return vm;\n  };\n\n  //----------------------\n  // Helper functions\n  Chart.scales = function () {\n    var vm = this;\n\n    var scales = {};\n    // xAxis scale\n    if (vm._config.xAxis && vm._config.xAxis.scale) {\n      switch (vm._config.xAxis.scale) {\n        case 'linear':\n          scales.x = d3.scaleLinear().range([0, vm._width]);\n          break;\n\n        case 'time':\n          scales.x = d3.scaleTime().range([0, vm._width]);\n          break;\n\n        case 'ordinal':\n          scales.x = d3.scaleOrdinal().range([0, vm._width], 0.1);\n          break;\n\n        case 'band':\n          scales.x = d3.scaleBand().rangeRound([0, vm._width]).padding(0.1);\n          break;\n\n        case 'quantile':\n          scales.x = d3.scaleOrdinal().range([0, vm._width], 0.1);\n\n          scales.q = d3\n            .scaleQuantile()\n            .range(d3.range(vm._config.xAxis.buckets));\n          break;\n\n        default:\n          scales.x = d3.scaleLinear().range([0, vm._width]);\n          break;\n      }\n    } else {\n      scales.x = d3.scaleLinear().range([0, vm._width]);\n    }\n\n    // yAxis scale\n    if (vm._config.yAxis && vm._config.yAxis.scale) {\n      switch (vm._config.yAxis.scale) {\n        case 'linear':\n          scales.y = d3.scaleLinear().range([vm._height, 0]);\n          break;\n\n        case 'time':\n          scales.y = d3.scaleTime().range([vm._height, 0]);\n          break;\n\n        case 'ordinal':\n          scales.y = d3.scaleOrdinal().range([vm._height, 0], 0.1);\n          break;\n\n        case 'band':\n          scales.y = d3.scaleBand().rangeRound([vm._height, 0]).padding(0.1);\n          break;\n\n        case 'quantile':\n          scales.y = d3.scaleOrdinal().range([0, vm._width], 0.1);\n\n          scales.q = d3\n            .scaleQuantile()\n            .range(d3.range(vm._config.yAxis.buckets));\n          break;\n\n        default:\n          scales.y = d3.scaleLinear().range([vm._height, 0]);\n          break;\n      }\n    } else {\n      scales.y = d3.scaleLinear().range([vm._height, 0]);\n    }\n\n    scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n    if (vm._config.legend && vm._config.legend.length > 0) {\n      scales.color.domain(vm._config.legend.map((o) => o.name));\n    }\n\n    return scales;\n  };\n\n  Chart.setScales = function () {};\n\n  Chart.axes = function () {\n    var vm = this,\n      axes = {};\n    axes.x = d3.axisBottom(vm._scales.x);\n    axes.y = d3.axisLeft(vm._scales.y);\n\n    // Remove corners in axis line\n    axes.x.tickSizeOuter(0);\n    axes.y.tickSizeOuter(0);\n\n    // Replaced with *addStyle -check\n    if (\n      vm._config.xAxis &&\n      vm._config.xAxis.ticks &&\n      vm._config.xAxis.ticks.enabled === true &&\n      vm._config.xAxis.ticks.style\n    ) {\n      switch (vm._config.xAxis.ticks.style) {\n        case 'straightLine':\n          axes.x.tickSize(-vm._height, 0);\n          break;\n        case 'dashLine':\n          axes.x.tickSize(-vm._width, 0);\n          break;\n      }\n    }\n    // addStyle\n    if (vm._addStyle.xAxis.ticks.grid) {\n      switch (vm._addStyle.xAxis.ticks.grid) {\n        case 'straight':\n          axes.y.tickSize(-vm._width, 0);\n          break;\n        case 'dashed':\n          axes.y.tickSize(-vm._width, 0);\n          break;\n      }\n    }\n\n    if (\n      vm._config.xAxis &&\n      vm._config.xAxis.ticks &&\n      vm._config.xAxis.ticks.ticks\n    ) {\n      axes.x.ticks(vm._config.xAxis.ticks.ticks);\n    }\n\n    if (\n      vm._config.xAxis &&\n      vm._config.xAxis.ticks &&\n      vm._config.xAxis.ticks.values\n    ) {\n      axes.x.tickValues(vm._config.xAxis.ticks.values);\n    }\n\n    if (\n      vm._config.xAxis &&\n      vm._config.xAxis.ticks &&\n      vm._config.xAxis.scale === 'linear'\n    ) {\n      vm._scales.x.domain()[1];\n      axes.x.tickFormat(vm.helper.utils.format(vm._config.xAxis, true));\n    }\n    if (\n      vm._config.xAxis &&\n      vm._config.xAxis.ticks &&\n      vm._config.xAxis.ticks.format\n    ) {\n      axes.x.tickFormat(vm._config.xAxis.ticks.format);\n    }\n\n    // Replaced with *addStyle -check\n    if (\n      vm._config.yAxis &&\n      vm._config.yAxis.ticks &&\n      vm._config.yAxis.ticks.enabled === true &&\n      vm._config.yAxis.ticks.style\n    ) {\n      switch (vm._config.yAxis.ticks.style) {\n        case 'straightLine':\n          axes.y.tickSize(-vm._width, 0);\n          break;\n        case 'dashLine':\n          axes.y.tickSize(-vm._width, 0);\n          break;\n      }\n    }\n    // addStyle\n    if (vm._addStyle.yAxis.ticks.grid) {\n      switch (vm._addStyle.yAxis.ticks.grid) {\n        case 'straight':\n          axes.y.tickSize(-vm._width, 0);\n          break;\n        case 'dashed':\n          axes.y.tickSize(-vm._width, 0);\n          break;\n      }\n    }\n    if (\n      vm._config.yAxis &&\n      vm._config.yAxis.ticks &&\n      vm._config.yAxis.scale === 'linear'\n    ) {\n      axes.y.tickFormat(vm.helper.utils.format(vm._config.yAxis, true));\n    }\n    if (\n      vm._config.yAxis &&\n      vm._config.yAxis.ticks &&\n      vm._config.yAxis.ticks.format\n    ) {\n      axes.y.tickFormat(vm._config.yAxis.ticks.format);\n    }\n    if (\n      vm._config.yAxis &&\n      vm._config.yAxis.ticks &&\n      vm._config.yAxis.ticks.ticks\n    ) {\n      axes.y.ticks(vm._config.yAxis.ticks.ticks);\n    }\n    return axes;\n  };\n\n  Chart.loadData = function () {\n    var vm = this;\n    var q;\n\n    if (vm._config.data.tsv) {\n      q = d3.queue().defer(d3.tsv, vm._config.data.tsv);\n    }\n\n    if (vm._config.data.json) {\n      q = d3.queue().defer(d3.json, vm._config.data.json);\n    }\n\n    if (vm._config.data.csv) {\n      q = d3.queue().defer(d3.csv, vm._config.data.csv);\n    }\n\n    if (vm._config.data.raw) {\n      q = d3.queue().defer(vm.mapData, vm._config.data.raw);\n    }\n\n    if (\n      vm._config.map &&\n      vm._config.map.topojson &&\n      vm._config.map.topojson.url\n    ) {\n      q.defer(d3.json, vm._config.map.topojson.url);\n    }\n\n    return q;\n  };\n\n  Chart.initLayers = function () {\n    var vm = this;\n    vm.layers.forEach(function (ly) {\n      ly.data(vm._data).scales();\n\n      /** @todo validate domains from multiple layers */\n      vm._scales = ly._scales;\n    });\n  };\n\n  Chart.drawSVG = function () {\n    var vm = this;\n\n    // Remove any previous svg\n    d3.select(vm._config.bindTo).select('svg').remove();\n    d3.select(vm._config.bindTo).html('');\n\n    // Add the css template class\n    if (vm._config.template) {\n      d3.select(vm._config.bindTo).classed(vm._config.template, true);\n    }\n\n    // Add title to the chart\n    if (vm._config && vm._config.title) {\n      d3.select(vm._config.bindTo)\n        .append('div')\n        .attr('class', 'chart-title')\n        .html(vm._config.title)\n        .style('display', 'flex')\n        .style('justify-content', 'center')\n        .style('align-items', 'center')\n        .style('font-size', vm._addStyle.title.fontSize)\n        .style('font-weight', vm._addStyle.title.fontWeight)\n        .style('color', vm._addStyle.title.textColor)\n        .style('text-align', vm._addStyle.title.textAlign);\n\n      if (vm._addStyle.title.hr.enabled) {\n        d3.select(vm._config.bindTo)\n          .append('hr')\n          .attr('class', 'hr-title')\n          .style('width', '80%')\n          .style('margin-left', '10%')\n          .style('margin-top', '0.5em')\n          .style('border-width', vm._addStyle.title.hr.borderWidth)\n          .style('border-color', vm._addStyle.title.hr.borderColor);\n      }\n    }\n\n    // Add Legend to the chart\n    /** @todo PASS THE STYLES TO DBOX.CSS */\n    /** @todo ALLOW DIFFERENT POSSITIONS FOR THE LEGEND */\n    if (\n      vm._config.legend &&\n      vm._config.legend.enabled === true &&\n      vm._config.legend.position === 'top'\n    ) {\n      var legend = d3\n        .select(vm._config.bindTo)\n        .append('div')\n        .attr('class', 'chart-legend-top');\n\n      var html = '';\n      html +=\n        '<div style=\"background-color:#E2E2E1;text-align:center;height: 40px;margin: 0px 15px\">';\n      vm._config.legend.categories.forEach(function (c) {\n        html +=\n          '<div class=\"dbox-legend-category-title\" style=\"margin:0 20px;\"><span class=\"dbox-legend-category-color\" style=\"background-color:' +\n          c.color +\n          ';\"> </span><span style=\"height: 10px;float: left;margin: 10px 5px 5px 5px;border-radius: 50%;\">' +\n          c.title +\n          '</span></div>';\n      });\n      html += '</div>';\n      legend.html(html);\n    }\n\n    const width = vm._width + vm._margin.left + vm._margin.right;\n    const height = vm._height + vm._margin.top + vm._margin.bottom;\n    // Create the svg\n    vm._fullSvg = d3\n      .select(vm._config.bindTo)\n      .append('svg')\n      .style(\n        'font-size',\n        vm._config.chart\n          ? vm._config.chart['font-size']\n            ? vm._config.chart['font-size']\n            : '12px'\n          : '12px'\n      )\n      .attr('width', width)\n      .attr('height', height)\n      .attr('viewBox', `0 0 ${width} ${height}`);\n\n    vm._svg = vm._fullSvg\n      .append('g')\n      .attr(\n        'transform',\n        'translate(' + vm._margin.left + ',' + vm._margin.top + ')'\n      );\n\n    //Apply background color\n\n    d3.select(vm._config.bindTo + ' svg').style(\n      'background-color',\n      vm._addStyle.chart.backgroundColor.color\n    );\n\n    // Legend for average lines\n    /*\n    d3.select(vm._config.bindTo).append('div')\n      .attr('class', 'chart-legend-bottom');\n    if (vm._config.plotOptions && vm._config.plotOptions.bars\n      && vm._config.plotOptions.bars.averageLines && Array.isArray(vm._config.plotOptions.bars.averageLines)\n      && vm._config.plotOptions.bars.averageLines.length >0 ){\n\n      d3.select(vm._config.bindTo).append('div')\n        .attr('class', 'container-average-lines')\n        .append('div')\n          .attr('class', 'legend-average-lines')\n        .html('Average Lines Controller')\n    }\n    */\n\n    if (\n      vm._config.hasOwnProperty('legend') &&\n      vm._config.legendEnabled === true\n    ) {\n      vm.drawLegend();\n    }\n  };\n\n  Chart.drawLayers = function () {\n    var vm = this;\n    vm.layers.forEach(function (ly) {\n      ly.draw();\n    });\n  };\n\n  /**\n   * Draw chart legends section\n   */\n  Chart.drawLegend = function () {\n    // Reference to chart object\n    var vm = this,\n      legendBox,\n      virtualScroller,\n      legendX = vm._config.size.width - vm._config.size.margin.right + 10,\n      marginTop = vm._config.size.margin.top + 10;\n    // Set color domain\n    if (!vm._scales.color && vm._config.colors) {\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    }\n    if (vm._config.legend && vm._config.legend.length > 0) {\n      vm._scales.color.domain(vm._config.legend.map((o) => o.name));\n    }\n    // Create information tips for each legend\n    const legendTip = vm.helper.utils.d3.tip().html((d) => {\n      return '<div class=\"title-tip\">' + (d.name || d) + '</div>';\n    });\n    vm._fullSvg.call(legendTip);\n\n    // Draw legend, defaults to right\n    legendBox = vm._fullSvg\n      .append('g')\n      .attr('class', 'legendBox')\n      .attr('transform', 'translate(' + legendX + ', ' + marginTop + ')')\n      .attr('width', vm._width)\n      .attr('height', vm._height);\n    // Add legends title (on top of legendBox)\n    if (vm._config.legendTitle) {\n      legendBox\n        .append('g')\n        .attr('width', '150px')\n        .append('text')\n        .attr('class', 'legend-title')\n        .attr('x', 5)\n        .style('font-weight', 'bold')\n        .text(vm._config.legendTitle);\n      // Wrap legend title if text size exceeds 70% of container\n      let lWidth = vm._config.size.margin.right;\n      var text = d3.selectAll('.legend-title'),\n        words = text.text().split(/\\s+/).reverse(),\n        word,\n        line = [],\n        lineNumber = 1,\n        lineHeight = 1.1, // ems\n        y = text.attr('y'),\n        dy = 0,\n        tspan = text\n          .text(null)\n          .append('tspan')\n          .attr('x', 0)\n          .attr('y', y)\n          .attr('dy', dy + 'em');\n      while ((word = words.pop())) {\n        line.push(word);\n        tspan.text(line.join(' '));\n        if (tspan.node().getComputedTextLength() > lWidth) {\n          line.pop();\n          tspan.text(line.join(' '));\n          line = [word];\n          ++lineNumber;\n          tspan = text\n            .append('tspan')\n            .attr('x', -6)\n            .attr('y', y)\n            .attr('dy', lineHeight + 'em')\n            .text(word);\n        }\n      }\n    }\n\n    // Label width\n    let lbWidth = vm._config.size.margin.right * 0.8;\n    if (vm._config.legendType === 'checkbox') {\n      // Size and position of every checkbox\n      let size = 18,\n        x = 0,\n        y = 0,\n        rx = 2,\n        ry = 2,\n        markStrokeWidth = 3;\n\n      vm._scales.color.domain(vm._config.legend.map((o) => o.name));\n\n      var legendEnter = function (legendCheck) {\n        legendCheck\n          .append('rect')\n          .attr('width', size)\n          .attr('height', size)\n          .attr('x', x)\n          .attr('rx', rx)\n          .attr('ry', ry)\n          .attr('fill-opacity', 1);\n        let coordinates = [\n          {\n            x: x + size / 8,\n            y: y + size / 2,\n          },\n          {\n            x: x + size / 2.2,\n            y: y + size - size / 4,\n          },\n          {\n            x: x + size - size / 8,\n            y: y + size / 10,\n          },\n        ];\n\n        let line = d3\n          .line()\n          .x(function (d) {\n            return d.x;\n          })\n          .y(function (d) {\n            return d.y;\n          });\n\n        // Mark (inside checkbox)\n        legendCheck\n          .append('path')\n          .attr('d', line(coordinates))\n          .attr('stroke-width', markStrokeWidth)\n          .attr('stroke', 'white')\n          .attr('fill', 'none')\n          .attr('class', 'mark')\n          .property('checked', function (d) {\n            // External function call. It must be after all the internal code; allowing the user to overide\n            return d.active;\n          })\n          .attr('opacity', function () {\n            if (d3.select(this).property('checked')) {\n              return 1;\n            } else {\n              return 0;\n            }\n          });\n\n        legendCheck\n          .append('text')\n          .attr('class', 'labelText')\n          .attr('x', 20)\n          .attr('y', 9)\n          .attr('dy', '.35em')\n          .attr('text-anchor', 'start');\n\n        legendCheck.select('rect').attr('fill', function (d) {\n          return vm._scales.color(d.name);\n        });\n\n        legendCheck.select('text').text(function (d) {\n          // External function call. It must be after all the internal code; allowing the user to overide\n          // External function call. It must be after all the internal code; allowing the user to overide\n          // External function call. It must be after all the internal code; allowing the user to overide\n          return d.name;\n        });\n\n        // Cut label text if text size exceeds 80% of container\n        legendCheck.selectAll('text').each(function (d) {\n          if (typeof d.name === 'string') {\n            // getComputedTextLenght: Returns a float representing the computed length for the text within the element.\n            if (this.getComputedTextLength() > lbWidth) {\n              d3.select(this)\n                .attr('title', d.name)\n                .on('mouseover', legendTip.show)\n                .on('mouseout', legendTip.hide);\n              let i = 1;\n              while (this.getComputedTextLength() > lbWidth) {\n                d3.select(this).text(function (d) {\n                  return d['name'].slice(0, -i) + '...';\n                });\n                ++i;\n              }\n            } else {\n              return d;\n            }\n          }\n        });\n      }; // legendEnter ends\n\n      // Let scroll legendBox from anywhere inside g container\n      legendBox\n        .append('rect')\n        .attr('class', 'legendBoxBackground')\n        .attr('width', '160px')\n        .attr('height', '90%')\n        .attr('transform', 'translate(0,0)')\n        .style('fill', 'transparent');\n\n      var legendUpdate = function (legendCheck) {\n        legendCheck.select('rect').attr('fill', function (d) {\n          return vm._scales.color(d.name);\n        });\n\n        legendCheck.select('text').text(function (d) {\n          // External function call. It must be after all the internal code; allowing the user to overide\n          // External function call. It must be after all the internal code; allowing the user to overide\n          // External function call. It must be after all the internal code; allowing the user to overide\n          return d.name;\n        });\n\n        legendCheck.selectAll('text').each(function (d) {\n          if (typeof d.name === 'string') {\n            // getComputedTextLenght: Returns a float representing the computed length for the text within the element.\n            if (this.getComputedTextLength() > lbWidth) {\n              d3.select(this)\n                .attr('title', d.name)\n                .on('mouseover', legendTip.show)\n                .on('mouseout', legendTip.hide);\n              let i = 1;\n              while (this.getComputedTextLength() > lbWidth) {\n                d3.select(this).text(function (d) {\n                  return d['name'].slice(0, -i) + '...';\n                });\n                ++i;\n              }\n            } else {\n              return d;\n            }\n          }\n        });\n      };\n\n      var legendExit = function (legendCheck) {};\n\n      virtualScroller = vm.helper.utils\n        .VirtualScroller()\n        .rowHeight(size)\n        .enter(legendEnter)\n        .update(legendUpdate)\n        .exit(legendExit)\n        .svg(vm._fullSvg)\n        .totalRows(vm._config.legend.length)\n        .viewport(d3.select('.empty-chart'))\n        .lineNumber(lineNumber);\n\n      virtualScroller.data(vm._config.legend, function (d) {\n        return d.name;\n      });\n      legendBox.call(virtualScroller);\n\n      // End of checkbox case\n    } else {\n      var legend;\n      if (vm._config.styles && vm._addStyle.legend.position === 'bottom') {\n        legend = legendBox\n          .selectAll('.legend')\n          .data(vm._config.legend)\n          .enter()\n          .append('g')\n          .attr('class', 'legend')\n          .attr('width', vm._width / (vm._config.legend.length + 1))\n          .attr('transform', function (d, i) {\n            // Horizontal position\n            // What if there are too many legends?\n            return (\n              'translate(' +\n              (vm._width / (vm._config.legend.length + 1)) * i +\n              ',' +\n              (vm._config.legendTitle && lineNumber > 1\n                ? lineNumber * lineHeight\n                : 0) *\n                19 +\n              ')'\n            );\n          });\n      } else {\n        legend = legendBox\n          .selectAll('.legend')\n          .data(vm._config.legend)\n          .enter()\n          .append('g')\n          .attr('class', 'legend')\n          .attr('transform', function (d, i) {\n            return (\n              'translate(' +\n              5 +\n              ',' +\n              (vm._config.legendTitle && lineNumber > 1\n                ? lineNumber * lineHeight + i\n                : 1 + i) *\n                19 +\n              ')'\n            );\n          });\n      }\n\n      if (vm._addStyle.legend.figure === 'circle') {\n        legend\n          .append('circle')\n          .attr('cx', 2)\n          .attr('cy', 9)\n          .attr('r', 7)\n          .attr('stroke-width', 2)\n          .attr('stroke', function (d) {\n            return vm._scales.color(d.name);\n          })\n          .attr('fill', function (d) {\n            return vm._scales.color(d.name);\n          })\n          .attr('fill-opacity', 0.8);\n      } else {\n        legend\n          .append('rect')\n          .attr('x', 0)\n          .attr('width', 18)\n          .attr('height', 18)\n          .attr('fill', function (d) {\n            return vm._scales.color(d.name);\n          });\n      }\n\n      legend\n        .append('text')\n        .attr('x', 20)\n        .attr('y', 9)\n        .attr('dy', '.35em')\n        .attr('text-anchor', 'start')\n        .text(function (d) {\n          // External function call. It must be after all the internal code; allowing the user to overide\n          return d.name;\n        });\n\n      // Cut label text if text size exceeds 80% of container\n      let lbWidth = vm._config.size.margin.right - 19;\n      legend.selectAll('text').each(function (d) {\n        if (typeof d.name === 'string') {\n          if (this.getComputedTextLength() > lbWidth) {\n            d3.select(this)\n              .attr('title', d.name)\n              .on('mouseover', legendTip.show)\n              .on('mouseout', legendTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > lbWidth) {\n              d3.select(this).text(function (d) {\n                return d['name'].slice(0, -i) + '...';\n              });\n              ++i;\n            }\n          } else {\n            return d;\n          }\n        }\n      });\n    }\n\n    /**\n     * Give some extra style\n     */\n\n    legendBox\n      .selectAll('.legend text')\n      .attr('fill', vm._addStyle.legend.text.textColor)\n      .attr('font-size', vm._addStyle.legend.text.fontSize)\n      .attr('font-weight', vm._addStyle.legend.text.fontWeight);\n\n    // Prevent default scrolling of all elements inside legendBox\n    let isFirefox = typeof InstallTrigger !== 'undefined';\n    let support =\n      'onwheel' in d3.select('.legendBox')\n        ? 'wheel' // Modern browsers support 'wheel'\n        : document.onmousewheel !== undefined\n        ? 'mousewheel' // Webkit and IE support at least 'mousewheel'\n        : 'DOMMouseScroll'; // let's assume that remaining browsers are older Firefox\n    if (isFirefox) {\n      // Newer Firefox versions support wheel events.\n      // DOMMouseScroll is not supported yet.\n      support = 'wheel';\n    }\n    d3.select('.legendBoxBackground').on(support, function () {\n      var evt = d3.event;\n      evt.preventDefault();\n    });\n\n    d3.select('.scroll-legend').on(support, function () {\n      var evt = d3.event;\n      evt.preventDefault();\n    });\n\n    legendBox.selectAll('text').on(support, function () {\n      var evt = d3.event;\n      evt.preventDefault();\n    });\n\n    legendBox.selectAll('rect').on(support, function () {\n      var evt = d3.event;\n      evt.preventDefault();\n    });\n\n    legendBox.selectAll('path').on(support, function () {\n      var evt = d3.event;\n      evt.preventDefault();\n    });\n  };\n\n  Chart.drawGrid = function () {\n    var vm = this;\n    return vm;\n  };\n\n  Chart.drawAxes = function () {\n    var vm = this;\n    var yAxis;\n\n    /**\n     * Draw axes depends on axes config and styles.\n     * Let's start with config.\n     */\n\n    //Axes tooltip\n    const axesTip = vm.helper.utils.d3.tip().html((d) => {\n      return '<div class=\"title-tip\">' + d + '</div>';\n    });\n\n    if (\n      (!vm._config.yAxis ||\n        (vm._config.yAxis && vm._config.yAxis.enabled !== false)) &&\n      (!vm._config.xAxis ||\n        (vm._config.xAxis && vm._config.xAxis.enabled !== false))\n    ) {\n      vm._svg.call(axesTip);\n    }\n\n    /**\n     * Config axes\n     */\n\n    // y\n\n    if (\n      !vm._config.yAxis ||\n      (vm._config.yAxis && vm._config.yAxis.enabled !== false)\n    ) {\n      yAxis = vm._svg.append('g').attr('class', 'y axis').call(vm._axes.y);\n\n      if (vm._config.yAxis && vm._config.yAxis.text) {\n        yAxis\n          .append('text')\n          .attr('class', 'axis-title')\n          .attr('y', -vm._margin.left * 0.7)\n          .attr('x', -vm._height / 2)\n          .attr('transform', 'rotate(-90)')\n          .attr('text-anchor', 'middle')\n          .text(vm._config.yAxis.text);\n      }\n\n      if (vm._config.yAxis && vm._config.yAxis.scaleText) {\n        yAxis\n          .append('text')\n          .attr('class', 'axis-scale-title')\n          .attr('y', -12)\n          .attr('x', -12)\n          .attr('font-weight', 'bold')\n          .attr('text-anchor', 'middle')\n          .text(vm._config.yAxis.scaleText);\n      }\n    }\n\n    if (\n      vm._config.yAxis.domain &&\n      vm._config.yAxis.domain.hasOwnProperty('enabled')\n    ) {\n      if (vm._config.yAxis.ticks) {\n        if (\n          vm._config.yAxis.domain.enabled === false &&\n          vm._config.yAxis.ticks.enabled === false\n        ) {\n          d3.select('g.y.axis .domain').remove();\n          d3.selectAll('g.y.axis .tick').remove();\n        } else if (\n          vm._config.yAxis.domain.enabled === false &&\n          vm._config.yAxis.ticks.enabled === true\n        ) {\n          d3.select('g.y.axis .domain').remove();\n          // d3.selectAll('g.y.axis .tick text').remove();\n        }\n      } else {\n        if (vm._config.yAxis.domain.enabled === false) {\n          d3.select('g.y.axis .domain').remove();\n          d3.selectAll('g.y.axis .tick').remove();\n        }\n      }\n    }\n\n    if (\n      !vm._config.yAxis ||\n      (vm._config.yAxis && vm._config.yAxis.enabled !== false)\n    ) {\n      // Add ellipsis to cut label text when too long\n      // for yAxis on the left\n      yAxis.selectAll('text').each(function (d) {\n        let element = this;\n        if (typeof d === 'string') {\n          if (this.getComputedTextLength() > 0.8 * vm._margin.left) {\n            d3.select(element)\n              .on('mouseover', axesTip.show)\n              .on('mouseout', axesTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > 0.8 * vm._margin.left) {\n              d3.select(this)\n                .text(function (d) {\n                  return d.slice(0, -i) + '...';\n                })\n                .attr('title', d);\n              ++i;\n            }\n          } else {\n            return d;\n          }\n        }\n      });\n    }\n\n    // Dropdown Y axis\n    if (\n      vm._config.yAxis &&\n      vm._config.yAxis.dropdown &&\n      vm._config.yAxis.dropdown.enabled === true\n    ) {\n      var yAxisDropDown = d3\n        .select(vm._config.bindTo)\n        .append('div')\n        .attr('class', 'dbox-yAxis-select')\n        .append('select')\n        .on('change', function () {\n          vm.updateAxis('y', this.value);\n        });\n\n      /*\n      .attr('style', function(){\n                              var x = -1*d3.select(vm._config.bindTo).node().getBoundingClientRect().width/2+ vm._chart._margin.left/4;\n                              var y = -1*d3.select(vm._config.bindTo).node().getBoundingClientRect().height/2;\n                              return 'transform: translate('+x+'px,'+y+'px) rotate(-90deg);'\n                            })\n      */\n\n      var x =\n        (-1 *\n          d3.select(vm._config.bindTo).node().getBoundingClientRect().width) /\n          2 +\n        vm._margin.left / 2.5;\n      var y =\n        (-1 *\n          d3.select(vm._config.bindTo).node().getBoundingClientRect().height) /\n        1.5;\n\n      if (vm._config.yAxis.dropdown.styles) {\n        var styles = vm._config.yAxis.dropdown.styles;\n        styles.display = 'block';\n        styles.transform = 'translate(' + x + 'px,' + y + 'px) rotate(-90deg)';\n        styles.margin = 'auto';\n        styles['text-align'] = 'center';\n        styles['text-align-last'] = 'center';\n\n        d3.select('.dbox-yAxis-select select').styles(styles);\n\n        d3.select('.dbox-yAxis-select select option').styles({\n          'text-align': 'left',\n        });\n      } else {\n        d3.select('.dbox-yAxis-select select').styles({\n          display: 'block',\n          transform: 'translate(' + x + 'px,' + y + 'px) rotate(-90deg)',\n          margin: 'auto',\n          'text-align': 'center',\n          'text-align-last': 'center',\n        });\n\n        d3.select('.dbox-yAxis-select select option').styles({\n          'text-align': 'left',\n        });\n      }\n\n      if (vm._config.yAxis.dropdown.options) {\n        yAxisDropDown\n          .selectAll('option')\n          .data(vm._config.yAxis.dropdown.options)\n          .enter()\n          .append('option')\n          .attr('class', function (d) {\n            return d.value;\n          })\n          .attr('value', function (d) {\n            return d.value;\n          })\n          .text(function (d) {\n            return d.title;\n          })\n          .property('selected', function (d) {\n            return d.selected;\n          });\n      } else {\n        console.log('No options present in config');\n      }\n    }\n\n    // y\n\n    /////////////////////////////\n\n    // x\n    if (\n      !vm._config.xAxis ||\n      (vm._config.xAxis && vm._config.xAxis.enabled !== false)\n    ) {\n      vm._xAxis = vm._svg\n        .append('g')\n        .attr('class', 'x axis')\n        .attr('transform', 'translate(0,' + vm._height + ')')\n        .call(vm._axes.x);\n\n      // Move axis domain line\n      if (vm._config.yAxis.scale === 'linear' && vm._scales.y.domain()[0] < 0) {\n        vm._xAxis\n          .select('.domain')\n          .attr(\n            'transform',\n            'translate(0,-' +\n              Math.abs(vm._scales.y.range()[0] - vm._scales.y(0)) +\n              ')'\n          );\n      }\n\n      // Do not show line if axis is disabled\n      if (vm._config.xAxis.line && vm._config.xAxis.line.enabled === false) {\n        vm._xAxis.selectAll('path').style('display', 'none');\n      }\n\n      // Set custom position for ticks\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.x) {\n        vm._xAxis.selectAll('text').attr('dx', vm._config.xAxis.ticks.x);\n      }\n\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.y) {\n        vm._xAxis.selectAll('text').attr('dy', vm._config.xAxis.ticks.y);\n      }\n\n      // Disable ticks when set to false\n      if (\n        vm._config.xAxis.ticks &&\n        vm._config.xAxis.ticks.line &&\n        vm._config.xAxis.ticks.line.enabled === false\n      ) {\n        vm._xAxis.selectAll('line').style('display', 'none');\n      }\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.text) {\n      vm._svg\n        .select('.x.axis')\n        .append('text')\n        .attr('class', 'axis-title')\n        .attr('x', vm._width / 2)\n        .attr('y', 40)\n        .style('text-anchor', 'middle')\n        .text(vm._config.xAxis.text);\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.scaleText && vm._xAxis) {\n      vm._xAxis\n        .append('text')\n        .attr('class', 'axis-scale-title')\n        .attr('x', vm._width)\n        .attr('y', 15)\n        .style('text-anchor', 'start')\n        .text(vm._config.xAxis.scaleText);\n    }\n\n    if (\n      vm._config.xAxis.domain !== undefined &&\n      vm._config.xAxis.domain.hasOwnProperty('enabled')\n    ) {\n      if (vm._config.xAxis.ticks) {\n        if (\n          vm._config.xAxis.domain.enabled === false &&\n          vm._config.xAxis.ticks.enabled === false\n        ) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          d3.selectAll('g.x.axis .tick').remove();\n        } else if (\n          vm._config.xAxis.domain.enabled === false &&\n          vm._config.xAxis.ticks.enabled === true\n        ) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          // d3.selectAll('g.x.axis .tick text').remove();\n        }\n      } else {\n        if (vm._config.xAxis.domain.enabled === false) {\n          d3.select(vm._config.bindTo + ' g.x.axis .domain').remove();\n          d3.selectAll(vm._config.bindTo + ' g.x.axis .tick').remove();\n        }\n      }\n    }\n\n    // Dropdown X axis\n    if (\n      vm._config.xAxis &&\n      vm._config.xAxis.dropdown &&\n      vm._config.xAxis.dropdown.enabled === true\n    ) {\n      var xAxisDropDown = d3\n        .select(vm._config.bindTo)\n        .append('div')\n        .attr('class', 'dbox-xAxis-select')\n        .append('select')\n        .on('change', function () {\n          vm.updateAxis('x', this.value);\n        });\n\n      if (vm._config.xAxis.dropdown.styles) {\n        var styles = vm._config.xAxis.dropdown.styles;\n        styles.display = 'block';\n        styles.margin = 'auto';\n        styles['text-align'] = 'center';\n        styles['text-align-last'] = 'center';\n\n        d3.select('.dbox-xAxis-select select').styles(styles);\n\n        d3.select('.dbox-xAxis-select select option').styles({\n          'text-align': 'left',\n        });\n      } else {\n        d3.select('.dbox-xAxis-select select').styles({\n          display: 'block',\n          margin: 'auto',\n          'text-align': 'center',\n          'text-align-last': 'center',\n        });\n\n        d3.select('.dbox-xAxis-select select option').styles({\n          'text-align': 'left',\n        });\n      }\n\n      if (vm._config.xAxis.dropdown.options) {\n        xAxisDropDown\n          .selectAll('option')\n          .data(vm._config.xAxis.dropdown.options)\n          .enter()\n          .append('option')\n          .attr('class', function (d) {\n            return d.value;\n          })\n          .attr('value', function (d) {\n            return d.value;\n          })\n          .text(function (d) {\n            return d.title;\n          })\n          .property('selected', function (d) {\n            return d.selected;\n          });\n      } else {\n        console.log('No options present in config');\n      }\n    }\n\n    /**\n     * Let's style axes\n     */\n    // Style Y axis\n    if (vm._config.yAxis.enabled !== false && vm._addStyle.yAxis.enabled) {\n      // Axis line\n      yAxis\n        .selectAll('.domain')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', vm._addStyle.yAxis.axis.strokeWidth)\n        .attr('stroke', vm._addStyle.yAxis.axis.strokeColor)\n        .attr('opacity', vm._addStyle.yAxis.axis.strokeOpacity);\n\n      //axis title\n      yAxis\n        .selectAll('.axis-title')\n        .attr('font-size', vm._addStyle.yAxis.title.fontSize)\n        .attr('font-weight', vm._addStyle.yAxis.title.fontWeight)\n        .attr('fill', vm._addStyle.yAxis.title.textColor)\n        .attr('text-anchor', vm._addStyle.yAxis.title.textAnchor);\n\n      // Tick lines\n      yAxis\n        .selectAll('.tick line')\n        .attr('stroke-width', vm._addStyle.yAxis.ticks.strokeWidth)\n        .attr('stroke', vm._addStyle.yAxis.ticks.strokeColor)\n        .attr('stroke-opacity', vm._addStyle.yAxis.ticks.opacity)\n        .attr('width', vm._addStyle.yAxis.ticks.tickWidth)\n        // Condition gridline\n        .attr('stroke-dasharray', vm._addStyle.yAxis.ticks.gridDashed)\n        .attr(\n          'transform',\n          'translate(-' + vm._addStyle.yAxis.axis.paddingTick + ', 0)'\n        );\n      // Don't draw first tick when styled as grid\n      if (vm._addStyle.yAxis.ticks.grid) {\n        yAxis\n          .selectAll('.tick:first-of-type line:first-of-type')\n          .attr('stroke', 'none');\n      }\n\n      // Tick text\n      yAxis\n        .selectAll('.tick text')\n        .attr('font-size', vm._addStyle.yAxis.labels.fontSize)\n        .attr('font-weight', vm._addStyle.yAxis.labels.fontWeight)\n        .attr('fill', vm._addStyle.yAxis.labels.textColor)\n        .attr('text-anchor', vm._addStyle.yAxis.labels.textAnchor)\n        .attr(\n          'transform',\n          'translate(-' + vm._addStyle.yAxis.axis.paddingTick + ', 0)'\n        );\n    }\n\n    // Style X axis\n    if (vm._config.xAxis.enabled !== false && vm._addStyle.xAxis.enabled) {\n      // Axis line\n      vm._xAxis\n        .selectAll('.domain')\n        .attr('stroke-linecap', 'round')\n        .attr('stroke-width', vm._addStyle.xAxis.axis.strokeWidth)\n        .attr('stroke', vm._addStyle.xAxis.axis.strokeColor)\n        .attr('opacity', vm._addStyle.xAxis.axis.strokeOpacity);\n\n      // Tick lines\n      vm._xAxis\n        .selectAll('.tick line')\n        .attr('stroke-width', vm._addStyle.xAxis.ticks.strokeWidth)\n        .attr('stroke', vm._addStyle.xAxis.ticks.strokeColor)\n        .attr(\n          'transform',\n          'translate(0, ' + vm._addStyle.xAxis.axis.paddingTick + ')'\n        );\n      // Don't draw first tick when styled as grid\n      if (vm._addStyle.xAxis.ticks.grid) {\n        vm._xAxis\n          .selectAll('.tick:first-of-type line:first-of-type')\n          .attr('stroke', 'none');\n      }\n\n      // Tick text\n      vm._xAxis\n        .selectAll('.tick text')\n        .attr('font-size', vm._addStyle.xAxis.labels.fontSize)\n        .attr('font-weight', vm._addStyle.xAxis.labels.fontWeight)\n        .attr('fill', vm._addStyle.xAxis.labels.textColor)\n        .attr('text-anchor', vm._addStyle.xAxis.labels.textAnchor)\n        .attr(\n          'transform',\n          vm._addStyle.xAxis.labels.rotate\n            ? 'translate(0,55) rotate(' +\n                vm._addStyle.xAxis.axis.labels.rotate +\n                ')'\n            : 'translate(0, ' + vm._addStyle.xAxis.axis.paddingTick + ')'\n        );\n    }\n\n    const biggestLabelWidth = d3.max(\n      d3\n        .select('.x.axis')\n        .selectAll('text')\n        .nodes()\n        .map((o) => o.getComputedTextLength())\n    );\n    if (\n      !vm._config.xAxis ||\n      (vm._config.xAxis && vm._config.xAxis.enabled !== false)\n    ) {\n      // Add ellipsis to cut label text\n      // when it is too long\n\n      // Biggest label computed text length\n\n      let xBandWidth =\n        (vm._scales.x.bandwidth\n          ? vm._scales.x.bandwidth()\n          : (vm._config.size.width -\n              (vm._config.size.margin.left + vm._config.size.margin.right)) /\n            vm._scales.x.ticks()) - 5;\n      if (biggestLabelWidth > xBandWidth) {\n        vm._addStyle.xAxis.labels.rotate = true;\n        // Biggest label doesn't fit\n        vm._xAxis.selectAll('text').each(function (d) {\n          if (typeof d === 'string') {\n            // Vertical labels\n            d3.select(this)\n              .attr('text-anchor', 'end')\n              .attr('dy', 0)\n              .attr('transform', 'translate(-6,12)rotate(-90)');\n            // Still doesn't fit!\n            if (\n              this.getComputedTextLength() >\n              0.8 * vm._config.size.margin.bottom\n            ) {\n              d3.select(this)\n                .on('mouseover', axesTip.show)\n                .on('mouseout', axesTip.hide);\n              let i = 1;\n              while (\n                this.getComputedTextLength() >\n                0.8 * vm._config.size.margin.bottom\n              ) {\n                d3.select(this)\n                  .text(function (d) {\n                    return d.slice(0, -i) + '...';\n                  })\n                  .attr('title', d);\n                ++i;\n              }\n            } else {\n              return d;\n            }\n          }\n        });\n      }\n    }\n\n    if (vm._config.xAxis.enabled !== false && vm._addStyle.xAxis.enabled) {\n      // Axis title\n      vm._xAxis\n        .selectAll('.axis-title')\n        .attr('font-size', vm._addStyle.xAxis.title.fontSize)\n        .attr('font-weight', vm._addStyle.xAxis.title.fontWeight)\n        .attr('fill', vm._addStyle.xAxis.title.textColor)\n        .attr('text-anchor', vm._addStyle.xAxis.title.textAnchor)\n        .attr(\n          'transform',\n          'translate(0, ' +\n            (vm._addStyle.xAxis.labels.rotate\n              ? d3.min([vm._config.size.margin.bottom * 0.7, biggestLabelWidth])\n              : vm._addStyle.xAxis.axis.paddingTick) +\n            ')'\n        );\n    }\n\n    /**\n     * Already replaced with addStyle\n     */\n    /*if (vm._config.yAxis && vm._config.yAxis.enabled !== false) {\n\n      if (vm._config.yAxis && vm._config.yAxis.text) {\n        yAxis.append('text')\n          .attr('class', 'label title')\n          .attr('transform', 'rotate(-90)')\n          .attr('y', vm._config.yAxis.y ? vm._config.yAxis.y : -50)\n          .attr('x', -150)\n          .attr('dy', '.71em')\n          .style('text-anchor', 'middle')\n          .style('fill', vm._config.yAxis.fill ? vm._config.yAxis.fill : 'black')\n          .style('font-size', vm._config.yAxis['font-size'] ? vm._config.yAxis['font-size'] : '12px')\n          .style('font-weight', vm._config.xAxis['font-weight'] ? vm._config.xAxis['font-weight'] : '600')\n          .text(vm._config.yAxis.text);\n      }\n    }*/\n\n    // Set ticks straight or dashed, to be replaced with *addStyle -checked\n    if (\n      vm._config.yAxis.ticks &&\n      vm._config.yAxis.ticks.enabled &&\n      vm._config.yAxis.ticks.style\n    ) {\n      switch (vm._config.yAxis.ticks.style) {\n        case 'straightLine':\n          break;\n        case 'dashLine':\n          d3.selectAll('g.y.axis .tick line').attr('stroke-dasharray', '5, 5');\n          break;\n      }\n    }\n    // To be replaced with *addStyle -checked\n    if (\n      vm._config.yAxis.domain &&\n      vm._config.yAxis.domain.enabled &&\n      vm._config.yAxis.domain.stroke\n    ) {\n      d3.select('g.y.axis .domain').attr(\n        'stroke',\n        vm._config.yAxis.domain.stroke\n      );\n    }\n\n    // To be replaced with *addStyle -checked\n    if (\n      vm._config.yAxis.domain &&\n      vm._config.yAxis.domain.enabled &&\n      vm._config.yAxis.domain['stroke-width']\n    ) {\n      d3.select('g.y.axis .domain').attr(\n        'stroke-width',\n        vm._config.yAxis.domain['stroke-width']\n      );\n    }\n\n    // y\n\n    /////////////////////////////\n\n    // x\n\n    if (\n      !vm._config.xAxis ||\n      (vm._config.xAxis && vm._config.xAxis.enabled !== false)\n    ) {\n      // To be replaced with *addStyle -checked\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.style) {\n        Object.keys(vm._config.xAxis.ticks.style).forEach(function (k) {\n          vm._xAxis.selectAll('text').style(k, vm._config.xAxis.ticks.style[k]);\n        });\n      }\n\n      // Set rotation for ticks, to be replaced with *addStyle -checked\n      if (vm._config.xAxis.ticks && vm._config.xAxis.ticks.rotate) {\n        vm._xAxis\n          .selectAll('text')\n          .attr('text-anchor', 'end')\n          .attr('transform', 'rotate(' + vm._config.xAxis.ticks.rotate + ')');\n      }\n\n      // Set ticks straight or dashed, to be replaced with *addStyle -checked\n      if (\n        vm._config.xAxis.ticks &&\n        vm._config.xAxis.ticks.enabled &&\n        vm._config.xAxis.ticks.style\n      ) {\n        switch (vm._config.xAxis.ticks.style) {\n          case 'straightLine':\n            break;\n          case 'dashLine':\n            d3.selectAll(vm._config.bindTo + ' g.x.axis .tick line').attr(\n              'stroke-dasharray',\n              '5, 5'\n            );\n            break;\n        }\n      }\n    }\n\n    // To be replaced with *addStyle -checked\n    if (\n      vm._config.xAxis.domain &&\n      vm._config.xAxis.domain.enabled &&\n      vm._config.xAxis.domain.stroke\n    ) {\n      d3.select(vm._config.bindTo + ' g.x.axis .domain').attr(\n        'stroke',\n        vm._config.xAxis.domain.stroke\n      );\n    }\n\n    // To be replaced with *addStyle -checked\n    if (\n      vm._config.xAxis.domain &&\n      vm._config.xAxis.domain.enabled &&\n      vm._config.xAxis.domain['stroke-width']\n    ) {\n      d3.select(vm._config.bindTo + ' g.x.axis .domain').attr(\n        'stroke-width',\n        vm._config.xAxis.domain['stroke-width']\n      );\n    }\n  };\n\n  Chart.updateAxis = function (axis, value) {\n    var vm = this;\n\n    if (axis === 'x') {\n      vm._config.xAxis.dropdown.options.map((obj) => {\n        if (obj.value === value) {\n          obj.selected = true;\n        } else {\n          obj.selected = false;\n        }\n      });\n    } else if (axis === 'y') {\n      vm._config.yAxis.dropdown.options.map((obj) => {\n        if (obj.value === value) {\n          obj.selected = true;\n        } else {\n          obj.selected = false;\n        }\n      });\n    }\n\n    vm._config[axis] = value;\n\n    var layer = vm.layers[0];\n\n    layer._config = vm._config;\n\n    vm.draw();\n\n    // Trigger update chart axis\n    if (vm._config.events && vm._config.events.change) {\n      vm.dispatch.on('change.axis', vm._config.events.change(vm));\n    }\n  };\n\n  Chart.dispatch = d3.dispatch('load', 'change');\n\n  Chart.mapData = function (data, callback) {\n    callback(null, data);\n  };\n\n  Chart.getDomains = function (data) {\n    var vm = this;\n\n    var domains = {};\n    var minMax = [];\n    var sorted = [];\n\n    // Default ascending function\n    var sortFunctionY = function (a, b) {\n      return vm.utils.sortAscending(a.y, b.y);\n    };\n    var sortFunctionX = function (a, b) {\n      return vm.utils.sortAscending(a.x, b.x);\n    };\n\n    // If applying sort\n    if (vm._config.data.sort && vm._config.data.sort.order) {\n      switch (vm._config.data.sort.order) {\n        case 'asc':\n          sortFunctionY = function (a, b) {\n            return vm.utils.sortAscending(a.y, b.y);\n          };\n          sortFunctionX = function (a, b) {\n            return vm.utils.sortAscending(a.x, b.x);\n          };\n          break;\n\n        case 'desc':\n          sortFunctionY = function (a, b) {\n            return vm.utils.sortDescending(a.y, b.y);\n          };\n          sortFunctionX = function (a, b) {\n            return vm.utils.sortDescending(a.x, b.x);\n          };\n          break;\n      }\n    }\n\n    // xAxis\n    if (vm._config.xAxis && vm._config.xAxis.scale) {\n      switch (vm._config.xAxis.scale) {\n        case 'linear':\n          minMax = d3.extent(data, function (d) {\n            return d.x;\n          });\n          domains.x = minMax;\n          break;\n\n        case 'time':\n          minMax = d3.extent(data, function (d) {\n            return d.x;\n          });\n          domains.x = minMax;\n          break;\n\n        case 'ordinal':\n          // If the xAxis' order depends on the yAxis values\n          if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n            sorted = data.sort(sortFunctionY);\n          } else {\n            sorted = data.sort(sortFunctionX);\n          }\n\n          domains.x = [];\n          sorted.forEach(function (d) {\n            domains.x.push(d.x);\n          });\n\n          break;\n\n        case 'quantile':\n          // The xAxis order depends on the yAxis values\n          if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n            sorted = data.sort(sortFunctionY);\n          } else {\n            sorted = data.sort(sortFunctionX);\n          }\n\n          domains.q = [];\n          sorted.forEach(function (d) {\n            domains.q.push(d.x);\n          });\n\n          domains.x = d3.range(vm._config.xAxis.buckets);\n\n          break;\n\n        default:\n          minMax = d3.extent(data, function (d) {\n            return d.x;\n          });\n          domains.x = minMax;\n          break;\n      }\n    } else {\n      minMax = d3.extent(data, function (d) {\n        return d.x;\n      });\n      domains.x = minMax;\n    }\n\n    // yAxis\n    if (vm._config.yAxis && vm._config.yAxis.scale) {\n      switch (vm._config.yAxis.scale) {\n        case 'linear':\n          minMax = d3.extent(data, function (d) {\n            return d.y;\n          });\n\n          // Adjust for min values greater than zero\n          // Set the min value to -10%\n          if (minMax[0] > 0) {\n            minMax[0] = minMax[0] - (minMax[1] - minMax[0]) * 0.1;\n          }\n          domains.y = minMax;\n          break;\n\n        case 'time':\n          minMax = d3.extent(data, function (d) {\n            return d.y;\n          });\n          domains.y = minMax;\n          break;\n\n        case 'ordinal':\n          if (vm._config.data.sort && vm._config.data.sort.axis === 'y') {\n            sorted = data.sort(function (a, b) {\n              return vm.utils.sortAscending(a.y, b.y);\n            });\n            domains.y = [];\n            sorted.forEach(function (d) {\n              domains.y.push(d.x);\n            });\n          } else {\n            domains.y = d3\n              .map(data, function (d) {\n                return d.y;\n              })\n              .keys()\n              .sort(function (a, b) {\n                return vm.utils.sortAscending(a, b);\n              });\n          }\n\n          break;\n\n        default:\n          minMax = d3.extent(data, function (d) {\n            return d.y;\n          });\n          domains.y = minMax;\n          break;\n      }\n    } else {\n      minMax = d3.extent(data, function (d) {\n        return d.y;\n      });\n      domains.y = minMax;\n    }\n\n    return domains;\n  };\n\n  Chart.destroy = function () {\n    var vm = this;\n    d3.select(vm._config.bindTo).html('');\n  };\n\n  Chart.init(config);\n\n  return Chart;\n}\n","import * as d3 from 'd3';\nimport * as _ from 'lodash';\n\n/*\n * Simple Bar chart\n */\nexport default function(config, helper) {\n  //Link Bars to the helper object in helper.js\n  var Bars = Object.create(helper);\n\n  Bars.init = function(config) {\n    var vm = this;\n\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    console.log(vm._config);\n    vm._tip = vm.utils.d3\n      .tip()\n      .attr(\n        'class',\n        'd3-tip ' +\n          (vm._config.tooltip && vm._config.tooltip.classed\n            ? vm._config.tooltip.classed\n            : '')\n      )\n      .direction('n')\n      .html(\n        vm._config.tip ||\n          function(d) {\n            var html = '';\n            html += d[vm._config.x]\n              ? '<span>' +\n                (Number.isNaN(+d[vm._config.x]) ||\n                vm._config.xAxis.scale === 'band'\n                  ? d[vm._config.x]\n                  : vm.utils.format(vm._config.xAxis)(d[vm._config.x])) +\n                '</span></br>'\n              : '';\n            html += d[vm._config.y]\n              ? '<span>' +\n                (Number.isNaN(+d[vm._config.y]) ||\n                vm._config.yAxis.scale === 'band'\n                  ? d[vm._config.y]\n                  : vm.utils.format(vm._config.yAxis)(d[vm._config.y])) +\n                '</span></br>'\n              : '';\n            return html;\n          }\n      );\n  };\n\n  //-------------------------------\n  //User config functions\n  Bars.id = function(columnName) {\n    var vm = this;\n    vm._config.id = columnName;\n    return vm;\n  };\n\n  Bars.x = function(columnName) {\n    var vm = this;\n    vm._config.x = columnName;\n    return vm;\n  };\n\n  Bars.y = function(columnName) {\n    var vm = this;\n    vm._config.y = columnName;\n    return vm;\n  };\n\n  /**\n   * Used to draw a bar chart with multiple bars per group\n   * @param {array} columns\n   */\n  Bars.groupBy = function(columns) {\n    var vm = this;\n    vm._config.groupBy = columns;\n    return vm;\n  };\n\n  /**\n   * Used to draw a bar chart stacked with multiple bars per group\n   * @param {array} columns\n   */\n  Bars.stackBy = function(columnName) {\n    var vm = this;\n    vm._config.stackBy = columnName;\n    return vm;\n  };\n\n  /**\n   * column name used for the domain values\n   * @param {string} columnName\n   */\n  Bars.fill = function(columnName) {\n    var vm = this;\n    vm._config.fill = columnName;\n    return vm;\n  };\n\n  /**\n   * array of values used\n   * @param {array or scale} columnName\n   */\n  Bars.colors = function(colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      // Using an array of colors for the range\n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Bars.sortBy = function(option) {\n    //option = string [asc,desc]\n    //option = array for groupBy and stackBy\n    var vm = this;\n    vm._config.sortBy = option;\n    return vm;\n  };\n\n  Bars.format = function(format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function) {\n      vm.utils.format = format;\n    } else {\n      vm.utils.format = d3.format(format);\n    }\n    return vm;\n  };\n\n  Bars.tip = function(tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    return vm;\n  };\n\n  Bars.legend = function(legend) {\n    var vm = this;\n    vm._config.legend = legend;\n    return vm;\n  };\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Bars.data = function(data) {\n    var vm = this;\n\n    if (vm._config.filter) {\n      //In case we want to filter observations\n      data = data.filter(vm._config.filter);\n    }\n\n    if (\n      vm._config.hasOwnProperty('stackBy') &&\n      Array.isArray(vm._config.stackBy) &&\n      vm._config.stackBy.length > 0\n    ) {\n      // Used in a stackbar, transpose the data into layers\n      vm._data = d3.stack().keys(vm._config.stackBy)(data);\n    } else {\n      // Normal bar, save the data as numbers\n      vm._data = data.map(function(d) {\n        if (d[vm._config.x] == Number(d[vm._config.x]))\n          d[vm._config.x] = +d[vm._config.x];\n        if (d[vm._config.y] == Number(d[vm._config.y]))\n          d[vm._config.y] = +d[vm._config.y];\n        return d;\n      });\n    }\n\n    //@TODO - ALLOW MULITPLE SORTS\n    if (vm._config.sortBy) {\n      vm._data = vm._data.sort(function(a, b) {\n        return a[vm._config.sortBy[0]] - b[vm._config.sortBy[0]];\n      });\n    }\n\n    if (vm._config.hasOwnProperty('quantiles')) {\n      vm._quantiles = vm._setQuasecondntile(data);\n      vm._minMax = d3.extent(data, function(d) {\n        return +d[vm._config.fill];\n      });\n    }\n\n    return vm;\n  };\n\n  Bars.scales = function() {\n    var vm = this;\n    var config;\n    // vm._scales = scales;\n    /* Use\n     * vm._config.x\n     * vm._config.xAxis.scale\n     * vm._config.y\n     * vm._config.yAxis.scale\n     * vm._data\n     */\n    //Normal bars\n    if (vm._config.hasOwnProperty('x') && vm._config.hasOwnProperty('y')) {\n      config = {\n        column: vm._config.x,\n        type: vm._config.xAxis.scale,\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      config = {\n        column: vm._config.y,\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    //GroupBy bars on the xAxis\n    if (\n      vm._config.hasOwnProperty('x') &&\n      vm._config.hasOwnProperty('groupBy')\n    ) {\n      /* Generate x scale */\n      config = {\n        column: vm._config.x,\n        type: vm._config.xAxis.scale,\n        groupBy: 'parent',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate groupBy scale */\n      config = {\n        column: vm._config.groupBy,\n        type: 'band',\n        groupBy: 'children',\n        range: [0, vm._scales.x.bandwidth()]\n      };\n      vm._scales.groupBy = vm.utils.generateScale(vm._data, config);\n      //vm.chart.scales.groupBy = vm._scales.groupBy;\n\n      /* Generate y scale */\n      config = {\n        column: vm._config.groupBy,\n        type: vm._config.yAxis.scale,\n        groupBy: 'data',\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    //GroupBy bars on the yAxis\n    if (\n      vm._config.hasOwnProperty('y') &&\n      vm._config.hasOwnProperty('groupBy')\n    ) {\n      /* Generate y scale */\n      config = {\n        column: vm._config.y,\n        type: vm._config.yAxis.scale,\n        groupBy: 'parent',\n        range: [0, vm.chart.height],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n\n      /* Generate groupBy scale */\n      config = {\n        column: vm._config.groupBy,\n        type: 'band',\n        groupBy: 'children',\n        range: [0, vm._scales.y.bandwidth()]\n      };\n      vm._scales.groupBy = vm.utils.generateScale(vm._data, config);\n      //vm.chart.scales.groupBy = vm._scales.groupBy;\n\n      /* Generate x scale */\n      config = {\n        column: vm._config.groupBy,\n        type: vm._config.xAxis.scale,\n        groupBy: 'data',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n    }\n\n    //Stack bars on the xAxis\n    if (\n      vm._config.hasOwnProperty('x') &&\n      vm._config.hasOwnProperty('stackBy')\n    ) {\n      /* Generate x scale */\n      config = {\n        column: vm._config.x,\n        type: vm._config.xAxis.scale,\n        stackBy: 'parent',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate y scale */\n      config = {\n        column: '',\n        stackBy: 'data',\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    // Stack bars on the yAxis\n    if (\n      vm._config.hasOwnProperty('y') &&\n      vm._config.hasOwnProperty('stackBy')\n    ) {\n      /* Generate x scale */\n      config = {\n        column: '',\n        type: vm._config.xAxis.scale,\n        stackBy: 'data',\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero\n      };\n      if (vm._config.xAxis.domains) {\n        config.domains = vm._config.xAxis.domains;\n      }\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate y scale */\n      config = {\n        column: vm._config.y,\n        stackBy: 'parent',\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero\n      };\n      if (vm._config.yAxis.domains) {\n        config.domains = vm._config.yAxis.domains;\n      }\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    //vm.chart.scales.x = vm._scales.x;\n    //vm.chart.scales.y = vm._scales.y;\n\n    if (\n      !vm._scales.color ||\n      (vm._scales.color && vm._scales.color.domain().length === 0)\n    ) {\n      if (vm._config.hasOwnProperty('colors')) {\n        vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n      } else {\n        vm._scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n      }\n      if (vm._data && vm._data.length > 0) {\n        vm._scales.color.domain(_.uniq(vm._data.map(d => d[vm._config.fill])));\n      }\n      if (vm._config.legend && vm._config.legend.length > 0) {\n        vm._scales.color.domain(vm._config.legend.map(d => d.name));\n      }\n      return vm;\n    }\n  };\n\n  Bars.drawLabels = function() {\n    var vm = this;\n\n    var charContainer = vm.chart\n      .svg()\n      .selectAll('.dbox-label')\n      .data(vm._data);\n\n    charContainer\n      .enter()\n      .append('text')\n      .attr('class', 'dbox-label')\n      .attr('x', function(d) {\n        var value = vm._scales.x(d[vm._config.x]);\n        if (vm._config.xAxis.scale == 'linear') {\n          if (d[vm._config.x] > 0) {\n            value = vm._scales.x(0);\n          }\n        }\n        return value;\n      })\n      .attr('y', function(d) {\n        var value = vm._scales.y(d[vm._config.y]);\n        var barH = vm._scales.y.bandwidth\n          ? vm._scales.y.bandwidth()\n          : Math.abs(vm._scales.y(d[vm._config.y]) - vm._scales.y(0));\n        if (vm._config.yAxis.scale === 'linear') {\n          if (d[vm._config.y] < 0) {\n            value = vm._scales.y(0);\n          }\n        } else if (vm._config.yAxis.scale !== 'linear') {\n          value = value + barH;\n        }\n        // if (barH < 50) {\n        //   return value - 30;\n        // }\n        return value - 7;\n      })\n      .attr('transform', function(d) {\n        var barW = vm._scales.x.bandwidth\n          ? vm._scales.x.bandwidth()\n          : Math.abs(vm._scales.x(d[vm._config.x]) - vm._scales.x(0));\n        if (!isNaN(d[vm._config.y])) {\n          return 'translate(' + barW / 2 + ', 0)';\n        }\n        return 'translate(' + (barW + 30) + ', 0)';\n      })\n      .attr('text-anchor', 'middle')\n      .text(function(d) {\n        if (!isNaN(d[vm._config.y])) {\n          return vm.utils.format(vm._config.yAxis)(d[vm._config.y])\n            ? vm.utils.format(vm._config.yAxis, true)(d[vm._config.y])\n            : '';\n        }\n        return vm.utils.format(vm._config.xAxis)(d[vm._config.x])\n          ? vm.utils.format(vm._config.xAxis, true)(d[vm._config.x])\n          : '';\n      });\n\n    // charContainer.enter().append('text')\n    //   .attr('class', 'dbox-label-coefficient dbox-label-bars-coefficient')\n    //   .attr('x', function (d) {\n    //     var value = vm._scales.x(d[vm._config.x]);\n    //     if (vm._config.xAxis.scale == 'linear') {\n    //       if (d[vm._config.x] > 0) {\n    //         value = vm._scales.x(0);\n    //       }\n    //     }\n    //     return value;\n    //   })\n    //   .attr('y', function (d) {\n    //     var value =  vm._scales.y(d[vm._config.y]);\n    //     var barH = vm._scales.y.bandwidth ? vm._scales.y.bandwidth() : Math.abs(vm._scales.y(d[vm._config.y]) - vm._scales.y(0));\n    //     if (vm._config.yAxis.scale === 'linear') {\n    //       if (d[vm._config.y] < 0) {\n    //         value = vm._scales.y(0);\n    //       }\n    //     }\n    //     // if (barH < 50) {\n    //     //   return value - 32;\n    //     // }\n    //     return value + 35;\n    //   })\n    //   .attr('transform', function(d) {\n    //     var barW = vm._scales.x.bandwidth ? vm._scales.x.bandwidth() : Math.abs(vm._scales.x(d[vm._config.x]) - vm._scales.x(0));\n    //     if (!isNaN(d[vm._config.y])) {\n    //       return 'translate(' + barW/2 + ', 0)';\n    //     }\n    //     return 'translate(' + (barW + 30) + ', 0)';\n    //   })\n    //   .attr('text-anchor', 'middle')\n    //   .text( function(d) {\n    //     return (d.coefficient && !Number.isNaN(d.coefficient)) ? '(' + d.coefficient.toFixed(1) + ')' : '(-)';\n    //   });\n  };\n\n  Bars.draw = function() {\n    var vm = this;\n    if (vm._config.hasOwnProperty('groupBy')) {\n      if (vm._config.hasOwnProperty('x')) vm._drawGroupByXAxis();\n      if (vm._config.hasOwnProperty('y')) vm._drawGroupByYAxis();\n      return vm;\n    }\n\n    if (vm._config.hasOwnProperty('stackBy')) {\n      if (vm._config.hasOwnProperty('x')) vm._drawStackByXAxis();\n      if (vm._config.hasOwnProperty('y')) vm._drawStackByYAxis();\n      return vm;\n    }\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart\n      .svg()\n      .selectAll('.bar')\n      .data(vm._data)\n      .enter()\n      .append('rect')\n      .attr('class', 'bar')\n      .attr('id', function(d, i) {\n        var id = 'bars-' + i;\n        if (vm._config.id) {\n          id = 'bars-' + d[vm._config.id];\n        }\n        return id;\n      })\n      .attr('x', function(d) {\n        var value = vm._scales.x(d[vm._config.x]);\n        if (vm._config.xAxis.scale == 'linear') {\n          if (d[vm._config.x] > 0) {\n            value = vm._scales.x(0);\n          }\n        }\n        return value;\n      })\n      .attr('y', function(d) {\n        var value = vm._scales.y(d[vm._config.y]);\n        if (vm._config.yAxis.scale === 'linear') {\n          if (d[vm._config.y] < 0) {\n            value = vm._scales.y(0);\n          }\n        }\n        return value;\n      })\n      .attr('width', function(d) {\n        return vm._scales.x.bandwidth\n          ? vm._scales.x.bandwidth()\n          : Math.abs(vm._scales.x(d[vm._config.x]) - vm._scales.x(0));\n      })\n      .attr('height', function(d) {\n        return vm._scales.y.bandwidth\n          ? vm._scales.y.bandwidth()\n          : Math.abs(vm._scales.y(d[vm._config.y]) - vm._scales.y(0));\n      })\n      .attr('fill', function(d) {\n        return vm._scales.color !== false\n          ? vm._scales.color(d[vm._config.fill])\n          : vm._getQuantileColor(d[vm._config.fill], 'default');\n      })\n      .style('opacity', 0.9)\n      .on('mouseover', function(d, i) {\n        if (\n          vm._config.hasOwnProperty('quantiles') &&\n          vm._config.quantiles.hasOwnProperty('colorsOnHover')\n        ) {\n          //OnHover colors\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call, must be after all the internal code; allowing the user to overide\n          vm._config.onmouseover.call(this, d, i);\n        }\n      })\n      .on('mouseout', function(d, i) {\n        if (\n          vm._config.hasOwnProperty('quantiles') &&\n          vm._config.quantiles.hasOwnProperty('colorsOnHover')\n        ) {\n          //OnHover reset default color\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) {\n          //External function call, must be after all the internal code; allowing the user to overide\n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function(d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n    Bars.drawLabels();\n\n    return vm;\n  };\n\n  /**\n   * Draw bars grouped by\n   */\n\n  Bars.drawGroupLabels = function() {\n    var vm = this;\n\n    vm.chart\n      .svg()\n      .selectAll('.grouped')\n      .each(function() {\n        var el = this;\n\n        d3.select(this)\n          .selectAll('rect')\n          .each(function(dat, index) {\n            d3.select(el)\n              .append('text')\n              .attr('class', 'dbox-label')\n              .attr('transform', function(d) {\n                var barReference = vm._scales.groupBy.bandwidth();\n                if (vm._config.x) {\n                  //if (Math.abs(vm._scales.y(d[vm._config.groupBy[index]]) - vm._scales.y(0)) < 50) {\n                  return (\n                    'translate(' +\n                    (vm._scales.groupBy(vm._config.groupBy[index]) +\n                      barReference / 2) +\n                    ',' +\n                    (vm._scales.y(d[vm._config.groupBy[index]]) - 7) +\n                    ')'\n                  );\n                  //}\n                  //return 'translate(' + (vm._scales.groupBy(vm._config.groupBy[index]) + 30) + ',' + (vm._scales.y(d[vm._config.groupBy[index]]) + 20) + ')';\n                } else {\n                  return (\n                    'translate(' +\n                    (vm._scales.x(d[vm._config.groupBy[index]]) + 26) +\n                    ',' +\n                    (vm._scales.groupBy(vm._config.groupBy[index]) +\n                      barReference) +\n                    ')'\n                  );\n                }\n              })\n              .attr('text-anchor', 'middle')\n              .text(function(d) {\n                return d[vm._config.groupBy[index]]\n                  ? vm.utils.format(\n                      undefined,\n                      true\n                    )(d[vm._config.groupBy[index]])\n                  : '';\n              });\n\n            d3.select(el)\n              .append('text')\n              .attr('class', 'dbox-label-coefficient')\n              .attr('transform', function(d) {\n                if (vm._config.x) {\n                  if (\n                    Math.abs(\n                      vm._scales.y(d[vm._config.groupBy[index]]) -\n                        vm._scales.y(0)\n                    ) < 50\n                  ) {\n                    return (\n                      'translate(' +\n                      (vm._scales.groupBy(vm._config.groupBy[index]) + 30) +\n                      ',' +\n                      vm._scales.y(d[vm._config.groupBy[index]]) +\n                      ')'\n                    );\n                  }\n                  return (\n                    'translate(' +\n                    (vm._scales.groupBy(vm._config.groupBy[index]) + 30) +\n                    ',' +\n                    (vm._scales.y(d[vm._config.groupBy[index]]) + 40) +\n                    ')'\n                  );\n                } else {\n                  return (\n                    'translate(' +\n                    (vm._scales.x(d[vm._config.groupBy[index]]) + 26) +\n                    ',' +\n                    (vm._scales.groupBy(vm._config.groupBy[index]) + 30) +\n                    ')'\n                  );\n                }\n              })\n              .attr('text-anchor', 'middle')\n              .text(function(d) {\n                return d[vm._config.groupBy[index] + 'coefficient'] &&\n                  !Number.isNaN(d[vm._config.groupBy[index] + 'coefficient'])\n                  ? '(' +\n                      d[vm._config.groupBy[index] + 'coefficient'].toFixed(1) +\n                      ')'\n                  : '';\n              });\n          });\n      });\n  };\n\n  Bars._drawGroupByXAxis = function() {\n    var vm = this;\n    vm._tip.html(\n      vm._config.tip ||\n        function(d) {\n          let html = d.key + '<br>';\n          if (d.axis !== d.key) {\n            html += d.axis + '<br>';\n          }\n          html += vm.utils.format()(d.value);\n          return html;\n        }\n    );\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart\n      .svg()\n      .append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter()\n      .append('g')\n      .attr('class', 'grouped')\n      .attr('transform', function(d) {\n        return 'translate(' + vm._scales.x(d[vm._config.x]) + ',0)';\n      })\n      .selectAll('rect')\n      .data(function(d) {\n        return vm._config.groupBy.map(function(key) {\n          return {\n            key: key,\n            value: d[key],\n            axis: d[vm._config.x]\n          };\n        });\n      })\n      .enter()\n      .append('rect')\n      .attr('x', function(d) {\n        return vm._scales.groupBy(d.key);\n      })\n      .attr('y', function(d) {\n        if (d.value > 0) {\n          return vm._scales.y(d.value);\n        } else {\n          return vm._scales.y(0);\n        }\n      })\n      .attr('width', vm._scales.groupBy.bandwidth())\n      .attr('height', function(d) {\n        return Math.abs(vm._scales.y(d.value) - vm._scales.y(0));\n      })\n      .attr('fill', function(d) {\n        return vm._scales.color(d.key);\n      })\n      .on('mouseover', function(d, i) {\n        if (\n          vm._config.hasOwnProperty('quantiles') &&\n          vm._config.quantiles.hasOwnProperty('colorsOnHover')\n        ) {\n          //OnHover colors\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide\n          vm._config.onmouseover.call(this, d, i);\n        }\n      })\n      .on('mouseout', function(d, i) {\n        if (\n          vm._config.hasOwnProperty('quantiles') &&\n          vm._config.quantiles.hasOwnProperty('colorsOnHover')\n        ) {\n          // OnHover colors\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) {\n          // External function call, must be after all the internal code; allowing the user to overide\n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function(d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n    Bars.drawGroupLabels();\n  };\n\n  Bars._drawGroupByYAxis = function() {\n    var vm = this;\n    vm._tip.html(\n      vm._config.tip ||\n        function(d) {\n          let html = d.key + '<br>';\n          if (d.axis !== d.key) {\n            html += d.axis + '<br>';\n          }\n          html += vm.utils.format()(d.value);\n          return html;\n        }\n    );\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart\n      .svg()\n      .append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter()\n      .append('g')\n      .attr('class', 'grouped')\n      .attr('transform', function(d) {\n        return 'translate(0,' + vm._scales.y(d[vm._config.y]) + ' )';\n      })\n      .selectAll('rect')\n      .data(function(d) {\n        return vm._config.groupBy.map(function(key) {\n          return {\n            key: key,\n            value: d[key],\n            axis: d[vm._config.y]\n          };\n        });\n      })\n      .enter()\n      .append('rect')\n      .attr('y', function(d) {\n        return vm._scales.groupBy(d.key);\n      })\n      .attr('x', function(d) {\n        if (d < 0) {\n          return vm._scales.x(d.value);\n        } else {\n          return vm._scales.x(0);\n        }\n      })\n      .attr('width', function(d) {\n        return Math.abs(vm._scales.x(d.value) - vm._scales.x(0));\n      })\n      .attr('height', vm._scales.groupBy.bandwidth())\n      .attr('fill', function(d) {\n        return vm._scales.color(d.key);\n      })\n      .on('mouseover', function(d, i) {\n        if (\n          vm._config.hasOwnProperty('quantiles') &&\n          vm._config.quantiles.hasOwnProperty('colorsOnHover')\n        ) {\n          //OnHover colors\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide\n          vm._config.onmouseover.call(this, d, i);\n        }\n      })\n      .on('mouseout', function(d, i) {\n        if (\n          vm._config.hasOwnProperty('quantiles') &&\n          vm._config.quantiles.hasOwnProperty('colorsOnHover')\n        ) {\n          //OnHover reset default color\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) {\n          //External function call, must be after all the internal code; allowing the user to overide\n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function(d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n    Bars.drawGroupLabels();\n  };\n\n  /**\n   * Draw Stack Labels\n   */\n  Bars.drawStackLabels = function() {\n    var vm = this;\n    var groups = vm.chart.svg().selectAll('.division');\n    let index = 0;\n    groups.each(function(data) {\n      var stacks = d3\n        .select(this)\n        .selectAll('rect')\n        .nodes();\n      // Get rect height to condition label drawing\n      data.forEach(d => {\n        var el = this;\n        var dat = d;\n        var rect = stacks[index];\n        index++;\n        var rectH = rect.getBBox().height;\n        //var rectW = rect.getBBox().width;\n        if (rectH > 35) {\n          d3.select(el)\n            .append('text')\n            .attr('class', 'dbox-label')\n            .attr('text-anchor', 'middle')\n            .attr('transform', function() {\n              var barReference;\n              if (vm._config.x) {\n                barReference = vm._scales.x.bandwidth();\n                return (\n                  'translate(' +\n                  (vm._scales.x(dat.data[vm._config.x]) + barReference / 2) +\n                  ',' +\n                  (vm._scales.y(dat[1]) + 20) +\n                  ')'\n                );\n              }\n              barReference = vm._scales.y.bandwidth();\n              return (\n                'translate(' +\n                (vm._scales.x(dat.data[1]) - 30) +\n                ',' +\n                (vm._scales.y(dat.data[vm._config.y]) + barReference / 2) +\n                ')'\n              );\n            })\n            .text(function() {\n              return dat.data[data.key]\n                ? vm.utils.format(null, true)(dat.data[data.key])\n                : '';\n            });\n        }\n      });\n      index = 0;\n    });\n  };\n\n  /**\n   * Draw bars stacked by x axis\n   */\n  Bars._drawStackByXAxis = function() {\n    var vm = this;\n    vm._tip.html(\n      vm._config.tip ||\n        function(d) {\n          var html = '';\n          for (var k in d.data) {\n            if ((d[1] - d[0]).toFixed(12) === Number(d.data[k]).toFixed(12)) {\n              html += k + '<br>';\n            }\n          }\n          html += d.data[vm._config.x];\n          return html + '<br>' + vm.utils.format()(d[1] - d[0]);\n        }\n    );\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart\n      .svg()\n      .append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter()\n      .append('g')\n      .attr('class', 'division')\n      .attr('fill', function(d) {\n        return vm._scales.color(d.key);\n      })\n      //.attr('transform', function(d) { return 'translate(0,'+ vm._scales.y(d[vm._config.y]) +' )'; })\n      .selectAll('rect')\n      .data(function(d) {\n        return d;\n      })\n      .enter()\n      .append('rect')\n      .attr('y', function(d) {\n        return vm._scales.y(d[1]);\n      })\n      .attr('x', function(d) {\n        return vm._scales.x(d.data[vm._config.x]);\n      })\n      .attr('width', function() {\n        return vm._scales.x.bandwidth();\n      })\n      .attr('height', function(d) {\n        return vm._scales.y(d[0]) - vm._scales.y(d[1]);\n      })\n      .on('mouseover', function(d, i) {\n        if (\n          vm._config.hasOwnProperty('quantiles') &&\n          vm._config.quantiles.hasOwnProperty('colorsOnHover')\n        ) {\n          //OnHover colors\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide\n          vm._config.onmouseover.call(this, d, i);\n        }\n      })\n      .on('mouseout', function(d, i) {\n        if (\n          vm._config.hasOwnProperty('quantiles') &&\n          vm._config.quantiles.hasOwnProperty('colorsOnHover')\n        ) {\n          //OnHover reset default color\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) {\n          //External function call, must be after all the internal code; allowing the user to overide\n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function(d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n    Bars.drawStackLabels();\n  };\n\n  /**\n   * Draw bars stacked by y axis\n   */\n  Bars._drawStackByYAxis = function() {\n    var vm = this;\n    vm._tip.html(\n      vm._config.tip ||\n        function(d) {\n          var html = '';\n          for (var k in d.data) {\n            if ((d[1] - d[0]).toFixed(12) === Number(d.data[k]).toFixed(12)) {\n              html += k + '<br>';\n            }\n          }\n          html += d.data[vm._config.y];\n          return html + '<br>' + vm.utils.format()(d[1] - d[0]);\n        }\n    );\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart\n      .svg()\n      .append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter()\n      .append('g')\n      .attr('class', 'division')\n      .attr('fill', function(d) {\n        return vm._scales.color(d.key);\n      })\n      .selectAll('rect')\n      .data(function(d) {\n        return d;\n      })\n      .enter()\n      .append('rect')\n      .attr('y', function(d) {\n        return vm._scales.y(d.data[vm._config.y]);\n      })\n      .attr('x', function(d) {\n        return vm._scales.x(d[0]);\n      })\n      .attr('height', function() {\n        return vm._scales.y.bandwidth();\n      })\n      .attr('width', function(d) {\n        return vm._scales.x(d[1]) - vm._scales.x(d[0]);\n      })\n      .on('mouseover', function(d, i) {\n        if (\n          vm._config.hasOwnProperty('quantiles') &&\n          vm._config.quantiles.hasOwnProperty('colorsOnHover')\n        ) {\n          //OnHover colors\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide\n          vm._config.onmouseover.call(this, d, i);\n        }\n      })\n      .on('mouseout', function(d, i) {\n        if (\n          vm._config.hasOwnProperty('quantiles') &&\n          vm._config.quantiles.hasOwnProperty('colorsOnHover')\n        ) {\n          //OnHover reset default color\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) {\n          //External function call, must be after all the internal code; allowing the user to overide\n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function(d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n    Bars.drawStackLabels();\n  };\n\n  Bars._setQuantile = function(data) {\n    var vm = this;\n    var values = [];\n    var quantile = [];\n\n    if (\n      vm._config.quantiles &&\n      vm._config.quantiles.predefinedQuantiles &&\n      vm._config.quantiles.predefinedQuantiles.length > 0\n    ) {\n      return vm._config.quantiles.predefinedQuantiles;\n    }\n\n    data.forEach(function(d) {\n      values.push(+d[vm._config.fill]);\n    });\n\n    values.sort(d3.ascending);\n\n    //@TODO use quantile scale instead of manual calculations\n    if (vm._config && vm._config.quantiles && vm._config.quantiles.buckets) {\n      if (vm._config.quantiles.ignoreZeros === true) {\n        var aux = _.dropWhile(values, function(o) {\n          return o <= 0;\n        });\n        //aux.unshift(values[0]);\n\n        quantile.push(values[0]);\n        quantile.push(0);\n\n        for (var i = 1; i <= vm._config.quantiles.buckets - 1; i++) {\n          quantile.push(\n            d3.quantile(aux, (i * 1) / (vm._config.quantiles.buckets - 1))\n          );\n        }\n      } else {\n        quantile.push(d3.quantile(values, 0));\n        for (var j = 1; j <= vm._config.quantiles.buckets; j++) {\n          quantile.push(\n            d3.quantile(values, (j * 1) / vm._config.quantiles.buckets)\n          );\n        }\n      }\n    } else {\n      quantile = [\n        d3.quantile(values, 0),\n        d3.quantile(values, 0.2),\n        d3.quantile(values, 0.4),\n        d3.quantile(values, 0.6),\n        d3.quantile(values, 0.8),\n        d3.quantile(values, 1)\n      ];\n    }\n\n    //@TODO - VALIDATE WHEN ZEROS NEED TO BE PUT ON QUANTILE 1 AND RECALCULATE NON ZERO VALUES INTO THE REST OF THE BUCKETS\n    if (\n      vm._config.quantiles &&\n      vm._config.quantiles.buckets &&\n      vm._config.quantiles.buckets === 5\n    ) {\n      if (\n        quantile[1] === quantile[2] &&\n        quantile[2] === quantile[3] &&\n        quantile[3] === quantile[4] &&\n        quantile[4] === quantile[5]\n      ) {\n        quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2)];\n      }\n    }\n\n    return quantile;\n  };\n\n  Bars._getQuantileColor = function(d, type) {\n    var vm = this;\n    var total = parseFloat(d);\n\n    //@TODO use quantile scale instead of manual calculations\n    if (\n      vm._config &&\n      vm._config.bars.quantiles &&\n      vm._config.bars.quantiles.colors\n    ) {\n      if (vm._quantiles.length > 2) {\n        if (\n          vm._config &&\n          vm._config.bars.min !== undefined &&\n          vm._config.bars.max !== undefined\n        ) {\n          if (total < vm._config.bars.min || total > vm._config.bars.max) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        } else {\n          if (total < vm._minMax[0] || total > vm._minMax[1]) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        }\n\n        if (type == 'default') {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.bars.quantiles.colors[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.bars.quantiles.colors[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.bars.quantiles.colors[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colors[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colors[4]; //'#480000';\n          }\n        }\n\n        if (\n          type == 'onHover' &&\n          vm._config.hasOwnProperty('quantiles') &&\n          vm._config.quantiles.hasOwnProperty('colorsOnHover')\n        ) {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.quantiles.colorsOnHover[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.quantiles.colorsOnHover[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.quantiles.colorsOnHover[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colorsOnHover[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colorsOnHover[4]; //'#480000';\n          }\n        }\n      }\n    }\n\n    if (vm._quantiles.length == 2) {\n      /*if(total === 0 ){\n        return d4theme.colors.quantiles[0];//return '#fff';\n      }else if(total <= vm._quantiles[1]){\n        return d4theme.colors.quantiles[1];//return '#f7c7c5';\n      }*/\n      if (total <= vm._quantiles[1]) {\n        return vm._config.quantiles.colors[0]; //'#f7c7c5';\n      }\n    }\n  };\n\n  Bars.init(config);\n  return Bars;\n}\n","import * as d3 from 'd3';\n/**\n * @fileOverview A D3 based distribution chart system. Supports: Box plots, Violin plots, Notched box plots, trend lines, beeswarm plot\n * @version 3.0\n */\n\n\n/**\n * Creates a box plot, violin plot, and or notched box plot\n * @param settings Configuration options for the base plot\n * @param settings.data The data for the plot\n * @param settings.xName The name of the column that should be used for the x groups\n * @param settings.yName The name of the column used for the y values\n * @param {string} settings.selector The selector string for the main chart div\n * @param [settings.axisLabels={}] Defaults to the xName and yName\n * @param [settings.yTicks = 1] 1 = default ticks. 2 =  double, 0.5 = half\n * @param [settings.scale='linear'] 'linear' or 'log' - y scale of the chart\n * @param [settings.chartSize={width:800, height:400}] The height and width of the chart itself (doesn't include the container)\n * @param [settings.margin={top: 15, right: 60, bottom: 40, left: 50}] The margins around the chart (inside the main div)\n * @param [settings.constrainExtremes=false] Should the y scale include outliers?\n * @returns {object} chart A chart object\n */\nexport default function makeDistroChart(settings) {\n    var chart = {};\n\n    // Defaults\n    chart.settings = {\n      data: null,\n      id: null,\n      idName: null,\n      events: null,\n      xName: null,\n      xSort:null,\n      yName: null,\n      selector: null,\n      axisLables: null,\n      yTicks: 1,\n      scale: 'linear',\n      chartSize: {width: 800, height: 400},\n      margin: {top: 15, right: 60, bottom: 40, left: 50},\n      constrainExtremes: false,\n      color: d3.scaleOrdinal(d3.schemeCategory10)\n    };\n    for (var setting in settings) {\n      chart.settings[setting] = settings[setting]\n    }\n\n\n    function formatAsFloat(d) {\n      if (d % 1 !== 0) {\n        return d3.format(\",.2f\")(d);\n      } else {\n        return d3.format(\",.0f\")(d);\n      }\n    }\n    function formatNumber(d) {\n      var value = '';\n        if (d % 1 == 0) {\n        value = d3.format(',.0f')(d);\n        } else if (d < 1 && d > 0) {\n        value = d3.format(',.2f')(d);\n        } else {\n        value = d3.format(',.1f')(d);\n        }\n        return value;\n    }\n\n    function formatRange(d) {\n        var range = d.split(' - ');\n        var value = '';\n        for(var i = 0; i < range.length; i++){\n          if (range[i] % 1 == 0) {\n            value += d3.format(',.0f')(range[i]);\n          } else if (range[i] < 1 && range[i] > 0) {\n            value += d3.format(',.2f')(range[i]);\n          } else {\n            value += d3.format(',.1f')(range[i]);\n          }\n          if (i === 0) {\n            value += ' - ';\n          }\n        }\n        return value;\n      }\n\n    function logFormatNumber(d) {\n      var x = Math.log(d) / Math.log(10) + 1e-6;\n      return Math.abs(x - Math.floor(x)) < 0.6 ? formatAsFloat(d) : \"\";\n    }\n\n    chart.yFormatter = formatNumber;\n    chart.xFormatter = formatRange;\n\n    chart.data = chart.settings.data;\n\n    chart.groupObjs = {}; //The data organized by grouping and sorted as well as any metadata for the groups\n    chart.objs = {mainDiv: null, chartDiv: null, g: null, xAxis: null, yAxis: null};\n    chart.colorFunct = null;\n\n    /**\n     * Takes an array, function, or object mapping and created a color function from it\n     * @param {function|[]|object} colorOptions\n     * @returns {function} Function to be used to determine chart colors\n     */\n    function getColorFunct(colorOptions) {\n        if (typeof colorOptions == 'function') {\n            return colorOptions\n        } else if (Array.isArray(colorOptions)) {\n            //  If an array is provided, map it to the domain\n            var colorMap = {}, cColor = 0;\n            /* @TODO - REVIEW PREVIOUS CODE \n            for (var cName in chart.groupObjs) {\n                \n                colorMap[cName] = colorOptions[cColor];\n                cColor = (cColor + 1) % colorOptions.length;\n            }*/\n            if (Array.isArray(chart.settings.xSort)){\n                chart.settings.xSort.forEach(function(key, index){\n                    colorMap[key] = colorOptions[index];\n                })\n            }else{\n                Object.keys(chart.groupObjs).sort(d3.ascending).forEach(function(key, index){\n                    colorMap[key] = colorOptions[index];\n                })\n            }\n            return function (group) {\n                return colorMap[group];\n            }\n        } else if (typeof colorOptions == 'object') {\n            // if an object is provided, assume it maps to  the colors\n            return function (group) {\n                return colorOptions[group];\n            }\n        } else {\n            return d3.scaleOrdinal(d3.schemeCategory10);\n        }\n    }\n\n    /**\n     * Takes a percentage as returns the values that correspond to that percentage of the group range witdh\n     * @param objWidth Percentage of range band\n     * @param gName The bin name to use to get the x shift\n     * @returns {{left: null, right: null, middle: null}}\n     */\n    function getObjWidth(objWidth, gName) {\n        var objSize = {left: null, right: null, middle: null};\n        var width = chart.xScale.bandwidth() * (objWidth / 100);\n        var padding = (chart.xScale.bandwidth() - width) / 2;\n        var gShift = chart.xScale(gName);\n        objSize.middle = chart.xScale.bandwidth() / 2 + gShift;\n        objSize.left = padding + gShift;\n        objSize.right = objSize.left + width;\n        return objSize;\n    }\n\n    /**\n     * Adds jitter to the  scatter point plot\n     * @param doJitter true or false, add jitter to the point\n     * @param width percent of the range band to cover with the jitter\n     * @returns {number}\n     */\n    function addJitter(doJitter, width) {\n        if (doJitter !== true || width == 0) {\n            return 0\n        }\n        return Math.floor(Math.random() * width) - width / 2;\n    }\n\n    function shallowCopy(oldObj) {\n        var newObj = {};\n        for (var i in oldObj) {\n            if (oldObj.hasOwnProperty(i)) {\n                newObj[i] = oldObj[i];\n            }\n        }\n        return newObj;\n    }\n\n    /**\n     * Closure that creates the tooltip hover function\n     * @param groupName Name of the x group\n     * @param metrics Object to use to get values for the group\n     * @returns {Function} A function that provides the values for the tooltip\n     */\n    function tooltipHover(groupName, metrics, pointName = '', pointValue = undefined, boxpart = '') {\n        var tooltipString = pointName;\n        tooltipString += pointValue ? '<br>' + pointValue.toLocaleString() + '<br><hr style=\"height: 1px; background-color: #ADADAE; border: none; margin: 0.5em;\">': '';\n        tooltipString += groupName;\n        tooltipString += boxpart ? '' : \"<br\\>Max: \" + formatAsFloat(metrics.max, 0.1);\n        tooltipString += boxpart ? '' : \"<br\\>Q3: \" + formatAsFloat(metrics.quartile3);\n        tooltipString += boxpart ? boxpart === 'mean' ? \"<br\\>Media: \" + formatAsFloat(metrics.mean) : '' : \"<br\\>Media: \" + formatAsFloat(metrics.mean);\n        tooltipString += boxpart ? boxpart  === 'median' ? \"<br\\>Mediana: \" + formatAsFloat(metrics.median) : '' : \"<br\\>Mediana: \" + formatAsFloat(metrics.median);\n        tooltipString += boxpart ? '' : \"<br\\>Q1: \" + formatAsFloat(metrics.quartile1);\n        tooltipString += boxpart ? '' : \"<br\\>Min: \" + formatAsFloat(metrics.min);\n        return function () {\n            chart.objs.tooltip.transition().duration(200).style(\"opacity\", 0.8);\n            chart.objs.tooltip.html(tooltipString)\n        };\n    }\n\n    function idSelection(id) {\n        console.log('this ', id, 'is selected');\n        chart.objs.mainDiv.select('.point.distro-' + id).attr('class', 'active');\n    };\n\n    //chart.idSelect = idSelection;\n\n    /**\n     * Parse the data and calculates base values for the plots\n     */\n    !function prepareData() {\n        function calcMetrics(values) {\n\n            var metrics = { //These are the original nonÔøΩscaled values\n                max: null,\n                upperOuterFence: null,\n                upperInnerFence: null,\n                quartile3: null,\n                median: null,\n                mean: null,\n                iqr: null,\n                quartile1: null,\n                lowerInnerFence: null,\n                lowerOuterFence: null,\n                min: null\n            };\n\n            metrics.min = d3.min(values);\n            metrics.quartile1 = d3.quantile(values, 0.25);\n            metrics.median = d3.median(values);\n            metrics.mean = d3.mean(values);\n            metrics.quartile3 = d3.quantile(values, 0.75);\n            metrics.max = d3.max(values);\n            metrics.iqr = metrics.quartile3 - metrics.quartile1;\n\n            //The inner fences are the closest value to the IQR without going past it (assumes sorted lists)\n            var LIF = metrics.quartile1 - (1.5 * metrics.iqr);\n            var UIF = metrics.quartile3 + (1.5 * metrics.iqr);\n            for (var i = 0; i <= values.length; i++) {\n                if (values[i] < LIF) {\n                    continue;\n                }\n                if (!metrics.lowerInnerFence && values[i] >= LIF) {\n                    metrics.lowerInnerFence = values[i];\n                    continue;\n                }\n                if (values[i] > UIF) {\n                    metrics.upperInnerFence = values[i - 1];\n                    break;\n                }\n            }\n\n\n            metrics.lowerOuterFence = metrics.quartile1 - (3 * metrics.iqr);\n            metrics.upperOuterFence = metrics.quartile3 + (3 * metrics.iqr);\n            if (!metrics.lowerInnerFence) {\n                metrics.lowerInnerFence = metrics.min;\n            }\n            if (!metrics.upperInnerFence) {\n                metrics.upperInnerFence = metrics.max;\n            }\n            return metrics\n        }\n\n        var current_x = null;\n        var current_y = null;\n        var current_id = null;\n        var current_idName = null;\n        var current_row;\n\n        // Group the values\n        for (current_row = 0; current_row < chart.data.length; current_row++) {\n            current_x = chart.data[current_row][chart.settings.xName];\n            current_y = chart.data[current_row][chart.settings.yName];\n            current_id = chart.settings.id ? chart.data[current_row][chart.settings.id] : null;\n            current_idName = chart.settings.idName ? chart.data[current_row][chart.settings.idName] : null;\n\n            if (chart.groupObjs.hasOwnProperty(current_x)) {\n                if (chart.settings.id) {\n                    chart.groupObjs[current_x].valuesInfo.push({\n                        value: current_y,\n                        id: current_id,\n                        idName: current_idName\n                    });\n                } else{\n                    chart.groupObjs[current_x].values.push(current_y);\n                }\n            } else {\n                if (chart.settings.id) {\n                    chart.groupObjs[current_x] = {};\n                    chart.groupObjs[current_x].valuesInfo = [{\n                        value: current_y,\n                        id: current_id,\n                        idName: current_idName\n                    }];\n                } else{\n                    chart.groupObjs[current_x] = {};\n                    chart.groupObjs[current_x].values = [current_y];\n                }\n            }\n\n\n            //original\n            /*if (chart.groupObjs.hasOwnProperty(current_x)) {\n                chart.groupObjs[current_x].values.push(current_y);\n            } else {\n                chart.groupObjs[current_x] = {};\n                chart.groupObjs[current_x].values = [current_y];\n            }*/\n        }\n\n        for (var cName in chart.groupObjs) {\n            if (chart.settings.id) {\n                chart.groupObjs[cName].values = [];\n                //in order to keep the array chart.groupObjs[cName].values \n                for (let index = 0; index < chart.groupObjs[cName].valuesInfo.length; index++){\n                    chart.groupObjs[cName].values.push(chart.groupObjs[cName].valuesInfo[index].value);\n                }\n\n                chart.groupObjs[cName].valuesInfo.sort(function(x,y) { return d3.ascending(x.value, y.value) });\n            }\n\n            //original\n            chart.groupObjs[cName].values.sort(d3.ascending);\n            chart.groupObjs[cName].metrics = {};\n            chart.groupObjs[cName].metrics =  calcMetrics(chart.groupObjs[cName].values);\n        }\n    }();\n\n    /**\n     * Prepare the chart settings and chart div and svg\n     */\n    !function prepareSettings() {\n        var domain = ''; \n        //Set base settings\n        chart.margin = chart.settings.margin;\n        chart.divWidth = chart.settings.chartSize.width;\n        chart.divHeight = chart.settings.chartSize.height;\n        chart.width = chart.divWidth - chart.margin.left - chart.margin.right;\n        chart.height = chart.divHeight - chart.margin.top - chart.margin.bottom;\n\n        if (chart.settings.axisLabels) {\n            chart.xAxisLable = chart.settings.axisLabels.xAxis;\n            chart.yAxisLable = chart.settings.axisLabels.yAxis;\n        } else {\n            chart.xAxisLable = chart.settings.xName;\n            chart.yAxisLable = chart.settings.yName;\n        }\n\n        if (chart.settings.scale === 'log') {\n            chart.yScale = d3.scaleLog();\n            chart.yFormatter = logFormatNumber;\n        } else {\n            chart.yScale = d3.scaleLinear();\n        }\n\n        if (chart.settings.constrainExtremes === true) {\n            var fences = [];\n            for (var cName in chart.groupObjs) {\n                fences.push(chart.groupObjs[cName].metrics.lowerInnerFence);\n                fences.push(chart.groupObjs[cName].metrics.upperInnerFence);\n            }\n            chart.range = d3.extent(fences);\n\n        } else {\n            chart.range = d3.extent(chart.data, function (d) {return d[chart.settings.yName];});\n        }\n\n        chart.colorFunct = getColorFunct(chart.settings.colors);\n\n        // Build Scale functions\n        chart.yScale.range([chart.height, 0]).domain(chart.range).nice().clamp(true);\n        \n        if (chart.settings.xSort === null) {\n            domain = Object.keys(chart.groupObjs)\n        } else {\n            domain = Array.isArray(chart.settings.xSort) ? chart.settings.xSort : Object.keys(chart.groupObjs).sort(d3.ascending)\n        }\n        chart.xScale = d3.scaleBand().domain(domain).rangeRound([0, chart.width]);\n\n        //Build Axes Functions\n        chart.objs.yAxis = d3.axisLeft()\n            .scale(chart.yScale)\n            .tickFormat(chart.yFormatter)\n            .tickSizeOuter(0)\n            .tickSizeInner(-chart.width + (chart.margin.right + chart.margin.left));\n        //chart.objs.yAxis.ticks(chart.objs.yAxis.ticks()*chart.settings.yTicks);\n        chart.objs.xAxis = d3.axisBottom()\n            .scale(chart.xScale)\n            //.tickFormat(chart.xFormatter)\n            .tickSizeOuter(0)\n            .tickSize(5); \n    }();\n\n    /**\n     * Updates the chart based on the current settings and window size\n     * @returns {*}\n     */\n    chart.update = function () {\n        // Update chart size based on view port size\n        chart.width = parseInt(chart.objs.chartDiv.style(\"width\"), 10) - (chart.margin.left + chart.margin.right);\n        chart.height = parseInt(chart.objs.chartDiv.style(\"height\"), 10) - (chart.margin.top + chart.margin.bottom);\n        // Update scale functions\n        chart.xScale.rangeRound([0, chart.width]);\n        chart.yScale.range([chart.height, 0]);\n\n        // Update the yDomain if the Violin plot clamp is set to -1 meaning it will extend the violins to make nice points\n        if (chart.violinPlots && chart.violinPlots.options.show == true && chart.violinPlots.options._yDomainVP != null) {\n            chart.yScale.domain(chart.violinPlots.options._yDomainVP).nice().clamp(true);\n        } else {\n            chart.yScale.domain(chart.range).nice().clamp(true);\n        }\n\n        //Update axes\n        chart.objs.g.select('.x.axis').attr(\"transform\", \"translate(0,\" + chart.height + \")\").call(chart.objs.xAxis)\n            .selectAll(\".tick text\")\n            .attr(\"y\", 5)\n            .attr(\"x\", -5)\n            .attr(\"transform\", \"rotate(-40)\")\n            .style(\"text-anchor\", \"end\");\n        chart.objs.g.select('.x.axis .label').attr(\"x\", chart.width / 2);\n        chart.objs.g.select('.y.axis').call(chart.objs.yAxis.tickSizeInner(-chart.width));\n        chart.objs.g.select('.y.axis .label').attr(\"x\", -chart.height / 2);\n        chart.objs.chartDiv.select('svg').attr(\"width\", chart.width + (chart.margin.left + chart.margin.right)).attr(\"height\", chart.height + (chart.margin.top + chart.margin.bottom));\n\n        return chart;\n    };\n\n    /**\n     * Prepare the chart html elements\n     */\n    !function prepareChart() {\n      // Build main div and chart div\n      chart.objs.mainDiv = d3.select(chart.settings.selector)\n        .style(\"width\", chart.divWidth + \"px\")\n        .style(\"height\", chart.divHeight+ \"px\");\n      // Add all the divs to make it centered and responsive\n      chart.objs.mainDiv.append(\"div\")\n        .attr(\"class\", \"inner-wrapper\")\n        .style(\"padding-bottom\", \"5%\")\n        .style(\"height\", chart.divHeight + \"px\")\n        .append(\"div\").attr(\"class\", \"outer-box\")\n        .append(\"div\").attr(\"class\", \"inner-box\");\n      // Capture the inner div for the chart (where the chart actually is)\n      chart.selector = chart.settings.selector + \" .inner-box\";   \n      chart.objs.chartDiv = d3.select(chart.selector);\n      d3.select(window).on('resize.' + chart.selector, chart.update);\n\n      // Create the svg\n      chart.objs.g = chart.objs.chartDiv.append(\"svg\")\n        .attr(\"class\", \"chart-area\")\n        .attr(\"width\", chart.width + (chart.margin.left + chart.margin.right))\n        .attr(\"height\", chart.height + (chart.margin.top + chart.margin.bottom))\n        .append(\"g\")\n        .attr(\"transform\", \"translate(\" + chart.margin.left + \",\" + chart.margin.top + \")\");\n      \n      // Create axes\n      chart.objs.axes = chart.objs.g.append(\"g\").attr(\"class\", \"axis\");\n      chart.objs.axes.append(\"g\")\n          .attr(\"class\", \"x axis\")\n          .attr(\"transform\", \"translate(0,\" + chart.height + \")\")\n          .call(chart.objs.xAxis)\n          .append(\"text\")\n          .attr(\"class\", \"label\")\n          .attr(\"y\", chart.margin.bottom - 20)\n          .attr(\"x\", -chart.width / 2)\n          .attr(\"dy\", \".71em\")\n          .attr('fill', '#fff')\n          .style(\"text-anchor\", \"middle\")\n          .text(chart.xAxisLable);\n\n      chart.objs.axes.append(\"g\")\n          .attr(\"class\", \"y axis\")\n          .call(chart.objs.yAxis)\n          .append(\"text\")\n          .attr(\"class\", \"label\")\n          .attr(\"transform\", \"rotate(-90)\")\n          .attr(\"y\", -chart.margin.left * 0.9)\n          .attr(\"x\", -chart.height / 2)\n          .attr(\"dy\", \".71em\")\n          .attr('fill', '#fff')\n          .style(\"text-anchor\", \"middle\")\n          .text(chart.yAxisLable);\n\n      // Create tooltip div\n      chart.objs.tooltip = chart.objs.mainDiv.append('div').attr('class', 'tooltip').style(\"display\", \"none\");\n      for (var cName in chart.groupObjs) {\n          chart.groupObjs[cName].g = chart.objs.g.append(\"g\").attr(\"class\", \"group\");\n          /*chart.groupObjs[cName].g.on(\"mouseover\", function () {\n              chart.objs.tooltip\n                  .style(\"display\", null)\n                  .style(\"left\", (d3.event.pageX) + \"px\")\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\n          }).on(\"mouseout\", function () {\n            chart.objs.tooltip.style(\"display\", \"none\");\n          }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics));*/\n      }\n      chart.update();\n    }();\n\n    /**\n     * Render a violin plot on the current chart\n     * @param options\n     * @param [options.showViolinPlot=true] True or False, show the violin plot\n     * @param [options.resolution=100 default]\n     * @param [options.bandwidth=10 default] May need higher bandwidth for larger data sets\n     * @param [options.width=50] The max percent of the group rangeBand that the violin can be\n     * @param [options.curve=''] How to render the violin\n     * @param [options.clamp=0 default]\n     *   0 = keep data within chart min and max, clamp once data = 0. May extend beyond data set min and max\n     *   1 = clamp at min and max of data set. Possibly no tails\n     *  -1 = extend chart axis to make room for data to interpolate to 0. May extend axis and data set min and max\n     * @param [options.colors=chart default] The color mapping for the violin plot\n     * @returns {*} The chart object\n     */\n    chart.renderViolinPlot = function (options) {\n        chart.violinPlots = {};\n\n        var defaultOptions = {\n            show: true,\n            showViolinPlot: true,\n            resolution: 100,\n            bandwidth: 20,\n            width: 50,\n            curve: d3.curveCardinal,\n            clamp: 1,\n            colors: chart.colorFunct,\n            _yDomainVP: null // If the Violin plot is set to close all violin plots, it may need to extend the domain, that extended domain is stored here\n        };\n        chart.violinPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.violinPlots.options[option] = options[option]\n        }\n        var vOpts = chart.violinPlots.options;\n\n        // Create violin plot objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].violin = {};\n            chart.groupObjs[cName].violin.objs = {};\n        }\n\n        /**\n         * Take a new set of options and redraw the violin\n         * @param updateOptions\n         */\n        chart.violinPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    vOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].violin.objs.g.remove()\n            }\n\n            chart.violinPlots.prepareViolin();\n            chart.violinPlots.update();\n        };\n\n        chart.violinPlots.reset = function () {\n            chart.violinPlots.change(defaultOptions)\n        };\n        chart.violinPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.violinPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.violinPlots.change(opts);\n\n        };\n\n        chart.violinPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.violinPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.violinPlots.change(opts);\n\n        };\n\n        /**\n         * Update the violin obj values\n         */\n        chart.violinPlots.update = function () {\n            var cName, cViolinPlot;\n\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                // Build the violins sideways, so use the yScale for the xScale and make a new yScale\n                var xVScale = chart.yScale.copy();\n\n\n                // Create the Kernel Density Estimator Function\n                cViolinPlot.kde = kernelDensityEstimator(eKernel(vOpts.bandwidth), xVScale.ticks(vOpts.resolution));\n                cViolinPlot.kdedata = cViolinPlot.kde(chart.groupObjs[cName].values);\n\n                var interpolateMax = chart.groupObjs[cName].metrics.max,\n                    interpolateMin = chart.groupObjs[cName].metrics.min;\n\n                if (vOpts.clamp == 0 || vOpts.clamp == -1) { //\n                    // When clamp is 0, calculate the min and max that is needed to bring the violin plot to a point\n                    // interpolateMax = the Minimum value greater than the max where y = 0\n                    interpolateMax = d3.min(cViolinPlot.kdedata.filter(function (d) {\n                        return (d.x > chart.groupObjs[cName].metrics.max && d.y == 0)\n                    }), function (d) {\n                        return d.x;\n                    });\n                    // interpolateMin = the Maximum value less than the min where y = 0\n                    interpolateMin = d3.max(cViolinPlot.kdedata.filter(function (d) {\n                        return (d.x < chart.groupObjs[cName].metrics.min && d.y == 0)\n                    }), function (d) {\n                        return d.x;\n                    });\n                    // If clamp is -1 we need to extend the axises so that the violins come to a point\n                    if (vOpts.clamp == -1) {\n                        kdeTester = eKernelTest(eKernel(vOpts.bandwidth), chart.groupObjs[cName].values);\n                        if (!interpolateMax) {\n                            var interMaxY = kdeTester(chart.groupObjs[cName].metrics.max);\n                            var interMaxX = chart.groupObjs[cName].metrics.max;\n                            var count = 25; // Arbitrary limit to make sure we don't get an infinite loop\n                            while (count > 0 && interMaxY != 0) {\n                                interMaxY = kdeTester(interMaxX);\n                                interMaxX += 1;\n                                count -= 1;\n                            }\n                            interpolateMax = interMaxX;\n                        }\n                        if (!interpolateMin) {\n                            var interMinY = kdeTester(chart.groupObjs[cName].metrics.min);\n                            var interMinX = chart.groupObjs[cName].metrics.min;\n                            var count = 25;  // Arbitrary limit to make sure we don't get an infinite loop\n                            while (count > 0 && interMinY != 0) {\n                                interMinY = kdeTester(interMinX);\n                                interMinX -= 1;\n                                count -= 1;\n                            }\n                            interpolateMin = interMinX;\n                        }\n\n                    }\n                    // Check to see if the new values are outside the existing chart range\n                    //   If they are assign them to the master _yDomainVP\n                    if (!vOpts._yDomainVP) vOpts._yDomainVP = chart.range.slice(0);\n                    if (interpolateMin && interpolateMin < vOpts._yDomainVP[0]) {\n                        vOpts._yDomainVP[0] = interpolateMin;\n                    }\n                    if (interpolateMax && interpolateMax > vOpts._yDomainVP[1]) {\n                        vOpts._yDomainVP[1] = interpolateMax;\n                    }\n\n\n                }\n\n\n                if (vOpts.showViolinPlot) {\n                    chart.update();\n                    xVScale = chart.yScale.copy();\n\n                    // Need to recalculate the KDE because the xVScale changed\n                    cViolinPlot.kde = kernelDensityEstimator(eKernel(vOpts.bandwidth), xVScale.ticks(vOpts.resolution));\n                    cViolinPlot.kdedata = cViolinPlot.kde(chart.groupObjs[cName].values);\n                }\n\n                cViolinPlot.kdedata = cViolinPlot.kdedata\n                    .filter(function (d) {\n                        return (!interpolateMin || d.x >= interpolateMin)\n                    })\n                    .filter(function (d) {\n                        return (!interpolateMax || d.x <= interpolateMax)\n                    });\n            }\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                // Get the violin width\n                var objBounds = getObjWidth(vOpts.width, cName);\n                var width = (objBounds.right - objBounds.left) / 2;\n\n                var yVScale = d3.scaleLinear()\n                    .range([width, 0])\n                    .domain([0, d3.max(cViolinPlot.kdedata, function (d) {return d.y;})])\n                    .clamp(true);\n\n                var area = d3.area()\n                    .curve(vOpts.curve)\n                    .x(function (d) {return xVScale(d.x);})\n                    .y0(width)\n                    .y1(function (d) {return yVScale(d.y);});\n\n                var line = d3.line()\n                    .curve(vOpts.curve)\n                    .x(function (d) {return xVScale(d.x);})\n                    .y(function (d) {return yVScale(d.y)});\n\n                if (cViolinPlot.objs.left.area) {\n                    cViolinPlot.objs.left.area\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", area);\n                    cViolinPlot.objs.left.line\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", line);\n\n                    cViolinPlot.objs.right.area\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", area);\n                    cViolinPlot.objs.right.line\n                        .datum(cViolinPlot.kdedata)\n                        .attr(\"d\", line);\n                }\n\n                // Rotate the violins\n                cViolinPlot.objs.left.g.attr(\"transform\", \"rotate(90,0,0)   translate(0,-\" + objBounds.left + \")  scale(1,-1)\");\n                cViolinPlot.objs.right.g.attr(\"transform\", \"rotate(90,0,0)  translate(0,-\" + objBounds.right + \")\");\n            }\n        };\n\n        /**\n         * Create the svg elements for the violin plot\n         */\n        chart.violinPlots.prepareViolin = function () {\n            var cName, cViolinPlot;\n\n            if (vOpts.colors) {\n                chart.violinPlots.color = getColorFunct(vOpts.colors);\n            } else {\n                chart.violinPlots.color = chart.colorFunct\n            }\n\n            if (vOpts.show == false) {return}\n\n            for (cName in chart.groupObjs) {\n                cViolinPlot = chart.groupObjs[cName].violin;\n\n                cViolinPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"violin-plot\");\n                cViolinPlot.objs.left = {area: null, line: null, g: null};\n                cViolinPlot.objs.right = {area: null, line: null, g: null};\n\n                cViolinPlot.objs.left.g = cViolinPlot.objs.g.append(\"g\");\n                cViolinPlot.objs.right.g = cViolinPlot.objs.g.append(\"g\");\n\n                if (vOpts.showViolinPlot !== false) {\n                    //Area\n                    cViolinPlot.objs.left.area = cViolinPlot.objs.left.g.append(\"path\")\n                        .attr(\"class\", \"area\")\n                        .style(\"fill\", chart.violinPlots.color(cName));\n                    cViolinPlot.objs.right.area = cViolinPlot.objs.right.g.append(\"path\")\n                        .attr(\"class\", \"area\")\n                        .style(\"fill\", chart.violinPlots.color(cName));\n\n                    //Lines\n                    cViolinPlot.objs.left.line = cViolinPlot.objs.left.g.append(\"path\")\n                        .attr(\"class\", \"line\")\n                        .attr(\"fill\", 'none')\n                        .style(\"stroke\", chart.violinPlots.color(cName));\n                    cViolinPlot.objs.right.line = cViolinPlot.objs.right.g.append(\"path\")\n                        .attr(\"class\", \"line\")\n                        .attr(\"fill\", 'none')\n                        .style(\"stroke\", chart.violinPlots.color(cName));\n                }\n\n            }\n\n        };\n\n\n        function kernelDensityEstimator(kernel, x) {\n            return function (sample) {\n                return x.map(function (x) {\n                    return {x:x, y:d3.mean(sample, function (v) {return kernel(x - v);})};\n                });\n            };\n        }\n\n        function eKernel(scale) {\n            return function (u) {\n                return Math.abs(u /= scale) <= 1 ? .75 * (1 - u * u) / scale : 0;\n            };\n        }\n\n        // Used to find the roots for adjusting violin axis\n        // Given an array, find the value for a single point, even if it is not in the domain\n        function eKernelTest(kernel, array) {\n            return function (testX) {\n                return d3.mean(array, function (v) {return kernel(testX - v);})\n            }\n        }\n\n        chart.violinPlots.prepareViolin();\n\n        d3.select(window).on('resize.' + chart.selector + '.violinPlot', chart.violinPlots.update);\n        chart.violinPlots.update();\n        return chart;\n    };\n\n    /**\n     * Render a box plot on the current chart\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showBox=true] Show the box part of the box plot\n     * @param [options.showWhiskers=true] Show the whiskers\n     * @param [options.showMedian=true] Show the median line\n     * @param [options.showMean=false] Show the mean line\n     * @param [options.medianCSize=3] The size of the circle on the median\n     * @param [options.showOutliers=true] Plot outliers\n     * @param [options.boxwidth=30] The max percent of the group rangeBand that the box can be\n     * @param [options.lineWidth=boxWidth] The max percent of the group rangeBand that the line can be\n     * @param [options.outlierScatter=false] Spread out the outliers so they don't all overlap (in development)\n     * @param [options.outlierCSize=2] Size of the outliers\n     * @param [options.colors=chart default] The color mapping for the box plot\n     * @returns {*} The chart object\n     */\n    chart.renderBoxPlot = function (options) {\n        chart.boxPlots = {};\n\n        // Defaults\n        var defaultOptions = {\n            show: true,\n            showBox: true,\n            showWhiskers: true,\n            showMedian: true,\n            showMean: false,\n            medianCSize: 3.5,\n            showOutliers: true,\n            boxWidth: 30,\n            lineWidth: null,\n            scatterOutliers: false,\n            outlierCSize: 2.5,\n            colors: chart.colorFunct\n        };\n        chart.boxPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.boxPlots.options[option] = options[option]\n        }\n        var bOpts = chart.boxPlots.options;\n\n        //Create box plot objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].boxPlot = {};\n            chart.groupObjs[cName].boxPlot.objs = {};\n        }\n\n\n        /**\n         * Calculates all the outlier points for each group\n         */\n        !function calcAllOutliers() {\n\n            /**\n             * Create lists of the outliers for each content group\n             * @param cGroup The object to modify\n             * @return null Modifies the object in place\n             */\n            function calcOutliers(cGroup) {\n                var cExtremes = [];\n                var cOutliers = [];\n                var cOut, idx;\n                for (idx = 0; idx <= cGroup.values.length; idx++) {\n                    cOut = {value: cGroup.values[idx]};\n\n                    if (cOut.value < cGroup.metrics.lowerInnerFence) {\n                        if (cOut.value < cGroup.metrics.lowerOuterFence) {\n                            cExtremes.push(cOut);\n                        } else {\n                            cOutliers.push(cOut);\n                        }\n                    } else if (cOut.value > cGroup.metrics.upperInnerFence) {\n                        if (cOut.value > cGroup.metrics.upperOuterFence) {\n                            cExtremes.push(cOut);\n                        } else {\n                            cOutliers.push(cOut);\n                        }\n                    }\n                }\n                cGroup.boxPlot.objs.outliers = cOutliers;\n                cGroup.boxPlot.objs.extremes = cExtremes;\n            }\n\n            for (var cName in chart.groupObjs) {\n                calcOutliers(chart.groupObjs[cName]);\n            }\n        }();\n\n        /**\n         * Take updated options and redraw the box plot\n         * @param updateOptions\n         */\n        chart.boxPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    bOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].boxPlot.objs.g.remove()\n            }\n            chart.boxPlots.prepareBoxPlot();\n            chart.boxPlots.update()\n        };\n\n        chart.boxPlots.reset = function () {\n            chart.boxPlots.change(defaultOptions)\n        };\n        chart.boxPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.boxPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.boxPlots.change(opts)\n\n        };\n        chart.boxPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.boxPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.boxPlots.change(opts)\n        };\n\n        /**\n         * Update the box plot obj values\n         */\n        chart.boxPlots.update = function () {\n            var cName, cBoxPlot;\n\n            for (cName in chart.groupObjs) {\n                cBoxPlot = chart.groupObjs[cName].boxPlot;\n\n                // Get the box width\n                var objBounds = getObjWidth(bOpts.boxWidth, cName);\n                var width = (objBounds.right - objBounds.left);\n\n                var sMetrics = {}; //temp var for scaled (plottable) metric values\n                for (var attr in chart.groupObjs[cName].metrics) {\n                    sMetrics[attr] = null;\n                    sMetrics[attr] = chart.yScale(chart.groupObjs[cName].metrics[attr]);\n                }\n\n                // Box\n                if (cBoxPlot.objs.box) {\n                    cBoxPlot.objs.box\n                        .attr(\"x\", objBounds.left)\n                        .attr('width', width)\n                        .attr(\"y\", sMetrics.quartile3)\n                        .attr(\"rx\", 1)\n                        .attr(\"ry\", 1)\n                        .attr(\"height\", -sMetrics.quartile3 + sMetrics.quartile1)\n                }\n\n                // Lines\n                var lineBounds = null;\n                if (bOpts.lineWidth) {\n                    lineBounds = getObjWidth(bOpts.lineWidth, cName)\n                } else {\n                    lineBounds = objBounds\n                }\n                // --Whiskers\n                if (cBoxPlot.objs.upperWhisker) {\n                    cBoxPlot.objs.upperWhisker.fence\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.upperInnerFence)\n                        .attr(\"y2\", sMetrics.upperInnerFence);\n                    cBoxPlot.objs.upperWhisker.line\n                        .attr(\"x1\", lineBounds.middle)\n                        .attr(\"x2\", lineBounds.middle)\n                        .attr('y1', sMetrics.quartile3)\n                        .attr(\"y2\", sMetrics.upperInnerFence);\n\n                    cBoxPlot.objs.lowerWhisker.fence\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.lowerInnerFence)\n                        .attr(\"y2\", sMetrics.lowerInnerFence);\n                    cBoxPlot.objs.lowerWhisker.line\n                        .attr(\"x1\", lineBounds.middle)\n                        .attr(\"x2\", lineBounds.middle)\n                        .attr('y1', sMetrics.quartile1)\n                        .attr(\"y2\", sMetrics.lowerInnerFence);\n                }\n\n                // --Median\n                if (cBoxPlot.objs.median) {\n                    cBoxPlot.objs.median.line\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.median)\n                        .attr(\"y2\", sMetrics.median);\n                    cBoxPlot.objs.median.circle\n                        .attr(\"cx\", lineBounds.middle)\n                        .attr(\"cy\", sMetrics.median)\n                }\n\n                // --Mean\n                if (cBoxPlot.objs.mean) {\n                    cBoxPlot.objs.mean.line\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', sMetrics.mean)\n                        .attr(\"y2\", sMetrics.mean);\n                    cBoxPlot.objs.mean.circle\n                        .attr(\"cx\", lineBounds.middle)\n                        .attr(\"cy\", sMetrics.mean);\n                }\n\n                // Outliers\n\n                var pt;\n                if (cBoxPlot.objs.outliers) {\n                    for (pt in cBoxPlot.objs.outliers) {\n                        cBoxPlot.objs.outliers[pt].point\n                            .attr(\"cx\", objBounds.middle + addJitter(bOpts.scatterOutliers, width))\n                            .attr(\"cy\", chart.yScale(cBoxPlot.objs.outliers[pt].value));\n                    }\n                }\n                if (cBoxPlot.objs.extremes) {\n                    for (pt in cBoxPlot.objs.extremes) {\n                        cBoxPlot.objs.extremes[pt].point\n                            .attr(\"cx\", objBounds.middle + addJitter(bOpts.scatterOutliers, width))\n                            .attr(\"cy\", chart.yScale(cBoxPlot.objs.extremes[pt].value));\n                    }\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the box plot\n         */\n        chart.boxPlots.prepareBoxPlot = function () {\n            var cName, cBoxPlot;\n\n            if (bOpts.colors) {\n                chart.boxPlots.colorFunct = getColorFunct(bOpts.colors);\n            } else {\n                chart.boxPlots.colorFunct = chart.colorFunct\n            }\n\n            if (bOpts.show == false) {\n                return\n            }\n\n            for (cName in chart.groupObjs) {\n                cBoxPlot = chart.groupObjs[cName].boxPlot;\n\n                cBoxPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"box-plot\");\n\n                //Plot Box (default show)\n                if (bOpts.showBox) {\n                    cBoxPlot.objs.box = cBoxPlot.objs.g.append(\"rect\")\n                        .attr(\"class\", \"box\")\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName))\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    //A stroke is added to the box with the group color, it is\n                    // hidden by default and can be shown through css with stroke-width\n                }\n\n                //Plot Median (default show)\n                if (bOpts.showMedian) {\n                    cBoxPlot.objs.median = {line: null, circle: null};\n                    cBoxPlot.objs.median.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"median\");\n                    cBoxPlot.objs.median.circle = cBoxPlot.objs.g.append(\"circle\")\n                        .attr(\"class\", \"median\")\n                        .attr('r', bOpts.medianCSize)\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName))\n                        .on(\"mouseover\", function () {\n                            chart.objs.tooltip\n                                .style(\"display\", null)\n                                .style(\"left\", (d3.event.pageX) + \"px\")\n                                .style(\"top\", (d3.event.pageY - 28) + \"px\");\n                        }).on(\"mouseout\", function () {\n                          chart.objs.tooltip.style(\"display\", \"none\");\n                        }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics, '', '', 'median'));\n                }\n\n                // Plot Mean (default no plot)\n                if (bOpts.showMean) {\n                    cBoxPlot.objs.mean = {line: null, circle: null};\n                    cBoxPlot.objs.mean.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"mean\");\n                    cBoxPlot.objs.mean.circle = cBoxPlot.objs.g.append(\"circle\")\n                        .attr(\"class\", \"mean\")\n                        .attr('r', bOpts.medianCSize)\n                        .style(\"fill\", chart.boxPlots.colorFunct(cName))\n                        .on(\"mouseover\", function () {\n                            chart.objs.tooltip\n                                .style(\"display\", null)\n                                .style(\"left\", (d3.event.pageX) + \"px\")\n                                .style(\"top\", (d3.event.pageY - 28) + \"px\");\n                        }).on(\"mouseout\", function () {\n                          chart.objs.tooltip.style(\"display\", \"none\");\n                        }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics, '', '', 'mean'));\n                }\n\n                // Plot Whiskers (default show)\n                if (bOpts.showWhiskers) {\n                    cBoxPlot.objs.upperWhisker = {fence: null, line: null};\n                    cBoxPlot.objs.lowerWhisker = {fence: null, line: null};\n                    cBoxPlot.objs.upperWhisker.fence = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    cBoxPlot.objs.upperWhisker.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n\n                    cBoxPlot.objs.lowerWhisker.fence = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                    cBoxPlot.objs.lowerWhisker.line = cBoxPlot.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower whisker\")\n                        .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                }\n\n                // Plot outliers (default show)\n                if (bOpts.showOutliers) {\n                    if (!cBoxPlot.objs.outliers) calcAllOutliers();\n                    var pt;\n                    if (cBoxPlot.objs.outliers.length) {\n                        var outDiv = cBoxPlot.objs.g.append(\"g\").attr(\"class\", \"boxplot outliers\");\n                        for (pt in cBoxPlot.objs.outliers) {\n                            cBoxPlot.objs.outliers[pt].point = outDiv.append(\"circle\")\n                                .attr(\"class\", \"outlier\")\n                                .attr('r', bOpts.outlierCSize)\n                                .style(\"fill\", chart.boxPlots.colorFunct(cName));\n                        }\n                    }\n\n                    if (cBoxPlot.objs.extremes.length) {\n                        var extDiv = cBoxPlot.objs.g.append(\"g\").attr(\"class\", \"boxplot extremes\");\n                        for (pt in cBoxPlot.objs.extremes) {\n                            cBoxPlot.objs.extremes[pt].point = extDiv.append(\"circle\")\n                                .attr(\"class\", \"extreme\")\n                                .attr('r', bOpts.outlierCSize)\n                                .style(\"stroke\", chart.boxPlots.colorFunct(cName));\n                        }\n                    }\n                }\n\n\n            }\n        };\n        chart.boxPlots.prepareBoxPlot();\n\n        d3.select(window).on('resize.' + chart.selector + '.boxPlot', chart.boxPlots.update);\n        chart.boxPlots.update();\n        return chart;\n\n    };\n\n    /**\n     * Render a notched box on the current chart\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showNotchBox=true] Show the notch box\n     * @param [options.showLines=false] Show lines at the confidence intervals\n     * @param [options.boxWidth=35] The width of the widest part of the box\n     * @param [options.medianWidth=20] The width of the narrowist part of the box\n     * @param [options.lineWidth=50] The width of the confidence interval lines\n     * @param [options.notchStyle=null] null=traditional style, 'box' cuts out the whole notch in right angles\n     * @param [options.colors=chart default] The color mapping for the notch boxes\n     * @returns {*} The chart object\n     */\n    chart.renderNotchBoxes = function (options) {\n        chart.notchBoxes = {};\n\n        //Defaults\n        var defaultOptions = {\n            show: true,\n            showNotchBox: true,\n            showLines: false,\n            boxWidth: 35,\n            medianWidth: 20,\n            lineWidth: 50,\n            notchStyle: null,\n            colors: null\n        };\n        chart.notchBoxes.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.notchBoxes.options[option] = options[option]\n        }\n        var nOpts = chart.notchBoxes.options;\n\n        //Create notch objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].notchBox = {};\n            chart.groupObjs[cName].notchBox.objs = {};\n        }\n\n        /**\n         * Makes the svg path string for a notched box\n         * @param cNotch Current notch box object\n         * @param notchBounds objBound object\n         * @returns {string} A string in the proper format for a svg polygon\n         */\n        function makeNotchBox(cNotch, notchBounds) {\n            var scaledValues = [];\n            if (nOpts.notchStyle == 'box') {\n                scaledValues = [\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile1)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile1)]\n                ];\n            } else {\n                scaledValues = [\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile1)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.medianLeft, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.boxLeft, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile3)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.upperNotch)],\n                    [notchBounds.medianRight, chart.yScale(cNotch.metrics.median)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.lowerNotch)],\n                    [notchBounds.boxRight, chart.yScale(cNotch.metrics.quartile1)]\n                ];\n            }\n            return scaledValues.map(function (d) {\n                return [d[0], d[1]].join(\",\");\n            }).join(\" \");\n        }\n\n        /**\n         * Calculate the confidence intervals\n         */\n        !function calcNotches() {\n            var cNotch, modifier;\n            for (var cName in chart.groupObjs) {\n                cNotch = chart.groupObjs[cName];\n                modifier = (1.57 * (cNotch.metrics.iqr / Math.sqrt(cNotch.values.length)));\n                cNotch.metrics.upperNotch = cNotch.metrics.median + modifier;\n                cNotch.metrics.lowerNotch = cNotch.metrics.median - modifier;\n            }\n        }();\n\n        /**\n         * Take a new set of options and redraw the notch boxes\n         * @param updateOptions\n         */\n        chart.notchBoxes.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    nOpts[key] = updateOptions[key]\n                }\n            }\n\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].notchBox.objs.g.remove()\n            }\n            chart.notchBoxes.prepareNotchBoxes();\n            chart.notchBoxes.update();\n        };\n\n        chart.notchBoxes.reset = function () {\n            chart.notchBoxes.change(defaultOptions)\n        };\n        chart.notchBoxes.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.notchBoxes.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.notchBoxes.change(opts)\n        };\n        chart.notchBoxes.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.notchBoxes.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.notchBoxes.change(opts)\n        };\n\n        /**\n         * Update the notch box obj values\n         */\n        chart.notchBoxes.update = function () {\n            var cName, cGroup;\n\n            for (cName in chart.groupObjs) {\n                cGroup = chart.groupObjs[cName];\n\n                // Get the box size\n                var boxBounds = getObjWidth(nOpts.boxWidth, cName);\n                var medianBounds = getObjWidth(nOpts.medianWidth, cName);\n\n                var notchBounds = {\n                    boxLeft: boxBounds.left,\n                    boxRight: boxBounds.right,\n                    middle: boxBounds.middle,\n                    medianLeft: medianBounds.left,\n                    medianRight: medianBounds.right\n                };\n\n                // Notch Box\n                if (cGroup.notchBox.objs.notch) {\n                    cGroup.notchBox.objs.notch\n                        .attr(\"points\", makeNotchBox(cGroup, notchBounds));\n                }\n                if (cGroup.notchBox.objs.upperLine) {\n                    var lineBounds = null;\n                    if (nOpts.lineWidth) {\n                        lineBounds = getObjWidth(nOpts.lineWidth, cName)\n                    } else {\n                        lineBounds = objBounds\n                    }\n\n                    var confidenceLines = {\n                        upper: chart.yScale(cGroup.metrics.upperNotch),\n                        lower: chart.yScale(cGroup.metrics.lowerNotch)\n                    };\n                    cGroup.notchBox.objs.upperLine\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', confidenceLines.upper)\n                        .attr(\"y2\", confidenceLines.upper);\n                    cGroup.notchBox.objs.lowerLine\n                        .attr(\"x1\", lineBounds.left)\n                        .attr(\"x2\", lineBounds.right)\n                        .attr('y1', confidenceLines.lower)\n                        .attr(\"y2\", confidenceLines.lower);\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the notch boxes\n         */\n        chart.notchBoxes.prepareNotchBoxes = function () {\n            var cName, cNotch;\n\n            if (nOpts && nOpts.colors) {\n                chart.notchBoxes.colorFunct = getColorFunct(nOpts.colors);\n            } else {\n                chart.notchBoxes.colorFunct = chart.colorFunct\n            }\n\n            if (nOpts.show == false) {\n                return\n            }\n\n            for (cName in chart.groupObjs) {\n                cNotch = chart.groupObjs[cName].notchBox;\n\n                cNotch.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"notch-plot\");\n\n                // Plot Box (default show)\n                if (nOpts.showNotchBox) {\n                    cNotch.objs.notch = cNotch.objs.g.append(\"polygon\")\n                        .attr(\"class\", \"notch\")\n                        .style(\"fill\", chart.notchBoxes.colorFunct(cName))\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n                    //A stroke is added to the notch with the group color, it is\n                    // hidden by default and can be shown through css with stroke-width\n                }\n\n                //Plot Confidence Lines (default hide)\n                if (nOpts.showLines) {\n                    cNotch.objs.upperLine = cNotch.objs.g.append(\"line\")\n                        .attr(\"class\", \"upper confidence line\")\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n\n                    cNotch.objs.lowerLine = cNotch.objs.g.append(\"line\")\n                        .attr(\"class\", \"lower confidence line\")\n                        .style(\"stroke\", chart.notchBoxes.colorFunct(cName));\n                }\n            }\n        };\n        chart.notchBoxes.prepareNotchBoxes();\n\n        d3.select(window).on('resize.' + chart.selector + '.notchBox', chart.notchBoxes.update);\n        chart.notchBoxes.update();\n        return chart;\n    };\n\n    /**\n     * Render a raw data in various forms\n     * @param options\n     * @param [options.show=true] Toggle the whole plot on and off\n     * @param [options.showPlot=false] True or false, show points\n     * @param [options.plotType='none'] Options: no scatter = (false or 'none'); scatter points= (true or [amount=% of width (default=10)]); beeswarm points = ('beeswarm')\n     * @param [options.pointSize=6] Diameter of the circle in pizels (not the radius)\n     * @param [options.showLines=['median']] Can equal any of the metrics lines\n     * @param [options.showbeanLines=false] Options: no lines = false\n     * @param [options.beanWidth=20] % width\n     * @param [options.colors=chart default]\n     * @returns {*} The chart object\n     *\n     */\n    chart.renderDataPlots = function (options) {\n        chart.dataPlots = {};\n\n\n        //Defaults\n        var defaultOptions = {\n            show: true,\n            showPlot: false,\n            plotType: 'none',\n            pointSize: 7,\n            showLines: false,//['median'],\n            showBeanLines: false,\n            beanWidth: 20,\n            colors: null\n        };\n        chart.dataPlots.options = shallowCopy(defaultOptions);\n        for (var option in options) {\n            chart.dataPlots.options[option] = options[option]\n        }\n        var dOpts = chart.dataPlots.options;\n\n        //Create notch objects\n        for (var cName in chart.groupObjs) {\n            chart.groupObjs[cName].dataPlots = {};\n            chart.groupObjs[cName].dataPlots.objs = {};\n        }\n        // The lines don't fit into a group bucket so they live under the dataPlot object\n        chart.dataPlots.objs = {};\n\n        /**\n         * Take updated options and redraw the data plots\n         * @param updateOptions\n         */\n        chart.dataPlots.change = function (updateOptions) {\n            if (updateOptions) {\n                for (var key in updateOptions) {\n                    dOpts[key] = updateOptions[key]\n                }\n            }\n\n            chart.dataPlots.objs.g.remove();\n            for (var cName in chart.groupObjs) {\n                chart.groupObjs[cName].dataPlots.objs.g.remove()\n            }\n            chart.dataPlots.preparePlots();\n            chart.dataPlots.update()\n        };\n\n        chart.dataPlots.reset = function () {\n            chart.dataPlots.change(defaultOptions)\n        };\n        chart.dataPlots.show = function (opts) {\n            if (opts !== undefined) {\n                opts.show = true;\n                if (opts.reset) {\n                    chart.dataPlots.reset()\n                }\n            } else {\n                opts = {show: true};\n            }\n            chart.dataPlots.change(opts)\n        };\n        chart.dataPlots.hide = function (opts) {\n            if (opts !== undefined) {\n                opts.show = false;\n                if (opts.reset) {\n                    chart.dataPlots.reset()\n                }\n            } else {\n                opts = {show: false};\n            }\n            chart.dataPlots.change(opts)\n        };\n\n        /**\n         * Update the data plot obj values\n         */\n        chart.dataPlots.update = function () {\n            var cName, cGroup, cPlot;\n\n            // Metrics lines\n            if (chart.dataPlots.objs.g) {\n                var halfBand = chart.xScale.bandwidth() / 2; // find the middle of each band\n                for (var cMetric in chart.dataPlots.objs.lines) {\n                    chart.dataPlots.objs.lines[cMetric].line\n                        .x(function (d) {\n                            return chart.xScale(d.x) + halfBand\n                        });\n                    chart.dataPlots.objs.lines[cMetric].g\n                        .datum(chart.dataPlots.objs.lines[cMetric].values)\n                        .attr('d', chart.dataPlots.objs.lines[cMetric].line);\n                }\n            }\n\n\n            for (cName in chart.groupObjs) {\n                cGroup = chart.groupObjs[cName];\n                cPlot = cGroup.dataPlots;\n\n                if (cPlot.objs.points) {\n                    if (dOpts.plotType == 'beeswarm') {\n                        var swarmBounds = getObjWidth(100, cName);\n                        var yPtScale = chart.yScale.copy()\n                            .range([Math.floor(chart.yScale.range()[0] / dOpts.pointSize), 0])\n                            .interpolate(d3.interpolateRound)\n                            .domain(chart.yScale.domain());\n                        var maxWidth = Math.floor(chart.xScale.bandwidth() / dOpts.pointSize);\n                        var ptsObj = {};\n                        var cYBucket = null;\n                        //  Bucket points\n                        for (var pt = 0; pt < cGroup.values.length; pt++) {\n                            cYBucket = yPtScale(cGroup.values[pt]);\n                            if (ptsObj.hasOwnProperty(cYBucket) !== true) {\n                                ptsObj[cYBucket] = [];\n                            }\n                            ptsObj[cYBucket].push(cPlot.objs.points.pts[pt]\n                                .attr(\"cx\", swarmBounds.middle)\n                                .attr(\"cy\", yPtScale(cGroup.values[pt]) * dOpts.pointSize));\n                        }\n                        //  Plot buckets\n                        var rightMax = Math.min(swarmBounds.right - dOpts.pointSize);\n                        for (var row in ptsObj) {\n                            var leftMin = swarmBounds.left + (Math.max((maxWidth - ptsObj[row].length) / 2, 0) * dOpts.pointSize);\n                            var col = 0;\n                            for (pt in ptsObj[row]) {\n                                ptsObj[row][pt].attr(\"cx\", Math.min(leftMin + col * dOpts.pointSize, rightMax) + dOpts.pointSize / 2);\n                                col++\n                            }\n                        }\n                    } else { // For scatter points and points with no scatter\n                        var plotBounds = null,\n                            scatterWidth = 0,\n                            width = 0;\n                        if (dOpts.plotType == 'scatter' || typeof dOpts.plotType == 'number') {\n                            //Default scatter percentage is 20% of box width\n                            scatterWidth = typeof dOpts.plotType == 'number' ? dOpts.plotType : 20;\n                        }\n\n                        plotBounds = getObjWidth(scatterWidth, cName);\n                        width = plotBounds.right - plotBounds.left;\n\n                        for (var pt = 0; pt < cGroup.values.length; pt++) {\n                            cPlot.objs.points.pts[pt]\n                                .attr(\"cx\", plotBounds.middle + addJitter(true, width))\n                                .attr(\"cy\", chart.yScale(cGroup.values[pt]));\n                        }\n                    }\n                }\n\n\n                if (cPlot.objs.bean) {\n                    var beanBounds = getObjWidth(dOpts.beanWidth, cName);\n                    for (var pt = 0; pt < cGroup.values.length; pt++) {\n                        cPlot.objs.bean.lines[pt]\n                            .attr(\"x1\", beanBounds.left)\n                            .attr(\"x2\", beanBounds.right)\n                            .attr('y1', chart.yScale(cGroup.values[pt]))\n                            .attr(\"y2\", chart.yScale(cGroup.values[pt]));\n                    }\n                }\n            }\n        };\n\n        /**\n         * Create the svg elements for the data plots\n         */\n        chart.dataPlots.preparePlots = function () {\n            var cName, cPlot;\n            \n            if (dOpts && dOpts.colors) {\n                chart.dataPlots.colorFunct = getColorFunct(dOpts.colors);\n            } else {\n                chart.dataPlots.colorFunct = chart.colorFunct\n            }\n\n            if (dOpts.show == false) {\n                return\n            }\n\n            // Metrics lines\n            chart.dataPlots.objs.g = chart.objs.g.append(\"g\").attr(\"class\", \"metrics-lines\");\n            if (dOpts.showLines && dOpts.showLines.length > 0) {\n                chart.dataPlots.objs.lines = {};\n                var cMetric;\n                for (var line in dOpts.showLines) {\n                    cMetric = dOpts.showLines[line];\n                    chart.dataPlots.objs.lines[cMetric] = {};\n                    chart.dataPlots.objs.lines[cMetric].values = [];\n                    for (var cGroup in chart.groupObjs) {\n                        chart.dataPlots.objs.lines[cMetric].values.push({\n                            x: cGroup,\n                            y: chart.groupObjs[cGroup].metrics[cMetric]\n                        })\n                    }\n                    chart.dataPlots.objs.lines[cMetric].line = d3.line()\n                        .curve(d3.curveCardinal)\n                        .y(function (d) {\n                            return chart.yScale(d.y)\n                        });\n                    chart.dataPlots.objs.lines[cMetric].g = chart.dataPlots.objs.g.append(\"path\")\n                        .attr(\"class\", \"line \" + cMetric)\n                        .attr(\"data-metric\", cMetric)\n                        .style(\"fill\", 'none')\n                        .style(\"stroke\", chart.colorFunct(cMetric));\n                }\n\n            }\n\n\n            for (cName in chart.groupObjs) {\n                cPlot = chart.groupObjs[cName].dataPlots;\n                cPlot.objs.g = chart.groupObjs[cName].g.append(\"g\").attr(\"class\", \"data-plot\");\n                // Points Plot\n                if (dOpts.showPlot) {\n                    cPlot.objs.points = {g: null, pts: []};\n                    cPlot.objs.points.g = cPlot.objs.g.append(\"g\").attr(\"class\", \"points-plot\");\n                    for (var pt = 0; pt < chart.groupObjs[cName].values.length; pt++) {\n                        let val = chart.groupObjs[cName].values[pt];\n                        let valInfo = chart.groupObjs[cName].valuesInfo[pt];\n                        cPlot.objs.points.pts.push(cPlot.objs.points.g.append(\"circle\")\n                            .attr(\"class\", \"point\")\n                            //class id so it can be selected\n                            .attr('class', function() { var id = chart.settings.id ? chart.settings.id : false;\n                            return id ? 'distro-' + valInfo.id : '';})\n                            .attr('r', dOpts.pointSize / 2)// Options is diameter, r takes radius so divide by 2\n                            .style(\"fill\", chart.dataPlots.colorFunct(cName))\n                            .style(\"fill-opacity\", 0.6)\n                            .style(\"stroke\", chart.dataPlots.colorFunct(cName))\n                            .style(\"stroke-width\", \"2px\")\n                            .on('mouseover', ()=>{\n                                chart.objs.tooltip\n                                    .style(\"display\", null)\n                                    .style(\"left\", (d3.event.pageX) + \"px\")\n                                    .style(\"top\", (d3.event.pageY - 28) + \"px\");\n                            }).on(\"mouseout\", function () {\n                                chart.objs.tooltip.style(\"display\", \"none\");\n                            }).on(\"mousemove\", tooltipHover(cName, chart.groupObjs[cName].metrics, valInfo.idName, val))\n                            .on('click', function(){\n                                if (chart.settings.events.onClickElement) {\n                                    chart.settings.events.onClickElement.call(this, valInfo);\n                                }\n                            }));\n                    }\n                }\n\n\n                // Bean lines\n                if (dOpts.showBeanLines) {\n                    cPlot.objs.bean = {g: null, lines: []};\n                    cPlot.objs.bean.g = cPlot.objs.g.append(\"g\").attr(\"class\", \"bean-plot\");\n                    for (var pt = 0; pt < chart.groupObjs[cName].values.length; pt++) {\n                        cPlot.objs.bean.lines.push(cPlot.objs.bean.g.append(\"line\")\n                            .attr(\"class\", \"bean line\")\n                            .style(\"stroke-width\", '1')\n                            .style(\"stroke\", chart.dataPlots.colorFunct(cName)));\n                    }\n                }\n            }\n\n        };\n        chart.dataPlots.preparePlots();\n\n        d3.select(window).on('resize.' + chart.selector + '.dataPlot', chart.dataPlots.update);\n        chart.dataPlots.update();\n        return chart;\n    };\n\n    return chart;\n}","import * as d3 from 'd3';\n\nimport makeDistroChart from './distrochart';\n\n/* Simple Distro example\n * Single and multiline Distros\n */\nexport default function(config, helper) {\n  var Distro = Object.create(helper);\n\n  Distro.init = function(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n\n    vm._tip = vm.utils.d3\n      .tip()\n      .attr('class', 'd3-tip')\n      .html(\n        vm._config.tip\n          ? vm._config.tip\n          : function(d) {\n              var html = '';\n              //html += d.x ? ('<span>' + (Number.isNaN(+d.x) ? d.x : vm.utils.format(vm._config.xAxis)(d.x)) + '</span></br>') : '';\n              html += d.y\n                ? '<span>' +\n                  (Number.isNaN(+d.y)\n                    ? d.y\n                    : vm.utils.format(vm._config.yAxis)(d.y)) +\n                  '</span></br>'\n                : '';\n              /* html += d.magnitude ? ('<span>' + (Number.isNaN(+d.magnitude) ? d.magnitude : vm.utils.format()(d.magnitude)) + '</span></br>') : '';\n        html += d.color ? ('<span>' + (Number.isNaN(+d.color) ? d.color : vm.utils.format()(d.color)) + '</span>') : ''; */\n              return html;\n            }\n      );\n  };\n\n  //-------------------------------\n  //User config functions\n  Distro.type = function(type) {\n    var vm = this;\n    vm._config.type = type;\n    return vm;\n  };\n\n  Distro.x = function(col) {\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  };\n\n  Distro.y = function(col) {\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  };\n\n  Distro.sortBy = function(opt) {\n    var vm = this;\n    vm._config.sortBy = opt;\n    return vm;\n  };\n\n  Distro.fill = function(col) {\n    var vm = this;\n    vm._config.fill = col;\n    return vm;\n  };\n\n  Distro.id = function(col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  };\n\n  Distro.colors = function(colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range\n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Distro.tip = function(tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Distro.data = function(data) {\n    var vm = this;\n\n    vm._data = [];\n    data.forEach(function(d) {\n      d.x = d[vm._config.x];\n      d.y = +d[vm._config.y];\n      d.color = vm._config.fill ? d[vm._config.fill] : 'red';\n      delete d[vm._config.x];\n      delete d[vm._config.y];\n      if (vm._config.fill) delete d[vm._config.x];\n\n      vm._data.push(d);\n    });\n\n    return vm;\n  };\n\n  Distro.scales = function() {\n    var vm = this;\n\n    return vm;\n  };\n\n  Distro.draw = function() {\n    var vm = this;\n    //Call the tip\n    //vm.chart.svg().call(vm._tip);\n\n    vm.chart.fullSvg().remove();\n\n    var chart1 = makeDistroChart({\n      chart: vm.chart,\n      data: vm._data,\n      id: vm._config.id,\n      idName: vm._config.idName,\n      events: vm._config.events,\n      xName: 'x',\n      xSort:\n        typeof vm._config.sortBy === 'object' && vm._config.sortBy.x\n          ? vm._config.sortBy.x\n          : null,\n      yName: 'y',\n      axisLabels: {\n        xAxis: vm._config.axisLabels.xAxis,\n        yAxis: vm._config.axisLabels.yAxis,\n      },\n      selector: '#distro',\n      colors: ['#fff5ca', '#fbc43a', '#5cbd00', '#084c1f'],\n      chartSize: {\n        height: vm._config.size.height,\n        width: vm._config.size.width,\n      },\n      margin: {\n        top: vm._config.size.margin.top,\n        right: vm._config.size.margin.right,\n        bottom: vm._config.size.margin.bottom,\n        left: vm._config.size.margin.left,\n      },\n      constrainExtremes: true,\n    });\n\n    if (vm.chart.config.styles) {\n      d3.select('#distro .tooltip')\n        .style('background-color', vm.chart.style.tooltip.backgroundColor)\n        .style('line-height', 1)\n        .style('font-weight', vm.chart.style.tooltip.text.fontWeight)\n        .style('font-size', vm.chart.style.tooltip.text.fontSize)\n        .style('color', vm.chart.style.tooltip.text.textColor)\n        .style('font-family', vm.chart.style.tooltip.text.fontFamily)\n        .style('background-color', vm.chart.style.tooltip.backgroundColor)\n        .style('padding', vm.chart.style.tooltip.text.padding)\n        .style(\n          'border',\n          vm.chart.style.tooltip.border.width +\n            ' solid ' +\n            vm.chart.style.tooltip.border.color\n        )\n        .style('border-radius', vm.chart.style.tooltip.border.radius);\n    }\n\n    chart1.renderBoxPlot();\n    chart1.renderDataPlots();\n    chart1.renderNotchBoxes({ showNotchBox: false });\n    chart1.renderViolinPlot({ showViolinPlot: false });\n\n    chart1.boxPlots.show({\n      reset: true,\n      showWhiskers: false,\n      showOutliers: false,\n      showMean: true,\n      showMedian: true,\n      showBox: false,\n    });\n    chart1.dataPlots.change({ showPlot: true });\n    chart1.violinPlots.show({ reset: true, clamp: 0, width: 100 });\n    //Box Plot\n    /* chart1.violinPlots.hide();\n    chart1.boxPlots.show({reset:true});\n    chart1.notchBoxes.hide();\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false});  */\n\n    //Notched Box Plot\n    /*  chart1.violinPlots.hide();\n    chart1.notchBoxes.show({reset:true});\n    chart1.boxPlots.show({reset:true, showBox:false,showOutliers:true,boxWidth:20,scatterOutliers:true});\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false}); */\n\n    //Violin Plot Unbound\n    /* chart1.violinPlots.show({reset:true,clamp:0});\n    chart1.boxPlots.show({reset:true, showWhiskers:false,showOutliers:false,boxWidth:10,lineWidth:15,colors:['#555']});\n    chart1.notchBoxes.hide();\n    chart1.dataPlots.change({showPlot:false,showBeanLines:false})  */\n\n    //Violin Plot Clamp to Data\n    if (vm._config.type === 'violin') {\n      chart1.violinPlots.show({ reset: true, clamp: 1, width: 50 });\n      chart1.boxPlots.show({\n        reset: true,\n        showWhiskers: false,\n        showOutliers: false,\n        boxWidth: 10,\n        lineWidth: 15,\n        colors: ['#555'],\n      });\n      chart1.notchBoxes.hide();\n      chart1.dataPlots.change({ showPlot: false, showBeanLines: false });\n    }\n\n    //Bean Plot\n    /* chart1.violinPlots.show({reset:true, width:75, clamp:0, resolution:30, bandwidth:50});\n    chart1.dataPlots.show({showBeanLines:true,beanWidth:15,showPlot:false,colors:['#555']});\n    chart1.boxPlots.hide();\n    chart1.notchBoxes.hide(); */\n\n    //Beeswarm Plot\n    /* chart1.violinPlots.hide();\n    chart1.dataPlots.show({showPlot:true, plotType:'beeswarm',showBeanLines:false, colors:null});\n    chart1.notchBoxes.hide();\n    chart1.boxPlots.hide(); */\n\n    //Scatter Plot\n    if (vm._config.type === 'scatter') {\n      chart1.violinPlots.hide();\n      chart1.dataPlots.show({\n        showPlot: true,\n        plotType: 40,\n        showBeanLines: false,\n        colors: null,\n      });\n      chart1.notchBoxes.hide();\n      //chart1.boxPlots.hide();\n    }\n\n    //Trend Lines\n    /* if(chart1.dataPlots.options.showLines){\n        chart1.dataPlots.change({showLines:false});\n    } else {\n        chart1.dataPlots.change({showLines:['median','quartile1','quartile3']});\n    } */\n\n    return vm;\n  };\n\n  Distro.select = function(id) {\n    var vm = this;\n    return d3.select('#distro .distro-' + id);\n  };\n\n  Distro.selectAll = function(id) {\n    var vm = this;\n    return d3.selectAll('#distro ' + id);\n  };\n\n  Distro.init(config);\n  return Distro;\n}\n","import * as d3 from 'd3';\n\n/*\n * Heatmap Chart\n */\nexport default function(config, helper) {\n  var Heatmap = Object.create(helper);\n\n  Heatmap.init = function(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    if (!vm._config.size.legendTranslate) {\n      vm._config.size.legendTranslate = 100;\n    }\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n\n    vm._legendElementWidth = vm._gridWidth;\n\n    vm._tip = vm.utils.d3\n      .tip()\n      .attr(\n        'class',\n        'd3-tip ' +\n          (vm._config.tooltip && vm._config.tooltip.classed\n            ? vm._config.tooltip.classed\n            : '')\n      )\n      .direction('n')\n      .html(\n        vm._config.tip ||\n          function(d) {\n            var html = d.x;\n            if (d.x !== d.y) {\n              html += '<br>' + d.y;\n            }\n            html += '<br>' + vm.utils.format()(d.value);\n            return html;\n          }\n      );\n  };\n\n  //-------------------------------\n  //User config functions\n  Heatmap.x = function(column) {\n    var vm = this;\n    vm._config.x = column;\n    return vm;\n  };\n\n  Heatmap.y = function(column) {\n    var vm = this;\n    vm._config.y = column;\n    return vm;\n  };\n\n  Heatmap.fill = function(column) {\n    var vm = this;\n    vm._config.fill = column;\n    return vm;\n  };\n\n  Heatmap.colors = function(colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    return vm;\n  };\n\n  Heatmap.colorLegend = function(legendTitle) {\n    var vm = this;\n    vm._config.legendTitle = legendTitle;\n    return vm;\n  };\n\n  /**\n   * Personalize border radius (rx, ry) for each rect\n   * @param {number} radius - value to be set, default is 5\n   */\n  Heatmap.borderRadius = function(radius) {\n    var vm = this;\n    vm._config.borderRadius = radius;\n    return vm;\n  };\n\n  Heatmap.sortBy = function(sortBy) {\n    var vm = this;\n    vm._config.sortBy = sortBy;\n    return vm;\n  };\n\n  Heatmap.tip = function(tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  //-------------------------------\n  //Triggered by chart.js;\n  Heatmap.data = function(data) {\n    var vm = this;\n    var xSort = vm.utils.sortAscending;\n    var ySort = vm.utils.sortAscending;\n\n    if (typeof vm._config.sortBy === 'string') {\n      if (vm._config.hasOwnProperty('sortBy') && vm._config.sortBy === 'desc')\n        xSort = vm.utils.sortDescending;\n    }\n\n    if (typeof vm._config.sortBy === 'object') {\n      if (\n        vm._config.hasOwnProperty('sortBy') &&\n        vm._config.sortBy.hasOwnProperty('x') &&\n        vm._config.sortBy.x === 'desc'\n      )\n        xSort = vm.utils.sortDescending;\n      if (\n        vm._config.hasOwnProperty('sortBy') &&\n        vm._config.sortBy.hasOwnProperty('y') &&\n        vm._config.sortBy.y === 'desc'\n      )\n        ySort = vm.utils.sortDescending;\n    }\n\n    vm._config.xCategories = d3\n      .nest()\n      .key(function(d) {\n        return d[vm._config.x];\n      })\n      .sortKeys(xSort)\n      .entries(data)\n      .map(function(d) {\n        return d.key;\n      });\n\n    vm._config.yCategories = d3\n      .nest()\n      .key(function(d) {\n        return d[vm._config.y];\n      })\n      .sortKeys(ySort)\n      .entries(data)\n      .map(function(d) {\n        return d.key;\n      });\n\n    vm._config.fillValues = d3\n      .nest()\n      .key(function(d) {\n        return d[vm._config.fill];\n      })\n      .entries(data)\n      .map(function(d) {\n        return Number(d.key);\n      });\n\n    /**\n     * Calculate grid width and height according to chart size\n     */\n    vm._gridWidth = Math.floor(\n      (vm._config.size.width -\n        (vm._config.size.margin.left + vm._config.size.margin.right)) /\n        vm._config.xCategories.length\n    );\n\n    vm._gridHeight = Math.floor(\n      (vm._config.size.height -\n        (vm._config.size.margin.top + vm._config.size.margin.bottom)) /\n        vm._config.yCategories.length\n    );\n\n    vm._data = data.map(function(d) {\n      var m = {\n        y: d[vm._config.y],\n        x: d[vm._config.x],\n        value: +d[vm._config.fill]\n      };\n      if (d.coefficient) {\n        m.coefficient = d.coefficient.toFixed(2);\n      }\n      return m;\n    });\n\n    return vm;\n  };\n\n  Heatmap.scales = function() {\n    var vm = this;\n    return vm;\n  };\n\n  Heatmap.drawColorLegend = function() {\n    var vm = this;\n\n    var domain = vm._config.colors;\n    var quantilePosition = d3\n      .scaleBand()\n      .rangeRound([vm._config.size.height * 0.8, 0])\n      .domain(domain);\n    //Add gradient legend\n    //defaults to right position\n    var legend = d3\n      .select(vm._config.bindTo)\n      .select('svg')\n      .append('g')\n      .attr('class', 'legend quantized')\n      .attr(\n        'transform',\n        'translate(' +\n          (vm._config.size.width - vm._config.size.legendTranslate) +\n          ',' +\n          vm._config.size.height * 0.1 +\n          ')'\n      );\n\n    // legend background\n    legend\n      .append('rect')\n      .attr('x', -50)\n      .attr('y', -35)\n      .attr('width', 100)\n      .attr('height', vm._config.size.height - 10)\n      .attr('rx', 10)\n      .attr('ry', 10)\n      .attr('class', 'legend-background')\n      .attr('fill', 'rgba(255,255,255,0.6)');\n\n    // legend title\n    legend\n      .append('text')\n      .attr('x', 0)\n      .attr('y', -12)\n      .attr('class', 'legend-title')\n      .attr('text-anchor', 'middle')\n      .text(vm._config.legendTitle);\n\n    var quantiles = legend\n      .selectAll('.quantile')\n      .data(vm._config.colors)\n      .enter()\n      .append('g')\n      .attr('class', 'quantile')\n      .attr('transform', function(d) {\n        return 'translate(-20, ' + quantilePosition(d) + ')';\n      });\n\n    // Rect\n    quantiles\n      .append('rect')\n      .attr('x', -15)\n      .attr('y', 0)\n      .attr('width', 18)\n      .attr('height', quantilePosition.bandwidth())\n      .attr('fill', function(d) {\n        return d;\n      });\n\n    //top text is the max value\n    quantiles\n      .append('text')\n      .attr('x', 17)\n      .attr('y', 5)\n      .attr('class', 'top-label')\n      .attr('text-anchor', 'left')\n      .text(function(d) {\n        let max = vm._scales.color.invertExtent(d)[1];\n        if (vm._config.legendTitle === 'Porcentaje' && max > 100) {\n          max = 100;\n        }\n        return vm.utils.format()(max);\n      });\n\n    //top text is the min value\n    quantiles\n      .append('text')\n      .attr('x', 17)\n      .attr('y', vm._config.size.height / 5 - 18)\n      .attr('class', 'bottom-label')\n      .attr('text-anchor', 'left')\n      .text(function(d, i) {\n        if (i === 0) {\n          let min = vm._scales.color.invertExtent(d)[0];\n          return vm.utils.format()(min);\n        } else {\n          return '';\n        }\n      });\n  };\n\n  Heatmap.drawLabels = function() {\n    var vm = this;\n    var cards = vm.chart\n      .svg()\n      .selectAll('.dbox-label')\n      .data(vm._data, function(d) {\n        return d.y + ':' + d.x;\n      });\n    // AXIS\n    /*cards.enter().append('text')\n      .attr('transform', 'translate(' + (-vm._gridWidth/2) + ', 10)')\n      .attr('dx', function(d){ \n        return (((vm._config.xCategories.indexOf(String(d.x))) + 1) * vm._gridWidth);\n      })\n      .attr('dy', function(d) {\n        return (vm._config.yCategories.indexOf(String(d.y))) * vm._gridHeight;\n      })\n      .attr('class', 'dbox-label')\n      .text( function(d) { return d.x });\n\n    cards.enter().append('text')\n      .attr('transform', 'translate(' + (-vm._gridWidth/2) + ', 30)')\n      .attr('dx', function(d){\n        return (((vm._config.xCategories.indexOf(String(d.x))) + 1) * vm._gridWidth)\n      })\n      .attr('dy', function(d) {\n        return (vm._config.yCategories.indexOf(String(d.y))) * vm._gridHeight;\n      })\n      .attr('class', 'dbox-label')\n      .text( function(d) { return d.y });*/\n\n    cards\n      .enter()\n      .append('text')\n      .attr('text-anchor', 'middle')\n      .attr('transform', 'translate(' + (-vm._gridWidth / 2 + 17) + ', 20)')\n      .attr('dx', function(d) {\n        return (\n          (vm._config.xCategories.indexOf(String(d.x)) + 1) * vm._gridWidth\n        );\n      })\n      .attr('dy', function(d) {\n        return vm._config.yCategories.indexOf(String(d.y)) * vm._gridHeight;\n      })\n      .attr('class', 'dbox-label')\n      .text(function(d) {\n        return d.value ? vm.utils.format()(d.value) : '';\n      });\n\n    //COEFFICIENT\n    cards\n      .enter()\n      .append('text')\n      .attr('transform', 'translate(' + -vm._gridWidth / 2 + ', 40)')\n      .attr('dx', function(d) {\n        return (\n          (vm._config.xCategories.indexOf(String(d.x)) + 1) * vm._gridWidth\n        );\n      })\n      .attr('dy', function(d) {\n        return vm._config.yCategories.indexOf(String(d.y)) * vm._gridHeight;\n      })\n      .attr('class', 'dbox-label-coefficient')\n      .text(function(d) {\n        return d.coefficient\n          ? '(' + parseFloat(d.coefficient).toFixed(1) + ')'\n          : '';\n      });\n  };\n\n  Heatmap.draw = function() {\n    var vm = this;\n\n    //Call the tip\n    vm.chart.svg().call(vm._tip);\n\n    const axesTip = vm.utils.d3.tip().html(d => {\n      return '<div class=\"title-tip\">' + d + '</div>';\n    });\n    vm.chart.svg().call(axesTip);\n\n    vm._yLabels = vm.chart\n      .svg()\n      .append('g')\n      .attr('class', 'y axis')\n      .attr('transform', 'translate(17,0)')\n      .selectAll('.tick')\n      .data(vm._config.yCategories)\n      .enter()\n      .append('g')\n      .attr('class', 'tick')\n      .attr('transform', function(d, i) {\n        return 'translate(0,' + i * vm._gridHeight + ')';\n      })\n      .append('text')\n      .attr('text-anchor', 'end')\n      .attr('transform', 'translate(-6,' + vm._gridHeight / 1.5 + ')')\n      .text(function(d) {\n        return d;\n      });\n\n    vm._yLabels.each(function(d) {\n      if (this.getComputedTextLength() > vm._config.size.margin.left * 0.9) {\n        d3.select(this)\n          .on('mouseover', axesTip.show)\n          .on('mouseout', axesTip.hide);\n        let i = 1;\n        while (\n          this.getComputedTextLength() >\n          vm._config.size.margin.left * 0.8\n        ) {\n          d3.select(this)\n            .text(function(d) {\n              return d.slice(0, -i) + '...';\n            })\n            .attr('title', d);\n          ++i;\n        }\n      }\n    });\n\n    /** Y axis title */\n    if (vm._config.yAxis && vm._config.yAxis.text) {\n      const yAxis = vm.chart.svg().select('.y.axis');\n      yAxis.selectAll('.y-title').remove();\n      vm._yTitle = yAxis\n        .append('g')\n        .attr('class', 'y-title')\n        .attr('transform', function(d, i) {\n          return 'translate(0,' + i * vm._gridHeight + ')';\n        })\n        .append('text')\n        .attr('class', 'axis-title')\n        .attr('font-size', 17)\n        .attr('font-weight', 600)\n        .attr('text-anchor', 'middle')\n        .attr(\n          'transform',\n          `translate(-${vm._config.size.margin.left - 3}, ${(vm._config.size\n            .height -\n            vm._config.size.margin.bottom) /\n            2} )rotate(-90)`\n        )\n        .text(vm._config.yAxis.text);\n    }\n\n    vm._xLabels = vm.chart\n      .svg()\n      .append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(23,0)')\n      .selectAll('.tick')\n      .data(vm._config.xCategories)\n      .enter()\n      .append('g')\n      .attr('class', 'tick')\n      .attr('transform', function(d, i) {\n        return (\n          'translate(' +\n          (i * vm._gridWidth + vm._gridWidth / 2) +\n          ',' +\n          (vm._config.yCategories.length * vm._gridHeight + 20) +\n          ')'\n        );\n      })\n      .append('text')\n      .attr('text-anchor', 'middle')\n      .text(function(d) {\n        return d;\n      });\n\n    const biggestLabelWidth = d3.max(\n      d3\n        .select('.x.axis')\n        .selectAll('text')\n        .nodes()\n        .map(o => o.getComputedTextLength())\n    ); // Biggest label computed text length\n    let xBandWidth = vm._gridWidth;\n    let labelMaxWidth = xBandWidth;\n    if (biggestLabelWidth > xBandWidth) {\n      // Biggest label doesn't fit\n      vm._xLabels.each(function(d) {\n        d3.select(this)\n          .attr('text-anchor', 'end')\n          .attr('dy', 0)\n          .attr('transform', 'translate(-5,-10)rotate(-90)');\n        // Still doesn't fit!\n        labelMaxWidth = 0.75 * vm._config.size.margin.bottom;\n        if (this.getComputedTextLength() > labelMaxWidth) {\n          d3.select(this)\n            .on('mouseover', axesTip.show)\n            .on('mouseout', axesTip.hide);\n          let i = 1;\n          while (this.getComputedTextLength() > labelMaxWidth) {\n            d3.select(this)\n              .text(function(d) {\n                return d.slice(0, -i) + '...';\n              })\n              .attr('title', d);\n            ++i;\n          }\n        } else {\n          return d;\n        }\n      });\n    }\n\n    if (vm._config.xAxis && vm._config.xAxis.text) {\n      const xAxis = vm.chart.svg().select('.x.axis');\n      xAxis.selectAll('.x-title').remove();\n      vm._xTitle = xAxis\n        .append('g')\n        .attr('class', 'x-title')\n        .attr('transform', function(d, i) {\n          return 'translate(0,' + i * vm._gridHeight + ')';\n        })\n        .append('text')\n        .attr('class', 'axis-title')\n        .attr('font-size', 17)\n        .attr('font-weight', 600)\n        .attr('text-anchor', 'middle')\n        .attr(\n          'transform',\n          `translate(${(vm._config.size.width -\n            vm._config.size.margin.left -\n            vm._config.size.margin.right) /\n            2}, ${vm._config.size.height - 20})`\n        )\n        .text(vm._config.xAxis.text);\n    }\n\n    vm._scales.color = d3\n      .scaleQuantile()\n      .domain(\n        vm._data\n          .map(d => {\n            return d.value;\n          })\n          .sort()\n      )\n      .range(vm._config.colors);\n\n    var cards = vm.chart\n      .svg()\n      .append('g')\n      .attr('class', 'grid-container')\n      .attr('transform', 'translate(17, 0)')\n      .selectAll('.grid-cell')\n      .data(vm._data, function(d) {\n        return d.y + ':' + d.x;\n      });\n\n    cards\n      .enter()\n      .append('rect')\n      .attr('x', function(d) {\n        return vm._config.xCategories.indexOf(String(d.x)) * vm._gridWidth;\n      })\n      .attr('y', function(d) {\n        return vm._config.yCategories.indexOf(String(d.y)) * vm._gridHeight;\n      })\n      .attr('rx', vm._config.borderRadius || 5)\n      .attr('ry', vm._config.borderRadius || 5)\n\n      .attr('class', 'grid-cell')\n      .attr('stroke', '#fff')\n      .attr('stroke-width', '2px')\n      .attr('id', function(d) {\n        return 'x' + d.x + 'y' + d.y;\n      })\n      .attr('width', vm._gridWidth)\n      .attr('height', vm._gridHeight)\n      .on('mouseover', function(d, i) {\n        vm._tip.show(d, d3.select(this).node());\n        if (vm._config.hasOwnProperty('mouseover')) {\n          vm._config.mouseover.call(vm, d, i);\n        }\n      })\n      .on('mouseout', function(d, i) {\n        vm._tip.hide(d, d3.select(this).node());\n        if (vm._config.hasOwnProperty('mouseout')) {\n          vm._config.mouseout.call(this, d, i);\n        }\n      })\n      .on('click', function(d, i) {\n        if (vm._config.hasOwnProperty('onclick')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      })\n      .attr('fill', function(d) {\n        return vm._scales.color(d.value);\n      });\n\n    Heatmap.drawLabels();\n\n    if (vm._config.hasOwnProperty('legendTitle')) {\n      Heatmap.drawColorLegend();\n    }\n\n    /*\n      var legend = vm.chart.svg().selectAll('.legend')\n          .data([0].concat(colorScale.quantiles()), function(d) { return d; });\n\n      var lgroup = legend.enter().append('g')\n          .attr('class', 'legend');\n\n      lgroup.append('rect')\n          .attr('x', function(d, i) {  return vm._legendElementWidth * i; })\n          .attr('y', vm._config.size.height - vm._config.size.margin.bottom*2)\n          .attr('width', vm._legendElementWidth)\n          .attr('height', vm._gridWidth / 2)\n          .style('fill', function(d, i) { return vm._config.colors[i]; });\n\n      lgroup.append('text')\n          .attr('class', 'mono')\n          .text(function(d) { return '‚â• ' + Math.round(d); })\n          .attr('x', function(d, i) { return vm._legendElementWidth * i; })\n          .attr('y', vm._config.size.height - vm._config.size.margin.bottom*2 + vm._gridWidth);\n\n      legend.exit().remove();*/\n    return vm;\n  };\n\n  Heatmap.init(config);\n\n  return Heatmap;\n}\n","import * as d3 from 'd3';\nvar L = require('leaflet');\nimport * as topojson from 'topojson';\n/**\n * Leaflet Chart\n */\n\nexport default function (config, helper) {\n  var Leaflet = Object.create(helper);\n\n  Leaflet.init = function (config) {\n    const vm = this;\n    vm._config = config ? config : {};\n    vm._scales = {};\n    vm._axes = {};\n    vm._data = [];\n\n    vm._scales.color = d3\n      .scaleQuantize()\n      .range(['#fee5d9', '#fcae91', '#fb6a4a', '#de2d26', '#a50f15']);\n  };\n\n  Leaflet.id = function (col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  };\n\n  Leaflet.fill = function (col) {\n    var vm = this;\n    vm._config.fill = col;\n    return vm;\n  };\n\n  Leaflet.opacity = function (value) {\n    var vm = this;\n    vm._config.opacity = value;\n    return vm;\n  };\n\n  Leaflet.colors = function (colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    if (colors && Array.isArray(colors)) {\n      vm._scales.color.range(colors);\n    } else if (typeof colors === 'function') {\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Leaflet.colorLegend = function (legendTitle) {\n    var vm = this;\n    vm._config.legendTitle = legendTitle;\n    return vm;\n  };\n\n  // -------------------------------\n  // Triggered by chart.js;\n  Leaflet.data = function (data) {\n    var vm = this;\n    vm._topojson = data[1] ? data[1] : false; //Topojson\n    data = data[0]; //User data\n\n    if (vm._config.data.filter) {\n      data = data.filter(vm._config.data.filter);\n    }\n\n    vm._data = data;\n    //vm._quantiles = vm._setQuantile(data);\n    vm._minMax = d3.extent(data, function (d) {\n      return +d[vm._config.fill];\n    });\n\n    vm._scales.color.domain(vm._minMax);\n\n    var objects = vm._config.map.topojson.objects;\n\n    vm._nodes = [];\n    if (Array.isArray(objects)) {\n      for (let idx = 0; idx < objects.length; idx++) {\n        const obj = objects[idx];\n        vm._topojson.objects[obj].geometries.forEach(function (geom) {\n          geom.id = vm._config.map.topojson.parser(geom);\n          var found = vm._data.filter((o) => o[vm._config.id] == geom.id)[0];\n          if (found) {\n            geom.properties[vm._config.fill] = found[vm._config.fill];\n          }\n          vm._nodes.push(geom);\n        });\n      }\n    } else if (objects) {\n      vm._topojson.objects[objects].geometries.forEach(function (geom) {\n        geom.id = vm._config.map.topojson.parser(geom);\n        var found = vm._data.filter((o) => o[vm._config.id] == geom.id)[0];\n        if (found) {\n          geom.properties[vm._config.fill] = found[vm._config.fill];\n        }\n        vm._nodes.push(geom);\n      });\n    }\n\n    // vm._config.map.min = vm._minMax[0];\n    // vm._config.map.max = vm._minMax[1];\n    return vm;\n  };\n\n  Leaflet.scales = function () {\n    var vm = this;\n    return vm;\n  };\n\n  Leaflet.drawColorLegend = function () {\n    var vm = this;\n\n    var range = vm._scales.color.range().length;\n    var step = (vm._minMax[1] - vm._minMax[0]) / (range - 1);\n    var domain = vm._config.colors;\n\n    var quantilePosition = d3\n      .scaleBand()\n      .rangeRound([vm._config.size.height * 0.8, 0])\n      .domain(domain);\n    //Add gradient legend\n    //defaults to right position\n    var legend = d3\n      .select('#' + vm._config.bindTo)\n      .append('svg')\n      .attr('width', 120)\n      .attr('height', vm._config.size.height)\n      .style('z-index', 401)\n      .style('position', 'absolute')\n      .style('top', '4px')\n      .style('right', '2px')\n      .append('g')\n      .attr('class', 'legend quantized')\n      .attr('transform', 'translate(50,25)');\n\n    // legend background\n    legend\n      .append('rect')\n      .attr('x', -50)\n      .attr('y', -35)\n      .attr('width', 100)\n      .attr('height', vm._config.size.height - 10)\n      .attr('rx', 10)\n      .attr('ry', 10)\n      .attr('class', 'legend-background')\n      .attr('fill', 'rgba(255,255,255,0.6)');\n\n    // legend title\n    legend\n      .append('text')\n      .attr('x', 0)\n      .attr('y', -12)\n      .attr('class', 'legend-title')\n      .attr('text-anchor', 'middle')\n      .text(vm._config.legendTitle);\n\n    var quantiles = legend\n      .selectAll('.quantile')\n      .data(vm._config.colors)\n      .enter()\n      .append('g')\n      .attr('class', 'quantile')\n      .attr('transform', function (d) {\n        return 'translate(-20, ' + quantilePosition(d) + ')';\n      });\n\n    // Rect\n    quantiles\n      .append('rect')\n      .attr('x', -10)\n      .attr('y', 0)\n      .attr('width', 18)\n      .attr('height', quantilePosition.bandwidth())\n      .attr('fill', function (d) {\n        return d;\n      });\n\n    //top text is the max value\n    quantiles\n      .append('text')\n      .attr('x', 17)\n      .attr('y', 5)\n      .attr('class', 'top-label')\n      .attr('text-anchor', 'left')\n      .text(function (d) {\n        let max = vm._scales.color.invertExtent(d)[1];\n        if (vm._config.legendTitle === 'Porcentaje' && max > 100) {\n          max = 100;\n        }\n        if (vm._config.map.formatLegend) {\n          return vm._config.map.formatLegend(max);\n        } else {\n          return vm.utils.format(max);\n        }\n      });\n\n    //bottom text is the min value\n    quantiles\n      .append('text')\n      .attr('x', 17)\n      .attr('y', vm._config.size.height / 5 - 11)\n      .attr('class', 'bottom-label')\n      .attr('text-anchor', 'left')\n      .text(function (d, i) {\n        if (i === 0) {\n          let min = vm._scales.color.invertExtent(d)[0];\n          if (vm._config.map.formatLegend) {\n            return vm._config.map.formatLegend(min);\n          } else {\n            return vm.utils.format(min);\n          }\n        } else {\n          return '';\n        }\n      });\n  };\n\n  Leaflet.draw = function () {\n    var vm = this;\n\n    var urlTopojson = vm._config.map.topojson.url;\n    var objects = vm._config.map.topojson.objects; //'states'\n    var tran = vm._config.map.topojson.translate; //var tran = [2580, 700];\n    var scale = vm._config.map.topojson.scale; //1300\n    var parser = vm._config.map.topojson.parser;\n    var id = vm._config.map.topojson.id;\n\n    L.TopoJSON = L.GeoJSON.extend({\n      addData: function (jsonData) {\n        var geojson, key;\n        if (jsonData.type === 'Topology') {\n          if (objects) {\n            if (Array.isArray(objects)) {\n              for (let idx = 0; idx < objects.length; idx++) {\n                const obj = objects[idx];\n                geojson = topojson.feature(jsonData, jsonData.objects[obj]);\n                L.GeoJSON.prototype.addData.call(this, geojson);\n              }\n            } else {\n              geojson = topojson.feature(jsonData, jsonData.objects[objects]);\n              L.GeoJSON.prototype.addData.call(this, geojson);\n            }\n          } else {\n            for (key in jsonData.objects) {\n              geojson = topojson.feature(jsonData, jsonData.objects[key]);\n              L.GeoJSON.prototype.addData.call(this, geojson);\n            }\n          }\n        } else {\n          L.GeoJSON.prototype.addData.call(this, jsonData);\n        }\n      },\n    });\n\n    var LatLng = {\n      lat: 25.5629994,\n      lon: -100.6405644,\n    };\n    if (\n      vm._config.map.topojson.center &&\n      vm._config.map.topojson.center.length === 2\n    ) {\n      LatLng.lat = vm._config.map.topojson.center[0];\n      LatLng.lon = vm._config.map.topojson.center[1];\n    }\n\n    var bounds = new L.LatLngBounds(\n      new L.LatLng(LatLng.lat + 5, LatLng.lon - 5),\n      new L.LatLng(LatLng.lat - 5, LatLng.lon + 5)\n    );\n\n    vm._map = new L.Map(vm._config.bindTo, {\n      center: bounds.getCenter(),\n      zoom: vm._config.map.topojson.zoom || 7,\n      maxZoom: vm._config.map.topojson.maxZoom || 10,\n      minZoom: vm._config.map.topojson.minZoom || 3,\n      maxBounds: bounds,\n      maxBoundsViscosity: 1.0,\n    });\n\n    var mapTiles = L.tileLayer(\n      'http://b.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png',\n      {\n        attribution:\n          '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\n      }\n    );\n    var topoLayer = new L.TopoJSON();\n\n    mapTiles.addTo(vm._map);\n    addTopoData(vm._topojson);\n\n    // vm._map.on('zoomend', function() {\n    //   d3.selectAll('.dbox-label').remove();\n    //   Object.values(vm._map._layers)\n    //     .filter(obj => obj.feature)\n    //     .forEach(function(layer) {\n    //     vm.drawLabel(layer);\n    //   });\n    // });\n\n    function addTopoData(topoData) {\n      topoLayer.addData(topoData);\n      topoLayer.addTo(vm._map);\n      topoLayer.eachLayer(handleLayer);\n    }\n\n    var tip = vm.utils.d3.tip().html(\n      vm._config.tip\n        ? vm._config.tip.bind(this)\n        : function (d) {\n            let html =\n              '<div class=\"d3-tip\" style=\"z-index: 99999;\"><span>' +\n              (d.feature.properties.NOM_ENT || d.feature.properties.NOM_MUN) +\n              '</span><br/><span>' +\n              vm.utils.format()(d.feature.properties[vm._config.fill]) +\n              '</span></div>';\n            return html;\n          }\n    );\n    d3.select('#' + vm._config.bindTo)\n      .select('svg.leaflet-zoom-animated')\n      .call(tip);\n\n    /**\n     * Set each layer\n     * @param {obj} layer\n     */\n    function handleLayer(layer) {\n      var value = layer.feature.properties[vm._config.fill];\n      if (!value) {\n        // Remove polygons without data\n        /** @todo validate what to do with NA's */\n        d3.select(layer._path).remove();\n      } else {\n        var fillColor = vm._scales.color(value);\n\n        layer.setStyle({\n          fillColor: fillColor,\n          fillOpacity: vm._config.opacity || 0.7,\n          color: '#555',\n          weight: 1,\n          opacity: 0.5,\n        });\n\n        vm.drawLabel(layer);\n\n        layer.on({\n          mouseover: function () {\n            enterLayer(layer);\n          },\n          mouseout: function () {\n            leaveLayer(layer);\n          },\n        });\n      }\n    }\n\n    function enterLayer(layer) {\n      tip.show(layer, d3.select(layer._path).node());\n    }\n\n    function leaveLayer(layer) {\n      tip.hide(layer);\n    }\n\n    /**\n     * Draw Legend\n     */\n    if (typeof vm._config.legend === 'function') {\n      vm._config.legend.call(this, vm._nodes);\n    }\n\n    Leaflet.drawColorLegend();\n\n    return vm;\n  };\n\n  /**\n   * Add labels for each path (layer) to display value\n   */\n  Leaflet.drawLabel = function (layer) {\n    const vm = this;\n    const props = layer.feature.properties;\n    const path = d3.select(layer._path).node();\n    const bbox = path.getBBox();\n    var svg = d3\n      .select('#' + vm._config.bindTo)\n      .select('svg.leaflet-zoom-animated');\n\n    if (props[vm._config.fill] !== undefined) {\n      svg\n        .append('text')\n        .attr('class', 'dbox-label')\n        .attr('x', bbox.x + bbox.width / 2)\n        .attr('y', bbox.y + d3.min([bbox.height / 2, 30]))\n        .attr('text-anchor', 'middle')\n        .text(\n          (props.NOM_ENT || props.NOM_MUN) +\n            ': ' +\n            vm.utils.format(props[vm._config.fill])\n        );\n    }\n    return vm;\n  };\n\n  Leaflet.init(config);\n\n  return Leaflet;\n}\n","import * as d3 from 'd3';\n/*\n * Map\n */\n\nexport default function(config) {\n  function Map(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    vm._tip = vm.utils.d3\n      .tip()\n      .attr(\n        'class',\n        'd3-tip ' +\n          (vm._config.tooltip && vm._config.tooltip.classed\n            ? vm._config.tooltip.classed\n            : '')\n      );\n\n    vm._formatWithZeroDecimals = d3.format(',.0f');\n    vm._formatWithOneDecimal = d3.format(',.1f');\n    vm._formatWithTwoDecimals = d3.format(',.2f');\n    vm._formatWithThreeDecimals = d3.format(',.3f');\n\n    vm._format = {};\n    vm._format.total = vm._formatWithZeroDecimals;\n    vm._format.percentage = function(d) {\n      return d3.format(',.1f')(d) + '%';\n    };\n    vm._format.change = d3.format(',.1f');\n  }\n\n  //-------------------------------\n  //User config functions\n\n  Map.prototype.id = function(col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  };\n\n  Map.prototype.color = function(col) {\n    var vm = this;\n    vm._config.color = col;\n    return vm;\n  };\n\n  Map.prototype.tip = function(tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  Map.prototype.onclick = function(onclick) {\n    var vm = this;\n    vm._config.onclick = onclick;\n    return vm;\n  };\n\n  Map.prototype.end = function() {\n    var vm = this;\n    return vm._chart;\n  };\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Map.prototype.chart = function(chart) {\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  };\n\n  Map.prototype.data = function(data) {\n    var vm = this;\n\n    vm._topojson = data[1] ? data[1] : false; //Topojson\n    var data = data[0]; //User data\n\n    if (vm._config.data.filter) {\n      data = data[0].filter(vm._config.data.filter);\n    }\n\n    vm._data = data;\n    vm._quantiles = vm._setQuantile(data);\n    vm._minMax = d3.extent(data, function(d) {\n      return +d[vm._config.color];\n    });\n\n    vm._config.map.min = vm._minMax[0];\n    vm._config.map.max = vm._minMax[1];\n\n    return vm;\n  };\n\n  Map.prototype.scales = function(s) {\n    var vm = this;\n    vm._scales = s;\n    return vm;\n  };\n\n  Map.prototype.axes = function(a) {\n    var vm = this;\n    vm._axes = a;\n    return vm;\n  };\n\n  Map.prototype.domains = function() {\n    var vm = this;\n    return vm;\n  };\n\n  Map.prototype.draw = function() {\n    var vm = this;\n\n    //@config\n    var urlTopojson = vm._config.map.topojson.url;\n    var objects = vm._config.map.topojson.objects; //'states'\n    var tran = vm._config.map.topojson.translate; //var tran = [2580, 700];\n    var scale = vm._config.map.topojson.scale; //1300\n\n    var parser = vm._config.map.topojson.parser;\n\n    var id = vm._config.map.topojson.id;\n\n    //Call the tip\n    vm._chart._svg.call(vm._tip);\n\n    vm._projection = d3\n      .geoMercator()\n      .scale(scale)\n      .translate(tran);\n\n    vm.path = d3.geoPath().projection(vm._projection);\n\n    vm._polygons = vm._chart._svg\n      .append('g')\n      .attr('id', 'dbox-map-polygons')\n      .style('display', 'true')\n      .attr('transform', function() {\n        return (\n          'translate(' +\n          vm._config.size.translateX +\n          ',100) scale(' +\n          vm._config.size.scale +\n          ')'\n        );\n      });\n\n    var features = topojson.feature(vm._topojson, vm._topojson.objects[objects])\n      .features;\n\n    if (typeof vm._config.map.topojson.filter != 'undefined') {\n      var filter = vm._config.map.topojson.filter;\n      Object.keys(filter).map(function(key) {\n        features = features.filter(\n          feature => feature.properties[key] === filter[key]\n        );\n      });\n    }\n\n    vm._polygons\n      .selectAll('path')\n      .data(features, parser)\n      .enter()\n      .append('path')\n      .attr('d', d3.geoPath().projection(vm._projection))\n      .attr('id', id)\n      .attr('data-geotype', objects)\n      .attr('fill', '#808080')\n      .attr('stroke', '#a0a0a0')\n      .style('stroke-width', '1px')\n      .on('mouseover', function(d, i) {\n        if (vm._config.map.quantiles.colorsOnHover) {\n          //OnHover colors\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.color], 'onHover');\n          });\n        }\n\n        //vm._tip.show(d, d3.select(this).node()) //Show TIP\n\n        if (vm._config.data.onmouseover) {\n          //External function call\n          vm._config.data.onmouseover.call(this, d, i);\n        }\n      })\n      .on('mouseout', function(d, i) {\n        if (vm._config.map.quantiles.colorsOnHover) {\n          //OnHover reset default color\n          d3.select(this).attr('fill', function(d) {\n            return vm._getQuantileColor(d[vm._config.color], 'default');\n          });\n        }\n        //Hide tip\n        //vm._tip.hide(d, d3.select(this).node())\n\n        if (vm._config.data.onmouseout) {\n          //External function call\n          vm._config.data.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function(d, i) {\n        if (vm._config.data.onclick) {\n          vm._config.data.onclick.call(this, d, i);\n        }\n      });\n\n    vm._polygonsDefault = vm._polygons.selectAll('path').data();\n\n    vm._polygons\n      .selectAll('path')\n      .attr('stroke', '#333')\n      .attr('stroke-width', 0.2);\n    vm._polygons.selectAll('path').attr('fill', 'red');\n    vm._polygons.selectAll('path').attr('data-total', null);\n    vm._polygons\n      .selectAll('path')\n      .data(vm._data, function(d) {\n        //@TODO WHY THE F..K IS D3 ITERATING OVER THE OLD DATA\n        return d.id ? d.id : d[vm._config.id];\n      })\n      .attr('fill', function(d) {\n        return vm._getQuantileColor(d[vm._config.color], 'default');\n      })\n      .attr('data-total', function(d) {\n        return +d[vm._config.color];\n      });\n\n    //Resets the map paths data to topojson\n    vm._polygons.selectAll('path').data(vm._polygonsDefault, function(d) {\n      return d.id;\n    });\n  };\n\n  Map.prototype._setQuantile = function(data) {\n    var vm = this;\n    var values = [];\n    var quantile = [];\n\n    if (\n      vm._config.map.quantiles &&\n      vm._config.map.quantiles.predefinedQuantiles &&\n      vm._config.map.quantiles.predefinedQuantiles.length > 0\n    ) {\n      return vm._config.map.quantiles.predefinedQuantiles;\n    }\n\n    data.forEach(function(d) {\n      values.push(+d[vm._config.color]);\n    });\n\n    values.sort(d3.ascending);\n\n    //@TODO use quantile scale instead of manual calculations\n    if (\n      vm._config &&\n      vm._config.map &&\n      vm._config.map.quantiles &&\n      vm._config.map.quantiles.buckets\n    ) {\n      if (vm._config.map.quantiles.ignoreZeros === true) {\n        var aux = _.dropWhile(values, function(o) {\n          return o <= 0;\n        });\n        //aux.unshift(values[0]);\n\n        quantile.push(values[0]);\n        quantile.push(0);\n\n        for (var i = 1; i <= vm._config.map.quantiles.buckets - 1; i++) {\n          quantile.push(\n            d3.quantile(aux, (i * 1) / (vm._config.map.quantiles.buckets - 1))\n          );\n        }\n      } else {\n        quantile.push(d3.quantile(values, 0));\n        for (var i = 1; i <= vm._config.map.quantiles.buckets; i++) {\n          quantile.push(\n            d3.quantile(values, (i * 1) / vm._config.map.quantiles.buckets)\n          );\n        }\n      }\n    } else {\n      quantile = [\n        d3.quantile(values, 0),\n        d3.quantile(values, 0.2),\n        d3.quantile(values, 0.4),\n        d3.quantile(values, 0.6),\n        d3.quantile(values, 0.8),\n        d3.quantile(values, 1),\n      ];\n    }\n\n    //@TODO - VALIDATE WHEN ZEROS NEED TO BE PUT ON QUANTILE 1 AND RECALCULATE NON ZERO VALUES INTO THE REST OF THE BUCKETS\n    if (\n      vm._config.map.quantiles &&\n      vm._config.map.quantiles.buckets &&\n      vm._config.map.quantiles.buckets === 5\n    ) {\n      if (\n        quantile[1] === quantile[2] &&\n        quantile[2] === quantile[3] &&\n        quantile[3] === quantile[4] &&\n        quantile[4] === quantile[5]\n      ) {\n        quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2)];\n      }\n    }\n\n    return quantile;\n  };\n\n  Map.prototype._getQuantileColor = function(d, type) {\n    var vm = this;\n    var total = parseFloat(d);\n\n    //@TODO use quantile scale instead of manual calculations\n    if (\n      vm._config &&\n      vm._config.map &&\n      vm._config.map.quantiles &&\n      vm._config.map.quantiles.colors\n    ) {\n      if (vm._quantiles.length > 2) {\n        if (\n          vm._config &&\n          vm._config.map &&\n          vm._config.map.min !== undefined &&\n          vm._config.map.max !== undefined\n        ) {\n          if (total < vm._config.map.min || total > vm._config.map.max) {\n            console.log(\n              'outOfRangeColor',\n              total,\n              vm._config.map.min,\n              vm._config.map.max\n            );\n            return vm._config.map.quantiles.outOfRangeColor;\n          }\n        } else {\n          if (total < vm._minMax[0] || total > vm._minMax[1]) {\n            console.log(\n              'outOfRangeColor',\n              total,\n              vm._config.map.min,\n              vm._config.map.max\n            );\n            return vm._config.map.quantiles.outOfRangeColor;\n          }\n        }\n\n        if (type == 'default') {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.map.quantiles.colors[0]; //\"#f7c7c5\";\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.map.quantiles.colors[1]; //\"#e65158\";\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.map.quantiles.colors[2]; //\"#c20216\";\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.map.quantiles.colors[3]; //\"#750000\";\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.map.quantiles.colors[4]; //\"#480000\";\n          }\n        }\n\n        if (type == 'onHover' && vm._config.map.quantiles.colorsOnHover) {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.map.quantiles.colorsOnHover[0]; //\"#f7c7c5\";\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.map.quantiles.colorsOnHover[1]; //\"#e65158\";\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.map.quantiles.colorsOnHover[2]; //\"#c20216\";\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.map.quantiles.colorsOnHover[3]; //\"#750000\";\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.map.quantiles.colorsOnHover[4]; //\"#480000\";\n          }\n        }\n      }\n    }\n\n    if (vm._quantiles.length == 2) {\n      /*if(total === 0 ){\n        return d4theme.colors.quantiles[0];//return '#fff';\n      }else if(total <= vm._quantiles[1]){\n        return d4theme.colors.quantiles[1];//return \"#f7c7c5\";\n      }*/\n      if (total <= vm._quantiles[1]) {\n        return vm._config.map.quantiles.colors[0]; //\"#f7c7c5\";\n      }\n    }\n  };\n\n  return new Map(config);\n}\n","import * as d3 from 'd3';\n\n/*\n * Build a radar chart.\n */\nexport default function(config) {\n  function Radar(config) {\n    var vm = this, size;\n\n    vm.CIRCLE_RADIANS = 2 * Math.PI;\n\n    // The first axis must be at the circle's top.\n    vm.RADIANS_TO_ROTATE = vm.CIRCLE_RADIANS / -4;\n\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n    vm._axesData = {};\n    vm._filter = null;\n    vm._minMax = [0, 0];\n    vm._viewData = [];\n    vm._colorMap = {};\n    vm._ticks = 0;\n    vm._scale = null;\n    vm._excludedPolygons = [];\n\n    // Set defaults.\n    if(!vm._config.ticks) {\n      vm._config.ticks = 10;\n    }\n\n    if(!vm._config.transitionDuration) {\n      vm._config.transitionDuration = 400;\n    }\n\n    if(!vm._config.axisLabelMargin) {\n      vm._config.axisLabelMargin = 24;\n    }\n\n    if(!vm._config.legend) {\n      vm._config.legend = {\n        enable: true\n      };\n    }\n\n    if(!vm._config.legend.at) {\n      vm._config.legend.at = {\n        x: 20,\n        y: 20\n      };\n    }\n\n    if('undefined' == typeof vm._config.styleDefaults) {\n      vm._config.styleDefaults = true;\n    }\n\n    // Calculate basic data.\n    size = vm._config.size;\n\n    vm._center = {\n      x: (size.width / 2) - size.margin.left,\n      y: (size.height / 2) - size.margin.top\n    };\n\n    vm._radius = Math.min(\n      (size.width - size.margin.left - size.margin.right) / 2,\n      (size.height - size.margin.top - size.margin.bottom) / 2\n    );\n  }\n\n  // User API.\n\n  Radar.prototype.polygonsFrom = function(column) {\n    var vm = this;\n    vm._config.polygonsFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.axesFrom = function(column) {\n    var vm = this;\n    vm._config.axesFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.valuesFrom = function(column) {\n    var vm = this;\n    vm._config.valuesFrom = column;\n    return vm;\n  };\n\n  Radar.prototype.ticks = function(ticks) {\n    var vm = this;\n    vm._config.ticks = ticks;\n    return vm;\n  };\n\n  Radar.prototype.colors = function(colors) {\n    var vm = this;\n    vm._config.colors = colors;\n    return vm;\n  };\n\n  Radar.prototype.end = function() {\n    var vm = this;\n    return vm._chart;\n  };\n\n  // Internal helpers.\n\n  Radar.prototype.drawTicks = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      dur = vm._config.transitionDuration,\n      sel;\n\n    sel = svg.select('g.ticks');\n\n    if(sel.empty()) {\n      sel = svg.append('g').attr('class', 'ticks');\n    }\n\n    sel = sel.selectAll('circle.tick')\n      .data(\n        // Add an explicit index for keying the chart with their original array\n        // indexes, then reverse it so rendering occurs from bigger to smaller\n        // circles, allowing to set a fill color to the concentric cirlces\n        // without getting the more external cirlce capping all the others.\n        vm._ticks.map((val, idx) => [idx, val]).reverse(),\n        d => d[0]);\n\n    sel\n      .transition()\n      .duration(dur)\n      .attr('r', function(d) { return vm._scale(d[1]); });\n\n    sel.enter()\n      .append('circle')\n      .classed('tick', true)\n      .attr('cx', vm._center.x)\n      .attr('cy', vm._center.y)\n      .style('fill', vm._ifStyleDefaults('none'))\n      .style('stroke', vm._ifStyleDefaults('gray'))\n      .attr('r', function(d) { return vm._scale(d[1]); })\n      .attr('opacity', 0)\n      .transition()\n      .duration(dur)\n      .attr('opacity', 1);\n\n    sel.exit()\n      .transition()\n      .duration(dur)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.drawTicksLabels = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      margin = 2,\n      dur = vm._config.transitionDuration,\n      sel;\n\n    sel = svg.select('g.ticks-labels');\n\n    if(sel.empty()) {\n      sel = svg.append('g').attr('class', 'ticks-labels');\n    }\n\n    sel = sel.selectAll('text.tick-label')\n      .data(vm._ticks);\n\n    sel\n      .transition()\n      .duration(dur)\n      .text(function(d) { return d; })\n      .attr('y', function(d) { return vm._center.y - margin - vm._scale(d); });\n\n    sel.enter()\n      .append('text')\n      .text(function(d) { return d.toFixed(1); })\n      .attr('class', 'tick-label')\n      .attr('x', vm._center.x + margin)\n      .attr('y', function(d) { return vm._center.y - margin - vm._scale(d); })\n      .attr('fill', vm._ifStyleDefaults('gray'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'))\n      .attr('opacity', 0)\n      .transition()\n      .duration(dur)\n      .attr('opacity', 1);\n\n    sel.exit()\n      .transition()\n      .duration(dur)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.extractAxes = function(data) {\n    var result,\n      vm = this,\n      axes = vm._config.axesFrom,\n      radiansPerAxis;\n\n    result = data.reduce(\n      function(prev, item) {\n        return prev.indexOf(item[axes]) > -1\n          ? prev\n          : prev.concat(item[axes]);\n      }, []);\n\n    radiansPerAxis = (vm.CIRCLE_RADIANS / result.length);\n\n    result = result.map(\n      function(item, idx) {\n        return {\n          axis: item,\n          rads: (idx * radiansPerAxis) + vm.RADIANS_TO_ROTATE\n        };\n      });\n\n    return {\n      list: result,\n      hash: result.reduce(function(hashed, el) {\n        hashed[el.axis] = el;\n        return hashed;\n      }, {})\n    };\n  };\n\n  Radar.prototype.buildColorMap = function(data) {\n    var vm = this,\n      colors = vm._config.colors;\n    return data.reduce(function(cMap, row) {\n      var polyg = row[vm._config.polygonsFrom],\n        cIdx = cMap.index.indexOf(polyg);\n\n      if(cIdx == -1) {\n        cIdx = cMap.index.push(polyg) - 1;\n        cMap.hash[polyg] = colors[cIdx];\n        cMap.list.push({polygon: polyg, color: colors[cIdx]});\n      }\n      return cMap;\n    }, {index: [], hash: {}, list: []});\n  };\n\n  Radar.prototype.drawAxes = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      selection;\n\n    selection = svg.selectAll('line.axis')\n      .data(vm._axesData.list, function(d) { return d.axis; });\n\n    selection.enter()\n      .append('line')\n      .classed('axis', true)\n      .attr('x1', vm._center.x)\n      .attr('y1', vm._center.y)\n      .style('stroke', vm._ifStyleDefaults('gray'))\n      .attr('x2', vm._center.x)\n      .attr('y2', vm._center.y)\n      .transition()\n      .duration(duration)\n      .attr('x2', function(d) {\n        return vm.xOf(d.rads, vm._radius + 8);\n      })\n      .attr('y2', function(d) {\n        return vm.yOf(d.rads, vm._radius + 8);\n      });\n\n    selection\n      .transition()\n      .duration(duration)\n      .attr('x2', function(d) {\n        return vm.xOf(d.rads, vm._radius + 8);\n      })\n      .attr('y2', function(d) {\n        return vm.yOf(d.rads, vm._radius + 8);\n      });\n\n    selection.exit()\n      .transition()\n      .duration(duration)\n      .attr('x2', vm._center.x)\n      .attr('y2', vm._center.y)\n      .remove();\n  };\n\n  Radar.prototype.drawAxesLabels = function() {\n    var vm = this,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      fromCenter = vm._radius + vm._config.axisLabelMargin,\n      labels,\n      rects;\n\n\n\n\n    rects = svg.selectAll('rect.axis-label')\n      .data(vm._axesData.list, function(d) { return d.axis; });\n\n    rects.enter()\n      .append('rect')\n      .attr('class', 'axis-label')\n      .attr('x', (d) => vm.xOf(d.rads, fromCenter) - 50)\n      .attr('y', (d) => vm.yOf(d.rads, fromCenter) - 20)\n      .attr('rx', '5px')\n      .attr('ry', '5px')\n      .attr('width', '100px')\n      .attr('height', '40px')\n      .attr('fill', '#A3A3AF')\n      .attr('opacity', 0)\n      .transition()\n      .duration(duration)\n      .attr('opacity', 1);\n\n    rects.exit()\n      .transition()\n      .duration(duration)\n      .attr('opacity', 0)\n      .remove();\n\n\n    labels = svg.selectAll('text.axis-label')\n      .data(vm._axesData.list, function(d) { return d.axis; });\n\n    labels\n      .transition()\n      .duration(duration)\n      .attr('x', (d) => vm.xOf(d.rads, fromCenter+5))\n      .attr('y', (d) => vm.yOf(d.rads, fromCenter+5));\n\n    labels.enter()\n      .append('text')\n      .attr('class', 'axis-label')\n      .attr('text-anchor', 'middle')\n      .attr('fill', 'white')//vm._ifStyleDefaults('gray'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'))\n      .text(function(d) { return d.axis; })\n      .attr('x', (d) => vm.xOf(d.rads, fromCenter+5))\n      .attr('y', (d) => vm.yOf(d.rads, fromCenter+5))\n      .attr('opacity', 0)\n      .transition()\n      .duration(duration)\n      .attr('opacity', 1);\n\n    labels.exit()\n      .transition()\n      .duration(duration)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype.drawPolygons = function() {\n\n\n    var vm = this,\n      data = vm._viewData,\n      svg = vm._chart._svg,\n      duration = vm._config.transitionDuration,\n      groupedData,\n      gs, gsExit, gsEnter;\n\n    // Prepare the data.\n    groupedData = data.reduce(function(bundle, row) {\n      var polygIdx = bundle.keys.indexOf(row.polygon);\n      if(polygIdx == -1) {\n        polygIdx = bundle.keys.push(row.polygon) - 1;\n        bundle.polygons.push({\n          polygon: row.polygon,\n          color: row.color,\n          points: [],\n          values: [],\n          rawData:row.rawData,\n        });\n      }\n      bundle.polygons[polygIdx].values.push(row);\n      bundle.polygons[polygIdx].points.push(row.xy.join(','));\n      return bundle;\n    }, {keys: [], polygons:[]}).polygons;\n\n\n    gs = svg.selectAll('g.polygon-container')\n      .data(groupedData, function(d) { return d.polygon + '-container'; });\n\n    gsEnter = gs.enter()\n      .append('g')\n      .attr('class', 'polygon-container')\n      .attr('id', function(d) {\n        var x= d;\n        return 'radar-id-'+d.rawData.CVE_ENT\n      })\n\n    gsExit = gs.exit();\n    gsExit.transition().duration(duration).remove();\n\n    vm._buildNestedPolygons(gs, gsEnter, gsExit);\n    vm._buildNestedVertexes(gs, gsEnter, gsExit);\n  };\n\n  Radar.prototype._buildNestedVertexes = function(update, enter, exit) {\n    var vm = this,\n      duration = vm._config.transitionDuration,\n      selector = 'circle.vertex',\n      toUpdate;\n\n    function appendHelper(selection) {\n      selection\n        .append('circle')\n        .attr('class', 'vertex')\n        .attr('cx', vm._center.x)\n        .attr('cy', vm._center.y)\n        .attr('r', 4)\n        .attr('fill', d => d.color)\n        .call(updateHelper)\n        .on('mouseover', d => {\n          var x = d.xy[0] + 10,\n            y = d.xy[1] - 10;\n          vm._showTooltip(x, y, d.polygon, d.value);\n        })\n        .on('mouseout', () => {\n          vm._hideTooltip();\n        });\n    }\n\n    function removeHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('cx', vm._center.x)\n        .attr('cy', vm._center.y)\n        .remove();\n    }\n\n    function updateHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('cx', function(d) { return d.xy[0]; })\n        .attr('cy', function(d) { return d.xy[1]; });\n    }\n\n    function dataFunc(d) { return d.values; }\n\n    function keyFunc(d) { return d.polygon + '-' + d.axis; }\n\n    toUpdate = update.selectAll(selector)\n      .data(dataFunc, keyFunc);\n\n    toUpdate\n      .call(updateHelper);\n\n    toUpdate.enter()\n      .call(appendHelper);\n\n    toUpdate.exit()\n      .call(removeHelper);\n\n    enter.selectAll(selector)\n      .data(dataFunc, keyFunc)\n      .enter()\n      .call(appendHelper);\n\n    exit.selectAll(selector)\n      .call(removeHelper);\n  };\n\n  /**\n   * Draw a tooltip at the given X, Y possition.\n   * @param  {int} x       The X coordinate\n   * @param  {int} y       The Y coordinate\n   * @param  {string} val1 The value to show as the first line\n   * @param  {string} val2 The value to show in the second line\n   * @return {selection}   Return the created tooltip as a D3 selection\n   */\n  Radar.prototype._showTooltip = function(x, y, val1, val2) {\n    var tt, subtt, bg, bbox,\n      padding = 2,\n      vm = this,\n      svg = vm._chart._svg;\n\n    tt = svg.append('g')\n      .attr('class', 'tooltip')\n      .attr('opacity', 0);\n\n    bg = tt.append('rect').attr('class', 'tooltip-background');\n\n    subtt = tt\n      .append('text')\n      .attr('y', y)\n      .attr('x', x)\n      .style('fill', vm._ifStyleDefaults('white'))\n      .style('font-family', vm._ifStyleDefaults('sans-serif'));\n\n    subtt.append('tspan')\n      .text(Number(val2).toFixed(1));\n\n    subtt.append('tspan')\n      .attr('dy', '-1.2em')\n      .attr('x', x)\n      .text(val1);\n\n    bbox = tt.node().getBBox();\n\n    bg.attr('x', bbox.x - padding)\n      .attr('y', bbox.y - padding)\n      .attr('width', bbox.width + (padding * 2))\n      .attr('height', bbox.height + (padding + 2))\n      .style('fill', vm._ifStyleDefaults('gray'));\n\n    tt.transition()\n      .duration(200)\n      .attr('opacity', .9);\n\n    return tt;\n  };\n\n  /**\n   * Remove the tooltip created by _showTooltip()\n   * @return {undefined}\n   */\n  Radar.prototype._hideTooltip = function() {\n    this._chart._svg.selectAll('g.tooltip')\n      .transition()\n      .duration(200)\n      .attr('opacity', 0)\n      .remove();\n  };\n\n  Radar.prototype._buildNestedPolygons = function(update, enter, exit) {\n    var vm = this,\n      duration = vm._config.transitionDuration,\n      selector = 'polygon.category',\n      toUpdate;\n\n    // Used for the transitions where the polygons expand from\n    // or shrink to the center.\n    function centerPoints(data) {\n      var center = [vm._center.x, vm._center.y].join(',');\n      return data.points.map(function() {\n        // All polygon's points move to the center.\n        return center;\n      }).join(' ');\n    }\n\n    function appendHelper(selection) {\n      selection\n        .append('polygon')\n        .attr('class', 'category')\n        .attr('points', centerPoints)\n        .style('stroke', function(d) { return d.color; })\n        .style('fill', function(d) { return d.color; })\n        .style('fill-opacity', 0.4)\n        .style('stroke-width', vm._ifStyleDefaults('1px'))\n        .call(updateHelper);\n    }\n\n    function removeHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('points', centerPoints)\n        .remove();\n    }\n\n    function updateHelper(selection) {\n      selection\n        .transition()\n        .duration(duration)\n        .attr('points', function(d) { return d.points.join(' '); });\n    }\n\n    function dataFunc(d) { return [d]; }\n\n    function keyFunc(d) { return d.polygon; }\n\n    toUpdate = update.selectAll(selector)\n      .data(dataFunc, keyFunc);\n\n    toUpdate\n      .call(updateHelper);\n\n    toUpdate.enter()\n      .call(appendHelper);\n\n    toUpdate.exit()\n      .call(removeHelper);\n\n    enter.selectAll(selector)\n      .data(dataFunc, keyFunc)\n      .enter()\n      .call(appendHelper);\n\n    exit.selectAll(selector)\n      .call(removeHelper);\n\n  };\n\n  Radar.prototype.drawLegend = function() {\n    var vm = this,\n      cMap = vm._colorMap.list,\n      svg = vm._chart._svg,\n      at = vm._config.legend.at,\n      side = 14,\n      margin = 4,\n      legend, newLegend;\n\n    legend = svg.selectAll('g.legend-item')\n      .data(cMap, function(d) { return d.polygon; })\n      .attr('opacity', d => {\n        return vm._excludedPolygons.indexOf(d.polygon) > -1 ? .4 : 1;\n      });\n\n    newLegend = legend.enter()\n      .append('g')\n      .on('click', (d) => {\n        vm._excludedPolygons = vm._toggleList(\n          vm._excludedPolygons, [d.polygon]);\n        vm.draw();\n      })\n      .attr('class', 'legend-item');\n\n    newLegend\n      .append('text')\n      .text(d => d.polygon)\n      .attr('x', at.x + side + margin)\n      .attr('y', (d, i) => ((side + margin) * i) + at.y + side)\n      .style('font-family', vm._ifStyleDefaults('sans-serif'));\n\n    newLegend\n      .append('rect')\n      .attr('fill', d => d.color)\n      .attr('width', side)\n      .attr('height', side)\n      .attr('x', at.x)\n      .attr('y', (d, i) => ((side + margin) * i) + at.y);\n  };\n\n  /**\n   * Return value if config styleDefaults is true, else null.\n   * @param  {string} value The value to use as default\n   * @return {string}       The value itself or null\n   */\n  Radar.prototype._ifStyleDefaults = function(value) {\n    return this._config.styleDefaults ? value : null;\n  };\n\n  /**\n   * Append items not present in base from items and pop those which are.\n   * @param  {array} base   Array to append to remove from.\n   * @param  {array} items  Items to be toogled (appended or removed).\n   * @return {array}        A new array.\n   */\n  Radar.prototype._toggleList = (base, items) => {\n    var newItems = items.filter(it => base.indexOf(it) == -1);\n    return base.filter(it => items.indexOf(it) == -1).concat(newItems);\n  };\n\n  Radar.prototype.xOf = function(rads, value) {\n    var vm = this;\n    return vm._center.x + (value * Math.cos(rads));\n  };\n\n  Radar.prototype.yOf = function(rads, value) {\n    var vm = this;\n    return vm._center.y + (value * Math.sin(rads));\n  };\n\n  Radar.prototype.minMax = function(data) {\n    var vm = this;\n    return data.reduce(function(minMax, row) {\n      var val = parseInt(row[vm._config.valuesFrom]);\n      if(minMax.length == 0) {\n        return [val, val];\n      }\n      return [\n        val < minMax[0] ? val : minMax[0],\n        val > minMax[1] ? val : minMax[1]\n      ];\n    }, []);\n  };\n\n  // Build the data with coords.\n  Radar.prototype.dataForVisualization = function(data) {\n    var vm = this,\n      scale = vm._scale,\n      axisKey = vm._config.axesFrom,\n      valKey = vm._config.valuesFrom,\n      polygKey = vm._config.polygonsFrom,\n      axesHash = vm._axesData.hash;\n\n    return data.map(function(row) {\n      var axis = row[axisKey],\n        rads = axesHash[axis].rads,\n        polygon = row[polygKey],\n        val = row[valKey],\n        scVal = scale(val);\n      return {\n        xy: [\n          vm.xOf(rads, scVal),\n          vm.yOf(rads, scVal)\n        ],\n        value: val,\n        polygon: polygon,\n        axis: axis,\n        color: vm._colorMap.hash[polygon],\n        rawData: row\n      };\n    });\n  };\n\n  Radar.prototype.filter = function(fun) {\n    var vm = this;\n    vm._filter = fun;\n    return vm;\n  };\n\n  // DBOX internals.\n\n  Radar.prototype.chart = function(chart) {\n    var vm = this;\n    vm._chart = chart;\n    return vm;\n  };\n\n  Radar.prototype.data = function(data) {\n    var vm = this;\n    //In case we want to filter observations\n    if(vm._config.data.filter){\n      data = data.filter(vm._config.data.filter);\n    }\n\n    vm._data = data;\n    return vm;\n  };\n\n  Radar.prototype.scales = function(scales) {\n    var vm = this;\n    vm._scales = scales;\n    // We only need one scale.\n    vm._scale = vm._scales.x;\n    vm._scale.range([0, vm._radius]);\n    return vm;\n  };\n\n  Radar.prototype.axes = function(axes) {\n    var vm = this;\n    // TODO Do nothing?\n    return vm;\n  };\n\n  Radar.prototype.domains = function() {\n    var vm = this;\n    vm._calcDomains(vm._data);\n    return vm;\n  };\n\n  Radar.prototype._calcDomains = function(data) {\n    var vm = this;\n    vm._minMax = vm.minMax(data);\n    vm._scale.domain(vm._config.scales && vm._config.scales.x && vm._config.scales.x.domain && Array.isArray(vm._config.scales.x.domain) ? vm._config.scales.x.domain : [0, vm._minMax[1]]);\n\n    vm._ticks = vm._scale.ticks(vm._config.ticks);\n    // Exclude 0 from ticks if it is the first element.\n    // We don't need to have the 0 actually rendered.\n    if(vm._ticks.length > 0 && vm._ticks[0] === 0) {\n      vm._ticks = vm._ticks.slice(1);\n    }\n  };\n\n  Radar.prototype.draw = function() {\n    var vm = this,\n      data = vm._data;\n\n    // Build the color map previusly to filtering in order to keep the\n    // association between colors and polygons even when some of them (the\n    // polygons) have been filtered out.\n    vm._colorMap = vm.buildColorMap(data);\n\n    // Apply the filter function, if it's present.\n    if(typeof vm._filter === 'function') {\n      data = data.filter(vm._filter);\n    }\n\n    // Filter out excluded polygons from.\n    if(vm._excludedPolygons.length > 0) {\n      data = data.filter(it => {\n        return vm._excludedPolygons.indexOf(\n          it[vm._config.polygonsFrom]) == -1;\n      });\n    }\n\n    vm._calcDomains(data);\n    vm._axesData = vm.extractAxes(data);\n    vm._viewData = vm.dataForVisualization(data);\n\n    vm.drawTicks();\n    vm.drawAxes();\n    vm.drawAxesLabels();\n    vm.drawTicksLabels();\n    vm.drawPolygons();\n    vm.drawLegend();\n  };\n\n  return new Radar(config);\n\n}\n","import * as d3 from 'd3';\n/*\n * Simple Scatter chart\n */\n\nexport default function(config, helper) {\n  var Scatter = Object.create(helper);\n\n  Scatter.init = function(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n\n    var defaultTip = function(d) {\n      var html;\n      if (vm.chart.config.styles) {\n        html = `<div style='\n        line-height: 1; \n        opacity: ${vm.chart.style.tooltip.opacity}; \n        font-weight: ${vm.chart.style.tooltip.text.fontWeight}; \n        font-size: ${vm.chart.style.tooltip.text.fontSize}; \n        color: ${vm.chart.style.tooltip.text.textColor};\n        font-family: ${vm.chart.style.tooltip.text.fontFamily};\n        background-color: ${vm.chart.style.tooltip.backgroundColor}; \n        padding: ${vm.chart.style.tooltip.text.padding};   \n        border: ${vm.chart.style.tooltip.border.width} solid ${vm.chart.style.tooltip.border.color};  \n        border-radius:  ${vm.chart.style.tooltip.border.radius};'>`;\n        html += `<strong style='color:${vm.chart.style.tooltip.text.fontColor};'>`;\n      } else {\n        html = '<div> <strong>';\n      }\n      html += vm._config.idName\n        ? d.datum[vm._config.idName]\n          ? d.datum[vm._config.idName] + '<br>'\n          : ''\n        : '';\n      html += d.x\n        ? '<span>(' +\n          (Number.isNaN(+d.x) || vm._config.xAxis.scale !== 'linear'\n            ? d.x\n            : vm.utils.format(vm._config.xAxis)(d.x)) +\n          '</span>'\n        : '(NA';\n      html += d.y\n        ? '<span>, &nbsp;' +\n          (Number.isNaN(+d.y) || vm._config.yAxis.scale !== 'linear'\n            ? d.y\n            : vm.utils.format(vm._config.yAxis)(d.y)) +\n          ')</span>'\n        : ', NA)';\n      html += ' </strong><br>';\n      if (vm._config.magnitude && d.magnitude !== d.x && d.magnitude !== d.y) {\n        html += d.magnitude\n          ? '<span>' +\n            (Number.isNaN(+d.magnitude) ||\n            (+d.magnitude >= 1993 && +d.magnitude <= 2019)\n              ? d.magnitude\n              : vm.utils.format()(d.magnitude)) +\n            '</span>'\n          : '';\n      }\n      if (d.color !== d.x && d.color !== d.y && d.color !== d.magnitude) {\n        html += d.color\n          ? '<span> ' +\n            (Number.isNaN(+d.color) || (+d.color >= 1993 && +d.color <= 2019)\n              ? d.color\n              : vm.utils.format()(d.color)) +\n            '</span>'\n          : '';\n      }\n      html += '</div>';\n      return html;\n    };\n\n    vm._tip = this.utils.d3\n      .tip()\n      .attr('class', 'd3-tip')\n      .html(\n        vm._config.tip && vm._config.tip.html ? vm._config.tip.html : defaultTip\n      );\n  };\n\n  //-------------------------------\n  //User config functions\n\n  Scatter.id = function(col) {\n    var vm = this;\n    vm._config.id = col;\n    return vm;\n  };\n\n  Scatter.idName = function(col) {\n    var vm = this;\n    vm._config.idName = col;\n    return vm;\n  };\n\n  Scatter.x = function(col) {\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  };\n\n  Scatter.y = function(col) {\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  };\n\n  Scatter.radius = function(radius) {\n    var vm = this;\n    vm._config.radius = radius;\n    return vm;\n  };\n\n  Scatter.magnitude = function(magnitude) {\n    var vm = this;\n    vm._config.magnitude = magnitude;\n    return vm;\n  };\n\n  Scatter.radiusRange = function(radiusRange) {\n    var vm = this;\n    vm._config.radiusRange = radiusRange;\n    return vm;\n  };\n\n  Scatter.magnitudeRange = function(magnitudeRange) {\n    var vm = this;\n    vm._config.magnitudeRange = magnitudeRange;\n    return vm;\n  };\n\n  Scatter.properties = function(properties) {\n    var vm = this;\n    vm._config.properties = properties;\n    return vm;\n  };\n\n  Scatter.figure = function(figureType) {\n    var vm = this;\n    vm._config.figureType = figureType;\n    return vm;\n  };\n\n  Scatter.colors = function(colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range\n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Scatter.fill = function(col) {\n    var vm = this;\n    vm._config.fill = col;\n    return vm;\n  };\n\n  Scatter.opacity = function(opacity) {\n    var vm = this;\n    vm._config.opacity = opacity;\n    return vm;\n  };\n\n  Scatter.regression = function(regression) {\n    var vm = this;\n    vm._config.regression = regression;\n    return vm;\n  };\n\n  Scatter.tip = function(tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  Scatter.data = function(data) {\n    var vm = this;\n    var xr, yr, xMean, yMean, b1, b0, term1, term2;\n    vm._data = [];\n\n    data.forEach(function(d) {\n      var m = {};\n      m.datum = d;\n      m.x =\n        vm._config.xAxis.scale == 'linear' ? +d[vm._config.x] : d[vm._config.x];\n      m.y =\n        vm._config.yAxis.scale == 'linear' ? +d[vm._config.y] : d[vm._config.y];\n      if (vm._config.xAxis.scale == 'linear' && Number.isNaN(m.x)) {\n        m.x = 0;\n      }\n      if (vm._config.yAxis.scale == 'linear' && Number.isNaN(m.y)) {\n        m.y = 0;\n      }\n      m.color =\n        vm._config.fill.slice(0, 1) !== '#'\n          ? d[vm._config.fill]\n          : vm._config.fill;\n      m.radius =\n        vm._config.radius !== undefined\n          ? isNaN(vm._config.radius)\n            ? +d[vm._config.radius]\n            : vm._config.radius\n          : 7;\n\n      //vm._config.magnitude = 'FACTOR_HOG'; For testing\n\n      m.magnitude =\n        vm._config.magnitude !== undefined\n          ? isNaN(vm._config.magnitude)\n            ? +d[vm._config.magnitude]\n            : vm._config.magnitude\n          : 7;\n\n      if (\n        vm._config.properties !== undefined &&\n        Array.isArray(vm._config.properties) &&\n        vm._config.properties.length > 0\n      ) {\n        vm._config.properties.forEach(function(p) {\n          m[p] = d[p];\n        });\n      }\n\n      vm._data.push(m);\n    });\n\n    if (\n      vm._config.regression === true &&\n      vm._config.yAxis.scale === 'linear' &&\n      vm._config.xAxis.scale === 'linear'\n    ) {\n      xMean = d3.mean(\n        data.map(function(d) {\n          return !Number.isNaN(+d[vm._config.x]) ? +d[vm._config.x] : 0;\n        })\n      );\n      yMean = d3.mean(\n        data.map(function(d) {\n          return !Number.isNaN(+d[vm._config.y]) ? +d[vm._config.y] : 0;\n        })\n      );\n      xr = 0;\n      yr = 0;\n      term1 = 0;\n      term2 = 0;\n\n      vm._data.forEach(function(m) {\n        xr = Number.isNaN(+m.x) ? -xMean : +m.x - xMean;\n        yr = Number.isNaN(+m.y) ? -yMean : +m.y - yMean;\n        term1 += xr * yr;\n        term2 += xr * xr;\n      });\n\n      b1 = term1 / term2;\n      b0 = yMean - b1 * xMean;\n\n      vm._data.forEach(function(m) {\n        m.yhat = b0 + Number(m.x) * b1;\n      });\n    }\n\n    if (vm._config.yAxis.scale !== 'linear') {\n      vm._data.sort(function(a, b) {\n        return vm.utils.sortAscending(a.y, b.y);\n      });\n    }\n    if (vm._config.xAxis.scale !== 'linear') {\n      vm._data.sort(function(a, b) {\n        return vm.utils.sortAscending(a.x, b.x);\n      });\n    }\n\n    return vm;\n  };\n\n  Scatter.scales = function() {\n    var vm = this;\n\n    if (vm._config.hasOwnProperty('x') && vm._config.hasOwnProperty('y')) {\n      config = {\n        column: 'x',\n        type: vm._config.xAxis.scale,\n        range: [0, vm.chart.width],\n        minZero: vm._config.xAxis.minZero ? vm._config.xAxis.minZero : false\n      };\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      config = {\n        column: 'y',\n        type: vm._config.yAxis.scale,\n        range: [vm.chart.height, 0],\n        minZero: vm._config.yAxis.minZero ? vm._config.yAxis.minZero : false\n      };\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n    if (vm._config.hasOwnProperty('colors')) {\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    } else {\n      vm._scales.color = d3.scaleOrdinal(d3.schemeCategory20c);\n    }\n\n    var radiusMinMax = d3.extent(vm._data, function(d) {\n      return d.radius;\n    });\n\n    var magnitudeMinMax = d3.extent(vm._data, function(d) {\n      return d.magnitude;\n    });\n\n    vm._scales.radius = d3\n      .scaleLinear()\n      .range(\n        vm._config.radiusRange != undefined ? vm._config.radiusRange : [7, 20]\n      )\n      .domain(radiusMinMax)\n      .nice();\n\n    vm._scales.magnitude = d3\n      .scaleLinear()\n      .range(\n        vm._config.magnitudeRange != undefined\n          ? vm._config.magnitudeRange\n          : [7, 20]\n      )\n      .domain(magnitudeMinMax)\n      .nice();\n\n    if (\n      vm._config.xAxis.scaleDomain &&\n      Array.isArray(vm._config.xAxis.scaleDomain)\n    ) {\n      vm._scales.x.domain(vm._config.xAxis.scaleDomain);\n    }\n    if (\n      vm._config.yAxis.scaleDomain &&\n      Array.isArray(vm._config.yAxis.scaleDomain)\n    ) {\n      vm._scales.y.domain(vm._config.yAxis.scaleDomain);\n    }\n    return vm;\n  };\n\n  Scatter.drawLabels = function() {\n    var vm = this;\n    var yCoords = [];\n    var xCoords = [];\n    var repeat = [];\n\n    vm.chart\n      .svg()\n      .selectAll('.dbox-label')\n      .data(vm._data)\n      .enter()\n      .append('text')\n      .attr('class', 'dbox-label')\n      .attr('transform', function(d, index) {\n        var xCoord;\n        if (\n          vm._config.xAxis.scale == 'ordinal' ||\n          vm._config.xAxis.scale == 'band'\n        ) {\n          xCoord =\n            vm._scales.x(d.x) +\n            vm._scales.x.bandwidth() / 2 -\n            vm._scales.magnitude(d.magnitude) / 2;\n        } else {\n          xCoord = vm._scales.x(d.x);\n        }\n        xCoords.push(d.datum[vm._config.x]);\n\n        var yCoord;\n        var space = 15;\n        if (\n          vm._config.yAxis.scale == 'ordinal' ||\n          vm._config.yAxis.scale == 'band'\n        ) {\n          yCoord =\n            vm._scales.y(d.y) +\n            vm._scales.y.bandwidth() / 2 -\n            vm._scales.magnitude(d.magnitude) / 2;\n          if (yCoords.indexOf(Math.ceil(yCoord)) !== -1) {\n            repeat.push(Math.ceil(yCoord));\n            let current = null;\n            let cnt = 0;\n            for (let i = 0; i < repeat.length; i++) {\n              if (repeat[i] != current) {\n                current = repeat[i];\n                cnt = 1;\n              } else {\n                cnt++;\n              }\n\n              space = space * cnt;\n            }\n            yCoord = yCoord + space;\n          }\n        } else {\n          yCoord = vm._scales.y(d.y);\n          if (yCoords.indexOf(Math.ceil(yCoord)) !== -1) {\n            repeat.push(Math.ceil(yCoord));\n            let current = null;\n            let cnt = 0;\n            for (let i = 0; i < repeat.length; i++) {\n              if (repeat[i] != current) {\n                current = repeat[i];\n                cnt = 1;\n              } else {\n                cnt++;\n              }\n\n              space = space * cnt;\n            }\n            yCoord = yCoord + space;\n          }\n        }\n        yCoords.push(Math.ceil(yCoord));\n\n        if (xCoords[index - 1] !== d.datum[vm._config.x]) {\n          yCoords = [];\n          repeat = [];\n        }\n\n        return 'translate(' + (xCoord + 10) + ',' + (yCoord - 20) + ')';\n      })\n      .text(function(d) {\n        var allText = '';\n        allText += d.color ? d.color : '';\n        allText += ' ';\n        allText += d.datum[vm._config.magnitude]\n          ? vm.utils.format(null, true)(d.datum[vm._config.magnitude])\n          : '';\n        return allText;\n      });\n  };\n\n  Scatter.draw = function() {\n    var vm = this;\n    // Call the tip\n    vm.chart.svg().call(vm._tip);\n\n    // Squares\n    if (vm._config.figureType === 'square') {\n      vm.chart\n        .svg()\n        .selectAll('square')\n        .data(vm._data)\n        .enter()\n        .append('rect')\n        .attr('class', 'square')\n        .attr('class', function(d, i) {\n          //Backward compability with d.properties\n          var id =\n            d.properties !== undefined && d.properties.id !== undefined\n              ? d.properties.id\n              : false;\n          id = vm._config.id ? vm._config.id : false;\n          return id ? 'scatter-' + d.datum[id] : 'scatter-' + i;\n        })\n        .attr('width', function(d) {\n          return vm._scales.magnitude(d.magnitude);\n        })\n        .attr('height', function(d) {\n          return vm._scales.magnitude(d.magnitude);\n        })\n        .attr('x', function(d) {\n          if (\n            vm._config.xAxis.scale == 'ordinal' ||\n            vm._config.xAxis.scale == 'band'\n          ) {\n            return (\n              vm._scales.x(d.x) +\n              vm._scales.x.bandwidth() / 2 -\n              vm._scales.magnitude(d.magnitude) / 2\n            );\n          } else {\n            return vm._scales.x(d.x);\n          }\n        })\n        .attr('y', function(d) {\n          if (\n            vm._config.yAxis.scale == 'ordinal' ||\n            vm._config.yAxis.scale == 'band'\n          ) {\n            return (\n              vm._scales.y(d.y) +\n              vm._scales.y.bandwidth() / 2 -\n              vm._scales.magnitude(d.magnitude) / 2\n            );\n          } else {\n            return vm._scales.y(d.y);\n          }\n        })\n        .style('fill', function(d) {\n          return String(d.color).slice(0, 1) !== '#'\n            ? vm._scales.color(d.color)\n            : d.color;\n        })\n        .style(\n          'opacity',\n          vm._config.opacity !== undefined ? vm._config.opacity : 1\n        )\n        .on('mouseover', function(d, i) {\n          if (vm._config.events.mouseover) {\n            vm._config.events.mouseover.call(vm, d, i);\n          }\n          vm._tip.show(d, d3.select(this).node());\n        })\n        .on('mouseout', function(d, i) {\n          if (vm._config.events.mouseout) {\n            vm._config.events.mouseout.call(this, d, i);\n          }\n          vm._tip.hide(d, d3.select(this).node());\n        })\n        .on('click', function(d, i) {\n          if (vm._config.events.onClickElement) {\n            vm._config.events.onClickElement.call(this, d, i);\n          }\n        });\n    }\n    // Circles\n    else {\n      vm.chart\n        .svg()\n        .selectAll('.dot')\n        .data(vm._data)\n        //.data(vm._data, function(d){ return d.key})\n        .enter()\n        .append('circle')\n        .attr('class', 'dot')\n        .attr('class', function(d, i) {\n          //Backward compability with d.properties\n          var id =\n            d.properties !== undefined && d.properties.id !== undefined\n              ? d.properties.id\n              : false;\n          id = vm._config.id ? vm._config.id : false;\n          return id ? 'scatter-' + d.datum[id] : 'scatter-' + i;\n        })\n        .attr('r', function(d) {\n          return vm._scales.radius(d.radius);\n        })\n        .attr('cx', function(d) {\n          if (\n            vm._config.xAxis.scale == 'ordinal' ||\n            vm._config.xAxis.scale == 'band'\n          )\n            return vm._scales.x(d.x) + vm._scales.x.bandwidth() / 2;\n          else return vm._scales.x(d.x);\n\n          /*  if(vm._config.xAxis.scale == 'ordinal' || vm._config.xAxis.scale == 'band')\n            return vm._scales.x(d.x) + (Math.random() * (vm._scales.x.bandwidth() - (d.size * 2)));\n          else \n            return vm._scales.x(d.x); */\n        })\n        .attr('cy', function(d) {\n          if (\n            vm._config.yAxis.scale == 'ordinal' ||\n            vm._config.yAxis.scale == 'band'\n          )\n            return vm._scales.y(d.y) + vm._scales.y.bandwidth() / 2;\n          else return vm._scales.y(d.y);\n\n          /* if(vm._config.yAxis.scale == 'ordinal' || vm._config.yAxis.scale == 'band')\n            return vm._scales.y(d.y) + (Math.random() * (vm._scales.y.bandwidth() - (d.size * 2)));\n          else \n            return vm._scales.y(d.y); */\n        })\n        .style('fill', function(d) {\n          return String(d.color).slice(0, 1) !== '#'\n            ? vm._scales.color(d.color)\n            : d.color;\n        })\n        .style(\n          'opacity',\n          vm._config.opacity !== undefined ? vm._config.opacity : 1\n        )\n        .on('mouseover', function(d, i) {\n          if (vm._config.events.mouseover) {\n            vm._config.events.mouseover.call(vm, d, i);\n          }\n          vm._tip.show(d, d3.select(this).node());\n        })\n        .on('mouseout', function(d, i) {\n          if (vm._config.events.mouseout) {\n            vm._config.events.mouseout.call(this, d, i);\n          }\n          vm._tip.hide(d, d3.select(this).node());\n        })\n        .on('click', function(d, i) {\n          if (vm._config.events.onClickElement) {\n            vm._config.events.onClickElement.call(this, d, i);\n          }\n        });\n    }\n\n    if (vm._config.regression === true) {\n      var line = d3\n        .line()\n        .x(function(d) {\n          return vm._scales.x(d.x);\n        })\n        .y(function(d) {\n          return vm._scales.y(d.yhat);\n        });\n\n      vm.chart\n        .svg()\n        .append('path')\n        .datum(vm._data)\n        .attr('class', 'line')\n        .attr('d', line)\n        .style('stroke', 'rgb(251, 196, 58)');\n    }\n\n    Scatter.drawLabels();\n\n    return vm;\n  };\n\n  Scatter.select = function(id) {\n    var vm = this;\n    return vm.chart.svg().select('circle.scatter-' + id);\n  };\n\n  Scatter.selectAll = function() {\n    var vm = this;\n    return vm.chart.svg().selectAll('circle');\n  };\n\n  Scatter.init(config);\n  return Scatter;\n}\n","import * as d3 from 'd3';\nimport * as _ from 'lodash';\n\n/*\n * Simple Spineplot\n */\nexport default function (config, helper) {\n\n  //Link Spineplot to the helper object in helper.js\n  var Spineplot = Object.create(helper);\n\n  Spineplot.init = function (config) {\n    var vm = this;\n\n    vm._config = config ? config : {};\n    vm._config.orientation = 'horizontal';\n    vm._data = [];\n    vm._scales = {};\n    vm._tip = vm.utils.d3.tip()\n      .attr(\n        'class', \n        'd3-tip ' + \n          (vm._config.tooltip && vm._config.tooltip.classed\n            ? vm._config.tooltip.classed\n            : '')\n      )\n      .direction('n')\n      .html(vm._config.tip || function (d) {\n        var html = '<div>';\n        html += '<span>' + d[vm._config.category] + '</span>';\n        html += '</br><span>' + vm.utils.format()(d[vm._config.value]) + '</span>';\n        html += '</div>';\n        return html;\n      });\n\n  };\n\n\n  //-------------------------------\n  //User config functions\n  Spineplot.id = function (columnName) {\n    var vm = this;\n    vm._config.id = columnName;\n    return vm;\n  };\n\n  Spineplot.category = function (columnName) {\n    var vm = this;\n    vm._config.category = columnName;\n    return vm;\n  };\n\n  Spineplot.value = function (columnName) {\n    var vm = this;\n    vm._config.value = columnName;\n    return vm;\n  };\n\n  Spineplot.orientation = function (orientation) {\n    var vm = this;\n    vm._config.orientation = orientation;\n    return vm;\n  };\n\n  /**\n   * Used to draw a bar chart stacked with multiple bars per group\n   * @param {array} columns \n   */\n  Spineplot.stackBy = function (columnName) {\n    var vm = this;\n    vm._config.stackBy = columnName;\n    return vm;\n  };\n\n  /**\n   * column name used for the domain values\n   * @param {string} columnName \n   */\n  Spineplot.fill = function (columnName) {\n    var vm = this;\n    vm._config.fill = columnName;\n    return vm;\n  };\n\n  /**\n   * array of values used \n   * @param {array or scale} columnName \n   */\n  Spineplot.colors = function (colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range \n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Spineplot.sortBy = function (option) {\n    //option = string [asc,desc] \n    //option = array for groupBy and stackBy\n    var vm = this;\n    vm._config.sortBy = option;\n    return vm;\n  };\n\n  Spineplot.format = function (format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function)\n      vm.utils.format = format;\n    else\n      vm.utils.format = d3.format(format);\n    return vm;\n  };\n\n  Spineplot.tip = function (tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    return vm;\n  };\n\n  Spineplot.legend = function (legend) {\n    var vm = this;\n    vm._config.legend = legend;\n    return vm;\n  };\n\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Spineplot.data = function (data) {\n    var vm = this;\n\n    if (vm._config.filter) {\n      // In case we want to filter observations\n      data = data.filter(vm._config.filter);\n    }\n    //@TODO - ALLOW MULITPLE SORTS\n    if (vm._config.sortBy) {\n      if (vm._config.sortBy.category) {\n        data = data.sort(function (a, b) {\n          return vm._config.sortBy.category === 'desc' ? vm.utils.sortDescending(a[vm._config.category], b[vm._config.category]) : vm.utils.sortAscending(a[vm._config.category], b[vm._config.category]);\n        });\n      }\n      if (vm._config.sortBy.value) {\n        data = data.sort(function (a, b) {\n          return vm._config.sortBy.value === 'desc' ? vm.utils.sortDescending(a[vm._config.value], b[vm._config.value]) : vm.utils.sortAscending(a[vm._config.value], b[vm._config.value]);\n        });\n      }\n    } else {\n      data = data.sort(function (a, b) {\n        return vm.utils.sortAscending(a[vm._config.category], b[vm._config.category]);\n      });\n    }\n\n    var total = 0;\n    vm._data = data.map(function(d) {\n      d.x0 = total;\n      d.x1 = total + d[vm._config.value];\n      total += +d[vm._config.value];\n      if (vm._config.hasOwnProperty('stackBy') && Array.isArray(vm._config.stackBy) && vm._config.stackBy.length > 0) {\n        d.stackValues = d3.stack().keys(vm._config.stackBy)([d]);\n        d.totalCollapse = d3.sum(d.stackValues, function(stack) {\n          return stack[0][1] - stack[0][0];\n        });\n      }\n      return d;\n    });\n\n    if (vm._config.hasOwnProperty('quantiles')) {\n      vm._quantiles = vm._setQuantile(data);\n      vm._minMax = d3.extent(data, function (d) {\n        return +d[vm._config.fill];\n      });\n    }\n\n    return vm;\n  };\n\n  Spineplot.scales = function () {\n    var vm = this;\n    var config;\n    //vm._scales = s;\n    /* Use\n     * vm._config.category\n     * vm._config.categoryAxis.scale\n     * vm._config.value\n     * vm._config.valueAxis.scale\n     * vm._data\n     */\n    // Normal bars \n    if (vm._config.hasOwnProperty('category') && vm._config.hasOwnProperty('value')) {\n      config = {\n        column: 'x1',\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      config = {\n        column: vm._config.value,\n        type: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n    }\n\n\n    //Stack bars on the xAxis\n    if (vm._config.orientation === 'horizontal' && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: 'x1',\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n      /* Generate y scale */\n      config = {\n        column: '',\n        type: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.y = d3.scaleLinear().range(config.range).domain([0, 1]);\n    }\n\n    //Stack bars on the yAxis\n    if (vm._config.orientation === 'vertical' && vm._config.hasOwnProperty('stackBy')) {\n      /* Generate x scale */\n      config = {\n        column: '',\n        txpe: 'linear',\n        range: [vm.chart.height, 0],\n        minZero: true\n      };\n      vm._scales.x = d3.scaleLinear().range(config.range).domain([0, 1]);\n\n      /* Generate y scale */\n      config = {\n        column: vm._config.value,\n        type: 'linear',\n        range: [0, vm.chart.width],\n        minZero: true\n      };\n      vm._scales.y = vm.utils.generateScale(vm._data, config);\n      \n    }\n    //vm.chart.scales.x = vm._scales.x;\n    //vm.chart.scales.y = vm._scales.y;\n\n    if (vm._config.hasOwnProperty('colors'))\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    else\n      vm._scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    return vm;\n  };\n\n  Spineplot.drawLabels = function() {\n    var vm = this;\n    var groups = vm.chart.svg().selectAll('.division');\n    groups.each(function(dat) {\n      var el = this;\n      dat.stackValues.forEach(function(sv) {\n        var rectW = vm._scales.x(sv[0].data[vm._config.value]);\n        var rectH = vm._scales.y((sv[0][0] / sv[0].data.totalCollapse)) - vm._scales.y(sv[0][1] / sv[0].data.totalCollapse);\n        if (rectH > 25 && rectW > 112) {\n          d3.select(el).append('text')\n            .attr('class', 'dbox-label')\n            .attr('text-anchor', 'middle')\n            .attr('transform', function() {\n              return 'translate(' + (vm._scales.x(sv[0].data.x0) + rectW/2) + ',' + (sv[0][1] ? vm._scales.y(sv[0][1] / sv[0].data.totalCollapse) + 20 : vm._scales.y(0) + 20) + ')';\n            })\n            .text(function() {\n              return 'X: ' + vm.utils.format(vm._config.xAxis)(sv[0].data[vm._config.value]) + ', Y: ' + vm.utils.format(vm._config.yAxis)(sv[0].data[sv.key]);\n            });\n        }\n      });\n    });\n  };\n\n  Spineplot.draw = function() {\n    var vm = this;\n    if (vm._config.hasOwnProperty('stackBy')) {\n      if (vm._config.orientation === 'horizontal') vm._drawStackByXAxis();\n      if (vm._config.orientation === 'vertical') vm._drawStackByYAxis();\n      return vm;\n    }\n\n    vm.chart.svg().call(vm._tip);\n\n    const axesTip = vm.utils.d3.tip()\n      .attr('class', 'title-tip')\n      .html(d => {\n        return d[vm._config.category];\n      });\n    vm.chart.svg().call(axesTip);\n\n    if (vm._config.orientation === 'horizontal') {\n\n      /**\n       * x axis tick labels\n       */\n      let posX = [];\n      vm._xLabels = vm.chart.svg().append('g')\n        .attr('class', 'x axis')\n        .attr('transform', 'translate(0,' + (vm.chart.height + 20) + ')')\n        .selectAll('.tick')\n        .data(vm._data)\n        .enter()\n        .append('g')\n        .attr('class', 'tick')\n        .attr('transform', d => {\n          const x = vm._scales.x(d.x0) + (vm._scales.x(d.x1 - d.x0) / 2);\n          posX.push(x);\n          return 'translate(' + x + ', 8)'; \n        })\n        .append('text')\n        .attr('text-anchor', 'middle')\n        .text(function(d) {\n          return d[vm._config.category];\n        });\n\n      let labelMaxWidth = d3.min(vm._data, function (d) {\n        return (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n      });\n      const largestLabelWidth = d3.max(vm._xLabels.nodes(), function (node) {\n        return node.getComputedTextLength();\n      });\n      let removed = [];\n\n      vm._xLabels.each(function (d, index, el) {\n        //const currentWidth = this.getComputedTextLength();\n        //let labelMaxWidth = (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n        if (largestLabelWidth < (labelMaxWidth * 2)) {\n          d3.select(this).call(vm.utils.wrap, labelMaxWidth, axesTip);\n        } else {\n          d3.select(this)\n            .attr('text-anchor', 'end')\n            .attr('dy', 0)\n            .attr('transform', 'translate(3,-8)rotate(-90)');\n          let newLabelMaxWidth = vm._config.size.margin.bottom * 0.9;\n          if (this.getComputedTextLength() > newLabelMaxWidth) {\n            d3.select(this)\n              .on('mouseover', axesTip.show)\n              .on('mouseout', axesTip.hide);\n            let i = 1;\n            while (this.getComputedTextLength() > newLabelMaxWidth) {\n              d3.select(this).text(function (d) {\n                return (d[vm._config.category] + '').slice(0, -i) + '...';\n              }).attr('title', d);\n              ++i;\n            }\n          }\n        }\n\n        let textSize = window.getComputedStyle(this, null).getPropertyValue('font-size');\n        let numSize = Number(textSize.replace(/\\D/g,''));\n\n        if (index !== 0 && index !== vm._data.length - 1) {\n          let diffPos1 = posX[index] - posX[index - 1];\n          let diffPos2 = posX[index + 1] - posX[index];\n\n          let lessThanPrev = d.value < vm._data[index - 1].value;\n          let lessThanPost = d.value < vm._data[index + 1].value;\n\n          if (diffPos1 < numSize - 2 || diffPos2 < numSize - 2) {\n            if (lessThanPrev || lessThanPost) {\n              d3.select(this).remove();\n              removed.push(index);\n            }\n          }\n        }\n      });\n      \n\n      vm.chart.svg().selectAll('.bar')\n        .data(vm._data)\n        .enter().append('rect')\n        .attr('class', 'bar')\n        .attr('id', (d, i) => {\n          var id = 'spineplot-' + i;\n          if (vm._config.id) {\n            id = 'spineplot-' + d[vm._config.id];\n          }\n          return id;\n        })\n        .attr('x', (d) => vm._scales.x(d.x0) )\n        .attr('y', 0)\n        .attr('width', d => vm._scales.x(d[vm._config.value]) )\n        .attr('height', vm.chart.height ? vm.chart.height : 100)\n        .attr('fill', (d) => {\n          return vm._scales.color !== false ? vm._scales.color(d[vm._config.fill]) : vm._getQuantileColor(d[vm._config.fill], 'default');\n        })\n        .attr('stroke', 'white')\n        .attr('stroke-width', 1)\n        .style('opacity', 0.9)\n        .on('mouseover', function(d, i) {\n          if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n            d3.select(this).attr('fill', function (d) {\n              return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n            });\n          }\n          vm._tip.show(d, d3.select(this).node());\n\n          if (vm._config.hasOwnProperty('onmouseover')) { //External function call, must be after all the internal code; allowing the user to overide \n            vm._config.onmouseover.call(this, d, i);\n          }\n\n        })\n        .on('mouseout', function (d, i) {\n          if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n            d3.select(this).attr('fill', function (d) {\n              return vm._getQuantileColor(d[vm._config.fill], 'default');\n            });\n          }\n          vm._tip.hide();\n\n          if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n            vm._config.onmouseout.call(this, d, i);\n          }\n        })\n        .on('click', function (d, i) {\n          if (vm._config.hasOwnProperty('click')) {\n            vm._config.onclick.call(this, d, i);\n          }\n        });\n    }\n    return vm;\n  };\n\n\n  //\n  /** \n   * Draw bars grouped by \n   */\n  Spineplot._drawStackByXAxis = function () {\n    var vm = this;\n    vm._tip.html(vm._config.tip || function (d) {\n      var cat = '';\n      cat += '<span>' + d.key + '</span>';\n      if (d.key !== d[0].data[vm._config.category]) {\n        cat += '<br><span>Y: ' + vm.utils.format(vm._config.yAxis)(d[0].data[d.key]) + '</span>';\n        cat += '<br><span>' + d[0].data[vm._config.category] + '</span>';\n        cat += '<br><span>X: ' + vm.utils.format(vm._config.xAxis)(d[0].data[vm._config.value]) + '</span>';\n      } else {\n        cat += '<br><span>' + vm.utils.format()(d[0].data[d.key]) + '</span>';\n      }\n      return cat;\n    });\n    vm.chart.svg().call(vm._tip);\n\n    const axesTip = vm.utils.d3.tip()\n      .attr('class', 'title-tip')\n      .html(d => {\n        return d[vm._config.category];\n      });\n    vm.chart.svg().call(axesTip);\n\n    /**\n     * x axis labels\n     */\n    vm._xLabels = vm.chart.svg().append('g')\n      .attr('class', 'x axis')\n      .attr('transform', 'translate(0,' + (vm.chart.height + 20) + ')')\n      .selectAll('g')\n      .data(vm._data)\n      .enter()\n      .append('g')\n      .attr('class', 'tick')\n      .attr('transform', d => {\n        const x = vm._scales.x(d.x0) + (vm._scales.x(d.x1 - d.x0) / 2);\n        return 'translate(' + x + ', 0)';\n      })\n      .append('text')\n      .attr('text-anchor', 'middle')\n      .text(d => d[vm._config.category]);\n\n    let labelMaxWidth = d3.min(vm._data, function(d) {\n      return (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n    });\n    const largestLabelWidth = d3.max(vm._xLabels.nodes(), function (node) {\n      return node.getComputedTextLength();\n    });\n    \n    vm._xLabels.each(function (d) {\n      //const currentWidth = this.getComputedTextLength();\n      //let labelMaxWidth = (vm._scales.x(d.x1) - vm._scales.x(d.x0)) * 0.9;\n      if (largestLabelWidth < (labelMaxWidth * 2)) {\n        d3.select(this).call(vm.utils.wrap, labelMaxWidth, axesTip);\n      } else {\n        d3.select(this)\n          .attr('text-anchor', 'end')\n          .attr('dy', 0)\n          .attr('transform', 'translate(3,-8)rotate(-90)');\n        let newLabelMaxWidth = vm._config.size.margin.bottom * 0.9;\n        if (this.getComputedTextLength() > newLabelMaxWidth) {\n          d3.select(this)\n            .on('mouseover', axesTip.show)\n            .on('mouseout', axesTip.hide);\n          let i = 1;\n          while (this.getComputedTextLength() > newLabelMaxWidth) {\n            d3.select(this).text(function (d) {\n              return (d[vm._config.category] + '').slice(0, -i) + '...';\n            }).attr('title', d);\n            ++i;\n          }\n        }\n      }\n    });\n      \n    var groups = vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('class', 'division');\n\n    groups.selectAll('rect')\n      .data(function (d) {\n        return d.stackValues;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return d[0][1] ? vm._scales.y(d[0][1] / d[0].data.totalCollapse) : vm._scales.y(0);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d[0].data.x0);\n      })\n      .attr('width', function (d) {\n        return vm._scales.x(d[0].data[vm._config.value]);\n      })\n      .attr('height', function (d) {\n        var h = vm._scales.y((d[0][0] / d[0].data.totalCollapse)) - vm._scales.y(d[0][1] / d[0].data.totalCollapse);\n        return h;\n      })\n      .attr('stroke', 'white')\n      .attr('stroke-width', 1)\n      .attr('fill', function (d) {\n        return vm._scales.color(d[vm._config.fill]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n    Spineplot.drawLabels();\n  };\n\n  Spineplot._drawStackByYAxis = function () {\n    var vm = this;\n\n    vm._tip.html(vm._config.tip || function (d) {\n      var html = '<div><span>' + d[vm._config.category] + '<span><br>';\n      for (var k in d.data) {\n        if ((d[1] - d[0]) == d.data[k]) {\n          html += '<span>' + k + '</span>';\n        }\n      }\n      html += '<br>' + vm.utils.format()(d[1] - d[0]);\n      return html;\n    });\n\n    vm.chart.svg().call(vm._tip);\n\n    vm.chart.svg().append('g')\n      .selectAll('g')\n      .data(vm._data)\n      .enter().append('g')\n      .attr('class', 'division')\n      .attr('fill', function (d) {\n        return vm._scales.color(d.key);\n      })\n      .selectAll('rect')\n      .data(function (d) {\n        return d;\n      })\n      .enter().append('rect')\n      .attr('y', function (d) {\n        return vm._scales.y(d.data[vm._config.value]);\n      })\n      .attr('x', function (d) {\n        return vm._scales.x(d[0]);\n      })\n      .attr('height', vm._scales.y.bandwidth())\n      .attr('width', function (d) {\n        return vm._scales.x(d[1]) - vm._scales.x(d[0]);\n      })\n      .on('mouseover', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover colors\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'onHover');\n          });\n        }\n        vm._tip.show(d, d3.select(this).node());\n\n        if (vm._config.hasOwnProperty('onmouseover')) {\n          //External function call. It must be after all the internal code; allowing the user to overide \n          vm._config.onmouseover.call(this, d, i);\n        }\n\n      })\n      .on('mouseout', function (d, i) {\n        if (vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) { //OnHover reset default color\n          d3.select(this).attr('fill', function (d) {\n            return vm._getQuantileColor(d[vm._config.fill], 'default');\n          });\n        }\n        vm._tip.hide();\n\n        if (vm._config.hasOwnProperty('onmouseout')) { //External function call, must be after all the internal code; allowing the user to overide \n          vm._config.onmouseout.call(this, d, i);\n        }\n      })\n      .on('click', function (d, i) {\n        if (vm._config.hasOwnProperty('click')) {\n          vm._config.onclick.call(this, d, i);\n        }\n      });\n\n  };\n\n  Spineplot._setQuantile = function (data) {\n    var vm = this;\n    var values = [];\n    var quantile = [];\n\n    if (vm._config.quantiles && vm._config.quantiles.predefinedQuantiles &&\n      vm._config.quantiles.predefinedQuantiles.length > 0) {\n      return vm._config.quantiles.predefinedQuantiles;\n    }\n\n    data.forEach(function (d) {\n      values.push(+d[vm._config.fill]);\n    });\n\n    values.sort(vm.utils.sortAscending);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.quantiles && vm._config.quantiles.buckets) {\n\n      if (vm._config.quantiles.ignoreZeros === true) {\n        var aux = _.dropWhile(values, function (o) {\n          return o <= 0;\n        });\n        //aux.unshift(values[0]);  \n\n        quantile.push(values[0]);\n        quantile.push(0);\n\n        for (var i = 1; i <= vm._config.quantiles.buckets - 1; i++) {\n          quantile.push(d3.quantile(aux, i * 1 / (vm._config.quantiles.buckets - 1)));\n        }\n\n      } else {\n        quantile.push(d3.quantile(values, 0));\n        for (var j = 1; j <= vm._config.quantiles.buckets; j++) {\n          quantile.push(d3.quantile(values, j * 1 / vm._config.quantiles.buckets));\n        }\n      }\n\n    } else {\n      quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2), d3.quantile(values, 0.4), d3.quantile(values, 0.6), d3.quantile(values, 0.8), d3.quantile(values, 1)];\n    }\n\n    //@TODO - VALIDATE WHEN ZEROS NEED TO BE PUT ON QUANTILE 1 AND RECALCULATE NON ZERO VALUES INTO THE REST OF THE BUCKETS\n    if (vm._config.quantiles && vm._config.quantiles.buckets && vm._config.quantiles.buckets === 5) {\n\n      if (quantile[1] === quantile[2] && quantile[2] === quantile[3] && quantile[3] === quantile[4] && quantile[4] === quantile[5]) {\n        quantile = [d3.quantile(values, 0), d3.quantile(values, 0.2)];\n      }\n    }\n\n    return quantile;\n  };\n\n  Spineplot._getQuantileColor = function (d, type) {\n    var vm = this;\n    var total = parseFloat(d);\n\n    //@TODO use quantile scale instead of manual calculations \n    if (vm._config && vm._config.bars.quantiles && vm._config.bars.quantiles.colors) {\n      if (vm._quantiles.length > 2) {\n\n        if (vm._config && vm._config.bars.min !== undefined && vm._config.bars.max !== undefined) {\n          if (total < vm._config.bars.min || total > vm._config.bars.max) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        } else {\n          if (total < vm._minMax[0] || total > vm._minMax[1]) {\n            return vm._config.bars.quantiles.outOfRangeColor;\n          }\n        }\n\n        if (type == 'default') {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.bars.quantiles.colors[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.bars.quantiles.colors[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.bars.quantiles.colors[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colors[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colors[4]; //'#480000';\n          }\n        }\n\n        if (type == 'onHover' && vm._config.hasOwnProperty('quantiles') && vm._config.quantiles.hasOwnProperty('colorsOnHover')) {\n          if (total <= vm._quantiles[1]) {\n            return vm._config.quantiles.colorsOnHover[0]; //'#f7c7c5';\n          } else if (total <= vm._quantiles[2]) {\n            return vm._config.quantiles.colorsOnHover[1]; //'#e65158';\n          } else if (total <= vm._quantiles[3]) {\n            return vm._config.quantiles.colorsOnHover[2]; //'#c20216';\n          } else if (total <= vm._quantiles[4]) {\n            return vm._config.quantiles.colorsOnHover[3]; //'#750000';\n          } else if (total <= vm._quantiles[5]) {\n            return vm._config.quantiles.colorsOnHover[4]; //'#480000';\n          }\n        }\n\n      }\n    }\n\n    if (vm._quantiles.length == 2) {\n      /*if(total === 0 ){\n        return d4theme.colors.quantiles[0];//return '#fff';\n      }else if(total <= vm._quantiles[1]){\n        return d4theme.colors.quantiles[1];//return '#f7c7c5';\n      }*/\n      if (total <= vm._quantiles[1]) {\n        return vm._config.quantiles.colors[0]; //'#f7c7c5';\n      }\n    }\n\n  };\n\n  Spineplot.init(config);\n  return Spineplot;\n}\n","import * as d3 from 'd3';\n\n/* Simple timeline example\n * Single and multiline timelines\n */\nexport default function(config, helper) {\n  var Timeline = Object.create(helper);\n\n  Timeline.init = function(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._data = [];\n    vm._scales = {};\n    vm._axes = {};\n\n    vm._config.parseDate = d3.timeParse('%Y-%m-%d');\n    vm._config.curve = d3.curveLinear;\n\n    vm._tip = vm.utils.d3\n      .tip()\n      .attr(\n        'class',\n        'd3-tip ' +\n          (vm._config.tooltip && vm._config.tooltip.classed\n            ? vm._config.tooltip.classed\n            : '')\n      )\n      .html(\n        vm._config.tip && vm._config.tip.html\n          ? vm._config.tip.html\n          : function(d) {\n              let scaleColor =\n                vm._scales.color !== false\n                  ? vm._scales.color(d.name)\n                  : vm._getQuantileColor(d.name, 'default');\n              if (vm.chart.config.styles) {\n                var html = `<div style='\n            line-height: 1; \n            opacity: ${vm.chart.style.tooltip.opacity}; \n            font-weight: ${vm.chart.style.tooltip.text.fontWeight}; \n            font-size: ${vm.chart.style.tooltip.text.fontSize}; \n            color: ${vm.chart.style.tooltip.text.textColor};\n            font-family: ${vm.chart.style.tooltip.text.fontFamily};\n            background-color: ${vm.chart.style.tooltip.backgroundColor}; \n            padding: ${vm.chart.style.tooltip.text.padding};   \n            border: ${vm.chart.style.tooltip.border.width} solid ${vm.chart.style.tooltip.border.color};  \n            border-radius:  ${vm.chart.style.tooltip.border.radius};'>`;\n                html += `<strong style='color:${vm.chart.style.tooltip.text.fontColor};'>`;\n              } else {\n                var html = '<div> <strong>';\n              }\n              html +=\n                `<strong style='color:${scaleColor}'>` + d.name + ': </strong>';\n              html += d.y\n                ? `<span >` +\n                  (Number.isNaN(+d.y)\n                    ? d.y\n                    : vm.utils.format(vm._config.yAxis)(d.y)) +\n                  '</span>'\n                : '';\n              html += '</div>';\n\n              return html;\n            }\n      );\n  };\n\n  //-------------------------------\n  //User config functions\n  Timeline.x = function(col) {\n    var vm = this;\n    vm._config.x = col;\n    return vm;\n  };\n\n  Timeline.parseDate = function(format) {\n    var vm = this;\n    vm._config.parseDate = d3.timeParse(format);\n    return vm;\n  };\n\n  Timeline.y = function(col) {\n    var vm = this;\n    vm._config.y = col;\n    return vm;\n  };\n\n  Timeline.series = function(arr) {\n    var vm = this;\n    vm._config.series = arr;\n    return vm;\n  };\n\n  Timeline.curve = function(curve) {\n    var vm = this;\n    vm._config.curve = curve;\n    return vm;\n  };\n\n  Timeline.fill = function(col) {\n    var vm = this;\n    vm._config.fill = col;\n    return vm;\n  };\n\n  Timeline.colors = function(colors) {\n    var vm = this;\n    if (Array.isArray(colors)) {\n      //Using an array of colors for the range\n      vm._config.colors = colors;\n    } else {\n      //Using a preconfigured d3.scale\n      vm._scales.color = colors;\n    }\n    return vm;\n  };\n\n  Timeline.tip = function(tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  };\n\n  //-------------------------------\n  //Triggered by the chart.js;\n  Timeline.data = function(data) {\n    var vm = this;\n\n    vm._data = [];\n    data.forEach(function(d) {\n      var tmp = Object.assign({}, d);\n      if (d[vm._config.x]) {\n        try {\n          d[vm._config.x].getTime();\n          if (!Number.isNaN(d[vm._config.x].getTime())) {\n            tmp.x = d[vm._config.x];\n          }\n        } catch (err) {\n          tmp.x = vm._config.parseDate(d[vm._config.x]);\n        }\n      }\n\n      tmp.color = d[vm._config.fill];\n      delete tmp[vm._config.x];\n      vm._data.push(tmp);\n    });\n\n    //Sort the data by d.x\n    vm._data = vm._data.sort(function(a, b) {\n      return d3.ascending(a.x, b.x);\n    });\n\n    vm._lines = vm._config.y ? vm._config.y : vm._config.series;\n\n    vm._lines = vm._lines.map(function(name) {\n      return {\n        name: name,\n        values: vm._data.map(function(d) {\n          return { x: d.x, y: +d[name] };\n        }),\n      };\n    });\n\n    vm._lines.forEach(n => {\n      n.values = n.values.filter(v => {\n        return !isNaN(v.y);\n      });\n    });\n\n    vm._line = d3\n      .line()\n      .curve(vm._config.curve)\n      .defined(function(d) {\n        return d.y !== undefined;\n      })\n      .x(function(d) {\n        return vm._scales.x(d.x);\n      })\n      .y(function(d) {\n        return vm._scales.y(d.y);\n      });\n\n    vm._area = d3\n      .area()\n      .curve(vm._config.curve)\n      .x(function(d) {\n        if (d.alreadyScaled && d.alreadyScaled === true) {\n          return d.x;\n        } else {\n          return vm._scales.x(d.x);\n        }\n      })\n      .y1(function(d) {\n        if (d.alreadyScaled && d.alreadyScaled === true) {\n          return d.y;\n        } else {\n          return vm._scales.y(d.y);\n        }\n      });\n\n    return vm;\n  };\n\n  Timeline.scales = function() {\n    var vm = this;\n\n    vm._xMinMax = d3.extent(vm._data, function(d) {\n      return d.x;\n    });\n\n    vm._yMinMax = [\n      vm._config.yAxis.minZero\n        ? 0\n        : d3.min(vm._lines, function(c) {\n            return d3.min(c.values, function(v) {\n              return v.y;\n            });\n          }),\n      d3.max(vm._lines, function(c) {\n        return d3.max(c.values, function(v) {\n          return v.y;\n        });\n      }),\n    ];\n\n    config = {\n      column: vm._config.x,\n      type: vm._config.xAxis.scale,\n      range: [0, vm.chart.width],\n      minZero: false,\n    };\n    vm._scales.x = vm.utils.generateScale(vm._data, config);\n\n    config = {\n      column: vm._config.y,\n      type: vm._config.yAxis.scale,\n      range: [vm.chart.height, 0],\n      minZero: vm._config.yAxis.minZero,\n    };\n    vm._scales.y = vm.utils.generateScale(vm._data, config);\n\n    vm._scales.x.domain(vm._xMinMax);\n    vm._scales.y.domain(vm._yMinMax).nice();\n\n    if (vm._config.hasOwnProperty('colors'))\n      vm._scales.color = d3.scaleOrdinal(vm._config.colors);\n    else vm._scales.color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    if (\n      vm._scales.x.domain()[0].getTime() == vm._scales.x.domain()[1].getTime()\n    ) {\n      // max and min are the same, there's only one datum\n      var oldDomain = vm._scales.x.domain();\n      var oldRange = vm._scales.x.range();\n\n      vm._scales.x\n        .domain([\n          new Date(oldDomain[0].getTime() - 1),\n          oldDomain[0],\n          oldDomain[1],\n        ])\n        .range([0, oldRange[0] + (oldRange[1] - oldRange[0]) / 2, oldRange[1]]);\n    }\n\n    return vm;\n  };\n\n  Timeline.drawLabels = function() {\n    var vm = this;\n    var chartW = vm.chart.width;\n\n    vm.chart\n      .svg()\n      .selectAll('.dots')\n      .each(function(dat) {\n        var el = this;\n        dat.values.forEach(function(c, index) {\n          d3.select(el)\n            .append('text')\n            .attr('class', 'dbox-label')\n            .attr('text-anchor', 'start')\n            .attr('transform', function(d) {\n              if (vm._scales.x(d.values[index].x) >= chartW) {\n                d3.select(this).attr('text-anchor', 'end');\n                return (\n                  'translate (' +\n                  (vm._scales.x(d.values[index].x) - 10) +\n                  ',' +\n                  (vm._scales.y(d.values[index].y) + 4) +\n                  ')'\n                );\n              }\n              d3.select(this).attr('text-anchor', 'start');\n              return (\n                'translate (' +\n                (vm._scales.x(d.values[index].x) + 10) +\n                ',' +\n                (vm._scales.y(d.values[index].y) + 4) +\n                ')'\n              );\n            })\n            .text(function() {\n              return c.y ? vm.utils.format(vm._config.yAxis, true)(c.y) : '';\n            });\n        });\n      });\n  };\n\n  Timeline.draw = function() {\n    var vm = this;\n    //Call the tip\n    vm.chart.svg().call(vm._tip);\n\n    if (vm._scales.x.domain().length === 3) {\n      vm.chart\n        .svg()\n        .select('.x.axis .tick')\n        .remove();\n    }\n\n    var lines = vm.chart\n      .svg()\n      .selectAll('.lines')\n      .data(vm._lines)\n      .enter()\n      .append('g')\n      .attr('class', 'lines');\n\n    var path = vm.chart\n      .svg()\n      .selectAll('.lines')\n      .append('path')\n      .attr('class', 'line')\n      .attr('d', function(d) {\n        return vm._line(d.values);\n      })\n      .attr('stroke', function(d) {\n        return vm._scales.color !== false\n          ? vm._scales.color(d.name)\n          : vm._getQuantileColor(d.name, 'default');\n      })\n      .attr('stroke-width', 4)\n      .attr('fill', 'none');\n\n    /**By default it draws dots on data points with 4px radius*/\n    var dots = vm.chart\n      .svg()\n      .selectAll('.dots')\n      .data(vm._lines)\n      .enter()\n      .append('g')\n      .attr('class', 'dots')\n      .selectAll('.circle')\n      .data(function(d) {\n        d.values.forEach(el => {\n          el.name = d.name;\n        });\n        return d.values;\n      })\n      .enter()\n      .append('circle')\n      .attr('class', 'dot')\n      .attr('cx', function(d, i) {\n        return vm._scales.x(d.x);\n      })\n      .attr('cy', function(d) {\n        return vm._scales.y(d.y);\n      })\n      .attr('r', 4)\n      .style('stroke', function(d) {\n        return vm._scales.color !== false\n          ? vm._scales.color(d.name)\n          : vm._getQuantileColor(d.name, 'default');\n      })\n      .style('stroke-width', 2)\n      .style('fill', '#fff')\n      .style('fill-opacity', 0.5)\n      .on('mouseover', function(d, i) {\n        if (vm._config.mouseover) {\n          //vm._config.mouseover.call(vm, d, i);\n        }\n        vm._tip.show(d, d3.select(this).node());\n      })\n      .on('mouseout', function(d, i) {\n        if (vm._config.mouseout) {\n          //vm._config.mouseout.call(this, d, i);\n        }\n        vm._tip.hide(d, d3.select(this).node());\n      });\n\n    Timeline.drawLabels();\n    //var t = textures.lines().thicker();\n\n    //vm.chart.svg().call(t);\n\n    /* vm._area.y0(vm._scales.y(vm._yMinMax[0]));\n\n    var areas = vm.chart.svg().selectAll(\".areas\")\n      .data(vm._lines)\n    .enter().append(\"g\")\n      .attr(\"class\", \"areas\");\n\n    var pathArea  = vm.chart.svg().selectAll(\".areas\").append(\"path\")\n      .attr(\"class\", \"area\")\n      .attr(\"d\", function(d) {\n        return vm._area(d.values);\n      }) */\n    //.attr(\"fill\", t.url());\n\n    return vm;\n  };\n\n  Timeline.init(config);\n  return Timeline;\n}\n","import * as d3 from 'd3';\n\n/* \n * Simple SVG Treemap Chart\n */\nexport default function(config, helper) {\n\n  var Treemap = Object.create(helper);\n\n  Treemap.init = function(config) {\n    var vm = this;\n    vm._config = config ? config : {};\n    vm._config._padding = 3;\n    vm._config._labels = false;\n    vm._config.tip = function(d) {\n      var html = '<div>';\n      if (d.parent.data.name && d.parent.data.name !== 'data') {\n\n        html += '<span>' + d.parent.data.name + '</span><br>'; \n      }\n      html += '<span>' + d.data.name + '</span><br>'; \n      html += '<span>' + vm.utils.format()(d.value) + '</span>';\n      html += '</div>';\n      return html;\n    };\n    vm._data = [];\n    vm._scales = {\n      color: d3.scaleOrdinal(d3.schemeCategory20c)\n    };\n    vm._axes = {};\n    vm._tip = vm.utils.d3.tip()\n      .attr('class', 'd3-tip tip-treemap')\n      .direction('n')\n      .html(vm._config.tip);\n  }\n\n  Treemap.size = function(col) {\n    var vm = this;\n    vm._config._size = col;\n    return vm;\n  }\n\n  Treemap.colors = function(arrayOfColors, domain) {\n    var vm = this;\n    vm._scales.color = d3.scaleOrdinal(arrayOfColors);\n    if (domain) {\n      vm._scales.color.domain(domain);\n    }\n    return vm;\n  }\n\n  Treemap.padding = function(padding) {\n    var vm = this;\n    vm._config._padding = padding;\n    return vm;\n  }\n\n  Treemap.nestBy = function(keys) {\n    var vm = this;\n    if (Array.isArray(keys)) {\n      if (keys.length == 0)\n        throw \"Error: nestBy() array is empty\";\n      vm._config._keys = keys;\n    } else if (typeof keys === 'string' || keys instanceof String) {\n      vm._config._keys = [keys];\n    } else {\n      if (keys == undefined || keys == null)\n        throw \"Error: nestBy() expects column names to deaggregate data\";\n      vm._config._keys = [keys.toString()];\n      console.warning(\"nestBy() expected name of columns. Argument will be forced to string version .toString()\");\n    }\n    vm._config._labelName = vm._config._keys[vm._config._keys.length - 1]; //label will be last key\n    return vm;\n  }\n\n  Treemap.format = function(format) {\n    var vm = this;\n    if (typeof format == 'function' || format instanceof Function)\n      vm.utils.format = format;\n    else\n      vm.utils.format = d3.format(format, vm._config.decimals);\n    return vm;\n  }\n\n  Treemap.labels = function(bool) {\n    var vm = this;\n    vm._config._labels = Boolean(bool);\n    return vm;\n  };\n\n  Treemap.tip = function(tip) {\n    var vm = this;\n    vm._config.tip = tip;\n    vm._tip.html(vm._config.tip);\n    return vm;\n  }\n\n  Treemap.scales = function (scales) {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.axes = function() {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.domains = function() {\n    var vm = this;\n    return vm;\n  }\n\n  Treemap.isValidStructure = function(datum) {\n    var vm = this;\n    if ((typeof datum.name === 'string' || datum.name instanceof String) && Array.isArray(datum.children)) {\n      var res = true;\n      datum.children.forEach(function(child) {\n        res = res && vm.isValidStructure(child);\n      });\n      return res;\n    } else if ((typeof datum.name === 'string' || datum.name instanceof String) && Number(datum[vm._config._size]) == datum[vm._config._size]) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  Treemap.formatNestedData = function(data) {\n    var vm = this;\n    if (data.key) {\n      data.name = data.key;\n      delete data.key;\n    } else {\n      if (!Array.isArray(data.values)) {\n        data.name = data[vm._config._labelName];\n      }\n    }\n    if (Array.isArray(data.values)) {\n      var children = [];\n      data.values.forEach(function(v) {\n        children.push(vm.formatNestedData(v))\n      });\n      data.children = children;\n      delete data.values;\n    }\n    if (!data[vm._config._size] && data.value) {\n      data[vm._config._size] = data.value;\n    }\n    return data;\n  }\n\n  function nestKey(nest, key, callback) {\n    callback(null, nest.key(function(d) {\n      return d[key];\n    }))\n  }\n\n  Treemap.data = function(data) {\n    var vm = this;\n    // Validate structure like [{name: '', children: [{},{}]}]\n    if (data) {\n      if (Array.isArray(data) && data.length > 0) {\n        if (!vm.isValidStructure(data[0])) {\n          data.forEach(function(d) {\n            d[vm._config._size] = +d[vm._config._size];\n          });\n          try {\n            if (!vm._config._keys)\n              throw \"nestBy() in layer was not configured\";\n            var nested = d3.nest();\n            var queue = d3.queue();\n            for (var i = 0; i < vm._config._keys.length; i++)\n              queue.defer(nestKey, nested, vm._config._keys[i])\n            queue.awaitAll(function(error, nested) {\n              var nestedData = nested[0].rollup(function(leaves) {\n                return d3.sum(leaves, function(d) {\n                  return d[vm._config._size];\n                })\n              }).entries(data);\n              var aux = {};\n              aux.key = 'data';\n              aux.values = _.cloneDeep(nestedData); // WARN: Lodash dependency\n              data = vm.formatNestedData(aux);\n              vm._data = data;\n            });\n\n          } catch (err) {\n            console.error(err);\n          }\n        }\n      } else {\n        if (!vm.isValidStructure(data)) {\n          try {\n            if (!data.key)\n              throw \"Property 'key' not found\";\n            if (data[vm._config._size] !== Number(data[vm._config._size]))\n              throw \"Value used for treemap rect size is not a number\";\n            data = vm.formatNestedData(data);\n            vm._data = data;\n          } catch (err) {\n            console.error(err);\n          }\n        }\n      }\n    }\n    return vm;\n  }\n\n  Treemap.draw = function() {\n    var vm = this;\n    vm.chart.svg().call(vm._tip);\n\n    var treemap = d3.treemap()\n      .tile(d3.treemapResquarify)\n      .size([vm.chart.width, vm.chart.height])\n      .round(true)\n      .paddingInner(vm._config._padding);\n\n    var root = d3.hierarchy(vm._data)\n      .eachBefore(function(d) {\n        d.data.id = (d.parent ? d.parent.data.id + \".\" : \"\") + d.data.name;\n      })\n      .sum(function(d) {\n        return d[vm._config._size];\n      })\n      .sort(function(a, b) {\n        return b.height - a.height || b.value - a.value;\n      });\n\n    treemap(root);\n\n    var cell = vm.chart.svg().selectAll(\"g\")\n      .data(root.leaves())\n      .enter().append(\"g\")\n      .attr(\"transform\", function(d) {\n        return \"translate(\" + d.x0 + \",\" + d.y0 + \")\";\n      });\n\n    var rect = cell.append(\"rect\")\n      .attr(\"id\", function(d) {\n        return d.data.id;\n      })\n      .attr(\"width\", function(d) {\n        return d.x1 - d.x0;\n      })\n      .attr(\"height\", function(d) {\n        return d.y1 - d.y0;\n      })\n      .attr(\"fill\", function(d) {\n        return vm._scales.color(d.data.name);\n      });\n\n    cell.append(\"clipPath\")\n      .attr(\"id\", function(d) {\n        return \"clip-\" + d.data.id;\n      })\n      .append(\"use\")\n      .attr(\"xlink:href\", function(d) {\n        return \"#\" + d.data.id;\n      });\n\n    if (vm._config._labels) {\n      var text = cell.append(\"text\")\n        .attr(\"clip-path\", function(d) {\n          return \"url(#clip-\" + d.data.id + \")\";\n        })\n      text.append(\"tspan\")\n        .attr('class', 'capitalize')\n        .attr(\"x\", 8)\n        .attr(\"y\", 25)\n        .text(function(d) {\n          if (d.value > 2) {\n            var arr = d.data.id.replace('data.', '').split('.');\n            return arr.length > 1 ? arr.slice(arr.length - 2, arr.length).join(' / ') : arr[arr.length - 1].toString();\n          } else\n            return '';\n        });\n      text.append(\"tspan\")\n        .attr('class', 'capitalize')\n        .attr(\"x\", 8)\n        .attr(\"y\", 45)\n        .text(function(d) {\n          return d.value > 2 ? vm.utils.format(null, true)(d.value) : '';\n        });\n    }\n\n    rect.on('mouseover', function(d) {\n        /*if(vm._config.data.mouseover){\n          vm._config.data.mouseover.call(vm, d,i);\n        }*/\n        vm._tip.show(d, d3.select(this).node());\n      })\n      .on('mouseout', function(d) {\n        /*if(vm._config.data.mouseout){\n          vm._config.data.mouseout.call(this, d,i);\n        }*/\n        vm._tip.hide(d, d3.select(this).node());\n      })\n\n    return vm;\n  }\n\n  Treemap.init(config);\n  return Treemap;\n}\n","/*\n * Dboxjs\n *\n * You can import other modules here, including external packages. When\n * bundling using rollup you can mark those modules as external and have them\n * excluded or, if they have a jsnext:main entry in their package.json (like\n * this package does), let rollup bundle them into your dist file.\n */\n\n/* Core */\nexport { default as chart } from './lib/chart';\n\n/* Chart modules */\nexport { default as bars } from '@dboxjs/bars';\n\nexport { default as distro } from '@dboxjs/distro';\n\nexport { default as heatmap } from '@dboxjs/heatmap';\n\nexport { default as leaflet } from '@dboxjs/leaflet';\n\nexport { default as map } from '@dboxjs/map';\n\nexport { default as radar } from '@dboxjs/radar';\n\nexport { default as scatter } from '@dboxjs/scatter';\n\nexport { default as spineplot } from '@dboxjs/spineplot';\n\nexport { default as timeline } from '@dboxjs/timeline';\n\nexport { default as treemap } from '@dboxjs/treemap';\n"],"names":["d3Tip","require","vm","Helper","chart","config","_config","width","_width","height","_height","style","_addStyle","fullSvg","_fullSvg","svg","_svg","utils","d3","tip","default","generateScale","data","scale","domains","range","groupBy","map","d","column","stackBy","serie","undefined","type","minZero","Array","isArray","rangeRound","domain","nice","padding","bins","format","smallNumber","linearAxis","yAxis","xAxis","decimals","axis","formatPreffix","formatSuffix","Number","isNaN","floatingPoints","isInteger","value","suffix","currentAxis","mean","_scales","replace","ticks","scaleText","floats","toString","split","points","index","length","number","indexOf","wrap","text","tooltip","each","words","reverse","word","line","lineNumber","lineHeight","y","attr","dy","parseFloat","tspan","append","pop","push","join","node","getComputedTextLength","on","show","hide","i","slice","sortAscending","a","b","sortDescending","VirtualScroller","enter","update","exit","dataid","viewport","totalRows","position","rowHeight","totalHeight","viewportHeight","visibleRows","delta","scrollTop","virtualscroller","container","render","resize","parseInt","Math","ceil","lastPosition","scrollRenderFrame","scrollPosition","position0","max","min","position1","rowSelection","selectAll","call","remove","legendTitle","findIndex","x","name","events","onClickLegend","stopPropagation","order","rowUpdateSelection","isFirefox","InstallTrigger","support","document","onmousewheel","evt","preventDefault","deltaY","wheelDelta","drawScrollLegend","scrollLegend","_","__","arguments","Chart","isIE","documentMode","err","isEdge","window","StyleMedia","init","defaultConfig","size","margin","left","right","top","bottom","defaultStyle","backgroundColor","color","title","textColor","fontSize","fontWeight","textAlign","hr","enabled","borderWidth","borderColor","legend","figure","opacity","fontFamily","border","radius","strokeWidth","strokeColor","strokeOpacity","paddingTick","grid","gridDashed","labels","textAnchor","_data","_margin","addStyle","_axes","layers","helper","bind","sizeObj","stylesObj","bindTo","selector","Object","assign","legendType","layer","_layer","getLayer","layerIndex","draw","q","scales","loadData","awaitAll","error","results","initLayers","drawSVG","axes","drawAxes","drawLayers","load","dispatch","theme","buckets","o","setScales","tickSizeOuter","tickSize","values","tickValues","tickFormat","tsv","defer","json","csv","raw","mapData","topojson","url","forEach","ly","select","html","template","classed","categories","c","hasOwnProperty","legendEnabled","drawLegend","legendBox","virtualScroller","legendX","marginTop","colors","legendTip","lWidth","lbWidth","rx","ry","markStrokeWidth","legendEnter","legendCheck","coordinates","property","active","legendUpdate","legendExit","styles","drawGrid","axesTip","element","dropdown","yAxisDropDown","updateAxis","getBoundingClientRect","display","transform","options","selected","console","log","_xAxis","abs","xAxisDropDown","tickWidth","rotate","biggestLabelWidth","nodes","xBandWidth","bandwidth","stroke","keys","k","obj","change","callback","getDomains","minMax","sorted","sortFunctionY","sortFunctionX","sort","destroy","Bars","create","_tip","direction","id","columnName","columns","fill","sortBy","option","Function","filter","_quantiles","_setQuasecondntile","_minMax","drawLabels","charContainer","barH","barW","_drawGroupByXAxis","_drawGroupByYAxis","_drawStackByXAxis","_drawStackByYAxis","_getQuantileColor","quantiles","onmouseover","onmouseout","onclick","drawGroupLabels","el","dat","barReference","toFixed","key","drawStackLabels","groups","stacks","rect","rectH","getBBox","_setQuantile","quantile","predefinedQuantiles","ignoreZeros","aux","j","total","bars","outOfRangeColor","colorsOnHover","makeDistroChart","settings","idName","xName","xSort","yName","axisLables","yTicks","chartSize","constrainExtremes","setting","formatAsFloat","formatNumber","formatRange","logFormatNumber","floor","yFormatter","xFormatter","groupObjs","objs","mainDiv","chartDiv","g","colorFunct","getColorFunct","colorOptions","colorMap","group","getObjWidth","objWidth","gName","objSize","middle","xScale","gShift","addJitter","doJitter","random","shallowCopy","oldObj","newObj","tooltipHover","groupName","metrics","pointName","pointValue","boxpart","tooltipString","toLocaleString","quartile3","median","quartile1","transition","duration","prepareData","calcMetrics","upperOuterFence","upperInnerFence","iqr","lowerInnerFence","lowerOuterFence","LIF","UIF","current_x","current_y","current_id","current_idName","current_row","valuesInfo","cName","prepareSettings","divWidth","divHeight","axisLabels","xAxisLable","yAxisLable","yScale","fences","clamp","tickSizeInner","violinPlots","_yDomainVP","prepareChart","renderViolinPlot","defaultOptions","showViolinPlot","resolution","curve","vOpts","violin","updateOptions","prepareViolin","reset","opts","cViolinPlot","xVScale","copy","kde","kernelDensityEstimator","eKernel","kdedata","interpolateMax","interpolateMin","kdeTester","eKernelTest","interMaxY","interMaxX","count","interMinY","interMinX","objBounds","yVScale","area","y0","y1","datum","kernel","sample","v","u","array","testX","renderBoxPlot","boxPlots","showBox","showWhiskers","showMedian","showMean","medianCSize","showOutliers","boxWidth","lineWidth","scatterOutliers","outlierCSize","bOpts","boxPlot","calcAllOutliers","calcOutliers","cGroup","cExtremes","cOutliers","cOut","idx","outliers","extremes","prepareBoxPlot","cBoxPlot","sMetrics","box","lineBounds","upperWhisker","fence","lowerWhisker","circle","pt","point","pageX","pageY","outDiv","extDiv","renderNotchBoxes","notchBoxes","showNotchBox","showLines","medianWidth","notchStyle","nOpts","notchBox","makeNotchBox","cNotch","notchBounds","scaledValues","boxLeft","lowerNotch","medianLeft","upperNotch","boxRight","medianRight","calcNotches","modifier","sqrt","prepareNotchBoxes","boxBounds","medianBounds","notch","upperLine","confidenceLines","upper","lower","lowerLine","renderDataPlots","dataPlots","showPlot","plotType","pointSize","showBeanLines","beanWidth","dOpts","preparePlots","cPlot","halfBand","cMetric","lines","swarmBounds","yPtScale","interpolate","maxWidth","ptsObj","cYBucket","pts","rightMax","row","leftMin","col","plotBounds","scatterWidth","bean","beanBounds","val","valInfo","onClickElement","Distro","opt","chart1","babelHelpers.typeof","Heatmap","legendTranslate","_legendElementWidth","_gridWidth","colorLegend","borderRadius","ySort","xCategories","sortKeys","entries","yCategories","fillValues","_gridHeight","m","coefficient","drawColorLegend","quantilePosition","invertExtent","cards","String","_yLabels","_yTitle","_xLabels","labelMaxWidth","_xTitle","mouseover","mouseout","L","Leaflet","_topojson","objects","_nodes","geometries","geom","parser","found","properties","step","formatLegend","urlTopojson","tran","translate","TopoJSON","GeoJSON","extend","addData","jsonData","geojson","prototype","LatLng","lat","lon","center","bounds","LatLngBounds","_map","Map","getCenter","zoom","maxZoom","minZoom","maxBounds","maxBoundsViscosity","mapTiles","tileLayer","attribution","topoLayer","addTo","addTopoData","topoData","eachLayer","handleLayer","feature","NOM_ENT","NOM_MUN","_path","fillColor","setStyle","fillOpacity","weight","drawLabel","enterLayer","leaveLayer","props","path","bbox","_formatWithZeroDecimals","_formatWithOneDecimal","_formatWithTwoDecimals","_formatWithThreeDecimals","_format","percentage","end","_chart","s","_projection","projection","_polygons","translateX","features","_polygonsDefault","dropWhile","Radar","CIRCLE_RADIANS","PI","RADIANS_TO_ROTATE","_axesData","_filter","_viewData","_colorMap","_ticks","_scale","_excludedPolygons","transitionDuration","axisLabelMargin","enable","at","styleDefaults","_center","_radius","polygonsFrom","axesFrom","valuesFrom","drawTicks","dur","sel","empty","_ifStyleDefaults","drawTicksLabels","extractAxes","result","radiansPerAxis","reduce","prev","item","concat","rads","list","hash","hashed","buildColorMap","cMap","polyg","cIdx","polygon","selection","xOf","yOf","drawAxesLabels","fromCenter","rects","drawPolygons","groupedData","gs","gsExit","gsEnter","bundle","polygIdx","polygons","rawData","xy","CVE_ENT","_buildNestedPolygons","_buildNestedVertexes","toUpdate","appendHelper","updateHelper","_showTooltip","_hideTooltip","removeHelper","dataFunc","keyFunc","val1","val2","tt","subtt","bg","centerPoints","side","newLegend","_toggleList","base","items","newItems","it","cos","sin","dataForVisualization","axisKey","valKey","polygKey","axesHash","scVal","fun","_calcDomains","Scatter","defaultTip","fontColor","magnitude","radiusRange","magnitudeRange","figureType","regression","xr","yr","xMean","yMean","b1","b0","term1","term2","p","yhat","radiusMinMax","magnitudeMinMax","scaleDomain","yCoords","xCoords","repeat","xCoord","yCoord","space","current","cnt","allText","Spineplot","orientation","category","x0","x1","stackValues","totalCollapse","stack","txpe","sv","rectW","posX","largestLabelWidth","newLabelMaxWidth","textSize","getComputedStyle","getPropertyValue","numSize","diffPos1","diffPos2","lessThanPrev","lessThanPost","removed","cat","h","Timeline","parseDate","scaleColor","series","arr","tmp","getTime","_lines","n","_line","defined","_area","alreadyScaled","_xMinMax","_yMinMax","oldDomain","oldRange","Date","chartW","dots","Treemap","_padding","_labels","parent","_size","arrayOfColors","nestBy","_keys","warning","_labelName","bool","Boolean","isValidStructure","children","res","child","formatNestedData","nestKey","nest","nested","queue","nestedData","rollup","leaves","cloneDeep","treemap","tile","round","paddingInner","root","eachBefore","sum","cell"],"mappings":"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"}